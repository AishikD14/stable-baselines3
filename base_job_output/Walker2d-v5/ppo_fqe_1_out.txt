No devices were found
---------------------------------
Environment created
Box(-1.0, 1.0, (6,), float32) Box(-inf, inf, (17,), float64)
Loading Initial saved model
Model loaded
Loading replay buffer
Replay buffer loaded
Replay buffer shape:  (100000, 17) (100000, 6) (100000, 1) (100000, 1)
Starting evaluation
1953
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.015371836170885148
avg return on 5 trajectories of agent0: 2501.6509396666665
Episode generator created
[2m2025-05-05 15:47.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:47.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:47.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:47.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:47.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154712[0m
[2m2025-05-05 15:47.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:47.20[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019447941780090332, 'time_algorithm_update': 0.0050196490287780764, 'loss': 1.3223984198123218, 'time_step': 0.0070143635272979735, 'init_value': 10.236193656921387}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:47.29[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019465436935424804, 'time_algorithm_update': 0.005020866632461548, 'loss': 4.0025415391027925, 'time_step': 0.0070175805091857914, 'init_value': 19.794017791748047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:47.37[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019484431743621827, 'time_algorithm_update': 0.005032334089279175, 'loss': 7.614231501579285, 'time_step': 0.007031285047531128, 'init_value': 30.20250129699707}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:47.45[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019553329944610597, 'time_algorithm_update': 0.005031065464019775, 'loss': 12.989743480324746, 'time_step': 0.007037140846252441, 'init_value': 39.62370300292969}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:47.53[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001953770399093628, 'time_algorithm_update': 0.005023489236831665, 'loss': 14.495719007372855, 'time_step': 0.007027522563934326, 'init_value': 48.500083923339844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:48.02[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019592933654785155, 'time_algorithm_update': 0.005047419309616089, 'loss': 20.339778208971023, 'time_step': 0.007057071447372437, 'init_value': 55.42258071899414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:48.10[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019481792449951173, 'time_algorithm_update': 0.005026962518692017, 'loss': 21.131424695611, 'time_step': 0.007024922132492065, 'init_value': 62.90241622924805}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:48.18[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019562013149261475, 'time_algorithm_update': 0.0050338819026947024, 'loss': 25.402362173318863, 'time_step': 0.007039535284042359, 'init_value': 70.287109375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:48.27[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957653045654297, 'time_algorithm_update': 0.00503861141204834, 'loss': 27.489409524202348, 'time_step': 0.007046000003814697, 'init_value': 73.51910400390625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:48.35[0m [[32m[1minfo     [0m] [1mFQE_20250505154712: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955895185470581, 'time_algorithm_update': 0.005025023221969604, 'loss': 28.10744472193718, 'time_step': 0.00703090500831604, 'init_value': 79.99373626708984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.99373626708984
avg return on 5 trajectories of agent1: 2957.136307
Episode generator created
[2m2025-05-05 15:48.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:48.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:48.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:48.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:48.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154837[0m
[2m2025-05-05 15:48.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:48.46[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001947282075881958, 'time_algorithm_update': 0.004992061614990234, 'loss': 1.5212256227731704, 'time_step': 0.006988770008087159, 'init_value': 10.820701599121094}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:48.54[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019571521282196044, 'time_algorithm_update': 0.005047441720962525, 'loss': 4.05860847991705, 'time_step': 0.007054250240325927, 'init_value': 20.71124267578125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:49.03[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955677032470703, 'time_algorithm_update': 0.005063479423522949, 'loss': 7.522374441802501, 'time_step': 0.007069449663162231, 'init_value': 30.363012313842773}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:49.11[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001947678804397583, 'time_algorithm_update': 0.005027020215988159, 'loss': 13.088350937306881, 'time_step': 0.007024332046508789, 'init_value': 39.98827362060547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:49.19[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019533302783966066, 'time_algorithm_update': 0.00506258749961853, 'loss': 16.293366364359855, 'time_step': 0.00706566047668457, 'init_value': 48.177040100097656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:49.28[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019576733112335203, 'time_algorithm_update': 0.0050693776607513424, 'loss': 18.667988486886024, 'time_step': 0.007076996088027954, 'init_value': 56.6886100769043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:49.36[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019635145664215086, 'time_algorithm_update': 0.0050715522766113285, 'loss': 22.40372706615925, 'time_step': 0.007085277795791626, 'init_value': 63.4601936340332}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:49.44[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001954505920410156, 'time_algorithm_update': 0.005049762487411499, 'loss': 30.333446464776994, 'time_step': 0.007054246187210083, 'init_value': 70.33987426757812}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:49.53[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957093954086304, 'time_algorithm_update': 0.005060235738754273, 'loss': 32.10653984618187, 'time_step': 0.007067708969116211, 'init_value': 77.21092224121094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:50.01[0m [[32m[1minfo     [0m] [1mFQE_20250505154837: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969224452972412, 'time_algorithm_update': 0.005073705673217774, 'loss': 31.320407047390937, 'time_step': 0.007093287944793701, 'init_value': 82.38753509521484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.38753509521484
avg return on 5 trajectories of agent2: 1570.9516106666667
Episode generator created
[2m2025-05-05 15:50.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:50.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:50.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:50.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:50.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155002[0m
[2m2025-05-05 15:50.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:50.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019500529766082763, 'time_algorithm_update': 0.004997881889343261, 'loss': 1.442762452200055, 'time_step': 0.006997422695159912, 'init_value': 10.603042602539062}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:50.19[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019340157508850099, 'time_algorithm_update': 0.004959806680679322, 'loss': 4.727899295210839, 'time_step': 0.006942489147186279, 'init_value': 21.284698486328125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:50.27[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019374167919158935, 'time_algorithm_update': 0.004963332414627075, 'loss': 9.834394714951515, 'time_step': 0.006949310064315796, 'init_value': 30.395219802856445}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:50.35[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019422261714935303, 'time_algorithm_update': 0.004978736639022827, 'loss': 12.93396837770939, 'time_step': 0.006969926118850708, 'init_value': 39.52642822265625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:50.44[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001921198606491089, 'time_algorithm_update': 0.004920017004013061, 'loss': 15.446332177162171, 'time_step': 0.006889291524887085, 'init_value': 47.76042556762695}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:50.52[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019460175037384034, 'time_algorithm_update': 0.004973843574523926, 'loss': 21.63201282763481, 'time_step': 0.0069688594341278075, 'init_value': 55.77070617675781}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:51.00[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019741296768188477, 'time_algorithm_update': 0.00507344913482666, 'loss': 26.157788155674936, 'time_step': 0.007097488641738892, 'init_value': 62.08198165893555}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:51.09[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002195119857788, 'time_algorithm_update': 0.0051492094993591305, 'loss': 30.957197509527205, 'time_step': 0.007202720165252686, 'init_value': 69.1534423828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:51.17[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019808664321899414, 'time_algorithm_update': 0.005096154451370239, 'loss': 30.094045449495315, 'time_step': 0.007127812147140503, 'init_value': 72.3787841796875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:51.26[0m [[32m[1minfo     [0m] [1mFQE_20250505155002: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019633574485778808, 'time_algorithm_update': 0.005051327705383301, 'loss': 33.8640202909708, 'time_step': 0.007064426898956299, 'init_value': 75.56519317626953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.56519317626953
avg return on 5 trajectories of agent3: 1523.8585033333336
Episode generator created
[2m2025-05-05 15:51.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:51.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:51.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:51.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:51.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155127[0m
[2m2025-05-05 15:51.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:51.35[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019462859630584716, 'time_algorithm_update': 0.004966637134552002, 'loss': 1.4916462146937848, 'time_step': 0.006961995124816894, 'init_value': 10.663433074951172}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:51.43[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018978116512298583, 'time_algorithm_update': 0.004849722385406494, 'loss': 4.081027364224195, 'time_step': 0.006795510053634644, 'init_value': 21.255428314208984}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:51.51[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019033570289611816, 'time_algorithm_update': 0.004868249893188476, 'loss': 7.7578081743717195, 'time_step': 0.006819821119308471, 'init_value': 30.967599868774414}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:51.59[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001904114007949829, 'time_algorithm_update': 0.004868626594543457, 'loss': 12.924305241405964, 'time_step': 0.006820826768875122, 'init_value': 41.4511604309082}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:52.07[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907719373703003, 'time_algorithm_update': 0.004873273849487304, 'loss': 15.671523516535759, 'time_step': 0.006829636096954346, 'init_value': 48.99650192260742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:52.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018790640830993652, 'time_algorithm_update': 0.004820908784866333, 'loss': 21.7110175024271, 'time_step': 0.006747601509094238, 'init_value': 58.513858795166016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:52.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018926563262939454, 'time_algorithm_update': 0.004843345880508423, 'loss': 26.12591473531723, 'time_step': 0.0067838671207427976, 'init_value': 65.19189453125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:52.32[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001900465726852417, 'time_algorithm_update': 0.004859939575195312, 'loss': 27.68411685883999, 'time_step': 0.006808924674987793, 'init_value': 72.67975616455078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:52.40[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018917312622070313, 'time_algorithm_update': 0.004849687576293945, 'loss': 27.447416817188262, 'time_step': 0.00678977632522583, 'init_value': 78.56434631347656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:52.48[0m [[32m[1minfo     [0m] [1mFQE_20250505155127: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018944613933563233, 'time_algorithm_update': 0.004844744205474854, 'loss': 31.61858191251755, 'time_step': 0.006787270069122314, 'init_value': 86.13761901855469}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 86.13761901855469
avg return on 5 trajectories of agent4: 2602.683249333333
Episode generator created
[2m2025-05-05 15:52.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:52.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:52.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:52.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:52.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155250[0m
[2m2025-05-05 15:52.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:52.58[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001882641077041626, 'time_algorithm_update': 0.004766845226287842, 'loss': 1.3797234913855791, 'time_step': 0.006696983814239502, 'init_value': 10.024853706359863}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:53.06[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018963384628295898, 'time_algorithm_update': 0.004864256620407104, 'loss': 3.9756689486801626, 'time_step': 0.006808457851409912, 'init_value': 20.221187591552734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:53.14[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001895961046218872, 'time_algorithm_update': 0.004861562967300415, 'loss': 7.387983608245849, 'time_step': 0.006805361986160279, 'init_value': 29.38800048828125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:53.22[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018985259532928467, 'time_algorithm_update': 0.004870564699172974, 'loss': 11.295553384423256, 'time_step': 0.006817002773284912, 'init_value': 37.190914154052734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:53.30[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019030849933624268, 'time_algorithm_update': 0.004876947641372681, 'loss': 14.403281197547912, 'time_step': 0.00682876706123352, 'init_value': 44.42967987060547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:53.38[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018995132446289064, 'time_algorithm_update': 0.0048625669479370115, 'loss': 17.09230158126354, 'time_step': 0.006810286283493042, 'init_value': 52.091163635253906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:53.46[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018847002983093262, 'time_algorithm_update': 0.004829326152801514, 'loss': 19.884939361810684, 'time_step': 0.006761636972427368, 'init_value': 58.21468734741211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:53.54[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019009478092193604, 'time_algorithm_update': 0.004858055830001831, 'loss': 22.977023166537286, 'time_step': 0.006806936264038086, 'init_value': 66.10688018798828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:54.03[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019106936454772949, 'time_algorithm_update': 0.004887942552566528, 'loss': 27.82241799426079, 'time_step': 0.006847117900848389, 'init_value': 72.45246124267578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:54.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155250: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019071657657623291, 'time_algorithm_update': 0.004859518527984619, 'loss': 31.2942876932621, 'time_step': 0.006814979076385498, 'init_value': 78.27572631835938}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.27572631835938
avg return on 5 trajectories of agent5: 2417.3045953333335
Episode generator created
[2m2025-05-05 15:54.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:54.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:54.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:54.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:54.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155412[0m
[2m2025-05-05 15:54.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:54.20[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018824462890625, 'time_algorithm_update': 0.004760531902313232, 'loss': 1.412950583830476, 'time_step': 0.0066907482147216795, 'init_value': 9.850198745727539}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:54.28[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018954315185546874, 'time_algorithm_update': 0.0048247694969177244, 'loss': 4.5768647029995915, 'time_step': 0.006768494129180908, 'init_value': 19.09909439086914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:54.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019062101840972901, 'time_algorithm_update': 0.004854332447052002, 'loss': 8.63932142084837, 'time_step': 0.006809163808822632, 'init_value': 27.168058395385742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:54.45[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019047696590423584, 'time_algorithm_update': 0.004836803197860718, 'loss': 12.86773290848732, 'time_step': 0.00679000186920166, 'init_value': 36.042518615722656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:54.53[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019042267799377441, 'time_algorithm_update': 0.004834034204483032, 'loss': 15.662788007974624, 'time_step': 0.006786675930023194, 'init_value': 44.36416244506836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:55.01[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001905414581298828, 'time_algorithm_update': 0.004830078840255737, 'loss': 21.494938109993935, 'time_step': 0.006783880949020386, 'init_value': 50.87986373901367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:55.09[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018928999900817871, 'time_algorithm_update': 0.004821681976318359, 'loss': 24.76357876586914, 'time_step': 0.006762777328491211, 'init_value': 56.90707015991211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:55.17[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018988511562347413, 'time_algorithm_update': 0.0048249375820159915, 'loss': 26.405336913704872, 'time_step': 0.006772069931030273, 'init_value': 60.44613265991211}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:55.25[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001904980182647705, 'time_algorithm_update': 0.004825311183929443, 'loss': 29.120081697702407, 'time_step': 0.006778485774993896, 'init_value': 64.41194152832031}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:55.33[0m [[32m[1minfo     [0m] [1mFQE_20250505155412: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019020359516143798, 'time_algorithm_update': 0.004829892873764038, 'loss': 29.870394005537033, 'time_step': 0.006781739234924316, 'init_value': 67.78418731689453}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 67.78418731689453
avg return on 5 trajectories of agent6: 3000.148212
Episode generator created
[2m2025-05-05 15:55.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:55.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:55.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:55.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:55.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155535[0m
[2m2025-05-05 15:55.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:55.43[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018893799781799316, 'time_algorithm_update': 0.004770437717437744, 'loss': 1.481655039548874, 'time_step': 0.006707852363586426, 'init_value': 9.496025085449219}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:55.51[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001902190923690796, 'time_algorithm_update': 0.004824481010437012, 'loss': 4.27935250633955, 'time_step': 0.00677445912361145, 'init_value': 18.945751190185547}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:55.59[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018991034030914308, 'time_algorithm_update': 0.004828960180282593, 'loss': 8.806343926846981, 'time_step': 0.006776538133621216, 'init_value': 28.856082916259766}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:56.07[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001910109281539917, 'time_algorithm_update': 0.004862138271331787, 'loss': 14.773293268799781, 'time_step': 0.0068210926055908205, 'init_value': 38.48375701904297}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:56.16[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908522367477417, 'time_algorithm_update': 0.004843258619308471, 'loss': 19.92607170534134, 'time_step': 0.006800500631332397, 'init_value': 46.83909225463867}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:56.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019076695442199706, 'time_algorithm_update': 0.004844561576843261, 'loss': 27.007434475660325, 'time_step': 0.006800740957260132, 'init_value': 52.85194778442383}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:56.32[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001903818130493164, 'time_algorithm_update': 0.004836986780166626, 'loss': 28.901969713926317, 'time_step': 0.006789345264434815, 'init_value': 62.25265884399414}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:56.40[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00189975905418396, 'time_algorithm_update': 0.004832192182540894, 'loss': 36.02721051859856, 'time_step': 0.006779541969299316, 'init_value': 67.28019714355469}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:56.48[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019079384803771973, 'time_algorithm_update': 0.004838989496231079, 'loss': 39.038927597522736, 'time_step': 0.006795293807983398, 'init_value': 73.71979522705078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:56.56[0m [[32m[1minfo     [0m] [1mFQE_20250505155535: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018949005603790283, 'time_algorithm_update': 0.004833263397216797, 'loss': 41.68996235513687, 'time_step': 0.006776402473449707, 'init_value': 79.43624114990234}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.43624114990234
avg return on 5 trajectories of agent7: 2616.9605856666667
Episode generator created
[2m2025-05-05 15:56.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:56.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:56.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:56.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:56.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155658[0m
[2m2025-05-05 15:56.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:57.06[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018912873268127441, 'time_algorithm_update': 0.0047902376651763915, 'loss': 1.4045977337062359, 'time_step': 0.006729356527328491, 'init_value': 10.323200225830078}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:57.14[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019064509868621825, 'time_algorithm_update': 0.004883777379989624, 'loss': 4.083283453434706, 'time_step': 0.006838466882705689, 'init_value': 21.245378494262695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:57.22[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001900282382965088, 'time_algorithm_update': 0.004876367807388306, 'loss': 8.003746596097946, 'time_step': 0.006825098514556885, 'init_value': 31.187253952026367}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:57.30[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019068717956542969, 'time_algorithm_update': 0.004898000240325928, 'loss': 13.27719571018219, 'time_step': 0.006853732824325561, 'init_value': 40.28224563598633}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:57.38[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019038937091827393, 'time_algorithm_update': 0.004884153127670288, 'loss': 17.983110857248306, 'time_step': 0.006837029695510864, 'init_value': 48.27268981933594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:57.46[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001898104190826416, 'time_algorithm_update': 0.0048724615573883055, 'loss': 21.984845002293586, 'time_step': 0.006818529605865479, 'init_value': 56.36871337890625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:57.54[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019022557735443116, 'time_algorithm_update': 0.004881500244140625, 'loss': 25.8686296697855, 'time_step': 0.006832056999206543, 'init_value': 62.62904357910156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:58.03[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019141552448272705, 'time_algorithm_update': 0.00491256856918335, 'loss': 28.64790016746521, 'time_step': 0.006875620126724243, 'init_value': 67.31999206542969}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:58.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019048326015472412, 'time_algorithm_update': 0.004896901607513428, 'loss': 30.27244644165039, 'time_step': 0.00684992241859436, 'init_value': 71.8079833984375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:58.19[0m [[32m[1minfo     [0m] [1mFQE_20250505155658: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001900846004486084, 'time_algorithm_update': 0.004874263763427734, 'loss': 31.74465608239174, 'time_step': 0.006823389053344726, 'init_value': 75.0638198852539}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.0638198852539
avg return on 5 trajectories of agent8: 2236.295095
Episode generator created
[2m2025-05-05 15:58.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:58.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:58.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:58.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:58.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155821[0m
[2m2025-05-05 15:58.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:58.29[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018903164863586426, 'time_algorithm_update': 0.004791766881942749, 'loss': 1.4843356439620257, 'time_step': 0.006729552268981934, 'init_value': 10.731077194213867}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:58.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019039075374603272, 'time_algorithm_update': 0.004886432409286499, 'loss': 4.564909628808499, 'time_step': 0.006837860107421875, 'init_value': 21.149612426757812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:58.45[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019032580852508545, 'time_algorithm_update': 0.004879524230957031, 'loss': 8.725816750109196, 'time_step': 0.00683124828338623, 'init_value': 30.680526733398438}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:58.53[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001916522741317749, 'time_algorithm_update': 0.004882168769836426, 'loss': 13.237501049816608, 'time_step': 0.006847357749938965, 'init_value': 41.58788299560547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:59.01[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019102587699890137, 'time_algorithm_update': 0.004887830972671509, 'loss': 17.489400955080985, 'time_step': 0.006846482515335083, 'init_value': 49.08517074584961}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:59.09[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019046835899353028, 'time_algorithm_update': 0.004875052452087403, 'loss': 21.27347791302204, 'time_step': 0.006828082084655762, 'init_value': 57.84777069091797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:59.17[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019125306606292724, 'time_algorithm_update': 0.004890349626541138, 'loss': 24.355124253749846, 'time_step': 0.006851387977600098, 'init_value': 64.69317626953125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:59.25[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908921718597412, 'time_algorithm_update': 0.004884257078170777, 'loss': 28.34053019618988, 'time_step': 0.006841594934463501, 'init_value': 71.06586456298828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:59.34[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165406227111817, 'time_algorithm_update': 0.004898153066635132, 'loss': 30.00449072611332, 'time_step': 0.006863688707351685, 'init_value': 78.31307220458984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:59.42[0m [[32m[1minfo     [0m] [1mFQE_20250505155821: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001886399507522583, 'time_algorithm_update': 0.004860835075378418, 'loss': 33.22046712756157, 'time_step': 0.006794543266296387, 'init_value': 83.39208984375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.39208984375
avg return on 5 trajectories of agent9: 2404.59338
Episode generator created
[2m2025-05-05 15:59.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:59.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:59.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:59.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:59.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155943[0m
[2m2025-05-05 15:59.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:59.52[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018987135887145996, 'time_algorithm_update': 0.004793502807617187, 'loss': 1.396168371796608, 'time_step': 0.006739932775497437, 'init_value': 10.018272399902344}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:00.00[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018973639011383057, 'time_algorithm_update': 0.004859295845031739, 'loss': 4.565974354922772, 'time_step': 0.006805134534835815, 'init_value': 20.016857147216797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:00.08[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018644893169403075, 'time_algorithm_update': 0.0047624104022979735, 'loss': 8.343670076429843, 'time_step': 0.00667431116104126, 'init_value': 30.27503204345703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:00.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018766617774963379, 'time_algorithm_update': 0.004768193006515503, 'loss': 14.945957460165024, 'time_step': 0.0066935992240905766, 'init_value': 39.03494644165039}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:00.23[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018822882175445557, 'time_algorithm_update': 0.004764470815658569, 'loss': 19.92803393018246, 'time_step': 0.006695106983184814, 'init_value': 46.032806396484375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:00.31[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018790137767791747, 'time_algorithm_update': 0.0047762060165405275, 'loss': 22.15627507889271, 'time_step': 0.006703879833221436, 'init_value': 54.52879333496094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:00.39[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018782258033752442, 'time_algorithm_update': 0.004774901866912842, 'loss': 23.808072808742523, 'time_step': 0.006701372861862183, 'init_value': 61.09165954589844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:00.47[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018863065242767335, 'time_algorithm_update': 0.00481989049911499, 'loss': 27.602302376747133, 'time_step': 0.006754459857940674, 'init_value': 66.5490951538086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:00.56[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019108967781066894, 'time_algorithm_update': 0.004897441625595093, 'loss': 27.435653802633286, 'time_step': 0.006857781887054443, 'init_value': 72.21686553955078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:01.04[0m [[32m[1minfo     [0m] [1mFQE_20250505155943: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908212661743164, 'time_algorithm_update': 0.004886006593704224, 'loss': 30.73090671634674, 'time_step': 0.006842885494232178, 'init_value': 78.19376373291016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.19376373291016
avg return on 5 trajectories of agent10: 1963.5350600000002
Episode generator created
[2m2025-05-05 16:01.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:01.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:01.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:01.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:01.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160105[0m
[2m2025-05-05 16:01.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:01.13[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018808143138885499, 'time_algorithm_update': 0.0047861945629119875, 'loss': 1.5091234023869038, 'time_step': 0.0067143096923828124, 'init_value': 10.052757263183594}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:01.21[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907433032989502, 'time_algorithm_update': 0.00491633677482605, 'loss': 4.355713041007519, 'time_step': 0.006872074842453003, 'init_value': 20.337099075317383}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:01.30[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019132070541381836, 'time_algorithm_update': 0.004930558443069458, 'loss': 8.6947175719738, 'time_step': 0.006892922401428222, 'init_value': 29.856508255004883}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:01.38[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001938403606414795, 'time_algorithm_update': 0.005003638982772827, 'loss': 12.615035379052163, 'time_step': 0.00699196743965149, 'init_value': 38.14057540893555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:01.46[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908975601196289, 'time_algorithm_update': 0.004927520513534546, 'loss': 16.194733822464944, 'time_step': 0.006885635137557983, 'init_value': 46.16835403442383}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:01.54[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019146559238433839, 'time_algorithm_update': 0.004938115119934082, 'loss': 19.395627858877184, 'time_step': 0.006901717901229858, 'init_value': 54.55036163330078}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:02.02[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019226348400115966, 'time_algorithm_update': 0.004967693567276001, 'loss': 25.935837364077567, 'time_step': 0.006939794301986694, 'init_value': 62.19597244262695}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:02.11[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019140183925628663, 'time_algorithm_update': 0.00493452000617981, 'loss': 29.64430652153492, 'time_step': 0.006897132396697998, 'init_value': 68.54803466796875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:02.19[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019075136184692383, 'time_algorithm_update': 0.0049442131519317626, 'loss': 25.968189451813696, 'time_step': 0.006900483131408691, 'init_value': 73.76380157470703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:02.27[0m [[32m[1minfo     [0m] [1mFQE_20250505160105: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019129889011383057, 'time_algorithm_update': 0.004948864459991455, 'loss': 28.68581682014465, 'time_step': 0.006910935640335083, 'init_value': 78.6482925415039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.6482925415039
avg return on 5 trajectories of agent11: 1670.1180863333332
Episode generator created
[2m2025-05-05 16:02.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:02.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:02.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:02.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:02.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160228[0m
[2m2025-05-05 16:02.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:02.36[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019096748828887939, 'time_algorithm_update': 0.004836683988571167, 'loss': 1.475242788001895, 'time_step': 0.006793933868408203, 'init_value': 10.091492652893066}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:02.45[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019676570892333983, 'time_algorithm_update': 0.005108351707458496, 'loss': 4.377063330203295, 'time_step': 0.007125981330871582, 'init_value': 19.74247169494629}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:02.53[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999910593032837, 'time_algorithm_update': 0.005168547391891479, 'loss': 8.909784477114677, 'time_step': 0.007219185352325439, 'init_value': 28.815387725830078}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:03.01[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001927959442138672, 'time_algorithm_update': 0.004953744173049926, 'loss': 13.273061473309994, 'time_step': 0.006930510759353638, 'init_value': 38.24373245239258}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:03.10[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019038841724395752, 'time_algorithm_update': 0.004901479721069336, 'loss': 17.790293046712875, 'time_step': 0.006853729724884033, 'init_value': 46.4111442565918}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:03.18[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019085137844085693, 'time_algorithm_update': 0.004898558378219605, 'loss': 21.637744156122206, 'time_step': 0.006855165719985962, 'init_value': 54.98925018310547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:03.26[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001909787893295288, 'time_algorithm_update': 0.004902224063873291, 'loss': 24.077020494937898, 'time_step': 0.006860306978225708, 'init_value': 61.228233337402344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:03.34[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019116134643554687, 'time_algorithm_update': 0.004905057191848755, 'loss': 28.690875813126564, 'time_step': 0.00686527943611145, 'init_value': 65.13924407958984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:03.42[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019146575927734375, 'time_algorithm_update': 0.004911020517349243, 'loss': 33.935776868700984, 'time_step': 0.006874063014984131, 'init_value': 69.08519744873047}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:03.50[0m [[32m[1minfo     [0m] [1mFQE_20250505160228: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019140336513519287, 'time_algorithm_update': 0.004908212900161743, 'loss': 31.08392595911026, 'time_step': 0.0068707940578460695, 'init_value': 74.0677719116211}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.0677719116211
avg return on 5 trajectories of agent12: 2094.3668116666668
Episode generator created
[2m2025-05-05 16:03.52[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:03.52[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:03.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:03.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:03.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160352[0m
[2m2025-05-05 16:03.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:04.00[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018948662281036378, 'time_algorithm_update': 0.004769920825958252, 'loss': 1.4685460781008006, 'time_step': 0.006712394237518311, 'init_value': 10.619056701660156}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:04.08[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019052245616912843, 'time_algorithm_update': 0.004852337598800659, 'loss': 4.075945444464684, 'time_step': 0.006806025505065918, 'init_value': 20.127853393554688}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:04.16[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018948936462402344, 'time_algorithm_update': 0.004836030960083008, 'loss': 7.551849233448506, 'time_step': 0.006778658151626587, 'init_value': 29.447601318359375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:04.24[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018944675922393799, 'time_algorithm_update': 0.00483977198600769, 'loss': 12.24020350277424, 'time_step': 0.006782465696334839, 'init_value': 38.103763580322266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:04.32[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019067199230194092, 'time_algorithm_update': 0.004857129573822021, 'loss': 15.9110192643404, 'time_step': 0.006812301874160767, 'init_value': 46.40948486328125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:04.41[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019032473564147949, 'time_algorithm_update': 0.00484161925315857, 'loss': 19.825591937065123, 'time_step': 0.006792707443237305, 'init_value': 54.16203689575195}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:04.49[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019016609191894532, 'time_algorithm_update': 0.004838496685028076, 'loss': 20.75090925359726, 'time_step': 0.006788360118865967, 'init_value': 59.3788948059082}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:04.57[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019008879661560059, 'time_algorithm_update': 0.0048460991382598875, 'loss': 23.298533049464226, 'time_step': 0.006795764923095703, 'init_value': 63.116756439208984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:05.05[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019147210121154784, 'time_algorithm_update': 0.004868179798126221, 'loss': 26.95049439609051, 'time_step': 0.006831490278244019, 'init_value': 66.48225402832031}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:05.13[0m [[32m[1minfo     [0m] [1mFQE_20250505160352: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019503037929534913, 'time_algorithm_update': 0.004946386337280274, 'loss': 26.131557804465295, 'time_step': 0.0069472787380218505, 'init_value': 70.61910247802734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 70.61910247802734
avg return on 5 trajectories of agent13: 2786.988476666667
Episode generator created
[2m2025-05-05 16:05.15[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:05.15[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:05.15[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:05.15[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:05.15[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160515[0m
[2m2025-05-05 16:05.15[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:05.23[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001904125452041626, 'time_algorithm_update': 0.004784223318099976, 'loss': 1.5040414744764568, 'time_step': 0.00673566746711731, 'init_value': 10.815241813659668}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:05.31[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019027571678161622, 'time_algorithm_update': 0.004844231843948364, 'loss': 4.701641059368849, 'time_step': 0.006795245885848999, 'init_value': 21.163673400878906}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:05.39[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019121606349945068, 'time_algorithm_update': 0.004846672058105469, 'loss': 9.193091126680374, 'time_step': 0.00680753779411316, 'init_value': 30.92331314086914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:05.47[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018866775035858154, 'time_algorithm_update': 0.0048068144321441655, 'loss': 13.793875907540322, 'time_step': 0.006740561962127686, 'init_value': 40.21419143676758}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:05.55[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019029531478881837, 'time_algorithm_update': 0.004838688611984253, 'loss': 21.419697209835054, 'time_step': 0.006789772748947143, 'init_value': 48.732200622558594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:06.03[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908083438873291, 'time_algorithm_update': 0.004849985361099243, 'loss': 24.318611328601836, 'time_step': 0.006807728052139282, 'init_value': 56.7636833190918}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:06.11[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018950812816619872, 'time_algorithm_update': 0.004834479331970215, 'loss': 28.86542601788044, 'time_step': 0.0067780187129974365, 'init_value': 62.77353286743164}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:06.20[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019061341285705566, 'time_algorithm_update': 0.004849683761596679, 'loss': 31.859106061697005, 'time_step': 0.006804409265518188, 'init_value': 68.80473327636719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:06.28[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019019877910614014, 'time_algorithm_update': 0.004836112976074219, 'loss': 32.23887104392052, 'time_step': 0.006787055969238281, 'init_value': 73.35533905029297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:06.36[0m [[32m[1minfo     [0m] [1mFQE_20250505160515: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019060120582580567, 'time_algorithm_update': 0.0048493223190307615, 'loss': 31.95618224167824, 'time_step': 0.006804320335388183, 'init_value': 78.08091735839844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.08091735839844
avg return on 5 trajectories of agent14: 2373.986106
Episode generator created
[2m2025-05-05 16:06.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:06.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:06.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:06.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:06.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160638[0m
[2m2025-05-05 16:06.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:06.46[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018992977142333984, 'time_algorithm_update': 0.0047921533584594726, 'loss': 1.53022433167696, 'time_step': 0.006739445209503174, 'init_value': 10.08450698852539}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:06.54[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019100308418273926, 'time_algorithm_update': 0.004859996795654297, 'loss': 4.624666716903448, 'time_step': 0.006818408012390136, 'init_value': 20.27669334411621}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:07.02[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019054999351501465, 'time_algorithm_update': 0.004852591037750244, 'loss': 9.360127365529538, 'time_step': 0.006805798292160034, 'init_value': 30.517309188842773}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:07.10[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019013786315917969, 'time_algorithm_update': 0.004844139099121094, 'loss': 15.576927260696888, 'time_step': 0.006793763875961304, 'init_value': 39.3199462890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:07.18[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019057576656341553, 'time_algorithm_update': 0.004847120285034179, 'loss': 21.373172456383706, 'time_step': 0.006801143646240234, 'init_value': 48.12871551513672}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:07.26[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019085819721221923, 'time_algorithm_update': 0.004865755081176757, 'loss': 26.437636422157286, 'time_step': 0.00682303261756897, 'init_value': 56.629600524902344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:07.34[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019123029708862304, 'time_algorithm_update': 0.004872928380966187, 'loss': 29.973279831051826, 'time_step': 0.006834548950195312, 'init_value': 62.96067428588867}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:07.42[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019088766574859618, 'time_algorithm_update': 0.004892206192016602, 'loss': 30.15049680376053, 'time_step': 0.006849845170974731, 'init_value': 68.52217102050781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:07.50[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019123902320861816, 'time_algorithm_update': 0.004885592460632324, 'loss': 29.895990134835245, 'time_step': 0.006846754550933838, 'init_value': 73.77296447753906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:07.58[0m [[32m[1minfo     [0m] [1mFQE_20250505160638: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019136109352111816, 'time_algorithm_update': 0.004883490324020386, 'loss': 31.434696913719176, 'time_step': 0.0068459703922271724, 'init_value': 78.2392349243164}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.2392349243164
avg return on 5 trajectories of agent15: 2357.541671
Episode generator created
[2m2025-05-05 16:08.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:08.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:08.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:08.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:08.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160800[0m
[2m2025-05-05 16:08.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:08.08[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001900639772415161, 'time_algorithm_update': 0.004828584671020508, 'loss': 1.5025929433405398, 'time_step': 0.006777146339416504, 'init_value': 9.758122444152832}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:08.16[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001909595251083374, 'time_algorithm_update': 0.004908392906188965, 'loss': 4.011608229488134, 'time_step': 0.006866665601730347, 'init_value': 19.554235458374023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:08.25[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001911881685256958, 'time_algorithm_update': 0.0049003190994262695, 'loss': 7.316503478467465, 'time_step': 0.006861005544662476, 'init_value': 28.696935653686523}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:08.33[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019147248268127442, 'time_algorithm_update': 0.004915173053741455, 'loss': 11.273086600840092, 'time_step': 0.006878728151321411, 'init_value': 37.505615234375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:08.41[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019039812088012696, 'time_algorithm_update': 0.004901602029800415, 'loss': 14.22152277135849, 'time_step': 0.006854247331619262, 'init_value': 45.71623229980469}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:08.49[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019530012607574462, 'time_algorithm_update': 0.004995161533355713, 'loss': 18.032324980139734, 'time_step': 0.006998498678207397, 'init_value': 52.18748092651367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:08.57[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019148342609405517, 'time_algorithm_update': 0.004909714460372925, 'loss': 19.770237594366073, 'time_step': 0.006874319314956665, 'init_value': 59.441226959228516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:09.06[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001915822982788086, 'time_algorithm_update': 0.00491143536567688, 'loss': 24.88257396149635, 'time_step': 0.006876109361648559, 'init_value': 66.15110778808594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:09.14[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019169864654541016, 'time_algorithm_update': 0.004911247491836548, 'loss': 26.23565689754486, 'time_step': 0.006877044916152954, 'init_value': 71.87641143798828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:09.22[0m [[32m[1minfo     [0m] [1mFQE_20250505160800: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019176464080810547, 'time_algorithm_update': 0.004901540040969848, 'loss': 28.23138282084465, 'time_step': 0.006868011474609375, 'init_value': 76.72309112548828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.72309112548828
avg return on 5 trajectories of agent16: 1812.7237163333332
Episode generator created
[2m2025-05-05 16:09.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:09.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:09.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:09.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:09.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160923[0m
[2m2025-05-05 16:09.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:09.31[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912630796432495, 'time_algorithm_update': 0.004799470424652099, 'loss': 1.4771868290305137, 'time_step': 0.0067604706287384035, 'init_value': 9.96359634399414}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:09.40[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019170372486114501, 'time_algorithm_update': 0.004868172645568848, 'loss': 4.545950690209866, 'time_step': 0.006833427429199219, 'init_value': 19.363454818725586}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:09.48[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018798947334289552, 'time_algorithm_update': 0.004788808345794678, 'loss': 9.180322891175747, 'time_step': 0.0067151026725769045, 'init_value': 28.372753143310547}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:09.56[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018794021606445312, 'time_algorithm_update': 0.004757174491882324, 'loss': 13.567475957870483, 'time_step': 0.006684991836547851, 'init_value': 36.966793060302734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:10.04[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018877441883087159, 'time_algorithm_update': 0.004769428730010987, 'loss': 17.731780037403105, 'time_step': 0.006705606937408447, 'init_value': 43.842403411865234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:10.11[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018756935596466065, 'time_algorithm_update': 0.004744445085525513, 'loss': 23.88834499132633, 'time_step': 0.006668222427368164, 'init_value': 51.1554069519043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:10.19[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018787248134613038, 'time_algorithm_update': 0.0047466297149658205, 'loss': 27.29134399306774, 'time_step': 0.006673616409301758, 'init_value': 56.76935577392578}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:10.27[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018812515735626221, 'time_algorithm_update': 0.004745293378829956, 'loss': 27.930629053115844, 'time_step': 0.00667467999458313, 'init_value': 62.891944885253906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:10.35[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019009969234466554, 'time_algorithm_update': 0.004818852186203003, 'loss': 31.192284913063048, 'time_step': 0.006768137454986572, 'init_value': 69.11209869384766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:10.44[0m [[32m[1minfo     [0m] [1mFQE_20250505160923: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019112415313720704, 'time_algorithm_update': 0.004847942590713501, 'loss': 35.1775241701603, 'time_step': 0.006807879686355591, 'init_value': 73.89603424072266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.89603424072266
avg return on 5 trajectories of agent17: 2413.7777186666667
Episode generator created
[2m2025-05-05 16:10.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:10.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:10.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:10.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:10.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161045[0m
[2m2025-05-05 16:10.45[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:10.53[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001911128044128418, 'time_algorithm_update': 0.004804729700088501, 'loss': 1.4640363826155662, 'time_step': 0.006764228343963623, 'init_value': 9.732721328735352}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:11.02[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001916236400604248, 'time_algorithm_update': 0.0048471295833587644, 'loss': 4.274479363918305, 'time_step': 0.006811767101287842, 'init_value': 19.86511993408203}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:11.10[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001917485237121582, 'time_algorithm_update': 0.004856591463088989, 'loss': 9.110090668857097, 'time_step': 0.0068225665092468265, 'init_value': 29.119277954101562}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:11.18[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019205474853515624, 'time_algorithm_update': 0.004870373725891114, 'loss': 12.788738543450833, 'time_step': 0.0068396408557891844, 'init_value': 38.66120529174805}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:11.26[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019206221103668212, 'time_algorithm_update': 0.004858808517456055, 'loss': 17.480784322857858, 'time_step': 0.006828235864639282, 'init_value': 46.68790817260742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:11.34[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001921673536300659, 'time_algorithm_update': 0.004869641304016114, 'loss': 20.154839998602867, 'time_step': 0.006840241193771362, 'init_value': 52.521507263183594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:11.42[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001906078815460205, 'time_algorithm_update': 0.004852474689483643, 'loss': 23.982092202305793, 'time_step': 0.006807284593582153, 'init_value': 59.5455436706543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:11.50[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019460554122924805, 'time_algorithm_update': 0.00496365761756897, 'loss': 27.619791345953942, 'time_step': 0.006959896087646484, 'init_value': 67.0975570678711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:11.59[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001944720983505249, 'time_algorithm_update': 0.004947662353515625, 'loss': 29.300386440038682, 'time_step': 0.006942836284637452, 'init_value': 72.8475112915039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:12.07[0m [[32m[1minfo     [0m] [1mFQE_20250505161045: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019080195426940919, 'time_algorithm_update': 0.004858134746551513, 'loss': 30.23908077001572, 'time_step': 0.006814162731170654, 'init_value': 76.84695434570312}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.84695434570312
avg return on 5 trajectories of agent18: 1753.0123046666668
Episode generator created
[2m2025-05-05 16:12.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:12.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:12.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:12.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:12.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161208[0m
[2m2025-05-05 16:12.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:12.16[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019120192527770996, 'time_algorithm_update': 0.004816680431365967, 'loss': 1.51943135496974, 'time_step': 0.00677739429473877, 'init_value': 10.639188766479492}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:12.24[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019441280364990235, 'time_algorithm_update': 0.004954278230667114, 'loss': 4.238068661510944, 'time_step': 0.0069491715431213375, 'init_value': 21.080875396728516}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:12.33[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001923243284225464, 'time_algorithm_update': 0.004877613544464111, 'loss': 9.500367638170719, 'time_step': 0.006850273132324219, 'init_value': 30.826171875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:12.41[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001917793035507202, 'time_algorithm_update': 0.004891529321670533, 'loss': 12.98191187220812, 'time_step': 0.006858180046081543, 'init_value': 40.07693862915039}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:12.49[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165666103363036, 'time_algorithm_update': 0.00488729739189148, 'loss': 18.46215007215738, 'time_step': 0.006852294921875, 'init_value': 49.053070068359375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:12.57[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019245591163635253, 'time_algorithm_update': 0.004910973787307739, 'loss': 23.2510286591053, 'time_step': 0.006884366035461426, 'init_value': 57.155303955078125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:13.05[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019247767925262452, 'time_algorithm_update': 0.004893171072006226, 'loss': 26.7080717805624, 'time_step': 0.006866958856582642, 'init_value': 64.17444610595703}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:13.13[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019211912155151368, 'time_algorithm_update': 0.0049026720523834225, 'loss': 29.202314970374108, 'time_step': 0.006872701406478882, 'init_value': 70.8377914428711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:13.22[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019179399013519287, 'time_algorithm_update': 0.004882687330245971, 'loss': 33.46347762775421, 'time_step': 0.006850170373916626, 'init_value': 74.94900512695312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:13.30[0m [[32m[1minfo     [0m] [1mFQE_20250505161208: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019204788208007813, 'time_algorithm_update': 0.004893056869506836, 'loss': 33.104156323432925, 'time_step': 0.006862454652786255, 'init_value': 79.84344482421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.84344482421875
avg return on 5 trajectories of agent19: 1740.0428249999998
Episode generator created
[2m2025-05-05 16:13.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:13.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:13.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:13.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:13.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161331[0m
[2m2025-05-05 16:13.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:13.39[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165632724761964, 'time_algorithm_update': 0.004786171913146973, 'loss': 1.471022563174367, 'time_step': 0.006751260757446289, 'init_value': 9.79445743560791}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:13.47[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912125587463379, 'time_algorithm_update': 0.0048421225547790525, 'loss': 4.736765520125627, 'time_step': 0.006803075790405274, 'init_value': 19.66634178161621}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:13.55[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019220690727233887, 'time_algorithm_update': 0.00485783052444458, 'loss': 9.64142560327053, 'time_step': 0.006829566478729248, 'init_value': 28.912199020385742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:14.03[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019297442436218262, 'time_algorithm_update': 0.004877154350280762, 'loss': 14.076190848112107, 'time_step': 0.006856044769287109, 'init_value': 37.7932243347168}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:14.11[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019156992435455321, 'time_algorithm_update': 0.004853764533996582, 'loss': 20.983894782066344, 'time_step': 0.006817680597305298, 'init_value': 46.173133850097656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:14.20[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001918640375137329, 'time_algorithm_update': 0.004860642433166504, 'loss': 22.965512653946877, 'time_step': 0.006828348159790039, 'init_value': 54.15556716918945}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:14.28[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019196054935455321, 'time_algorithm_update': 0.0048434011936187744, 'loss': 30.644811615943908, 'time_step': 0.00681214714050293, 'init_value': 61.00848388671875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:14.36[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019232714176177978, 'time_algorithm_update': 0.004861072778701782, 'loss': 32.58605004739761, 'time_step': 0.006833396673202515, 'init_value': 67.21382904052734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:14.44[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165480136871338, 'time_algorithm_update': 0.004851683139801026, 'loss': 30.152164883971214, 'time_step': 0.0068171069622039795, 'init_value': 72.13188934326172}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:14.52[0m [[32m[1minfo     [0m] [1mFQE_20250505161331: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019173967838287355, 'time_algorithm_update': 0.004856968879699707, 'loss': 31.01248726773262, 'time_step': 0.006823081970214844, 'init_value': 76.36324310302734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.36324310302734
ave advantage rew: 77.47789993286133, std: 4.0648598834976655
avg cum rews: 2239.8837627166663, std: 441.95503615775
Pearson correlation coefficient: 0.06374379519896002
Spearman correlation coefficient: 0.14285714285714285
Kendall Tau correlation coefficient: 0.09473684210526316
the best agent: 3, best agent cum rewards: 1523.8585033333336
1954
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01861517427368796
avg return on 5 trajectories of agent0: 2146.820708333333
Episode generator created
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:15.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:15.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:15.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161504[0m
[2m2025-05-05 16:15.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:15.12[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019172592163085938, 'time_algorithm_update': 0.00478756856918335, 'loss': 1.4006376990526914, 'time_step': 0.00675295090675354, 'init_value': 9.865255355834961}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:15.20[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019284071922302246, 'time_algorithm_update': 0.004851051568984985, 'loss': 4.316941031873226, 'time_step': 0.0068277716636657715, 'init_value': 20.209545135498047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:15.28[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019240155220031738, 'time_algorithm_update': 0.0048430290222167965, 'loss': 8.222604975402355, 'time_step': 0.006815726280212402, 'init_value': 31.676921844482422}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:15.36[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165334701538087, 'time_algorithm_update': 0.004829461097717285, 'loss': 13.479617390871049, 'time_step': 0.006794593572616577, 'init_value': 40.20878982543945}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:15.44[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019319276809692382, 'time_algorithm_update': 0.0048429262638092045, 'loss': 17.95828332722187, 'time_step': 0.006823396682739258, 'init_value': 48.20048522949219}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:15.52[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019412195682525634, 'time_algorithm_update': 0.0048722784519195554, 'loss': 19.147944039583205, 'time_step': 0.006862950563430786, 'init_value': 56.567771911621094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:16.00[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019359958171844482, 'time_algorithm_update': 0.004854322671890259, 'loss': 25.007308850049974, 'time_step': 0.006839292526245117, 'init_value': 64.1928939819336}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:16.08[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001929274320602417, 'time_algorithm_update': 0.004848196029663086, 'loss': 26.87747751402855, 'time_step': 0.006826795816421509, 'init_value': 70.96284484863281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:16.16[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00193666934967041, 'time_algorithm_update': 0.0048551101684570315, 'loss': 27.597286271095275, 'time_step': 0.006840590000152588, 'init_value': 76.01826477050781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:16.24[0m [[32m[1minfo     [0m] [1mFQE_20250505161504: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019240198135375977, 'time_algorithm_update': 0.004832953214645386, 'loss': 33.39398868536949, 'time_step': 0.00680585241317749, 'init_value': 82.060546875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.060546875
avg return on 5 trajectories of agent1: 1595.2099806666668
Episode generator created
[2m2025-05-05 16:16.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:16.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:16.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:16.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:16.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161626[0m
[2m2025-05-05 16:16.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:16.34[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018914358615875243, 'time_algorithm_update': 0.004765562057495117, 'loss': 1.461570671454072, 'time_step': 0.006703803777694702, 'init_value': 10.93478012084961}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:16.42[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001920693874359131, 'time_algorithm_update': 0.004899693012237549, 'loss': 4.150161329507828, 'time_step': 0.006869583368301391, 'init_value': 21.545846939086914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:16.50[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001932378053665161, 'time_algorithm_update': 0.004898910760879517, 'loss': 8.464359000265599, 'time_step': 0.006880090236663818, 'init_value': 31.468454360961914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:16.58[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019266319274902344, 'time_algorithm_update': 0.004896471977233887, 'loss': 11.710778666377067, 'time_step': 0.006872008085250855, 'init_value': 40.26514434814453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:17.06[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019285929203033446, 'time_algorithm_update': 0.004891620635986328, 'loss': 13.983732869148254, 'time_step': 0.006868838787078857, 'init_value': 49.080116271972656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:17.15[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019323735237121583, 'time_algorithm_update': 0.004887471675872803, 'loss': 17.868241329073907, 'time_step': 0.00686891508102417, 'init_value': 55.145782470703125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:17.23[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019233818054199218, 'time_algorithm_update': 0.004881873369216919, 'loss': 21.151207947015763, 'time_step': 0.006853620052337647, 'init_value': 62.3341178894043}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:17.31[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019286949634552003, 'time_algorithm_update': 0.004898966789245606, 'loss': 21.70890308713913, 'time_step': 0.006876418352127075, 'init_value': 69.34917449951172}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:17.39[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019273178577423095, 'time_algorithm_update': 0.004907685518264771, 'loss': 22.494444689035415, 'time_step': 0.0068840172290802, 'init_value': 73.37810516357422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:17.47[0m [[32m[1minfo     [0m] [1mFQE_20250505161626: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001922898292541504, 'time_algorithm_update': 0.004891212224960327, 'loss': 23.495558665394782, 'time_step': 0.006863025188446045, 'init_value': 77.95699310302734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.95699310302734
avg return on 5 trajectories of agent2: 3105.578274
Episode generator created
[2m2025-05-05 16:17.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:17.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:17.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:17.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:17.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161749[0m
[2m2025-05-05 16:17.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:17.57[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019128069877624512, 'time_algorithm_update': 0.004798940658569336, 'loss': 1.4818345675617457, 'time_step': 0.006759706497192383, 'init_value': 9.907830238342285}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:18.06[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019045267105102538, 'time_algorithm_update': 0.004859227180480957, 'loss': 3.909723025262356, 'time_step': 0.006811022520065308, 'init_value': 19.475576400756836}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:18.14[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019215788841247558, 'time_algorithm_update': 0.004881834983825684, 'loss': 7.0066438753306866, 'time_step': 0.006851475954055786, 'init_value': 27.732242584228516}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:18.22[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019124407768249512, 'time_algorithm_update': 0.0048838920593261715, 'loss': 11.70635782945156, 'time_step': 0.006844830513000488, 'init_value': 35.90998840332031}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:18.30[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019219434261322022, 'time_algorithm_update': 0.004891322135925293, 'loss': 14.603877583622932, 'time_step': 0.006861706256866455, 'init_value': 42.610694885253906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:18.38[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019220647811889649, 'time_algorithm_update': 0.00488841986656189, 'loss': 19.646820741415024, 'time_step': 0.006858896970748901, 'init_value': 49.44318389892578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:18.46[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019148764610290526, 'time_algorithm_update': 0.004876507043838501, 'loss': 21.505970112562178, 'time_step': 0.006839706659317017, 'init_value': 56.37390899658203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:18.54[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019162592887878417, 'time_algorithm_update': 0.0048833231925964355, 'loss': 23.81940193629265, 'time_step': 0.00684799599647522, 'init_value': 63.67344284057617}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:19.02[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019213151931762695, 'time_algorithm_update': 0.004877827644348145, 'loss': 25.532443042278288, 'time_step': 0.006847522497177124, 'init_value': 69.12140655517578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:19.11[0m [[32m[1minfo     [0m] [1mFQE_20250505161749: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019104547500610352, 'time_algorithm_update': 0.004875236034393311, 'loss': 28.77662297666073, 'time_step': 0.006834185123443604, 'init_value': 73.2195053100586}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.2195053100586
avg return on 5 trajectories of agent3: 2702.0882786666666
Episode generator created
[2m2025-05-05 16:19.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:19.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:19.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:19.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:19.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161913[0m
[2m2025-05-05 16:19.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:19.21[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019456830024719238, 'time_algorithm_update': 0.004867406368255616, 'loss': 1.3951324029564858, 'time_step': 0.0068623838424682615, 'init_value': 10.081162452697754}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:19.29[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019255993366241455, 'time_algorithm_update': 0.004876235723495484, 'loss': 3.8315603798627853, 'time_step': 0.006850112438201905, 'init_value': 19.478883743286133}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:19.37[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018899042606353759, 'time_algorithm_update': 0.0048106529712677, 'loss': 7.978128261446953, 'time_step': 0.0067469642162323, 'init_value': 28.383596420288086}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:19.45[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001890336513519287, 'time_algorithm_update': 0.004783491611480713, 'loss': 13.109296414017678, 'time_step': 0.006722098827362061, 'init_value': 36.0351676940918}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:19.53[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018856632709503174, 'time_algorithm_update': 0.0047928357124328615, 'loss': 16.768966305613517, 'time_step': 0.006726808071136474, 'init_value': 44.65599060058594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:20.01[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018874354362487793, 'time_algorithm_update': 0.004796103954315185, 'loss': 20.342749195337294, 'time_step': 0.006731754302978516, 'init_value': 52.399993896484375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:20.09[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018806588649749757, 'time_algorithm_update': 0.004783782720565796, 'loss': 25.538285774588584, 'time_step': 0.006712613105773926, 'init_value': 60.26899337768555}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:20.17[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018861517906188965, 'time_algorithm_update': 0.0047932882308959965, 'loss': 27.6057606613636, 'time_step': 0.006727882623672485, 'init_value': 65.58707427978516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:20.25[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019115386009216308, 'time_algorithm_update': 0.004848247051239014, 'loss': 27.108819299697878, 'time_step': 0.006808418512344361, 'init_value': 69.63439178466797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:20.33[0m [[32m[1minfo     [0m] [1mFQE_20250505161913: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001915041446685791, 'time_algorithm_update': 0.004861993789672852, 'loss': 30.341188583135605, 'time_step': 0.006825249910354614, 'init_value': 73.78973388671875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.78973388671875
avg return on 5 trajectories of agent4: 2003.4242853333333
Episode generator created
[2m2025-05-05 16:20.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:20.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:20.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:20.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:20.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162035[0m
[2m2025-05-05 16:20.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:20.43[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019152429103851318, 'time_algorithm_update': 0.004807873249053955, 'loss': 1.4664905537515878, 'time_step': 0.006771285057067871, 'init_value': 10.369051933288574}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:20.51[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001918717622756958, 'time_algorithm_update': 0.004890538930892944, 'loss': 3.8996721760332584, 'time_step': 0.006857447385787964, 'init_value': 20.711952209472656}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:20.59[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019180235862731934, 'time_algorithm_update': 0.004905325174331665, 'loss': 7.829934126496315, 'time_step': 0.006872053146362305, 'init_value': 30.009807586669922}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:21.07[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001895491600036621, 'time_algorithm_update': 0.004879411935806275, 'loss': 11.588120872616768, 'time_step': 0.006822567224502563, 'init_value': 38.98148727416992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:21.15[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019194037914276123, 'time_algorithm_update': 0.0048990979194641114, 'loss': 14.839517445147038, 'time_step': 0.006866720199584961, 'init_value': 47.96586608886719}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:21.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00192030668258667, 'time_algorithm_update': 0.004909043312072754, 'loss': 17.56803681397438, 'time_step': 0.006878064632415771, 'init_value': 56.33781814575195}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:21.32[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019262290000915526, 'time_algorithm_update': 0.004907174348831177, 'loss': 21.11021292090416, 'time_step': 0.006882068157196045, 'init_value': 64.8865737915039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:21.40[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019358210563659667, 'time_algorithm_update': 0.004916115760803223, 'loss': 25.875201021432876, 'time_step': 0.006901264905929566, 'init_value': 71.24040985107422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:21.48[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019196369647979737, 'time_algorithm_update': 0.004899272203445435, 'loss': 26.939464340448378, 'time_step': 0.006867526531219482, 'init_value': 78.25389099121094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:21.56[0m [[32m[1minfo     [0m] [1mFQE_20250505162035: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019161124229431152, 'time_algorithm_update': 0.004904047966003418, 'loss': 27.431274438619614, 'time_step': 0.0068687119483947755, 'init_value': 85.56817626953125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.56817626953125
avg return on 5 trajectories of agent5: 1759.680026666667
Episode generator created
[2m2025-05-05 16:21.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:21.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:21.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:21.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:21.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162157[0m
[2m2025-05-05 16:21.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:22.06[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019131085872650146, 'time_algorithm_update': 0.004798191070556641, 'loss': 1.5969174261391164, 'time_step': 0.006759390354156494, 'init_value': 10.500251770019531}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:22.14[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019176390171051026, 'time_algorithm_update': 0.004846863269805908, 'loss': 4.539390945881605, 'time_step': 0.006812704563140869, 'init_value': 20.21270751953125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:22.22[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019346728324890136, 'time_algorithm_update': 0.00486091136932373, 'loss': 8.234961818814277, 'time_step': 0.006843981981277466, 'init_value': 30.12767219543457}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:22.30[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001921389102935791, 'time_algorithm_update': 0.004868621826171875, 'loss': 13.314555635809898, 'time_step': 0.00683815598487854, 'init_value': 38.56147384643555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:22.38[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019005310535430908, 'time_algorithm_update': 0.0048285057544708255, 'loss': 17.659021831154824, 'time_step': 0.006776416540145874, 'init_value': 46.47711944580078}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:22.46[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019159059524536132, 'time_algorithm_update': 0.004851555109024048, 'loss': 22.022108226776123, 'time_step': 0.0068160536289215085, 'init_value': 54.529823303222656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:22.54[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001940464973449707, 'time_algorithm_update': 0.004904616832733155, 'loss': 23.432579587340356, 'time_step': 0.0068939425945281985, 'init_value': 61.50057601928711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:23.02[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963634729385376, 'time_algorithm_update': 0.0049549098014831545, 'loss': 31.079987160444258, 'time_step': 0.006968896627426147, 'init_value': 65.8772964477539}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:23.11[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001946394920349121, 'time_algorithm_update': 0.004920918703079224, 'loss': 29.28860051870346, 'time_step': 0.006917244195938111, 'init_value': 71.01982116699219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:23.19[0m [[32m[1minfo     [0m] [1mFQE_20250505162157: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019191713333129882, 'time_algorithm_update': 0.004853723049163819, 'loss': 32.906732904195785, 'time_step': 0.006821550369262695, 'init_value': 74.90788269042969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.90788269042969
avg return on 5 trajectories of agent6: 1416.2706800000003
Episode generator created
[2m2025-05-05 16:23.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:23.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:23.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:23.20[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:23.20[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162320[0m
[2m2025-05-05 16:23.20[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:23.28[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001903531551361084, 'time_algorithm_update': 0.004778854608535767, 'loss': 1.4433367205113172, 'time_step': 0.006730364084243774, 'init_value': 10.238199234008789}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:23.36[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019085781574249268, 'time_algorithm_update': 0.004827546834945679, 'loss': 4.085848141908645, 'time_step': 0.006784342527389527, 'init_value': 20.556760787963867}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:23.44[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001924043655395508, 'time_algorithm_update': 0.004848498344421387, 'loss': 10.008721107304096, 'time_step': 0.006821317911148071, 'init_value': 31.04990577697754}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:23.52[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019250905513763428, 'time_algorithm_update': 0.004861983776092529, 'loss': 16.16641765379906, 'time_step': 0.006835500240325928, 'init_value': 40.40901184082031}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:24.00[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019145097732543945, 'time_algorithm_update': 0.0048593530654907225, 'loss': 21.14022586131096, 'time_step': 0.006822279691696167, 'init_value': 48.022220611572266}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:24.08[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001892893075942993, 'time_algorithm_update': 0.004831609010696411, 'loss': 26.702120449662207, 'time_step': 0.006771975755691528, 'init_value': 57.003570556640625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:24.16[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019163386821746827, 'time_algorithm_update': 0.004863262176513672, 'loss': 32.11531812250614, 'time_step': 0.00682802677154541, 'init_value': 63.846614837646484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:24.25[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019175338745117188, 'time_algorithm_update': 0.004869460105895996, 'loss': 34.512962838292125, 'time_step': 0.006835376262664795, 'init_value': 70.44705963134766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:24.33[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019155969619750975, 'time_algorithm_update': 0.004857095718383789, 'loss': 40.696564690828325, 'time_step': 0.006821374416351319, 'init_value': 78.48136901855469}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:24.41[0m [[32m[1minfo     [0m] [1mFQE_20250505162320: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001926504611968994, 'time_algorithm_update': 0.004867081165313721, 'loss': 41.081877856016156, 'time_step': 0.006842200994491577, 'init_value': 83.3145523071289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.3145523071289
avg return on 5 trajectories of agent7: 1457.0326306666666
Episode generator created
[2m2025-05-05 16:24.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:24.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:24.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:24.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:24.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162442[0m
[2m2025-05-05 16:24.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:24.50[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019068024158477783, 'time_algorithm_update': 0.004791049003601075, 'loss': 1.4464294381290674, 'time_step': 0.006745799779891968, 'init_value': 10.976696968078613}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:24.58[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019159088134765626, 'time_algorithm_update': 0.00488126015663147, 'loss': 4.288822889059782, 'time_step': 0.00684575891494751, 'init_value': 22.07958984375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:25.06[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001919304609298706, 'time_algorithm_update': 0.004887251853942871, 'loss': 8.122199996113777, 'time_step': 0.006854677438735962, 'init_value': 31.814485549926758}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:25.15[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019177849292755127, 'time_algorithm_update': 0.0048858532905578615, 'loss': 11.571367505073548, 'time_step': 0.0068525090217590335, 'init_value': 40.416316986083984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:25.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019187970161437988, 'time_algorithm_update': 0.004871180772781372, 'loss': 16.429750029206275, 'time_step': 0.006838008880615234, 'init_value': 49.80080032348633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:25.31[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019206600189208985, 'time_algorithm_update': 0.004879864454269409, 'loss': 19.366177545785902, 'time_step': 0.006848802328109741, 'init_value': 56.874351501464844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:25.39[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018988795280456543, 'time_algorithm_update': 0.00485115909576416, 'loss': 22.795482452511788, 'time_step': 0.006797614574432373, 'init_value': 63.688289642333984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:25.47[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001915043354034424, 'time_algorithm_update': 0.00486938738822937, 'loss': 27.431724969625474, 'time_step': 0.006832640409469604, 'init_value': 69.53968811035156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:25.55[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00191270112991333, 'time_algorithm_update': 0.004875153779983521, 'loss': 26.955928927898405, 'time_step': 0.006836315870285034, 'init_value': 75.112548828125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:26.03[0m [[32m[1minfo     [0m] [1mFQE_20250505162442: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019279654026031494, 'time_algorithm_update': 0.004893639326095581, 'loss': 29.29301671218872, 'time_step': 0.00687028694152832, 'init_value': 80.31340789794922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.31340789794922
avg return on 5 trajectories of agent8: 1486.4708616666667
Episode generator created
[2m2025-05-05 16:26.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:26.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:26.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:26.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:26.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162605[0m
[2m2025-05-05 16:26.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:26.12[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019018442630767821, 'time_algorithm_update': 0.004762591361999512, 'loss': 1.3753517826497554, 'time_step': 0.006712466478347778, 'init_value': 9.90919017791748}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:26.20[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019155447483062745, 'time_algorithm_update': 0.004811119794845581, 'loss': 3.9950678552985193, 'time_step': 0.006774686098098755, 'init_value': 19.815837860107422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:26.29[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019071195125579833, 'time_algorithm_update': 0.0048182692527771, 'loss': 8.090107623994351, 'time_step': 0.0067736926078796385, 'init_value': 28.44382667541504}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:26.37[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019330661296844483, 'time_algorithm_update': 0.004882802963256836, 'loss': 12.684182084798813, 'time_step': 0.006864218711853027, 'init_value': 36.56483840942383}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:26.45[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019201014041900634, 'time_algorithm_update': 0.004857111930847168, 'loss': 15.291985341787338, 'time_step': 0.006826044082641602, 'init_value': 44.38252639770508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:26.53[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019163851737976074, 'time_algorithm_update': 0.004836155652999878, 'loss': 20.561967856645584, 'time_step': 0.00680068039894104, 'init_value': 51.67305374145508}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:27.01[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019226162433624268, 'time_algorithm_update': 0.004851654052734375, 'loss': 25.41505069887638, 'time_step': 0.006822515487670899, 'init_value': 58.854576110839844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:27.09[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001894455909729004, 'time_algorithm_update': 0.004803096055984497, 'loss': 28.377964014410974, 'time_step': 0.006744689464569091, 'init_value': 67.38140869140625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:27.17[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019145596027374267, 'time_algorithm_update': 0.004846143960952759, 'loss': 33.93768563342094, 'time_step': 0.006809497833251953, 'init_value': 72.67571258544922}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:27.25[0m [[32m[1minfo     [0m] [1mFQE_20250505162605: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019165942668914796, 'time_algorithm_update': 0.0048455939292907715, 'loss': 32.82469480609894, 'time_step': 0.006810378313064575, 'init_value': 77.9550552368164}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.9550552368164
avg return on 5 trajectories of agent9: 2095.510314
Episode generator created
[2m2025-05-05 16:27.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:27.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:27.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:27.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:27.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162727[0m
[2m2025-05-05 16:27.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:27.35[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019062533378601074, 'time_algorithm_update': 0.004774888277053833, 'loss': 1.4170593529194593, 'time_step': 0.006729457855224609, 'init_value': 10.717460632324219}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:27.43[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019218306541442872, 'time_algorithm_update': 0.0048701858520507815, 'loss': 4.333273166060447, 'time_step': 0.006840387344360352, 'init_value': 20.594310760498047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:27.51[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019141740798950195, 'time_algorithm_update': 0.004844701766967773, 'loss': 8.197581627130509, 'time_step': 0.006806792736053467, 'init_value': 30.684648513793945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:27.59[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019138391017913818, 'time_algorithm_update': 0.004844600200653076, 'loss': 13.796765052199364, 'time_step': 0.006806221008300781, 'init_value': 38.55853271484375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:28.07[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019215457439422606, 'time_algorithm_update': 0.0048618075847625735, 'loss': 16.184092075109483, 'time_step': 0.0068319118022918705, 'init_value': 47.26803207397461}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019113047122955322, 'time_algorithm_update': 0.004851913452148438, 'loss': 20.352592949330806, 'time_step': 0.0068117396831512455, 'init_value': 55.221961975097656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:28.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001925816535949707, 'time_algorithm_update': 0.0048576946258544924, 'loss': 26.381524357318877, 'time_step': 0.006831968545913696, 'init_value': 61.93199920654297}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:28.32[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019114480018615724, 'time_algorithm_update': 0.004837400674819946, 'loss': 31.252497611165047, 'time_step': 0.006796752214431763, 'init_value': 68.91149139404297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:28.40[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018958282470703126, 'time_algorithm_update': 0.004806304693222046, 'loss': 34.174087143421175, 'time_step': 0.0067502505779266355, 'init_value': 74.73158264160156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:28.48[0m [[32m[1minfo     [0m] [1mFQE_20250505162727: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019101676940917968, 'time_algorithm_update': 0.004837596893310547, 'loss': 36.4647836971283, 'time_step': 0.006795581579208374, 'init_value': 82.6173324584961}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.6173324584961
avg return on 5 trajectories of agent10: 1495.1101676666665
Episode generator created
[2m2025-05-05 16:28.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:28.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:28.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:28.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:28.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162849[0m
[2m2025-05-05 16:28.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:28.57[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018963558673858643, 'time_algorithm_update': 0.004757844924926758, 'loss': 1.3237033580392599, 'time_step': 0.006701895475387573, 'init_value': 10.71674633026123}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:29.05[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019182612895965576, 'time_algorithm_update': 0.004866170406341553, 'loss': 3.6495219832658767, 'time_step': 0.006832491636276245, 'init_value': 21.926713943481445}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:29.13[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019216885566711425, 'time_algorithm_update': 0.004870092391967774, 'loss': 6.706855026304722, 'time_step': 0.006840935468673706, 'init_value': 31.09865951538086}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:29.21[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019121098518371583, 'time_algorithm_update': 0.00485112476348877, 'loss': 12.130588818073273, 'time_step': 0.006811279535293579, 'init_value': 39.6345329284668}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:29.29[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018812205791473389, 'time_algorithm_update': 0.004771461725234985, 'loss': 14.495380780339241, 'time_step': 0.006700311183929443, 'init_value': 48.21780776977539}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:29.37[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018842260837554931, 'time_algorithm_update': 0.00476784086227417, 'loss': 18.601743221759797, 'time_step': 0.0067003629207611085, 'init_value': 54.33134078979492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:29.45[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018964774608612061, 'time_algorithm_update': 0.00478955340385437, 'loss': 21.298676010608673, 'time_step': 0.00673434591293335, 'init_value': 60.35091018676758}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:29.53[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001891514539718628, 'time_algorithm_update': 0.004774495363235474, 'loss': 22.5772042170763, 'time_step': 0.006714205265045166, 'init_value': 66.23426818847656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:30.01[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019000294208526612, 'time_algorithm_update': 0.00479178524017334, 'loss': 24.48587354540825, 'time_step': 0.006740182876586914, 'init_value': 72.95172882080078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:30.09[0m [[32m[1minfo     [0m] [1mFQE_20250505162849: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018987979888916017, 'time_algorithm_update': 0.004819453716278076, 'loss': 29.418645282030106, 'time_step': 0.006766610860824585, 'init_value': 78.09664154052734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.09664154052734
avg return on 5 trajectories of agent11: 1500.1264986666667
Episode generator created
[2m2025-05-05 16:30.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:30.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:30.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:30.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:30.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163010[0m
[2m2025-05-05 16:30.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:30.18[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019440269470214844, 'time_algorithm_update': 0.004880533456802368, 'loss': 1.6008063916265964, 'time_step': 0.006874369382858276, 'init_value': 10.176873207092285}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:30.27[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019150955677032472, 'time_algorithm_update': 0.0048533096313476565, 'loss': 4.817272474765778, 'time_step': 0.006816828250885009, 'init_value': 20.467622756958008}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:30.35[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019017775058746337, 'time_algorithm_update': 0.004844495534896851, 'loss': 8.954632553696632, 'time_step': 0.006794325113296509, 'init_value': 30.233428955078125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:30.43[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019063589572906495, 'time_algorithm_update': 0.004862759351730347, 'loss': 12.26294552665949, 'time_step': 0.006817331790924072, 'init_value': 39.67337417602539}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:30.51[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912024736404419, 'time_algorithm_update': 0.004853512048721313, 'loss': 19.756431710004808, 'time_step': 0.006814076662063599, 'init_value': 46.87648391723633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:30.59[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019136507511138916, 'time_algorithm_update': 0.004871823310852051, 'loss': 21.101768550395967, 'time_step': 0.006834014415740967, 'init_value': 53.31488037109375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:31.07[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019128079414367676, 'time_algorithm_update': 0.004859498500823975, 'loss': 23.533729801654815, 'time_step': 0.006820716857910156, 'init_value': 58.0240478515625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:31.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001914057970046997, 'time_algorithm_update': 0.004876542568206787, 'loss': 27.560873906493185, 'time_step': 0.006839069604873657, 'init_value': 64.57330322265625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:31.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019196910858154297, 'time_algorithm_update': 0.00487651515007019, 'loss': 29.298574763536454, 'time_step': 0.006844967603683472, 'init_value': 67.4154281616211}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:31.31[0m [[32m[1minfo     [0m] [1mFQE_20250505163010: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019064137935638427, 'time_algorithm_update': 0.004863861322402954, 'loss': 25.09962706232071, 'time_step': 0.006818947792053223, 'init_value': 73.24913787841797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.24913787841797
avg return on 5 trajectories of agent12: 2542.8438100000003
Episode generator created
[2m2025-05-05 16:31.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:31.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:31.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:31.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:31.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163133[0m
[2m2025-05-05 16:31.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:31.41[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019113023281097411, 'time_algorithm_update': 0.004775340795516968, 'loss': 1.478984450444579, 'time_step': 0.0067345211505889895, 'init_value': 10.783729553222656}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:31.50[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019112045764923095, 'time_algorithm_update': 0.004839681625366211, 'loss': 4.877505360454321, 'time_step': 0.006798952102661133, 'init_value': 21.048465728759766}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:31.58[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018983566761016845, 'time_algorithm_update': 0.004837607622146607, 'loss': 9.103176767885685, 'time_step': 0.006783892631530761, 'init_value': 31.044261932373047}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:32.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019265339374542236, 'time_algorithm_update': 0.004888383626937866, 'loss': 15.481959239006043, 'time_step': 0.006864010334014892, 'init_value': 40.367431640625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:32.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001916532039642334, 'time_algorithm_update': 0.004861580610275269, 'loss': 18.913328170537948, 'time_step': 0.006826510190963745, 'init_value': 49.33861541748047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:32.22[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019166648387908935, 'time_algorithm_update': 0.004867841005325318, 'loss': 23.5895310305357, 'time_step': 0.006833189249038697, 'init_value': 58.036781311035156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:32.30[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019082188606262206, 'time_algorithm_update': 0.004857219219207763, 'loss': 25.14377534222603, 'time_step': 0.006814024448394775, 'init_value': 65.53662872314453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:32.38[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019161264896392822, 'time_algorithm_update': 0.004867856502532959, 'loss': 26.847984953522683, 'time_step': 0.006832068920135498, 'init_value': 70.20829010009766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:32.46[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019197399616241455, 'time_algorithm_update': 0.004874297380447388, 'loss': 32.50132252573967, 'time_step': 0.006842806339263916, 'init_value': 76.00254821777344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:32.54[0m [[32m[1minfo     [0m] [1mFQE_20250505163133: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019100723266601562, 'time_algorithm_update': 0.004870510339736939, 'loss': 31.196694348096848, 'time_step': 0.006828937530517578, 'init_value': 81.24935150146484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.24935150146484
avg return on 5 trajectories of agent13: 1311.6429013333334
Episode generator created
[2m2025-05-05 16:32.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:32.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:32.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:32.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:32.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163255[0m
[2m2025-05-05 16:32.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:33.03[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019047081470489502, 'time_algorithm_update': 0.004781582832336426, 'loss': 1.4966819542050362, 'time_step': 0.006734919786453247, 'init_value': 10.412775993347168}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:33.12[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019067399501800537, 'time_algorithm_update': 0.0048255550861358645, 'loss': 4.225871702194214, 'time_step': 0.006780315637588501, 'init_value': 21.26624870300293}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:33.20[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019133777618408202, 'time_algorithm_update': 0.004834267616271972, 'loss': 9.156970382273197, 'time_step': 0.006796022891998291, 'init_value': 31.932186126708984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:33.28[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019206511974334717, 'time_algorithm_update': 0.004864421606063843, 'loss': 16.00569192558527, 'time_step': 0.006833970785140991, 'init_value': 40.311180114746094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:33.36[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019197607040405274, 'time_algorithm_update': 0.004867776393890381, 'loss': 19.693639578700065, 'time_step': 0.006836286544799805, 'init_value': 49.24421691894531}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:33.44[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019328036308288573, 'time_algorithm_update': 0.0048775293827056886, 'loss': 23.384296423196794, 'time_step': 0.006865966558456421, 'init_value': 57.062164306640625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:33.52[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019067113399505616, 'time_algorithm_update': 0.004846057653427124, 'loss': 28.718901155591013, 'time_step': 0.0068014562129974365, 'init_value': 63.933895111083984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:34.00[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019394068717956544, 'time_algorithm_update': 0.0049040050506591795, 'loss': 31.09615267634392, 'time_step': 0.006892852067947388, 'init_value': 68.0357894897461}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:34.08[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019195590019226074, 'time_algorithm_update': 0.004861181974411011, 'loss': 32.45706712436676, 'time_step': 0.0068294119834899905, 'init_value': 74.14468383789062}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:34.17[0m [[32m[1minfo     [0m] [1mFQE_20250505163255: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019147017002105714, 'time_algorithm_update': 0.004853668928146362, 'loss': 34.970082688570024, 'time_step': 0.006816850900650024, 'init_value': 77.78520202636719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.78520202636719
avg return on 5 trajectories of agent14: 1047.582540333333
Episode generator created
[2m2025-05-05 16:34.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:34.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:34.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:34.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:34.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163417[0m
[2m2025-05-05 16:34.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:34.26[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019029717445373535, 'time_algorithm_update': 0.004779685974121093, 'loss': 1.4351731057688595, 'time_step': 0.006730555772781372, 'init_value': 10.113008499145508}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:34.34[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001906407594680786, 'time_algorithm_update': 0.004837235689163208, 'loss': 4.522524008899927, 'time_step': 0.0067918825149536136, 'init_value': 19.984149932861328}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:34.42[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019015302658081054, 'time_algorithm_update': 0.00482889723777771, 'loss': 7.9938267530202864, 'time_step': 0.006777891159057617, 'init_value': 29.949859619140625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:34.50[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001915976047515869, 'time_algorithm_update': 0.004838679790496826, 'loss': 12.390050924003123, 'time_step': 0.0068028564453125, 'init_value': 39.5978889465332}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:34.58[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001911191701889038, 'time_algorithm_update': 0.004835682392120361, 'loss': 17.914843831181525, 'time_step': 0.006795262098312378, 'init_value': 48.079952239990234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:35.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019145519733428954, 'time_algorithm_update': 0.004847063064575195, 'loss': 21.491814730525018, 'time_step': 0.006810424566268921, 'init_value': 55.93891525268555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:35.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908987045288086, 'time_algorithm_update': 0.004833826303482056, 'loss': 22.31150116288662, 'time_step': 0.006792598962783813, 'init_value': 63.3900146484375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:35.22[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912834644317627, 'time_algorithm_update': 0.004848728895187378, 'loss': 22.84691602253914, 'time_step': 0.0068103566169738766, 'init_value': 70.26032257080078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:35.30[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019127860069274901, 'time_algorithm_update': 0.004840250492095947, 'loss': 24.94929969918728, 'time_step': 0.006801576614379883, 'init_value': 77.0247573852539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:35.38[0m [[32m[1minfo     [0m] [1mFQE_20250505163417: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019069056510925293, 'time_algorithm_update': 0.004837574243545533, 'loss': 30.07467516684532, 'time_step': 0.0067927522659301754, 'init_value': 82.58403015136719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.58403015136719
avg return on 5 trajectories of agent15: 1042.5614153333333
Episode generator created
[2m2025-05-05 16:35.39[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:35.39[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:35.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:35.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:35.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163539[0m
[2m2025-05-05 16:35.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:35.47[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021096653938293456, 'time_algorithm_update': 0.0047871038913726805, 'loss': 1.4689620063453912, 'time_step': 0.006945371627807617, 'init_value': 10.092519760131836}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:35.55[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019109196662902832, 'time_algorithm_update': 0.004848294019699097, 'loss': 4.284688272058964, 'time_step': 0.006807807922363281, 'init_value': 20.52022361755371}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:36.03[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019123256206512451, 'time_algorithm_update': 0.004867260456085205, 'loss': 9.230379089951516, 'time_step': 0.006828158140182495, 'init_value': 30.851078033447266}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:36.11[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019031445980072022, 'time_algorithm_update': 0.004860819578170777, 'loss': 15.727493075728416, 'time_step': 0.006812375783920288, 'init_value': 39.663204193115234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:36.20[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019131262302398682, 'time_algorithm_update': 0.004879572868347168, 'loss': 18.761015162706375, 'time_step': 0.0068409590721130375, 'init_value': 48.04841613769531}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:36.28[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019155828952789307, 'time_algorithm_update': 0.004885411262512207, 'loss': 23.098493575692178, 'time_step': 0.006849998235702514, 'init_value': 55.626731872558594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:36.36[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019111900329589844, 'time_algorithm_update': 0.004881303310394287, 'loss': 25.53611972296238, 'time_step': 0.006840958833694458, 'init_value': 60.887107849121094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:36.44[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019114537239074707, 'time_algorithm_update': 0.004876460075378418, 'loss': 27.335542293310166, 'time_step': 0.006836548566818237, 'init_value': 66.59246063232422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:36.52[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019198029041290283, 'time_algorithm_update': 0.004885578632354736, 'loss': 31.885480428099633, 'time_step': 0.006854066133499146, 'init_value': 72.30705261230469}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:37.00[0m [[32m[1minfo     [0m] [1mFQE_20250505163539: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019107325077056885, 'time_algorithm_update': 0.004868520498275757, 'loss': 35.423916454195975, 'time_step': 0.006827714204788208, 'init_value': 75.90213775634766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.90213775634766
avg return on 5 trajectories of agent16: 2172.499041
Episode generator created
[2m2025-05-05 16:37.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:37.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:37.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:37.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:37.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163702[0m
[2m2025-05-05 16:37.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:37.10[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00189941668510437, 'time_algorithm_update': 0.00477289342880249, 'loss': 1.440853283405304, 'time_step': 0.006720520973205566, 'init_value': 10.287969589233398}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:37.18[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019091989994049073, 'time_algorithm_update': 0.0048461594581604, 'loss': 4.057417424231768, 'time_step': 0.006803683042526245, 'init_value': 20.17953109741211}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:37.26[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001923940420150757, 'time_algorithm_update': 0.004869703531265259, 'loss': 9.767280129432677, 'time_step': 0.006842630386352539, 'init_value': 30.17053985595703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:37.34[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019040915966033935, 'time_algorithm_update': 0.00483534026145935, 'loss': 15.915995527148247, 'time_step': 0.006787647485733032, 'init_value': 39.41752243041992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:37.42[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019094400405883789, 'time_algorithm_update': 0.00482579779624939, 'loss': 20.013398718833923, 'time_step': 0.006783400297164917, 'init_value': 48.049476623535156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:37.50[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907822608947754, 'time_algorithm_update': 0.004833030700683594, 'loss': 21.59996442103386, 'time_step': 0.006789805412292481, 'init_value': 55.07032012939453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:37.58[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019146130084991455, 'time_algorithm_update': 0.00484277081489563, 'loss': 26.101695600032805, 'time_step': 0.006806147336959839, 'init_value': 60.89308166503906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:38.07[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001919018030166626, 'time_algorithm_update': 0.004865118741989136, 'loss': 29.038131417155267, 'time_step': 0.006833270788192749, 'init_value': 67.35968780517578}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:38.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019151053428649902, 'time_algorithm_update': 0.004848003149032593, 'loss': 29.400734808683396, 'time_step': 0.00681148624420166, 'init_value': 74.0448226928711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:38.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163702: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019201996326446533, 'time_algorithm_update': 0.004852470636367798, 'loss': 28.77611100077629, 'time_step': 0.006821772813796997, 'init_value': 78.87986755371094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.87986755371094
avg return on 5 trajectories of agent17: 2459.7617276666665
Episode generator created
[2m2025-05-05 16:38.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:38.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:38.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:38.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:38.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163825[0m
[2m2025-05-05 16:38.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:38.33[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001900231122970581, 'time_algorithm_update': 0.004779912233352661, 'loss': 1.5545077190846204, 'time_step': 0.00672800350189209, 'init_value': 10.536054611206055}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:38.41[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912569522857666, 'time_algorithm_update': 0.004835517406463623, 'loss': 4.443541370421648, 'time_step': 0.006796038627624511, 'init_value': 20.437427520751953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:38.49[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019160451889038085, 'time_algorithm_update': 0.0048394956588745115, 'loss': 9.37426183027029, 'time_step': 0.0068040876388549805, 'init_value': 30.40974235534668}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:38.57[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019199433326721191, 'time_algorithm_update': 0.004840442180633545, 'loss': 14.695880694746972, 'time_step': 0.006808871269226074, 'init_value': 40.05170440673828}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:39.05[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019164366722106935, 'time_algorithm_update': 0.00484192967414856, 'loss': 18.057780394375325, 'time_step': 0.006806604385375977, 'init_value': 47.54182434082031}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:39.13[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018701438903808594, 'time_algorithm_update': 0.004747399091720581, 'loss': 21.673993993639947, 'time_step': 0.006663768529891968, 'init_value': 55.62532424926758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:39.21[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018841195106506347, 'time_algorithm_update': 0.004744110107421875, 'loss': 24.371502398133277, 'time_step': 0.006676294326782226, 'init_value': 62.04256820678711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:39.29[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018869314193725585, 'time_algorithm_update': 0.004738749742507935, 'loss': 26.30112129497528, 'time_step': 0.006673777341842651, 'init_value': 68.21685791015625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:39.37[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018905315399169922, 'time_algorithm_update': 0.004743850231170655, 'loss': 29.05181753671169, 'time_step': 0.006682909250259399, 'init_value': 74.32081604003906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:39.45[0m [[32m[1minfo     [0m] [1mFQE_20250505163825: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018957762718200685, 'time_algorithm_update': 0.004739496946334839, 'loss': 31.29357611334324, 'time_step': 0.006683794498443604, 'init_value': 79.07098388671875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.07098388671875
avg return on 5 trajectories of agent18: 1826.7862780000003
Episode generator created
[2m2025-05-05 16:39.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:39.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:39.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:39.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:39.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163946[0m
[2m2025-05-05 16:39.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00187365984916687, 'time_algorithm_update': 0.004684356689453125, 'loss': 1.5408061346039177, 'time_step': 0.006605300426483154, 'init_value': 9.706710815429688}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:40.02[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019268138408660889, 'time_algorithm_update': 0.004876727104187011, 'loss': 4.329329561203719, 'time_step': 0.006851807832717895, 'init_value': 19.165576934814453}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:40.10[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001918013334274292, 'time_algorithm_update': 0.004856283903121948, 'loss': 8.615741870045662, 'time_step': 0.006822516918182373, 'init_value': 29.28659439086914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:40.18[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019166986942291259, 'time_algorithm_update': 0.0048658702373504635, 'loss': 14.778366028666497, 'time_step': 0.0068307797908782955, 'init_value': 38.788063049316406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:40.26[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019169628620147705, 'time_algorithm_update': 0.004850892305374145, 'loss': 19.493700541734697, 'time_step': 0.006815938949584961, 'init_value': 46.99098205566406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:40.35[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907952070236206, 'time_algorithm_update': 0.004837542772293091, 'loss': 23.781704924702645, 'time_step': 0.006793703556060791, 'init_value': 55.202632904052734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:40.43[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019133048057556152, 'time_algorithm_update': 0.00484966778755188, 'loss': 27.801766112923623, 'time_step': 0.006811084508895874, 'init_value': 61.038822174072266}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:40.51[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019418926239013672, 'time_algorithm_update': 0.004910111665725708, 'loss': 30.479783022522927, 'time_step': 0.006901505947113037, 'init_value': 67.31804656982422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:40.59[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001910742998123169, 'time_algorithm_update': 0.0048570485115051265, 'loss': 31.49617699241638, 'time_step': 0.0068159916400909425, 'init_value': 72.86698150634766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:41.07[0m [[32m[1minfo     [0m] [1mFQE_20250505163946: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019143419265747071, 'time_algorithm_update': 0.004863077640533447, 'loss': 34.6429549677372, 'time_step': 0.006825794696807861, 'init_value': 76.48159790039062}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.48159790039062
avg return on 5 trajectories of agent19: 1678.8952613333333
Episode generator created
[2m2025-05-05 16:41.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:41.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:41.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:41.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:41.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164108[0m
[2m2025-05-05 16:41.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:41.16[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001894981861114502, 'time_algorithm_update': 0.004763192892074585, 'loss': 1.4716271327883006, 'time_step': 0.006705718517303467, 'init_value': 10.181661605834961}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:41.24[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019133076667785644, 'time_algorithm_update': 0.004838846921920777, 'loss': 4.584050877839327, 'time_step': 0.006800195932388306, 'init_value': 20.553361892700195}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:41.33[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019152097702026367, 'time_algorithm_update': 0.004847671985626221, 'loss': 8.081415425777434, 'time_step': 0.0068111541271209716, 'init_value': 30.256065368652344}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:41.41[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019093940258026122, 'time_algorithm_update': 0.004844414234161377, 'loss': 11.976860951304436, 'time_step': 0.006802117109298706, 'init_value': 38.297996520996094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:41.49[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019072227478027343, 'time_algorithm_update': 0.004840466260910034, 'loss': 14.86510781800747, 'time_step': 0.006795483589172363, 'init_value': 45.831180572509766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:41.57[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001905592441558838, 'time_algorithm_update': 0.00483649468421936, 'loss': 18.87722917294502, 'time_step': 0.006789861679077148, 'init_value': 53.229736328125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:42.05[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019099149703979492, 'time_algorithm_update': 0.004857413768768311, 'loss': 22.019614132523536, 'time_step': 0.006815600872039795, 'init_value': 59.41937255859375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:42.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019265098571777345, 'time_algorithm_update': 0.004919915199279785, 'loss': 21.70191069829464, 'time_step': 0.006896204948425293, 'init_value': 65.15333557128906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:42.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019349789619445802, 'time_algorithm_update': 0.0049352068901062016, 'loss': 26.09934133207798, 'time_step': 0.006920368909835816, 'init_value': 71.72508239746094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:42.29[0m [[32m[1minfo     [0m] [1mFQE_20250505164108: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018958518505096437, 'time_algorithm_update': 0.0048266263008117675, 'loss': 27.69546445417404, 'time_step': 0.006770209074020385, 'init_value': 77.18573760986328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.18573760986328
ave advantage rew: 78.6093936920166, std: 3.4270051359049507
avg cum rews: 1842.2947840666664, std: 540.4033203723162
Pearson correlation coefficient: -0.15609614153389645
Spearman correlation coefficient: -0.09172932330827067
Kendall Tau correlation coefficient: -0.08421052631578947
the best agent: 4, best agent cum rewards: 2003.4242853333333
1955
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01766817734441952
avg return on 5 trajectories of agent0: 1452.6626573333333
Episode generator created
[2m2025-05-05 16:42.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:42.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:42.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:42.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:42.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164240[0m
[2m2025-05-05 16:42.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:42.48[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019034767150878907, 'time_algorithm_update': 0.004799465417861939, 'loss': 1.3466508122384548, 'time_step': 0.006750295639038086, 'init_value': 9.845635414123535}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:42.56[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00190706729888916, 'time_algorithm_update': 0.004876941680908203, 'loss': 4.422354725331068, 'time_step': 0.006832032918930054, 'init_value': 19.91881561279297}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:43.05[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001918952226638794, 'time_algorithm_update': 0.004879848718643188, 'loss': 8.272120347321033, 'time_step': 0.006846819162368774, 'init_value': 28.36949348449707}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:43.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019160609245300294, 'time_algorithm_update': 0.004883491992950439, 'loss': 12.255272715210914, 'time_step': 0.006847847938537597, 'init_value': 36.09112548828125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:43.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019201548099517822, 'time_algorithm_update': 0.004887379646301269, 'loss': 15.566714711666107, 'time_step': 0.006855730295181274, 'init_value': 43.66450119018555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:43.29[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019146687984466554, 'time_algorithm_update': 0.0048848876953125, 'loss': 20.480487749934195, 'time_step': 0.0068478379249572756, 'init_value': 51.56167984008789}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:43.37[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019036638736724854, 'time_algorithm_update': 0.004869219541549683, 'loss': 22.30502871668339, 'time_step': 0.006820621013641358, 'init_value': 57.3526725769043}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:43.45[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019234952926635743, 'time_algorithm_update': 0.004890909671783447, 'loss': 25.794616032004356, 'time_step': 0.00686277961730957, 'init_value': 62.65617752075195}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:43.53[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019113073348999024, 'time_algorithm_update': 0.0048747525215148925, 'loss': 26.71338076043129, 'time_step': 0.006834684133529663, 'init_value': 67.41824340820312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:44.01[0m [[32m[1minfo     [0m] [1mFQE_20250505164240: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00190759539604187, 'time_algorithm_update': 0.004870943069458008, 'loss': 25.784480370879173, 'time_step': 0.006826503276824951, 'init_value': 72.8250961303711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 72.8250961303711
avg return on 5 trajectories of agent1: 1188.2862113333333
Episode generator created
[2m2025-05-05 16:44.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:44.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:44.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:44.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:44.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164402[0m
[2m2025-05-05 16:44.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:44.11[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019022831916809082, 'time_algorithm_update': 0.004783149003982544, 'loss': 1.3197749327868222, 'time_step': 0.006733348608016968, 'init_value': 10.28609848022461}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:44.19[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019490551948547364, 'time_algorithm_update': 0.004933411121368408, 'loss': 4.133679860413075, 'time_step': 0.0069320909976959225, 'init_value': 20.55823516845703}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:44.27[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019179677963256836, 'time_algorithm_update': 0.0048720123767852785, 'loss': 7.701642886221409, 'time_step': 0.006838507175445556, 'init_value': 29.81598472595215}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:44.35[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019150390625, 'time_algorithm_update': 0.004877369165420533, 'loss': 11.758745222628116, 'time_step': 0.006840893745422363, 'init_value': 38.92422103881836}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:44.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019195036888122559, 'time_algorithm_update': 0.004869213104248047, 'loss': 16.47503352689743, 'time_step': 0.006837083578109741, 'init_value': 46.478580474853516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:44.51[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019213290214538574, 'time_algorithm_update': 0.004880929708480835, 'loss': 20.92473676800728, 'time_step': 0.006850667953491211, 'init_value': 53.76703643798828}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:44.59[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019095418453216552, 'time_algorithm_update': 0.004857930421829223, 'loss': 24.81258424437046, 'time_step': 0.006815430164337158, 'init_value': 61.0909423828125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:45.07[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019234330654144286, 'time_algorithm_update': 0.0048832504749298095, 'loss': 25.029191967487336, 'time_step': 0.006855244398117065, 'init_value': 67.29815673828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:45.16[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019153628349304198, 'time_algorithm_update': 0.004872224569320679, 'loss': 29.021438944101334, 'time_step': 0.006836084604263305, 'init_value': 72.33939361572266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:45.24[0m [[32m[1minfo     [0m] [1mFQE_20250505164402: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001905921220779419, 'time_algorithm_update': 0.004858891010284424, 'loss': 28.460211794376374, 'time_step': 0.0068132212162017826, 'init_value': 77.87602233886719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.87602233886719
avg return on 5 trajectories of agent2: 1059.8224273333335
Episode generator created
[2m2025-05-05 16:45.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:45.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:45.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:45.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:45.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164524[0m
[2m2025-05-05 16:45.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:45.33[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019082882404327392, 'time_algorithm_update': 0.004790246486663818, 'loss': 1.3537057227641345, 'time_step': 0.006746539354324341, 'init_value': 9.629316329956055}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:45.41[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019130899906158448, 'time_algorithm_update': 0.00485217022895813, 'loss': 3.9910696744918823, 'time_step': 0.006813213109970093, 'init_value': 18.47627830505371}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:45.49[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019169857501983643, 'time_algorithm_update': 0.004858928203582764, 'loss': 8.860424505650997, 'time_step': 0.0068248529434204105, 'init_value': 28.108097076416016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:45.57[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019118456840515137, 'time_algorithm_update': 0.004855684995651245, 'loss': 13.442294455468655, 'time_step': 0.006816008567810059, 'init_value': 36.61167526245117}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:46.05[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001920804500579834, 'time_algorithm_update': 0.0048642904758453365, 'loss': 16.88360318493843, 'time_step': 0.006833920955657959, 'init_value': 43.17811965942383}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:46.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019172236919403076, 'time_algorithm_update': 0.00485339903831482, 'loss': 19.46999305319786, 'time_step': 0.006818318605422973, 'init_value': 49.400360107421875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:46.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019186561107635497, 'time_algorithm_update': 0.004860470771789551, 'loss': 21.609868640303613, 'time_step': 0.00682744288444519, 'init_value': 54.8790397644043}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:46.29[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019218978881835938, 'time_algorithm_update': 0.004866156101226806, 'loss': 23.92731681203842, 'time_step': 0.006836101293563843, 'init_value': 60.560813903808594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:46.37[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001914879322052002, 'time_algorithm_update': 0.004856024265289307, 'loss': 26.083128829360007, 'time_step': 0.006819318294525147, 'init_value': 65.21222686767578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:46.46[0m [[32m[1minfo     [0m] [1mFQE_20250505164524: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019212346076965332, 'time_algorithm_update': 0.004847647190093994, 'loss': 27.21030938243866, 'time_step': 0.006817522764205932, 'init_value': 69.74791717529297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 69.74791717529297
avg return on 5 trajectories of agent3: 1046.547672
Episode generator created
[2m2025-05-05 16:46.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:46.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:46.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:46.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:46.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164647[0m
[2m2025-05-05 16:46.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:46.54[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018934438228607178, 'time_algorithm_update': 0.004760366439819336, 'loss': 1.453370296701789, 'time_step': 0.006701133489608765, 'init_value': 10.13894271850586}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:47.03[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019150705337524414, 'time_algorithm_update': 0.004855575323104858, 'loss': 4.304067439615727, 'time_step': 0.006818755149841309, 'init_value': 20.18768310546875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:47.11[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001914522409439087, 'time_algorithm_update': 0.004860708713531494, 'loss': 9.275454809486867, 'time_step': 0.006823270082473755, 'init_value': 29.73562240600586}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019086813926696778, 'time_algorithm_update': 0.0048729171752929686, 'loss': 14.411072048127652, 'time_step': 0.006830061435699463, 'init_value': 38.39996337890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:47.27[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019163119792938233, 'time_algorithm_update': 0.004869676113128662, 'loss': 21.64754598772526, 'time_step': 0.006834493637084961, 'init_value': 46.837100982666016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:47.35[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019062914848327636, 'time_algorithm_update': 0.004851268053054809, 'loss': 25.206722772717477, 'time_step': 0.006805525302886963, 'init_value': 54.285499572753906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:47.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019113192558288575, 'time_algorithm_update': 0.004858561277389526, 'loss': 28.767290445923805, 'time_step': 0.00681801152229309, 'init_value': 59.13640594482422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:47.51[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019484283924102784, 'time_algorithm_update': 0.004951720952987671, 'loss': 30.01360846185684, 'time_step': 0.006950614213943482, 'init_value': 64.14196014404297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:48.00[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00193990421295166, 'time_algorithm_update': 0.004918046236038208, 'loss': 34.874186706900595, 'time_step': 0.0069078369140625, 'init_value': 68.34815979003906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:48.08[0m [[32m[1minfo     [0m] [1mFQE_20250505164647: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019189827442169188, 'time_algorithm_update': 0.004865176200866699, 'loss': 31.46779558980465, 'time_step': 0.006832958459854126, 'init_value': 74.02672576904297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.02672576904297
avg return on 5 trajectories of agent4: 1469.5287613333333
Episode generator created
[2m2025-05-05 16:48.09[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:48.09[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:48.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:48.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:48.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164809[0m
[2m2025-05-05 16:48.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:48.17[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001901932954788208, 'time_algorithm_update': 0.004763927698135376, 'loss': 1.4142687313854694, 'time_step': 0.0067137513160705565, 'init_value': 10.309552192687988}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:48.25[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019043846130371094, 'time_algorithm_update': 0.004821669340133667, 'loss': 4.198927861064672, 'time_step': 0.006773380279541016, 'init_value': 20.485363006591797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:48.33[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019006979465484618, 'time_algorithm_update': 0.004809083461761475, 'loss': 8.466026102542877, 'time_step': 0.006757912635803223, 'init_value': 30.440305709838867}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:48.41[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019133350849151612, 'time_algorithm_update': 0.004831116676330566, 'loss': 13.065182667911053, 'time_step': 0.00679256820678711, 'init_value': 39.46906280517578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:48.49[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019041600227355958, 'time_algorithm_update': 0.004837046146392823, 'loss': 18.31675718307495, 'time_step': 0.006789436101913452, 'init_value': 47.63569641113281}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:48.57[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018785407543182374, 'time_algorithm_update': 0.004768627166748047, 'loss': 23.78622791159153, 'time_step': 0.006693647146224975, 'init_value': 55.976139068603516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:49.05[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018847687244415282, 'time_algorithm_update': 0.004749241113662719, 'loss': 30.36935316371918, 'time_step': 0.006682771682739258, 'init_value': 63.439273834228516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:49.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018807661533355713, 'time_algorithm_update': 0.004741307735443115, 'loss': 26.778688015341757, 'time_step': 0.006670150756835937, 'init_value': 70.97985076904297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:49.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018806138038635254, 'time_algorithm_update': 0.0047399232387542725, 'loss': 34.58177564203739, 'time_step': 0.0066692991256713866, 'init_value': 76.60188293457031}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:49.29[0m [[32m[1minfo     [0m] [1mFQE_20250505164809: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001879432201385498, 'time_algorithm_update': 0.004742445468902588, 'loss': 34.44718011498451, 'time_step': 0.006670127153396607, 'init_value': 80.7403335571289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.7403335571289
avg return on 5 trajectories of agent5: 1228.0340536666665
Episode generator created
[2m2025-05-05 16:49.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:49.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:49.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:49.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:49.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164930[0m
[2m2025-05-05 16:49.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:49.38[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018676280975341796, 'time_algorithm_update': 0.004684768915176392, 'loss': 1.424418279364705, 'time_step': 0.0065998809337615965, 'init_value': 10.805261611938477}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:49.46[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00190777850151062, 'time_algorithm_update': 0.0048708093166351316, 'loss': 4.732901104807854, 'time_step': 0.006826576709747315, 'init_value': 21.43755340576172}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:49.54[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001902336597442627, 'time_algorithm_update': 0.004855668067932129, 'loss': 9.631491903603077, 'time_step': 0.00680605149269104, 'init_value': 31.499866485595703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:50.02[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019102931022644044, 'time_algorithm_update': 0.004877383708953857, 'loss': 14.296345895469189, 'time_step': 0.0068353829383850095, 'init_value': 43.04623031616211}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:50.10[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001902890920639038, 'time_algorithm_update': 0.004860291719436646, 'loss': 20.072994015693663, 'time_step': 0.006810992002487182, 'init_value': 52.93767547607422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:50.18[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019026992321014404, 'time_algorithm_update': 0.004861110925674438, 'loss': 29.24996538376808, 'time_step': 0.006812278032302856, 'init_value': 61.95295715332031}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:50.26[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019110245704650878, 'time_algorithm_update': 0.00486889123916626, 'loss': 32.33485410141945, 'time_step': 0.006828494071960449, 'init_value': 69.78459167480469}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:50.34[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019012911319732666, 'time_algorithm_update': 0.0048576023578643795, 'loss': 35.95776588797569, 'time_step': 0.006806593894958496, 'init_value': 77.51951599121094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:50.42[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019126744270324706, 'time_algorithm_update': 0.00487397289276123, 'loss': 40.91135003018379, 'time_step': 0.006835132598876953, 'init_value': 86.22611999511719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:50.50[0m [[32m[1minfo     [0m] [1mFQE_20250505164930: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019248042106628418, 'time_algorithm_update': 0.004887128353118896, 'loss': 41.53416979634762, 'time_step': 0.006860547542572022, 'init_value': 89.54203796386719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 89.54203796386719
avg return on 5 trajectories of agent6: 1831.2969229999999
Episode generator created
[2m2025-05-05 16:50.52[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:50.52[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:50.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:50.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:50.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165052[0m
[2m2025-05-05 16:50.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:51.00[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019024720191955567, 'time_algorithm_update': 0.00477606201171875, 'loss': 1.5065469725281, 'time_step': 0.006726131916046142, 'init_value': 10.287164688110352}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:51.08[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019172229766845704, 'time_algorithm_update': 0.004884434938430786, 'loss': 4.343285119861364, 'time_step': 0.0068498880863189695, 'init_value': 19.80254364013672}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:51.16[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019106900691986085, 'time_algorithm_update': 0.0048740005493164065, 'loss': 8.018007357478142, 'time_step': 0.0068323204517364506, 'init_value': 29.305496215820312}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:51.24[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019310555458068848, 'time_algorithm_update': 0.004926491260528565, 'loss': 12.473526294231414, 'time_step': 0.006906357049942017, 'init_value': 37.6699333190918}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:51.33[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019084374904632568, 'time_algorithm_update': 0.004865203380584717, 'loss': 15.423430667042732, 'time_step': 0.006821853876113892, 'init_value': 46.272281646728516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:51.41[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019140136241912842, 'time_algorithm_update': 0.004868959188461304, 'loss': 18.549332334399224, 'time_step': 0.006831341981887817, 'init_value': 53.34657287597656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:51.49[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019142134189605712, 'time_algorithm_update': 0.004876688241958618, 'loss': 25.04764971935749, 'time_step': 0.006839589118957519, 'init_value': 60.29594802856445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:51.57[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019108495712280274, 'time_algorithm_update': 0.004868835687637329, 'loss': 24.352208901643753, 'time_step': 0.006827721357345581, 'init_value': 65.89779663085938}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:52.05[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019169571399688722, 'time_algorithm_update': 0.004875508546829224, 'loss': 27.93150660991669, 'time_step': 0.0068411164283752445, 'init_value': 71.4408950805664}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:52.13[0m [[32m[1minfo     [0m] [1mFQE_20250505165052: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019129645824432374, 'time_algorithm_update': 0.00486591649055481, 'loss': 31.70176186513901, 'time_step': 0.0068274614810943605, 'init_value': 75.51940155029297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.51940155029297
avg return on 5 trajectories of agent7: 1070.3213916666666
Episode generator created
[2m2025-05-05 16:52.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:52.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:52.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:52.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:52.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165214[0m
[2m2025-05-05 16:52.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:52.22[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001903839349746704, 'time_algorithm_update': 0.004808488607406616, 'loss': 1.5009881614744662, 'time_step': 0.00675981068611145, 'init_value': 10.355649948120117}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:52.30[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019189710617065429, 'time_algorithm_update': 0.004902473449707031, 'loss': 4.6599490447342395, 'time_step': 0.006869700908660889, 'init_value': 20.327672958374023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:52.38[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001913762092590332, 'time_algorithm_update': 0.004893991947174072, 'loss': 8.628998853325843, 'time_step': 0.006855756044387817, 'init_value': 30.841585159301758}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:52.46[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019158618450164796, 'time_algorithm_update': 0.0048955147266387935, 'loss': 15.157261349081994, 'time_step': 0.00685970425605774, 'init_value': 40.00471496582031}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:52.55[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019029781818389892, 'time_algorithm_update': 0.004876761198043823, 'loss': 20.37638447600603, 'time_step': 0.006827600240707397, 'init_value': 49.1295166015625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:53.03[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019131040573120118, 'time_algorithm_update': 0.00490109634399414, 'loss': 25.46508509647846, 'time_step': 0.006862391710281372, 'init_value': 56.8084602355957}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:53.11[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001923231840133667, 'time_algorithm_update': 0.0048925127983093265, 'loss': 28.081175447463988, 'time_step': 0.006864349126815796, 'init_value': 61.643245697021484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:53.19[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019133343696594238, 'time_algorithm_update': 0.004885635852813721, 'loss': 33.987268582463265, 'time_step': 0.006847050189971924, 'init_value': 68.16824340820312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:53.27[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019181475639343261, 'time_algorithm_update': 0.004895599365234375, 'loss': 35.926577538728715, 'time_step': 0.006862053632736206, 'init_value': 72.46267700195312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:53.35[0m [[32m[1minfo     [0m] [1mFQE_20250505165214: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019200215339660646, 'time_algorithm_update': 0.004897189378738403, 'loss': 39.97485921144485, 'time_step': 0.00686521577835083, 'init_value': 78.65489959716797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.65489959716797
avg return on 5 trajectories of agent8: 1933.5042879999999
Episode generator created
[2m2025-05-05 16:53.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:53.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:53.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:53.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:53.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165337[0m
[2m2025-05-05 16:53.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:53.45[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019010846614837646, 'time_algorithm_update': 0.004779973268508911, 'loss': 1.4497634370476007, 'time_step': 0.006728252649307251, 'init_value': 11.064997673034668}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:53.53[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019068002700805664, 'time_algorithm_update': 0.004845715522766113, 'loss': 4.201005066335202, 'time_step': 0.0068002910614013675, 'init_value': 21.542694091796875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:54.01[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912806510925293, 'time_algorithm_update': 0.0048556387424469, 'loss': 7.871998988389969, 'time_step': 0.006816637516021728, 'init_value': 31.65656280517578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:54.09[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019154527187347412, 'time_algorithm_update': 0.004848739385604858, 'loss': 13.149985476374626, 'time_step': 0.00681246542930603, 'init_value': 40.36631774902344}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:54.17[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019089701175689698, 'time_algorithm_update': 0.004836692094802857, 'loss': 16.479714158177377, 'time_step': 0.006793775081634521, 'init_value': 48.832191467285156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:54.25[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019027841091156005, 'time_algorithm_update': 0.004832331657409668, 'loss': 20.610088691473006, 'time_step': 0.006782722949981689, 'init_value': 56.71285629272461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:54.33[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019179685115814208, 'time_algorithm_update': 0.004860053062438965, 'loss': 27.57354090166092, 'time_step': 0.006826461791992188, 'init_value': 63.85519027709961}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:54.41[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019103174209594727, 'time_algorithm_update': 0.004854579448699951, 'loss': 29.6436982960701, 'time_step': 0.006813246488571167, 'init_value': 69.3322525024414}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:54.50[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019432756900787354, 'time_algorithm_update': 0.004919628381729126, 'loss': 31.89253550004959, 'time_step': 0.0069125273227691655, 'init_value': 72.92509460449219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:54.58[0m [[32m[1minfo     [0m] [1mFQE_20250505165337: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019179182052612305, 'time_algorithm_update': 0.004867744207382202, 'loss': 28.26741995191574, 'time_step': 0.006834115743637085, 'init_value': 77.12150573730469}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.12150573730469
avg return on 5 trajectories of agent9: 2085.8002036666667
Episode generator created
[2m2025-05-05 16:54.59[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:54.59[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:54.59[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:54.59[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:54.59[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165459[0m
[2m2025-05-05 16:54.59[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:55.07[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019161643981933593, 'time_algorithm_update': 0.00478822135925293, 'loss': 1.5658059061169625, 'time_step': 0.006752307891845703, 'init_value': 10.176326751708984}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:55.15[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019152297973632812, 'time_algorithm_update': 0.004881929636001587, 'loss': 4.582606722980738, 'time_step': 0.006845061302185059, 'init_value': 19.784347534179688}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:55.24[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019150166511535645, 'time_algorithm_update': 0.004879374742507934, 'loss': 8.812585339009761, 'time_step': 0.0068424873352050785, 'init_value': 29.288875579833984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:55.32[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001916853666305542, 'time_algorithm_update': 0.004880937337875366, 'loss': 12.088329498410225, 'time_step': 0.006845829963684082, 'init_value': 38.039615631103516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:55.40[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019194891452789307, 'time_algorithm_update': 0.004885053634643555, 'loss': 16.43275889480114, 'time_step': 0.0068533926010131835, 'init_value': 46.1558837890625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:55.48[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019301795959472657, 'time_algorithm_update': 0.0048896648883819584, 'loss': 22.859923657655717, 'time_step': 0.006868389368057251, 'init_value': 53.57075881958008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:55.56[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019066123962402344, 'time_algorithm_update': 0.0048641650676727296, 'loss': 24.299462321162224, 'time_step': 0.006818513631820679, 'init_value': 60.91563034057617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:56.04[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019253270626068116, 'time_algorithm_update': 0.004893701553344726, 'loss': 29.528412039637566, 'time_step': 0.0068679327964782716, 'init_value': 66.09060668945312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:56.12[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001930690050125122, 'time_algorithm_update': 0.004891361474990845, 'loss': 34.395285253882406, 'time_step': 0.006870802879333496, 'init_value': 71.74386596679688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:56.20[0m [[32m[1minfo     [0m] [1mFQE_20250505165459: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019318528175354004, 'time_algorithm_update': 0.004906481742858887, 'loss': 28.345427790760994, 'time_step': 0.00688694953918457, 'init_value': 75.76885223388672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.76885223388672
avg return on 5 trajectories of agent10: 2283.977854666666
Episode generator created
[2m2025-05-05 16:56.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:56.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:56.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:56.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:56.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165622[0m
[2m2025-05-05 16:56.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:56.30[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907639741897583, 'time_algorithm_update': 0.004779274463653564, 'loss': 1.5291387504935265, 'time_step': 0.006734304189682007, 'init_value': 9.46043586730957}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:56.39[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001917598009109497, 'time_algorithm_update': 0.004882037401199341, 'loss': 4.740380501627922, 'time_step': 0.0068475396633148194, 'init_value': 18.72515869140625}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:56.47[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019195611476898193, 'time_algorithm_update': 0.004876313209533692, 'loss': 8.218024469554424, 'time_step': 0.0068442702293396, 'init_value': 27.851608276367188}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:56.55[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019134974479675293, 'time_algorithm_update': 0.004867868423461914, 'loss': 13.035435781478881, 'time_step': 0.006829461097717285, 'init_value': 37.20394515991211}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:57.03[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019093167781829834, 'time_algorithm_update': 0.0048668720722198485, 'loss': 18.577811423063277, 'time_step': 0.0068241143226623535, 'init_value': 45.756126403808594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:57.11[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019171183109283447, 'time_algorithm_update': 0.004873877048492432, 'loss': 24.10987995362282, 'time_step': 0.006838830947875976, 'init_value': 52.86909866333008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:57.19[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019118072986602783, 'time_algorithm_update': 0.004857783555984497, 'loss': 29.23235995399952, 'time_step': 0.006817587375640869, 'init_value': 59.4007568359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:57.27[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018901033401489257, 'time_algorithm_update': 0.0048383629322052, 'loss': 32.776263100624085, 'time_step': 0.006775967597961426, 'init_value': 65.84752655029297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:57.35[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00190761661529541, 'time_algorithm_update': 0.004871955394744873, 'loss': 33.193559352636335, 'time_step': 0.006827934741973877, 'init_value': 72.25820922851562}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:57.43[0m [[32m[1minfo     [0m] [1mFQE_20250505165622: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907228946685791, 'time_algorithm_update': 0.004867795944213867, 'loss': 36.06218619298935, 'time_step': 0.006823024749755859, 'init_value': 77.30863952636719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.30863952636719
avg return on 5 trajectories of agent11: 2864.680523333334
Episode generator created
[2m2025-05-05 16:57.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:57.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:57.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:57.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:57.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165745[0m
[2m2025-05-05 16:57.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:57.54[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001897716999053955, 'time_algorithm_update': 0.004790699720382691, 'loss': 1.3788759514093398, 'time_step': 0.006736619234085083, 'init_value': 10.493597030639648}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:58.02[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001908273458480835, 'time_algorithm_update': 0.004851325035095215, 'loss': 4.491339629590511, 'time_step': 0.006807986259460449, 'init_value': 21.191158294677734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:58.10[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019036500453948975, 'time_algorithm_update': 0.004856359481811523, 'loss': 8.285739891588689, 'time_step': 0.006808156013488769, 'init_value': 31.16754150390625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:58.18[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019178428649902343, 'time_algorithm_update': 0.004886762142181396, 'loss': 13.267499551534653, 'time_step': 0.006853663921356201, 'init_value': 39.822654724121094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:58.26[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019243202209472657, 'time_algorithm_update': 0.0048995413780212405, 'loss': 18.339793522715567, 'time_step': 0.006873023271560669, 'init_value': 47.805118560791016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:58.34[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001915304183959961, 'time_algorithm_update': 0.004867418766021729, 'loss': 24.459468815207483, 'time_step': 0.00683112621307373, 'init_value': 55.31884002685547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:58.42[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018780255317687989, 'time_algorithm_update': 0.004780773162841797, 'loss': 22.857074310660362, 'time_step': 0.00670517635345459, 'init_value': 62.45338439941406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:58.50[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001876124858856201, 'time_algorithm_update': 0.004769220113754273, 'loss': 26.80590735256672, 'time_step': 0.00669358229637146, 'init_value': 68.75955200195312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:58.58[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018655774593353271, 'time_algorithm_update': 0.0047446458339691164, 'loss': 32.25211587262154, 'time_step': 0.006658342599868775, 'init_value': 74.27875518798828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:59.06[0m [[32m[1minfo     [0m] [1mFQE_20250505165745: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001882822036743164, 'time_algorithm_update': 0.004773611068725586, 'loss': 33.32671356010437, 'time_step': 0.006704480409622193, 'init_value': 79.05397033691406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.05397033691406
avg return on 5 trajectories of agent12: 1324.2376073333335
Episode generator created
[2m2025-05-05 16:59.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:59.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:59.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:59.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:59.07[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165907[0m
[2m2025-05-05 16:59.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:59.15[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018705356121063233, 'time_algorithm_update': 0.004681296586990356, 'loss': 1.4877587546110154, 'time_step': 0.006599754810333252, 'init_value': 10.01196002960205}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:59.23[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018732199668884278, 'time_algorithm_update': 0.004735434293746948, 'loss': 4.487276383936405, 'time_step': 0.0066566836833953855, 'init_value': 20.890714645385742}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:59.31[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019102864265441895, 'time_algorithm_update': 0.004839797258377075, 'loss': 8.901330666065217, 'time_step': 0.006798317670822143, 'init_value': 31.31438636779785}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:59.39[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001914269208908081, 'time_algorithm_update': 0.004843286037445068, 'loss': 13.994957838714123, 'time_step': 0.006806180000305175, 'init_value': 40.38933181762695}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:59.47[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001903017520904541, 'time_algorithm_update': 0.004825074911117553, 'loss': 16.758266234636306, 'time_step': 0.006776462078094483, 'init_value': 47.67452621459961}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:59.55[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001907214641571045, 'time_algorithm_update': 0.004820883512496948, 'loss': 21.99483647823334, 'time_step': 0.006776705026626587, 'init_value': 55.74905776977539}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:00.03[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001912837266921997, 'time_algorithm_update': 0.004839026212692261, 'loss': 25.957028487920763, 'time_step': 0.006800482749938965, 'init_value': 62.11857223510742}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:00.11[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019145145416259765, 'time_algorithm_update': 0.004836117506027222, 'loss': 27.122613134503364, 'time_step': 0.0067994587421417235, 'init_value': 67.88904571533203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:00.19[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019092025756835937, 'time_algorithm_update': 0.004811348676681518, 'loss': 30.43260743355751, 'time_step': 0.006768699407577515, 'init_value': 72.73579406738281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:00.27[0m [[32m[1minfo     [0m] [1mFQE_20250505165907: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018892157077789306, 'time_algorithm_update': 0.004795942544937134, 'loss': 29.777397035837172, 'time_step': 0.0067327568531036375, 'init_value': 78.35379791259766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.35379791259766
avg return on 5 trajectories of agent13: 1167.4612646666667
Episode generator created
[2m2025-05-05 17:00.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:00.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:00.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:00.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:00.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170028[0m
[2m2025-05-05 17:00.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:00.36[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001896134376525879, 'time_algorithm_update': 0.004779757261276245, 'loss': 1.4234324450045823, 'time_step': 0.006724070787429809, 'init_value': 9.412359237670898}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:00.44[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019018452167510987, 'time_algorithm_update': 0.00482982325553894, 'loss': 3.6345468058884145, 'time_step': 0.006779931783676148, 'init_value': 18.339168548583984}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:00.53[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001918623685836792, 'time_algorithm_update': 0.004855315685272216, 'loss': 7.769002050518989, 'time_step': 0.006822691679000854, 'init_value': 26.491867065429688}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:01.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019131810665130615, 'time_algorithm_update': 0.004844879150390625, 'loss': 12.61832056605816, 'time_step': 0.00680667519569397, 'init_value': 34.46031188964844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:01.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019216766357421874, 'time_algorithm_update': 0.004832220792770386, 'loss': 17.84754316818714, 'time_step': 0.006802541494369507, 'init_value': 42.233848571777344}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:01.17[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019062929153442383, 'time_algorithm_update': 0.0048275055885314945, 'loss': 18.429591142773628, 'time_step': 0.006782191753387451, 'init_value': 48.50001907348633}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:01.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019124932289123536, 'time_algorithm_update': 0.0048469240665435795, 'loss': 22.169697309613227, 'time_step': 0.0068081974983215336, 'init_value': 54.9881477355957}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:01.33[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019107580184936524, 'time_algorithm_update': 0.004838006973266602, 'loss': 25.302792978048323, 'time_step': 0.006797493934631348, 'init_value': 59.60395050048828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:01.41[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019044351577758788, 'time_algorithm_update': 0.0048321328163146975, 'loss': 26.333567964315414, 'time_step': 0.006785175800323486, 'init_value': 64.84979248046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:01.49[0m [[32m[1minfo     [0m] [1mFQE_20250505170028: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019530351161956786, 'time_algorithm_update': 0.004948771476745605, 'loss': 25.812744536995886, 'time_step': 0.006952503204345703, 'init_value': 70.0574722290039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 70.0574722290039
avg return on 5 trajectories of agent14: 1054.4077029999999
Episode generator created
[2m2025-05-05 17:01.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:01.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:01.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:01.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:01.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170150[0m
[2m2025-05-05 17:01.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:01.58[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018871824741363526, 'time_algorithm_update': 0.004755359172821045, 'loss': 1.3567175557017326, 'time_step': 0.006689414024353028, 'init_value': 10.141111373901367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:02.06[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019259362220764161, 'time_algorithm_update': 0.00487936544418335, 'loss': 3.946586173057556, 'time_step': 0.006854209423065185, 'init_value': 20.464923858642578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:02.14[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001917152166366577, 'time_algorithm_update': 0.004868334531784058, 'loss': 7.392461024105549, 'time_step': 0.006833996057510376, 'init_value': 29.94525909423828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:02.23[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019221420288085937, 'time_algorithm_update': 0.0048808369636535644, 'loss': 10.72945601850748, 'time_step': 0.0068513104915618895, 'init_value': 39.4403076171875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:02.31[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019210660457611084, 'time_algorithm_update': 0.0048809792995452884, 'loss': 15.48792231988907, 'time_step': 0.006850768089294434, 'init_value': 47.234710693359375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:02.39[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019153852462768554, 'time_algorithm_update': 0.004866979837417603, 'loss': 19.365568217635154, 'time_step': 0.006830819368362427, 'init_value': 55.32605743408203}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:02.47[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001913898229598999, 'time_algorithm_update': 0.004869129419326782, 'loss': 20.865676213383676, 'time_step': 0.006831975460052491, 'init_value': 61.40235137939453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:02.55[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019210762977600099, 'time_algorithm_update': 0.004880878210067749, 'loss': 21.77693805539608, 'time_step': 0.006850708723068238, 'init_value': 69.91487121582031}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:03.03[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019131712913513183, 'time_algorithm_update': 0.004862050771713257, 'loss': 24.013625667333603, 'time_step': 0.006823608636856079, 'init_value': 75.97737884521484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:03.11[0m [[32m[1minfo     [0m] [1mFQE_20250505170150: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019263837337493896, 'time_algorithm_update': 0.004870831251144409, 'loss': 25.05668043756485, 'time_step': 0.006845821142196656, 'init_value': 82.11202239990234}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.11202239990234
avg return on 5 trajectories of agent15: 1128.7877063333333
Episode generator created
[2m2025-05-05 17:03.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:03.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:03.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:03.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:03.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170312[0m
[2m2025-05-05 17:03.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:03.20[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019093434810638428, 'time_algorithm_update': 0.004779216527938843, 'loss': 1.4271292402595281, 'time_step': 0.006736809730529785, 'init_value': 10.21619987487793}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:03.28[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018908228874206542, 'time_algorithm_update': 0.004798158407211304, 'loss': 3.9953680600225927, 'time_step': 0.006736540794372558, 'init_value': 20.213478088378906}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:03.36[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019099445343017578, 'time_algorithm_update': 0.004846920490264892, 'loss': 7.663069728076458, 'time_step': 0.006805040121078491, 'init_value': 30.232343673706055}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:03.44[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019146370887756347, 'time_algorithm_update': 0.004847024440765381, 'loss': 12.895572565734387, 'time_step': 0.006810022592544556, 'init_value': 39.32699203491211}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:03.53[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019202089309692382, 'time_algorithm_update': 0.004861882209777832, 'loss': 15.764706012487412, 'time_step': 0.00683721923828125, 'init_value': 46.671199798583984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:04.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019156620502471923, 'time_algorithm_update': 0.004850433349609375, 'loss': 18.972220408678055, 'time_step': 0.0068146767616271975, 'init_value': 54.00324249267578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:04.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019193203449249267, 'time_algorithm_update': 0.004857996940612793, 'loss': 19.48143515264988, 'time_step': 0.006825829982757568, 'init_value': 61.05049133300781}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:04.17[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00191548752784729, 'time_algorithm_update': 0.004859629392623901, 'loss': 23.927366583943368, 'time_step': 0.006823848724365234, 'init_value': 67.8762435913086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:04.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019063458442687988, 'time_algorithm_update': 0.004849697351455688, 'loss': 24.888260622143747, 'time_step': 0.006804535865783692, 'init_value': 72.73855590820312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:04.33[0m [[32m[1minfo     [0m] [1mFQE_20250505170312: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019175257682800292, 'time_algorithm_update': 0.0048567898273468016, 'loss': 29.371246975183485, 'time_step': 0.006822871923446655, 'init_value': 78.09576416015625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.09576416015625
avg return on 5 trajectories of agent16: 1493.8764766666666
Episode generator created
[2m2025-05-05 17:04.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:04.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:04.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:04.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:04.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170434[0m
[2m2025-05-05 17:04.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:04.43[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001932765007019043, 'time_algorithm_update': 0.004864769697189331, 'loss': 1.49836936429888, 'time_step': 0.006845933198928833, 'init_value': 9.646200180053711}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:04.51[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020055575370788573, 'time_algorithm_update': 0.005106371402740478, 'loss': 4.584570578992367, 'time_step': 0.007162970542907715, 'init_value': 19.274070739746094}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:04.59[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019951517581939695, 'time_algorithm_update': 0.005094489097595215, 'loss': 8.403274043321609, 'time_step': 0.0071398718357086185, 'init_value': 29.038219451904297}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:05.08[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015737771987915, 'time_algorithm_update': 0.005145880222320556, 'loss': 12.266816516697407, 'time_step': 0.007213196039199829, 'init_value': 35.780330657958984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:05.17[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020245587825775146, 'time_algorithm_update': 0.0051414031982421875, 'loss': 17.141648739933967, 'time_step': 0.0072178437709808346, 'init_value': 42.751617431640625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:05.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002006295442581177, 'time_algorithm_update': 0.0050792315006256104, 'loss': 17.69334346807003, 'time_step': 0.007136582612991333, 'init_value': 50.64789962768555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:05.33[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019959704875946046, 'time_algorithm_update': 0.005057843446731568, 'loss': 26.251180978417395, 'time_step': 0.007104800224304199, 'init_value': 55.22586441040039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:05.42[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019908895492553712, 'time_algorithm_update': 0.00506061315536499, 'loss': 24.328312462329865, 'time_step': 0.00710250973701477, 'init_value': 62.076141357421875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:05.50[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994582176208496, 'time_algorithm_update': 0.00505734634399414, 'loss': 27.776617889523507, 'time_step': 0.00710292649269104, 'init_value': 67.39845275878906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:05.59[0m [[32m[1minfo     [0m] [1mFQE_20250505170434: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019921510219573974, 'time_algorithm_update': 0.005064831018447876, 'loss': 30.631194070458413, 'time_step': 0.00710791802406311, 'init_value': 73.63025665283203}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.63025665283203
avg return on 5 trajectories of agent17: 2174.670466
Episode generator created
[2m2025-05-05 17:06.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:06.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:06.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:06.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:06.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170600[0m
[2m2025-05-05 17:06.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:06.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019821348190307616, 'time_algorithm_update': 0.0050062212944030765, 'loss': 1.5290133388489484, 'time_step': 0.007038192749023437, 'init_value': 10.07557201385498}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:06.17[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019895620346069335, 'time_algorithm_update': 0.005060175657272339, 'loss': 4.490595773041249, 'time_step': 0.007099960565567017, 'init_value': 20.555452346801758}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:06.26[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004741430282593, 'time_algorithm_update': 0.005080796003341674, 'loss': 9.307624130368232, 'time_step': 0.007136139154434204, 'init_value': 30.457321166992188}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:06.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019808721542358397, 'time_algorithm_update': 0.005048598766326904, 'loss': 15.16412662011385, 'time_step': 0.007079658031463623, 'init_value': 40.525943756103516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:06.42[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989133358001709, 'time_algorithm_update': 0.00506694746017456, 'loss': 21.03356748723984, 'time_step': 0.007106517553329468, 'init_value': 48.52628707885742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:06.51[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996438980102539, 'time_algorithm_update': 0.005074310064315796, 'loss': 25.80030547130108, 'time_step': 0.007121342658996582, 'init_value': 55.83203125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:06.59[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002005275011062622, 'time_algorithm_update': 0.005079559087753296, 'loss': 29.70451711547375, 'time_step': 0.00713559079170227, 'init_value': 64.68311309814453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:07.08[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996204376220703, 'time_algorithm_update': 0.0050779573917388915, 'loss': 30.995915581822395, 'time_step': 0.007125066757202148, 'init_value': 70.83442687988281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:07.16[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019924895763397217, 'time_algorithm_update': 0.005079127550125122, 'loss': 38.498099232673646, 'time_step': 0.0071223311424255375, 'init_value': 76.92427825927734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:07.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170600: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999821662902832, 'time_algorithm_update': 0.005076054811477661, 'loss': 39.69937171554565, 'time_step': 0.007126566648483277, 'init_value': 81.53385162353516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.53385162353516
avg return on 5 trajectories of agent18: 3095.1636553333337
Episode generator created
[2m2025-05-05 17:07.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:07.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:07.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:07.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:07.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170727[0m
[2m2025-05-05 17:07.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:07.35[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984947681427002, 'time_algorithm_update': 0.004994937181472778, 'loss': 1.4244148802757264, 'time_step': 0.00702972412109375, 'init_value': 10.685577392578125}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:07.44[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019839556217193604, 'time_algorithm_update': 0.005044731616973877, 'loss': 4.299728081941605, 'time_step': 0.007079071044921875, 'init_value': 20.846830368041992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:07.52[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019887516498565674, 'time_algorithm_update': 0.0050694246292114255, 'loss': 7.740176618993282, 'time_step': 0.007109285354614258, 'init_value': 31.491064071655273}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:08.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019903168678283693, 'time_algorithm_update': 0.005064351320266724, 'loss': 12.910558647572994, 'time_step': 0.007105376243591309, 'init_value': 40.627174377441406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:08.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196816086769104, 'time_algorithm_update': 0.005036543130874634, 'loss': 16.521294592142105, 'time_step': 0.0070546560287475584, 'init_value': 47.844078063964844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:08.17[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019949088096618654, 'time_algorithm_update': 0.005072706460952759, 'loss': 20.409858180761336, 'time_step': 0.007119117021560669, 'init_value': 55.624603271484375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:08.26[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019988062381744386, 'time_algorithm_update': 0.0050812759399414065, 'loss': 22.009246730804442, 'time_step': 0.007131428003311157, 'init_value': 62.493289947509766}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:08.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996750831604004, 'time_algorithm_update': 0.005081296920776367, 'loss': 28.69319300162792, 'time_step': 0.007128928661346436, 'init_value': 69.1629409790039}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:08.42[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019489545822143554, 'time_algorithm_update': 0.004974760770797729, 'loss': 24.661723572969436, 'time_step': 0.0069726998805999755, 'init_value': 73.55894470214844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505170727: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019943764209747316, 'time_algorithm_update': 0.005053936719894409, 'loss': 29.744570599794386, 'time_step': 0.00709914755821228, 'init_value': 78.51294708251953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.51294708251953
avg return on 5 trajectories of agent19: 2501.913312
Episode generator created
[2m2025-05-05 17:08.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:08.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:08.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:08.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:08.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170853[0m
[2m2025-05-05 17:08.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:09.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019516608715057374, 'time_algorithm_update': 0.00490518856048584, 'loss': 1.4712716708928346, 'time_step': 0.006905485868453979, 'init_value': 10.703522682189941}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:09.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019565629959106445, 'time_algorithm_update': 0.004953264236450195, 'loss': 4.1772514626085755, 'time_step': 0.00695887541770935, 'init_value': 21.39846420288086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:09.18[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965156078338623, 'time_algorithm_update': 0.004965547323226929, 'loss': 8.89916177868843, 'time_step': 0.006980241298675537, 'init_value': 32.19132614135742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:09.26[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987755298614502, 'time_algorithm_update': 0.00505128812789917, 'loss': 14.41010782444477, 'time_step': 0.00708978796005249, 'init_value': 41.81415557861328}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:09.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001669883728027, 'time_algorithm_update': 0.005066091775894165, 'loss': 19.44904631370306, 'time_step': 0.007118605136871338, 'init_value': 50.09282684326172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:09.43[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978372097015381, 'time_algorithm_update': 0.005028714895248413, 'loss': 21.621134565114975, 'time_step': 0.007056532621383667, 'init_value': 56.34202575683594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:09.51[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990983247756958, 'time_algorithm_update': 0.00506151294708252, 'loss': 27.12546253299713, 'time_step': 0.007103546857833863, 'init_value': 63.991397857666016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:10.00[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996903419494629, 'time_algorithm_update': 0.005066903114318848, 'loss': 28.17883425450325, 'time_step': 0.007115973472595215, 'init_value': 69.9454116821289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:10.08[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991856813430786, 'time_algorithm_update': 0.005059273719787598, 'loss': 29.836332290530205, 'time_step': 0.007102416038513183, 'init_value': 75.8849105834961}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:10.16[0m [[32m[1minfo     [0m] [1mFQE_20250505170853: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994560956954956, 'time_algorithm_update': 0.005053877830505371, 'loss': 30.23824863743782, 'time_step': 0.007099354267120361, 'init_value': 80.6756820678711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.6756820678711
ave advantage rew: 77.5578598022461, std: 4.362051862988763
avg cum rews: 1672.7490579333335, std: 622.9243477841674
Pearson correlation coefficient: 0.1609941834726519
Spearman correlation coefficient: 0.20451127819548873
Kendall Tau correlation coefficient: 0.15789473684210525
the best agent: 5, best agent cum rewards: 1228.0340536666665
1956
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.018156347930207893
avg return on 5 trajectories of agent0: 1338.321613
Episode generator created
[2m2025-05-05 17:10.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:10.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:10.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:10.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:10.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171028[0m
[2m2025-05-05 17:10.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:10.36[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989030361175537, 'time_algorithm_update': 0.005005543470382691, 'loss': 1.4123481491208076, 'time_step': 0.007044398069381714, 'init_value': 10.532974243164062}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:10.44[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019906506538391114, 'time_algorithm_update': 0.005078857421875, 'loss': 4.015755128622055, 'time_step': 0.0071211838722229, 'init_value': 20.771474838256836}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:10.53[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019927332401275637, 'time_algorithm_update': 0.005080389499664307, 'loss': 7.869406421720981, 'time_step': 0.007124496936798096, 'init_value': 30.683406829833984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:11.01[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019974124431610106, 'time_algorithm_update': 0.005075788497924805, 'loss': 11.01945272910595, 'time_step': 0.007123810529708862, 'init_value': 40.45948028564453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:11.10[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898135662078857, 'time_algorithm_update': 0.005061241865158081, 'loss': 17.371170476555825, 'time_step': 0.007101475238800049, 'init_value': 48.92699432373047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:11.18[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019978199005126953, 'time_algorithm_update': 0.005055843353271484, 'loss': 20.3690645236969, 'time_step': 0.0071042213439941404, 'init_value': 55.74150085449219}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:11.26[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998709440231323, 'time_algorithm_update': 0.005065544128417969, 'loss': 23.359487741827966, 'time_step': 0.007114972114562988, 'init_value': 62.800960540771484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:11.35[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020016400814056395, 'time_algorithm_update': 0.00507499647140503, 'loss': 28.28414262509346, 'time_step': 0.0071276741027832035, 'init_value': 69.42313385009766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:11.43[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993221044540405, 'time_algorithm_update': 0.0050601277351379394, 'loss': 29.4065163025856, 'time_step': 0.00710409951210022, 'init_value': 74.67538452148438}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:11.52[0m [[32m[1minfo     [0m] [1mFQE_20250505171028: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002182483673096, 'time_algorithm_update': 0.005074597835540771, 'loss': 30.76585292720795, 'time_step': 0.007127759695053101, 'init_value': 78.89749908447266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.89749908447266
avg return on 5 trajectories of agent1: 1867.756904
Episode generator created
[2m2025-05-05 17:11.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:11.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:11.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:11.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:11.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171153[0m
[2m2025-05-05 17:11.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:12.02[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019895765781402586, 'time_algorithm_update': 0.0050125100612640385, 'loss': 1.4797957975417375, 'time_step': 0.007052607774734497, 'init_value': 9.998547554016113}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:12.10[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994738578796387, 'time_algorithm_update': 0.005065296649932861, 'loss': 4.721497042089701, 'time_step': 0.007110432624816894, 'init_value': 19.908702850341797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:12.19[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028022289276123, 'time_algorithm_update': 0.005156486511230469, 'loss': 7.930927023410797, 'time_step': 0.0072369172573089596, 'init_value': 28.402421951293945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:12.27[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019911835193634035, 'time_algorithm_update': 0.005066308736801147, 'loss': 11.339107427418233, 'time_step': 0.00710822606086731, 'init_value': 37.98897933959961}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:12.36[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020041303634643556, 'time_algorithm_update': 0.00507080602645874, 'loss': 15.022884999513627, 'time_step': 0.007125858068466186, 'init_value': 47.52975845336914}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:12.44[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019804437160491945, 'time_algorithm_update': 0.005046231746673584, 'loss': 23.500841524004937, 'time_step': 0.007076413631439209, 'init_value': 53.80603790283203}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:12.53[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026457071304321, 'time_algorithm_update': 0.005133044481277466, 'loss': 26.489872316002845, 'time_step': 0.007211562156677246, 'init_value': 61.00124740600586}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:13.01[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202738618850708, 'time_algorithm_update': 0.00513473105430603, 'loss': 30.302738418221473, 'time_step': 0.007214148998260498, 'init_value': 66.96178436279297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:13.10[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019688029289245605, 'time_algorithm_update': 0.005026006221771241, 'loss': 34.8549368891716, 'time_step': 0.00704482388496399, 'init_value': 72.84449005126953}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:13.18[0m [[32m[1minfo     [0m] [1mFQE_20250505171153: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020052242279052735, 'time_algorithm_update': 0.0050589141845703125, 'loss': 32.24160448551178, 'time_step': 0.007115262508392334, 'init_value': 78.26703643798828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.26703643798828
avg return on 5 trajectories of agent2: 2802.227622666667
Episode generator created
[2m2025-05-05 17:13.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:13.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:13.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:13.20[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:13.20[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171320[0m
[2m2025-05-05 17:13.20[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:13.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981076717376709, 'time_algorithm_update': 0.00500193452835083, 'loss': 1.5050045942515136, 'time_step': 0.0070329420566558835, 'init_value': 10.964958190917969}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:13.37[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019937169551849363, 'time_algorithm_update': 0.00507262635231018, 'loss': 4.459703314512968, 'time_step': 0.007117097616195679, 'init_value': 20.550365447998047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:13.45[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019922399520874022, 'time_algorithm_update': 0.005078978061676025, 'loss': 8.770178727447986, 'time_step': 0.007121645212173462, 'init_value': 30.484127044677734}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:13.54[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019868290424346923, 'time_algorithm_update': 0.005074603319168091, 'loss': 12.63408364534378, 'time_step': 0.007112255096435547, 'init_value': 39.85985565185547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:14.02[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996222734451294, 'time_algorithm_update': 0.00508299207687378, 'loss': 17.152710608959197, 'time_step': 0.007129961013793945, 'init_value': 48.101478576660156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:14.10[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019848241806030274, 'time_algorithm_update': 0.00506221866607666, 'loss': 21.83723474121094, 'time_step': 0.007097372055053711, 'init_value': 55.71503829956055}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:14.19[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993659973144531, 'time_algorithm_update': 0.0050753259658813474, 'loss': 23.782594110608102, 'time_step': 0.007119830131530762, 'init_value': 63.97551345825195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:14.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019901275634765627, 'time_algorithm_update': 0.00507523775100708, 'loss': 29.26630090546608, 'time_step': 0.007116124153137207, 'init_value': 70.94322967529297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:14.36[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019934594631195067, 'time_algorithm_update': 0.005077611923217773, 'loss': 28.634185367107392, 'time_step': 0.0071219573020935055, 'init_value': 77.28362274169922}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:14.44[0m [[32m[1minfo     [0m] [1mFQE_20250505171320: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019752826690673827, 'time_algorithm_update': 0.005052532911300659, 'loss': 32.19756029701233, 'time_step': 0.0070776925086975095, 'init_value': 81.6629867553711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.6629867553711
avg return on 5 trajectories of agent3: 2713.7203173333332
Episode generator created
[2m2025-05-05 17:14.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:14.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:14.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:14.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:14.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171446[0m
[2m2025-05-05 17:14.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:14.55[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197182559967041, 'time_algorithm_update': 0.004979494571685791, 'loss': 1.4745914897918702, 'time_step': 0.007000995635986328, 'init_value': 9.780841827392578}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:15.03[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019787466526031494, 'time_algorithm_update': 0.0050489199161529545, 'loss': 4.3845928237140175, 'time_step': 0.007078209400177002, 'init_value': 19.30240821838379}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:15.11[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990689992904663, 'time_algorithm_update': 0.005052560091018677, 'loss': 9.577714188814163, 'time_step': 0.007094140529632568, 'init_value': 28.718780517578125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:15.20[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019895269870758058, 'time_algorithm_update': 0.005054964542388916, 'loss': 12.784797742307186, 'time_step': 0.0070952394008636475, 'init_value': 37.21470642089844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:15.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898533821105955, 'time_algorithm_update': 0.005055502653121948, 'loss': 14.650769434452057, 'time_step': 0.00709627914428711, 'init_value': 45.00737762451172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:15.37[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019908092021942137, 'time_algorithm_update': 0.005059987306594849, 'loss': 19.670696636676787, 'time_step': 0.007101755619049072, 'init_value': 53.47972106933594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:15.45[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019928531646728515, 'time_algorithm_update': 0.00506993293762207, 'loss': 23.267153974056242, 'time_step': 0.007113739013671875, 'init_value': 58.754112243652344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:15.54[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025489330291748, 'time_algorithm_update': 0.005144236087799073, 'loss': 23.481406641364096, 'time_step': 0.007221944093704223, 'init_value': 65.21125030517578}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:16.02[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999955177307129, 'time_algorithm_update': 0.00507119607925415, 'loss': 27.775750816106797, 'time_step': 0.0071219642162323, 'init_value': 71.28556823730469}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:16.11[0m [[32m[1minfo     [0m] [1mFQE_20250505171446: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992920160293579, 'time_algorithm_update': 0.005051980495452881, 'loss': 32.876011829853056, 'time_step': 0.0070956296920776365, 'init_value': 75.66287994384766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.66287994384766
avg return on 5 trajectories of agent4: 1298.378586
Episode generator created
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:16.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:16.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171612[0m
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:16.20[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019715170860290527, 'time_algorithm_update': 0.0050041799545288085, 'loss': 1.5235115910172463, 'time_step': 0.0070254943370819094, 'init_value': 9.672122955322266}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:16.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019881961345672608, 'time_algorithm_update': 0.0050790090560913085, 'loss': 4.435001751601696, 'time_step': 0.007117660284042359, 'init_value': 19.796850204467773}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:16.37[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019863650798797607, 'time_algorithm_update': 0.00508635425567627, 'loss': 8.108668807446957, 'time_step': 0.0071231269836425784, 'init_value': 29.2155818939209}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:16.45[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019897685050964354, 'time_algorithm_update': 0.005070246696472168, 'loss': 11.711290465891361, 'time_step': 0.007110656499862671, 'init_value': 37.76507568359375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:16.54[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019859607219696045, 'time_algorithm_update': 0.005064755916595459, 'loss': 16.655582921266557, 'time_step': 0.007100768566131592, 'init_value': 45.291107177734375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:17.02[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990715026855469, 'time_algorithm_update': 0.005070852756500244, 'loss': 21.997715157389642, 'time_step': 0.007112163782119751, 'init_value': 52.9755859375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:17.11[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993037223815918, 'time_algorithm_update': 0.005074410915374756, 'loss': 23.20304816031456, 'time_step': 0.007117923498153687, 'init_value': 59.5184326171875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:17.19[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987050771713257, 'time_algorithm_update': 0.005072386264801026, 'loss': 28.288633375763894, 'time_step': 0.007110400915145874, 'init_value': 64.56291961669922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:17.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019979257583618163, 'time_algorithm_update': 0.005073577642440796, 'loss': 28.622979495644568, 'time_step': 0.007122245311737061, 'init_value': 69.46485900878906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:17.36[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199936580657959, 'time_algorithm_update': 0.0050823924541473385, 'loss': 32.11138810932636, 'time_step': 0.00713243317604065, 'init_value': 74.85367584228516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.85367584228516
avg return on 5 trajectories of agent5: 1927.0422543333334
Episode generator created
[2m2025-05-05 17:17.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:17.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:17.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:17.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:17.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171738[0m
[2m2025-05-05 17:17.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:17.46[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196679949760437, 'time_algorithm_update': 0.0049668869972229, 'loss': 1.3891608858555555, 'time_step': 0.00698225998878479, 'init_value': 10.756457328796387}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:17.54[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019971926212310792, 'time_algorithm_update': 0.005054476976394653, 'loss': 4.088676092773676, 'time_step': 0.0071016960144042966, 'init_value': 21.711307525634766}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:18.03[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993595361709595, 'time_algorithm_update': 0.005075900793075561, 'loss': 8.516654884696006, 'time_step': 0.007120447874069214, 'init_value': 32.629337310791016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:18.11[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019823336601257325, 'time_algorithm_update': 0.005062246561050415, 'loss': 12.771193243265152, 'time_step': 0.007095132350921631, 'init_value': 41.57613754272461}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:18.20[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019856593608856203, 'time_algorithm_update': 0.0050649700164794925, 'loss': 17.10300686609745, 'time_step': 0.00710192346572876, 'init_value': 50.05208969116211}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:18.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019899709224700927, 'time_algorithm_update': 0.005072865486145019, 'loss': 19.94842812013626, 'time_step': 0.007113381385803223, 'init_value': 57.87791061401367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:18.36[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996717691421509, 'time_algorithm_update': 0.005083641290664673, 'loss': 26.3589714820385, 'time_step': 0.007131322860717774, 'init_value': 65.36138153076172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:18.45[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019560065269470213, 'time_algorithm_update': 0.005006041526794434, 'loss': 27.711906969428064, 'time_step': 0.00701188588142395, 'init_value': 73.22452545166016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:18.53[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019566965103149413, 'time_algorithm_update': 0.004983392238616944, 'loss': 28.226087057352068, 'time_step': 0.006989935874938965, 'init_value': 79.41036987304688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:19.01[0m [[32m[1minfo     [0m] [1mFQE_20250505171738: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959484815597534, 'time_algorithm_update': 0.004994372367858887, 'loss': 35.843410813093186, 'time_step': 0.007003521919250489, 'init_value': 85.816162109375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.816162109375
avg return on 5 trajectories of agent6: 3411.6055553333335
Episode generator created
[2m2025-05-05 17:19.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:19.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:19.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:19.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:19.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171904[0m
[2m2025-05-05 17:19.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:19.12[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019443349838256835, 'time_algorithm_update': 0.004878544807434082, 'loss': 1.440860268369317, 'time_step': 0.006871154308319092, 'init_value': 9.940827369689941}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:19.21[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972932815551758, 'time_algorithm_update': 0.004986968994140625, 'loss': 4.235390121489763, 'time_step': 0.007009702682495117, 'init_value': 20.16366958618164}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:19.29[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196851110458374, 'time_algorithm_update': 0.004969905853271484, 'loss': 7.7228432648181915, 'time_step': 0.006987709522247315, 'init_value': 29.701847076416016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:19.37[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997304916381836, 'time_algorithm_update': 0.005039288282394409, 'loss': 11.022295619487762, 'time_step': 0.007086743831634521, 'init_value': 38.3405876159668}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:19.46[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019974324703216553, 'time_algorithm_update': 0.005043121337890625, 'loss': 14.318421117067338, 'time_step': 0.007091253995895386, 'init_value': 46.34028625488281}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:19.54[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019911558628082277, 'time_algorithm_update': 0.005042089939117432, 'loss': 16.095335186719893, 'time_step': 0.007083461284637451, 'init_value': 53.3731803894043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:20.02[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995661497116089, 'time_algorithm_update': 0.005047961473464966, 'loss': 21.442401716589927, 'time_step': 0.0070943071842193605, 'init_value': 60.41409683227539}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:20.11[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019847493171691894, 'time_algorithm_update': 0.0050311174392700195, 'loss': 23.283452018380164, 'time_step': 0.007066229104995728, 'init_value': 65.9228515625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:20.19[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992755889892578, 'time_algorithm_update': 0.005038135290145874, 'loss': 27.596971507549284, 'time_step': 0.007081637144088745, 'init_value': 70.75943756103516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:20.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171904: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019895381927490232, 'time_algorithm_update': 0.005022456407546997, 'loss': 23.336610180497168, 'time_step': 0.0070629951953887935, 'init_value': 75.7459487915039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.7459487915039
avg return on 5 trajectories of agent7: 1606.8252973333335
Episode generator created
[2m2025-05-05 17:20.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:20.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:20.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:20.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:20.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172029[0m
[2m2025-05-05 17:20.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:20.37[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971460819244385, 'time_algorithm_update': 0.005009914398193359, 'loss': 1.4136762532889844, 'time_step': 0.007031075477600098, 'init_value': 10.035863876342773}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:20.46[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986738681793213, 'time_algorithm_update': 0.0050905017852783205, 'loss': 3.9101390054523946, 'time_step': 0.0071276891231536865, 'init_value': 20.228879928588867}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:20.54[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019655287265777587, 'time_algorithm_update': 0.005058141708374023, 'loss': 8.666817183196544, 'time_step': 0.007073151826858521, 'init_value': 29.83344841003418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:21.03[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987700939178467, 'time_algorithm_update': 0.005089407205581665, 'loss': 13.380174438655377, 'time_step': 0.007127700328826904, 'init_value': 38.182254791259766}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:21.11[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199078631401062, 'time_algorithm_update': 0.005092051982879639, 'loss': 16.06764777612686, 'time_step': 0.007133414506912231, 'init_value': 45.845237731933594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:21.19[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019975967407226563, 'time_algorithm_update': 0.005094511032104492, 'loss': 20.11933117711544, 'time_step': 0.007143357515335083, 'init_value': 53.13552474975586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:21.28[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019892799854278565, 'time_algorithm_update': 0.005082953453063965, 'loss': 22.30439349770546, 'time_step': 0.007123197078704834, 'init_value': 58.91649627685547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:21.36[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019924066066741943, 'time_algorithm_update': 0.005084438800811768, 'loss': 26.67709385550022, 'time_step': 0.007127957344055176, 'init_value': 65.85786437988281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:21.45[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019884457588195802, 'time_algorithm_update': 0.005084760189056396, 'loss': 26.55812022805214, 'time_step': 0.007123753070831299, 'init_value': 70.6611557006836}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:21.53[0m [[32m[1minfo     [0m] [1mFQE_20250505172029: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975008249282837, 'time_algorithm_update': 0.0050754742622375485, 'loss': 26.96620919275284, 'time_step': 0.007100929260253906, 'init_value': 76.42741394042969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.42741394042969
avg return on 5 trajectories of agent8: 1244.9354620000001
Episode generator created
[2m2025-05-05 17:21.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:21.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:21.54[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:21.54[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:21.54[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172154[0m
[2m2025-05-05 17:21.54[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:22.03[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202233099937439, 'time_algorithm_update': 0.0050976402759552, 'loss': 1.4378893746882677, 'time_step': 0.007171402931213379, 'init_value': 9.783571243286133}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:22.12[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056668519973755, 'time_algorithm_update': 0.00522137975692749, 'loss': 4.0818514899611475, 'time_step': 0.0073313872814178465, 'init_value': 19.11267852783203}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:22.20[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020302319526672363, 'time_algorithm_update': 0.005173718690872193, 'loss': 7.580586159408092, 'time_step': 0.0072556154727935794, 'init_value': 29.43903160095215}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:22.29[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020100455284118653, 'time_algorithm_update': 0.005124828815460205, 'loss': 12.782656551897526, 'time_step': 0.007185702323913574, 'init_value': 37.30310821533203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:22.37[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041696310043335, 'time_algorithm_update': 0.005167900562286377, 'loss': 15.4354849614501, 'time_step': 0.007261373519897461, 'init_value': 46.11006546020508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:22.46[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020428500175476076, 'time_algorithm_update': 0.00520714521408081, 'loss': 20.54870530605316, 'time_step': 0.007302688121795654, 'init_value': 51.778656005859375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:22.54[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048846960067749, 'time_algorithm_update': 0.005195285320281982, 'loss': 21.833569727778436, 'time_step': 0.007296565294265747, 'init_value': 56.73099899291992}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:23.03[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038268566131592, 'time_algorithm_update': 0.005171333074569702, 'loss': 23.95387540256977, 'time_step': 0.007261980772018433, 'init_value': 62.860809326171875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:23.12[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031811237335205, 'time_algorithm_update': 0.005170104503631592, 'loss': 25.544838467359543, 'time_step': 0.007253661155700684, 'init_value': 68.30919647216797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:23.20[0m [[32m[1minfo     [0m] [1mFQE_20250505172154: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020328164100646973, 'time_algorithm_update': 0.00516398549079895, 'loss': 27.114587677240372, 'time_step': 0.007248938322067261, 'init_value': 73.37242126464844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.37242126464844
avg return on 5 trajectories of agent9: 1048.687761
Episode generator created
[2m2025-05-05 17:23.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:23.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:23.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:23.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:23.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172321[0m
[2m2025-05-05 17:23.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:23.30[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020165350437164305, 'time_algorithm_update': 0.005095108509063721, 'loss': 1.5403878968209028, 'time_step': 0.007162299156188965, 'init_value': 10.905454635620117}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:23.38[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033597707748413, 'time_algorithm_update': 0.005145251512527466, 'loss': 4.851797821640968, 'time_step': 0.007230733871459961, 'init_value': 21.701887130737305}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:23.47[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020240581035614012, 'time_algorithm_update': 0.0051278390884399415, 'loss': 9.215710920393468, 'time_step': 0.007202995777130127, 'init_value': 31.990312576293945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:23.55[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030529260635376, 'time_algorithm_update': 0.005150609016418457, 'loss': 15.899854749441147, 'time_step': 0.007232947587966919, 'init_value': 41.5053825378418}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:24.04[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202037501335144, 'time_algorithm_update': 0.005137138843536377, 'loss': 22.56764341008663, 'time_step': 0.007208990335464478, 'init_value': 49.8768424987793}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:24.12[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020241179466247558, 'time_algorithm_update': 0.005143919229507446, 'loss': 27.816156603097916, 'time_step': 0.0072197382450103756, 'init_value': 58.41337585449219}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:24.21[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029242515563965, 'time_algorithm_update': 0.005146915912628174, 'loss': 32.97082272565365, 'time_step': 0.007227825403213501, 'init_value': 63.673152923583984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:24.30[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032472372055054, 'time_algorithm_update': 0.005154239892959595, 'loss': 29.83447649526596, 'time_step': 0.00723870849609375, 'init_value': 68.81449890136719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:24.38[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032006740570068, 'time_algorithm_update': 0.005157082796096802, 'loss': 36.05941907334328, 'time_step': 0.007241218328475952, 'init_value': 74.65328216552734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:24.47[0m [[32m[1minfo     [0m] [1mFQE_20250505172321: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020269241333007813, 'time_algorithm_update': 0.00513457989692688, 'loss': 34.70245198369026, 'time_step': 0.0072131166458129885, 'init_value': 78.02061462402344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.02061462402344
avg return on 5 trajectories of agent10: 1053.6550696666666
Episode generator created
[2m2025-05-05 17:24.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:24.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:24.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:24.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:24.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172448[0m
[2m2025-05-05 17:24.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:24.56[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020170886516571044, 'time_algorithm_update': 0.005117818355560303, 'loss': 1.4418553511947394, 'time_step': 0.0071860020160675045, 'init_value': 10.33155345916748}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:25.05[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020240979194641115, 'time_algorithm_update': 0.005172987699508667, 'loss': 4.755780588239431, 'time_step': 0.007248686790466309, 'init_value': 20.37523078918457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:25.13[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019081115722656, 'time_algorithm_update': 0.005185638189315796, 'loss': 9.277240530490875, 'time_step': 0.00725605845451355, 'init_value': 30.227205276489258}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:25.22[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203344988822937, 'time_algorithm_update': 0.005188903570175171, 'loss': 13.926458752334117, 'time_step': 0.007274380683898926, 'init_value': 39.59675216674805}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:25.31[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020244090557098387, 'time_algorithm_update': 0.0051887788772583005, 'loss': 17.570809220433237, 'time_step': 0.007264927625656128, 'init_value': 46.34226608276367}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:25.39[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019371747970581, 'time_algorithm_update': 0.00516068720817566, 'loss': 22.609253794670106, 'time_step': 0.007231615781784058, 'init_value': 53.72734451293945}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:25.48[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032036542892456, 'time_algorithm_update': 0.0051828079223632815, 'loss': 27.06574392879009, 'time_step': 0.007267179489135742, 'init_value': 60.92898178100586}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:25.56[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020306429862976074, 'time_algorithm_update': 0.00519439697265625, 'loss': 31.723506878376007, 'time_step': 0.00727689266204834, 'init_value': 66.24616241455078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:26.05[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020406785011291505, 'time_algorithm_update': 0.005206418991088867, 'loss': 30.686204827070235, 'time_step': 0.007299724578857422, 'init_value': 70.23526763916016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:26.14[0m [[32m[1minfo     [0m] [1mFQE_20250505172448: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020274338722229006, 'time_algorithm_update': 0.005175882577896118, 'loss': 30.110878939151764, 'time_step': 0.007255139112472534, 'init_value': 75.13958740234375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.13958740234375
avg return on 5 trajectories of agent11: 1018.2100363333334
Episode generator created
[2m2025-05-05 17:26.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:26.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:26.15[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:26.15[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:26.15[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172615[0m
[2m2025-05-05 17:26.15[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:26.23[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020274930000305177, 'time_algorithm_update': 0.005168554544448853, 'loss': 1.457316413477063, 'time_step': 0.007247804164886474, 'init_value': 10.538917541503906}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:26.32[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020297386646270753, 'time_algorithm_update': 0.005174720287322998, 'loss': 4.2388046202361584, 'time_step': 0.007256107568740845, 'init_value': 20.361669540405273}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:26.40[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019740104675293, 'time_algorithm_update': 0.005160236120223999, 'loss': 7.853511849045754, 'time_step': 0.0072310950756073, 'init_value': 30.27338409423828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:26.49[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020266129970550537, 'time_algorithm_update': 0.00515234112739563, 'loss': 13.678898665308953, 'time_step': 0.007230355024337769, 'init_value': 38.070255279541016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:26.57[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020269558429718017, 'time_algorithm_update': 0.005159675359725952, 'loss': 18.969890335440635, 'time_step': 0.007238197803497315, 'init_value': 46.613487243652344}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:27.06[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027620792388916, 'time_algorithm_update': 0.0051725986003875735, 'loss': 22.862021782517434, 'time_step': 0.007251906871795655, 'init_value': 53.163543701171875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:27.15[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014577865600586, 'time_algorithm_update': 0.005144288301467895, 'loss': 27.63021238565445, 'time_step': 0.007209597587585449, 'init_value': 60.49494934082031}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:27.23[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020381247997283934, 'time_algorithm_update': 0.005174401760101318, 'loss': 28.66299864971638, 'time_step': 0.007264749526977539, 'init_value': 67.36824798583984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:27.32[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028029441833496, 'time_algorithm_update': 0.005171183586120605, 'loss': 34.75427093648911, 'time_step': 0.007251009464263916, 'init_value': 72.8890151977539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:27.40[0m [[32m[1minfo     [0m] [1mFQE_20250505172615: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020311434268951416, 'time_algorithm_update': 0.005163830280303955, 'loss': 35.52720529401302, 'time_step': 0.00724632716178894, 'init_value': 75.971435546875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.971435546875
avg return on 5 trajectories of agent12: 1537.613579
Episode generator created
[2m2025-05-05 17:27.41[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:27.41[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:27.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:27.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:27.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172742[0m
[2m2025-05-05 17:27.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:27.50[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020184240341186523, 'time_algorithm_update': 0.005106868982315063, 'loss': 1.4463952328413725, 'time_step': 0.007176796674728394, 'init_value': 9.969260215759277}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:27.59[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344007015228273, 'time_algorithm_update': 0.005149248361587524, 'loss': 4.1812405105233195, 'time_step': 0.007235349416732788, 'init_value': 19.67301368713379}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:28.07[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026374340057373, 'time_algorithm_update': 0.005151621341705322, 'loss': 7.756649476587772, 'time_step': 0.007229695558547974, 'init_value': 28.10506820678711}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:28.16[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022987127304077, 'time_algorithm_update': 0.005134218454360962, 'loss': 12.373189195990562, 'time_step': 0.007208760023117065, 'init_value': 36.604515075683594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:28.24[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029475450515747, 'time_algorithm_update': 0.005143326044082641, 'loss': 14.071781717896462, 'time_step': 0.007224627017974853, 'init_value': 43.996891021728516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:28.33[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020231149196624754, 'time_algorithm_update': 0.005153955698013306, 'loss': 18.568380626916884, 'time_step': 0.007228877305984497, 'init_value': 50.27284622192383}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:28.42[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035975217819214, 'time_algorithm_update': 0.005146164417266846, 'loss': 21.053414315223694, 'time_step': 0.0072337591648101805, 'init_value': 57.4560546875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:28.50[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020175657272338866, 'time_algorithm_update': 0.00512921142578125, 'loss': 22.85870668113232, 'time_step': 0.0071981606483459476, 'init_value': 64.18392944335938}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:28.59[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203342342376709, 'time_algorithm_update': 0.0051613891124725345, 'loss': 33.92838935911655, 'time_step': 0.0072466788291931155, 'init_value': 70.69508361816406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:29.07[0m [[32m[1minfo     [0m] [1mFQE_20250505172742: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019975836277008057, 'time_algorithm_update': 0.005077468395233154, 'loss': 33.10491908144951, 'time_step': 0.007125351190567016, 'init_value': 73.84052276611328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.84052276611328
avg return on 5 trajectories of agent13: 1641.1948423333333
Episode generator created
[2m2025-05-05 17:29.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:29.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:29.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:29.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:29.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172908[0m
[2m2025-05-05 17:29.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:29.17[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969356060028074, 'time_algorithm_update': 0.005027653932571411, 'loss': 1.3538703170567752, 'time_step': 0.007074122667312622, 'init_value': 10.665120124816895}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:29.25[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020068171024322508, 'time_algorithm_update': 0.00508250641822815, 'loss': 3.9070416188538073, 'time_step': 0.0071396992206573485, 'init_value': 20.811315536499023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:29.34[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002000485420227051, 'time_algorithm_update': 0.0050753002166748044, 'loss': 7.6593268184661865, 'time_step': 0.00712598729133606, 'init_value': 30.19515609741211}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:29.42[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020106029510498047, 'time_algorithm_update': 0.005086695432662964, 'loss': 10.823195781946183, 'time_step': 0.007147913694381714, 'init_value': 39.163482666015625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:29.51[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020196969509124756, 'time_algorithm_update': 0.0051346952915191655, 'loss': 15.954366380274296, 'time_step': 0.007205774068832397, 'init_value': 45.74064254760742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:29.59[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020356075763702393, 'time_algorithm_update': 0.005193695545196533, 'loss': 18.55198836827278, 'time_step': 0.007281293630599975, 'init_value': 52.87912368774414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:30.08[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026487350463867, 'time_algorithm_update': 0.0051565618515014644, 'loss': 21.418181787252426, 'time_step': 0.007234464883804321, 'init_value': 60.52106857299805}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:30.16[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020290160179138182, 'time_algorithm_update': 0.005140251159667969, 'loss': 25.290376170039178, 'time_step': 0.007220688104629516, 'init_value': 67.54754638671875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:30.25[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017920255661011, 'time_algorithm_update': 0.005124571800231933, 'loss': 28.848452621936797, 'time_step': 0.007193636417388916, 'init_value': 71.91678619384766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:30.33[0m [[32m[1minfo     [0m] [1mFQE_20250505172908: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020360965728759765, 'time_algorithm_update': 0.005157304286956787, 'loss': 30.09334152185917, 'time_step': 0.007244957447052002, 'init_value': 77.2610855102539}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.2610855102539
avg return on 5 trajectories of agent14: 1367.026767
Episode generator created
[2m2025-05-05 17:30.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:30.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:30.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:30.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:30.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173035[0m
[2m2025-05-05 17:30.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:30.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020152044296264647, 'time_algorithm_update': 0.0051160604953765865, 'loss': 1.3921813981682063, 'time_step': 0.007182896614074707, 'init_value': 9.952408790588379}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:30.52[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020206332206726073, 'time_algorithm_update': 0.005143265247344971, 'loss': 4.369470409452915, 'time_step': 0.007215212106704712, 'init_value': 20.405895233154297}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:31.00[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025868892669678, 'time_algorithm_update': 0.005155751466751099, 'loss': 9.39234453547001, 'time_step': 0.007233469486236572, 'init_value': 29.674903869628906}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:31.09[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020253357887268066, 'time_algorithm_update': 0.0051554272174835205, 'loss': 13.797761495471, 'time_step': 0.007232334852218628, 'init_value': 37.925575256347656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:31.18[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025540828704834, 'time_algorithm_update': 0.005159602403640747, 'loss': 17.314578531503678, 'time_step': 0.007237171888351441, 'init_value': 46.598114013671875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020285754203796386, 'time_algorithm_update': 0.005159877300262451, 'loss': 25.1821089758873, 'time_step': 0.007239890813827515, 'init_value': 54.66285705566406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:31.35[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020268471240997314, 'time_algorithm_update': 0.0051632850170135495, 'loss': 23.83126846539974, 'time_step': 0.007242029428482056, 'init_value': 60.47324752807617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:31.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020319108963012694, 'time_algorithm_update': 0.00516689658164978, 'loss': 32.01210371255875, 'time_step': 0.007250682830810547, 'init_value': 68.11382293701172}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:31.52[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202756142616272, 'time_algorithm_update': 0.005155277490615845, 'loss': 31.75239543437958, 'time_step': 0.007235145092010498, 'init_value': 75.2887954711914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:32.00[0m [[32m[1minfo     [0m] [1mFQE_20250505173035: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020232093334198, 'time_algorithm_update': 0.00514713454246521, 'loss': 38.88690150201321, 'time_step': 0.007222109079360962, 'init_value': 82.79249572753906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.79249572753906
avg return on 5 trajectories of agent15: 1555.8459469999998
Episode generator created
[2m2025-05-05 17:32.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:32.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:32.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:32.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:32.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173202[0m
[2m2025-05-05 17:32.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:32.10[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020105199813842773, 'time_algorithm_update': 0.005128324270248413, 'loss': 1.413087078526616, 'time_step': 0.007189715147018432, 'init_value': 10.539935111999512}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:32.19[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020278308391571045, 'time_algorithm_update': 0.005174072265625, 'loss': 4.002011111170053, 'time_step': 0.007253411769866943, 'init_value': 20.617292404174805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:32.27[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020278832912445067, 'time_algorithm_update': 0.005186311960220337, 'loss': 8.79207796537876, 'time_step': 0.007265645265579224, 'init_value': 30.996492385864258}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:32.36[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029048442840576, 'time_algorithm_update': 0.00518157696723938, 'loss': 13.930471464574337, 'time_step': 0.007262237548828125, 'init_value': 39.81801223754883}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:32.45[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339367389678956, 'time_algorithm_update': 0.005176891565322876, 'loss': 18.27392888700962, 'time_step': 0.0072625534534454346, 'init_value': 47.630794525146484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:32.53[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028796911239624, 'time_algorithm_update': 0.005183741331100464, 'loss': 20.23513335609436, 'time_step': 0.007264012336730957, 'init_value': 56.04068374633789}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:33.02[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020303971767425535, 'time_algorithm_update': 0.005197308301925659, 'loss': 22.248359321713448, 'time_step': 0.007279837131500244, 'init_value': 62.788761138916016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:33.10[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033375263214111, 'time_algorithm_update': 0.00519031286239624, 'loss': 23.362841391325, 'time_step': 0.00727567982673645, 'init_value': 68.91146087646484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:33.19[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020369696617126465, 'time_algorithm_update': 0.005209272623062134, 'loss': 26.669881846189497, 'time_step': 0.00729855227470398, 'init_value': 72.83483123779297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:33.28[0m [[32m[1minfo     [0m] [1mFQE_20250505173202: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044766902923584, 'time_algorithm_update': 0.00522832727432251, 'loss': 28.761992752313613, 'time_step': 0.007325519800186157, 'init_value': 77.98038482666016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.98038482666016
avg return on 5 trajectories of agent16: 1243.575416
Episode generator created
[2m2025-05-05 17:33.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:33.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:33.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:33.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:33.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173329[0m
[2m2025-05-05 17:33.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:33.37[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996122360229492, 'time_algorithm_update': 0.005095772504806519, 'loss': 1.390302577421069, 'time_step': 0.007142710208892822, 'init_value': 10.221315383911133}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:33.46[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018056631088257, 'time_algorithm_update': 0.005177563905715942, 'loss': 4.343515534847975, 'time_step': 0.007247185230255127, 'init_value': 19.939388275146484}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:33.54[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024778366088867, 'time_algorithm_update': 0.005218210935592651, 'loss': 7.978926340222359, 'time_step': 0.007294849395751953, 'init_value': 29.386363983154297}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:34.03[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055664300918579, 'time_algorithm_update': 0.005274228096008301, 'loss': 12.434276056587697, 'time_step': 0.007382030248641968, 'init_value': 37.008323669433594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:34.12[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031940937042236, 'time_algorithm_update': 0.005194143772125244, 'loss': 15.513071657717228, 'time_step': 0.007277372598648071, 'init_value': 44.87306594848633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:34.20[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034662961959839, 'time_algorithm_update': 0.005204039096832275, 'loss': 20.092177921652794, 'time_step': 0.007290225505828857, 'init_value': 52.67958068847656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:34.29[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029944658279419, 'time_algorithm_update': 0.005194783449172974, 'loss': 23.571616457104682, 'time_step': 0.007277013540267945, 'init_value': 59.825347900390625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:34.38[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032910108566284, 'time_algorithm_update': 0.00519826078414917, 'loss': 26.948639854192734, 'time_step': 0.007282932996749878, 'init_value': 65.87208557128906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:34.46[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353755950927735, 'time_algorithm_update': 0.005185674428939819, 'loss': 29.508786069393157, 'time_step': 0.007272769689559936, 'init_value': 73.49543762207031}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:34.55[0m [[32m[1minfo     [0m] [1mFQE_20250505173329: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020335712432861326, 'time_algorithm_update': 0.005203583478927612, 'loss': 35.96095400047302, 'time_step': 0.007289248466491699, 'init_value': 78.23765563964844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.23765563964844
avg return on 5 trajectories of agent17: 2428.4155576666667
Episode generator created
[2m2025-05-05 17:34.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:34.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:34.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:34.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:34.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173457[0m
[2m2025-05-05 17:34.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:35.05[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020150070190429687, 'time_algorithm_update': 0.0051067726612091064, 'loss': 1.5408715029358864, 'time_step': 0.007172997236251831, 'init_value': 9.531495094299316}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:35.14[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002006309747695923, 'time_algorithm_update': 0.005120077848434448, 'loss': 4.473971377372742, 'time_step': 0.007177801132202149, 'init_value': 19.254098892211914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:35.22[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357952117919923, 'time_algorithm_update': 0.005175103187561035, 'loss': 9.081987643122673, 'time_step': 0.007263201475143433, 'init_value': 27.78820037841797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:35.31[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020223748683929443, 'time_algorithm_update': 0.005162759065628052, 'loss': 12.811232393741607, 'time_step': 0.007236859083175659, 'init_value': 36.9542236328125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:35.39[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028601884841919, 'time_algorithm_update': 0.005144270658493042, 'loss': 16.456446511149405, 'time_step': 0.007224225282669068, 'init_value': 44.65370559692383}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:35.48[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034162759780884, 'time_algorithm_update': 0.005157248020172119, 'loss': 21.717573382973672, 'time_step': 0.007243182420730591, 'init_value': 51.9384765625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:35.57[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020384833812713624, 'time_algorithm_update': 0.0051612708568572994, 'loss': 24.376232521176338, 'time_step': 0.007251463174819946, 'init_value': 58.21558380126953}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:36.05[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020360543727874756, 'time_algorithm_update': 0.005184517383575439, 'loss': 27.075647653222084, 'time_step': 0.007272846460342407, 'init_value': 64.44235229492188}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:36.14[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020259811878204346, 'time_algorithm_update': 0.005157418012619018, 'loss': 31.429389932632446, 'time_step': 0.0072353119850158696, 'init_value': 70.0019302368164}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:36.22[0m [[32m[1minfo     [0m] [1mFQE_20250505173457: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020335397720336913, 'time_algorithm_update': 0.005157478094100952, 'loss': 26.858861880540847, 'time_step': 0.007243056058883667, 'init_value': 75.02973937988281}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.02973937988281
avg return on 5 trajectories of agent18: 2077.4886496666663
Episode generator created
[2m2025-05-05 17:36.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:36.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:36.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:36.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:36.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173624[0m
[2m2025-05-05 17:36.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:36.33[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017306089401245, 'time_algorithm_update': 0.005095948457717895, 'loss': 1.4187937608361245, 'time_step': 0.007164335012435913, 'init_value': 9.933484077453613}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:36.41[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018338441848755, 'time_algorithm_update': 0.00513637661933899, 'loss': 4.189841463655234, 'time_step': 0.007206559896469116, 'init_value': 20.260601043701172}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:36.50[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227870941162108, 'time_algorithm_update': 0.0051478960514068604, 'loss': 8.667458098948002, 'time_step': 0.007222149848937988, 'init_value': 29.926782608032227}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:36.58[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034733057022095, 'time_algorithm_update': 0.005168399810791016, 'loss': 13.138465988457202, 'time_step': 0.007254873275756836, 'init_value': 39.45566940307617}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:37.07[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020243752002716063, 'time_algorithm_update': 0.005128355741500855, 'loss': 18.596901654005052, 'time_step': 0.007204276323318481, 'init_value': 47.980804443359375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:37.15[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025895357131958, 'time_algorithm_update': 0.005139436960220337, 'loss': 22.487642453312873, 'time_step': 0.007216990232467651, 'init_value': 55.79010009765625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:37.24[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020258505344390868, 'time_algorithm_update': 0.005156691074371338, 'loss': 29.35652170586586, 'time_step': 0.007234332084655762, 'init_value': 61.85862731933594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:37.32[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023521900177002, 'time_algorithm_update': 0.005147272109985351, 'loss': 28.003732088088988, 'time_step': 0.007222404241561889, 'init_value': 66.66185760498047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:37.41[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032216548919678, 'time_algorithm_update': 0.005139728784561157, 'loss': 32.145127082586285, 'time_step': 0.0072235426902771, 'init_value': 71.20931243896484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:37.50[0m [[32m[1minfo     [0m] [1mFQE_20250505173624: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020279595851898195, 'time_algorithm_update': 0.005136537075042725, 'loss': 29.471205952167512, 'time_step': 0.007216427564620972, 'init_value': 75.60710906982422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.60710906982422
avg return on 5 trajectories of agent19: 2348.9386876666667
Episode generator created
[2m2025-05-05 17:37.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:37.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:37.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:37.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:37.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173751[0m
[2m2025-05-05 17:37.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:38.00[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020821809768677, 'time_algorithm_update': 0.005106220960617066, 'loss': 1.4710129482597112, 'time_step': 0.007177888393402099, 'init_value': 10.5556001663208}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:38.09[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020187368392944336, 'time_algorithm_update': 0.005152498006820679, 'loss': 4.471910900354385, 'time_step': 0.007223231315612793, 'init_value': 20.63192367553711}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:38.17[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020268774032592774, 'time_algorithm_update': 0.005163803577423096, 'loss': 8.18352419489622, 'time_step': 0.0072428109645843505, 'init_value': 29.87651824951172}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:38.26[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003885984420776, 'time_algorithm_update': 0.005134277582168579, 'loss': 12.58235020494461, 'time_step': 0.007189247131347656, 'init_value': 38.9541130065918}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:38.34[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020230629444122315, 'time_algorithm_update': 0.005155156612396241, 'loss': 18.266130890250206, 'time_step': 0.007230602025985718, 'init_value': 46.89357376098633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:38.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020327041149139405, 'time_algorithm_update': 0.005176963090896607, 'loss': 21.95857087302208, 'time_step': 0.007261982440948486, 'init_value': 54.29248046875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:38.51[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312750339508056, 'time_algorithm_update': 0.005175667762756348, 'loss': 23.708440658450126, 'time_step': 0.0072590217590332035, 'init_value': 60.63145065307617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:39.00[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038792133331299, 'time_algorithm_update': 0.005187351226806641, 'loss': 26.304132685422896, 'time_step': 0.007278721809387207, 'init_value': 67.31011962890625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:39.09[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020393314361572264, 'time_algorithm_update': 0.005184654951095581, 'loss': 28.4965769251585, 'time_step': 0.007276049852371216, 'init_value': 71.81147766113281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:39.17[0m [[32m[1minfo     [0m] [1mFQE_20250505173751: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020242300033569338, 'time_algorithm_update': 0.0051777493953704835, 'loss': 29.588599040031433, 'time_step': 0.007254589796066285, 'init_value': 77.27391052246094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.27391052246094
ave advantage rew: 77.39302825927734, std: 3.004940029435946
avg cum rews: 1776.5732962666668, std: 648.5847392483674
Pearson correlation coefficient: 0.0628135820699508
Spearman correlation coefficient: 0.08571428571428572
Kendall Tau correlation coefficient: 0.0736842105263158
the best agent: 5, best agent cum rewards: 1927.0422543333334
1957
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.017369418892922095
avg return on 5 trajectories of agent0: 1637.5377529999998
Episode generator created
[2m2025-05-05 17:39.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:39.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:39.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:39.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:39.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173929[0m
[2m2025-05-05 17:39.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:39.37[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019827826023101807, 'time_algorithm_update': 0.004995383262634277, 'loss': 1.361437976822257, 'time_step': 0.007027791023254394, 'init_value': 10.874822616577148}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:39.45[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007387638092041, 'time_algorithm_update': 0.00506198239326477, 'loss': 4.473891956746578, 'time_step': 0.007119667768478393, 'init_value': 21.023866653442383}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020037548542022705, 'time_algorithm_update': 0.0050686559677124024, 'loss': 9.038421715557575, 'time_step': 0.007122394323348999, 'init_value': 29.930097579956055}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:40.02[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019971716403961184, 'time_algorithm_update': 0.005057125806808472, 'loss': 12.982495870769023, 'time_step': 0.007104671239852906, 'init_value': 40.204776763916016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:40.11[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010136365890503, 'time_algorithm_update': 0.005082548141479492, 'loss': 18.194907851099966, 'time_step': 0.007143336772918701, 'init_value': 48.838897705078125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:40.19[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020384433269500734, 'time_algorithm_update': 0.005171811103820801, 'loss': 23.074477900862693, 'time_step': 0.0072621841430664065, 'init_value': 57.182220458984375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:40.28[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042717218399048, 'time_algorithm_update': 0.005175868749618531, 'loss': 26.185570013642312, 'time_step': 0.007270139932632446, 'init_value': 65.46397399902344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:40.36[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020348765850067138, 'time_algorithm_update': 0.0051655805110931395, 'loss': 32.963129558324816, 'time_step': 0.007252692222595215, 'init_value': 71.75161743164062}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:40.45[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020350043773651122, 'time_algorithm_update': 0.005166599273681641, 'loss': 32.12215064942837, 'time_step': 0.007253729581832886, 'init_value': 77.32058715820312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:40.54[0m [[32m[1minfo     [0m] [1mFQE_20250505173929: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045966148376465, 'time_algorithm_update': 0.005165517807006836, 'loss': 38.6063469657898, 'time_step': 0.007263111352920532, 'init_value': 82.56189727783203}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.56189727783203
avg return on 5 trajectories of agent1: 1721.829273666667
Episode generator created
[2m2025-05-05 17:40.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:40.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:40.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:40.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:40.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174055[0m
[2m2025-05-05 17:40.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:41.04[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027629613876343, 'time_algorithm_update': 0.005126382827758789, 'loss': 1.3928161223232747, 'time_step': 0.007205027103424072, 'init_value': 10.31287670135498}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:41.12[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020343401432037353, 'time_algorithm_update': 0.0052207279205322265, 'loss': 4.110969864979387, 'time_step': 0.007306910037994384, 'init_value': 19.991283416748047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:41.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020459680557250977, 'time_algorithm_update': 0.005221024751663208, 'loss': 8.703609019577502, 'time_step': 0.007318698167800904, 'init_value': 29.866228103637695}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:41.29[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036336183547974, 'time_algorithm_update': 0.005227591276168823, 'loss': 11.873784415245057, 'time_step': 0.007315383195877075, 'init_value': 38.73349380493164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:41.38[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029353380203247, 'time_algorithm_update': 0.005203456401824951, 'loss': 15.446945207178592, 'time_step': 0.00728484582901001, 'init_value': 47.373199462890625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:41.47[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038097858428955, 'time_algorithm_update': 0.00522557258605957, 'loss': 21.477657606720925, 'time_step': 0.007315235614776611, 'init_value': 55.62299728393555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:41.55[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020369863510131835, 'time_algorithm_update': 0.005224734306335449, 'loss': 23.489934054374693, 'time_step': 0.007313305139541626, 'init_value': 62.42833709716797}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:42.04[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050943851470947, 'time_algorithm_update': 0.0052403724193573, 'loss': 23.66381760907173, 'time_step': 0.007343990325927734, 'init_value': 67.89788055419922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:42.13[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034292936325073, 'time_algorithm_update': 0.005211318731307983, 'loss': 26.530999439358713, 'time_step': 0.007297201156616211, 'init_value': 74.25012969970703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:42.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174055: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020398147106170652, 'time_algorithm_update': 0.005237015485763549, 'loss': 29.853304104924202, 'time_step': 0.007329086780548096, 'init_value': 82.2218246459961}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.2218246459961
avg return on 5 trajectories of agent2: 1261.0763613333331
Episode generator created
[2m2025-05-05 17:42.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:42.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:42.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:42.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:42.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174223[0m
[2m2025-05-05 17:42.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:42.31[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026155710220337, 'time_algorithm_update': 0.005093636512756347, 'loss': 1.5418434944748878, 'time_step': 0.007170678853988648, 'init_value': 10.354886054992676}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:42.40[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038759708404541, 'time_algorithm_update': 0.00515221905708313, 'loss': 4.329206644654274, 'time_step': 0.007243383407592774, 'init_value': 21.138214111328125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:42.48[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031052589416504, 'time_algorithm_update': 0.005149293899536133, 'loss': 8.203854822337627, 'time_step': 0.007231927394866943, 'init_value': 31.305435180664062}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:42.57[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344130992889405, 'time_algorithm_update': 0.0051373600959777836, 'loss': 13.734081307947635, 'time_step': 0.007222930669784546, 'init_value': 40.068180084228516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:43.05[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042271852493286, 'time_algorithm_update': 0.00515051794052124, 'loss': 17.706750765681267, 'time_step': 0.007244880676269531, 'init_value': 49.40643310546875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:43.14[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020207562446594237, 'time_algorithm_update': 0.005117606878280639, 'loss': 22.374080437064173, 'time_step': 0.007189670324325562, 'init_value': 58.32738494873047}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:43.22[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020442824363708497, 'time_algorithm_update': 0.005144442558288574, 'loss': 25.350133862257003, 'time_step': 0.007240359544754028, 'init_value': 66.17376708984375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:43.31[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039335012435913, 'time_algorithm_update': 0.005139538764953613, 'loss': 31.593742753386497, 'time_step': 0.007230940818786621, 'init_value': 71.36785125732422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:43.40[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020367450714111326, 'time_algorithm_update': 0.005146271467208862, 'loss': 33.96161299598217, 'time_step': 0.007234721899032593, 'init_value': 76.59444427490234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:43.48[0m [[32m[1minfo     [0m] [1mFQE_20250505174223: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020563714504241945, 'time_algorithm_update': 0.005181452512741089, 'loss': 34.22995483624935, 'time_step': 0.007290671825408936, 'init_value': 81.97508239746094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.97508239746094
avg return on 5 trajectories of agent3: 1219.6767706666667
Episode generator created
[2m2025-05-05 17:43.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:43.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:43.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:43.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:43.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174349[0m
[2m2025-05-05 17:43.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:43.58[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019690990447998, 'time_algorithm_update': 0.005104125738143921, 'loss': 1.4939025908261538, 'time_step': 0.007174527645111084, 'init_value': 10.473539352416992}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:44.06[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020380210876464844, 'time_algorithm_update': 0.005169640302658081, 'loss': 3.8133683462440966, 'time_step': 0.007259677171707154, 'init_value': 20.56829071044922}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:44.15[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027554512023926, 'time_algorithm_update': 0.005140710830688477, 'loss': 7.624185891151428, 'time_step': 0.007219719409942627, 'init_value': 29.18545913696289}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:44.23[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034350156784058, 'time_algorithm_update': 0.005160020351409912, 'loss': 11.57103660106659, 'time_step': 0.007246446371078491, 'init_value': 38.134918212890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:44.32[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020334956645965577, 'time_algorithm_update': 0.00515788197517395, 'loss': 17.096538182616232, 'time_step': 0.007242707252502442, 'init_value': 46.72105407714844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:44.41[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027050018310547, 'time_algorithm_update': 0.005143640279769898, 'loss': 21.812640316605567, 'time_step': 0.007222272157669067, 'init_value': 52.96202087402344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:44.49[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020552306175231935, 'time_algorithm_update': 0.005204808473587036, 'loss': 22.352779149770736, 'time_step': 0.007313077926635742, 'init_value': 59.843196868896484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:44.58[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020565600395202636, 'time_algorithm_update': 0.005211392641067505, 'loss': 23.944306650996207, 'time_step': 0.007320902347564697, 'init_value': 65.22735595703125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:45.07[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028008937835693, 'time_algorithm_update': 0.005140287399291992, 'loss': 26.830227928996088, 'time_step': 0.007219390630722046, 'init_value': 71.03948211669922}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:45.15[0m [[32m[1minfo     [0m] [1mFQE_20250505174349: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020352749824523926, 'time_algorithm_update': 0.005159068107604981, 'loss': 30.392918122291565, 'time_step': 0.0072464683055877685, 'init_value': 76.024658203125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.024658203125
avg return on 5 trajectories of agent4: 2674.3651883333337
Episode generator created
[2m2025-05-05 17:45.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:45.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:45.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:45.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:45.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174517[0m
[2m2025-05-05 17:45.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:45.26[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029176712036133, 'time_algorithm_update': 0.005102156639099121, 'loss': 1.3636194683909417, 'time_step': 0.007182219982147217, 'init_value': 10.800719261169434}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:45.34[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020277669429779053, 'time_algorithm_update': 0.005132591247558594, 'loss': 4.029624274611473, 'time_step': 0.007211105823516846, 'init_value': 20.670442581176758}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:45.43[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020355572700500486, 'time_algorithm_update': 0.005155360937118531, 'loss': 9.021533132731914, 'time_step': 0.007242542266845703, 'init_value': 29.798507690429688}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:45.51[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027697801589966, 'time_algorithm_update': 0.005152320146560669, 'loss': 12.08111897855997, 'time_step': 0.0072316288948059086, 'init_value': 37.76226806640625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:46.00[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020288589000701904, 'time_algorithm_update': 0.005146162271499634, 'loss': 17.625241404175757, 'time_step': 0.007226561546325684, 'init_value': 46.24188232421875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:46.09[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020332930088043212, 'time_algorithm_update': 0.005137271881103515, 'loss': 19.014946156978606, 'time_step': 0.007222443342208862, 'init_value': 53.264625549316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:46.17[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030763149261475, 'time_algorithm_update': 0.005144423246383667, 'loss': 21.72978626716137, 'time_step': 0.007226585865020752, 'init_value': 59.16072463989258}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:46.26[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020347886085510256, 'time_algorithm_update': 0.0051584172248840335, 'loss': 25.504250814557075, 'time_step': 0.007244941234588623, 'init_value': 65.41677856445312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:46.34[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020348243713378907, 'time_algorithm_update': 0.005146334886550904, 'loss': 25.27484031879902, 'time_step': 0.007233078002929687, 'init_value': 70.86763000488281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:46.43[0m [[32m[1minfo     [0m] [1mFQE_20250505174517: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020232033729553223, 'time_algorithm_update': 0.005116943120956421, 'loss': 31.343640391469002, 'time_step': 0.007191190242767334, 'init_value': 75.12879943847656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.12879943847656
avg return on 5 trajectories of agent5: 2810.3289769999997
Episode generator created
[2m2025-05-05 17:46.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:46.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:46.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:46.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:46.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174645[0m
[2m2025-05-05 17:46.45[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:46.53[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020200564861297607, 'time_algorithm_update': 0.005105031490325928, 'loss': 1.3811214987039566, 'time_step': 0.007176254510879517, 'init_value': 10.117928504943848}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:47.02[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031076908111572, 'time_algorithm_update': 0.005169840812683105, 'loss': 3.983116473287344, 'time_step': 0.007252550125122071, 'init_value': 20.193180084228516}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:47.11[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032848358154297, 'time_algorithm_update': 0.00519759726524353, 'loss': 8.072891835570335, 'time_step': 0.007282730340957642, 'init_value': 30.046283721923828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034127712249756, 'time_algorithm_update': 0.0051782336235046385, 'loss': 14.05103794503212, 'time_step': 0.007264226675033569, 'init_value': 39.30082321166992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:47.28[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036149501800537, 'time_algorithm_update': 0.005192734718322754, 'loss': 17.827522357940673, 'time_step': 0.007280780076980591, 'init_value': 47.11560821533203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:47.36[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020286595821380616, 'time_algorithm_update': 0.005165840625762939, 'loss': 21.53815636920929, 'time_step': 0.007246176719665528, 'init_value': 54.399986267089844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:47.45[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039738655090332, 'time_algorithm_update': 0.005183077096939087, 'loss': 24.074794398903848, 'time_step': 0.00727498197555542, 'init_value': 60.90223693847656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:47.54[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037083864212036, 'time_algorithm_update': 0.00518849515914917, 'loss': 29.798202630519867, 'time_step': 0.007277556896209717, 'init_value': 67.71329498291016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:48.02[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204132604598999, 'time_algorithm_update': 0.005187164068222046, 'loss': 31.45992056107521, 'time_step': 0.007280781269073487, 'init_value': 72.86886596679688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:48.11[0m [[32m[1minfo     [0m] [1mFQE_20250505174645: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020436530113220213, 'time_algorithm_update': 0.005206778526306153, 'loss': 30.792321021556855, 'time_step': 0.007302462100982666, 'init_value': 77.31123352050781}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.31123352050781
avg return on 5 trajectories of agent6: 2539.9673446666666
Episode generator created
[2m2025-05-05 17:48.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:48.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:48.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:48.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:48.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174813[0m
[2m2025-05-05 17:48.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:48.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020115852355957033, 'time_algorithm_update': 0.005096429824829101, 'loss': 1.4210964699536561, 'time_step': 0.0071587347984313964, 'init_value': 10.604323387145996}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:48.30[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024407386779785, 'time_algorithm_update': 0.005143052101135254, 'loss': 4.098101899176836, 'time_step': 0.007218598127365112, 'init_value': 20.822172164916992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:48.39[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029288053512573, 'time_algorithm_update': 0.005149925708770752, 'loss': 7.729252762198448, 'time_step': 0.007230974674224853, 'init_value': 30.70366096496582}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:48.47[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035729646682739, 'time_algorithm_update': 0.005148889780044555, 'loss': 12.394800905942917, 'time_step': 0.007236633539199829, 'init_value': 39.69261932373047}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:48.56[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023968458175659, 'time_algorithm_update': 0.005150545597076416, 'loss': 14.835068608105182, 'time_step': 0.007225949287414551, 'init_value': 46.91773223876953}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:49.04[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020299272537231444, 'time_algorithm_update': 0.005152439594268799, 'loss': 21.489618697166442, 'time_step': 0.007234191417694092, 'init_value': 54.181373596191406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:49.13[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027233123779297, 'time_algorithm_update': 0.005142160415649414, 'loss': 22.61517419219017, 'time_step': 0.007221292734146118, 'init_value': 59.431976318359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:49.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020328803062438965, 'time_algorithm_update': 0.005142909526824951, 'loss': 23.38768154704571, 'time_step': 0.007227710723876953, 'init_value': 65.95130157470703}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:49.30[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020287158489227294, 'time_algorithm_update': 0.005144471406936645, 'loss': 25.177232039928438, 'time_step': 0.007225229978561402, 'init_value': 72.59711456298828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:49.38[0m [[32m[1minfo     [0m] [1mFQE_20250505174813: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032271385192871, 'time_algorithm_update': 0.005161797523498535, 'loss': 27.07275098788738, 'time_step': 0.0072461256980896, 'init_value': 76.44763946533203}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.44763946533203
avg return on 5 trajectories of agent7: 2579.797590333333
Episode generator created
[2m2025-05-05 17:49.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:49.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:49.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:49.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:49.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174940[0m
[2m2025-05-05 17:49.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:49.49[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008070945739746, 'time_algorithm_update': 0.0050854930877685545, 'loss': 1.41498474226892, 'time_step': 0.007143837928771973, 'init_value': 9.359932899475098}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:49.57[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019978256225585936, 'time_algorithm_update': 0.005066619157791137, 'loss': 4.401802395790815, 'time_step': 0.0071144657135009766, 'init_value': 18.635129928588867}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:50.06[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00201157546043396, 'time_algorithm_update': 0.005091208696365357, 'loss': 8.604466058135033, 'time_step': 0.007153240919113159, 'init_value': 27.637348175048828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:50.14[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200756573677063, 'time_algorithm_update': 0.005071983575820923, 'loss': 13.850485802412033, 'time_step': 0.0071298878192901614, 'init_value': 36.35103225708008}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:50.23[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020092923641204835, 'time_algorithm_update': 0.005080458641052246, 'loss': 16.859588867545128, 'time_step': 0.007139941930770874, 'init_value': 44.17543411254883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:50.31[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010058403015137, 'time_algorithm_update': 0.005081327199935913, 'loss': 21.17730093073845, 'time_step': 0.007141696214675903, 'init_value': 51.52761459350586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:50.40[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025294303894043, 'time_algorithm_update': 0.005126760482788086, 'loss': 24.319889070391653, 'time_step': 0.0072036457061767575, 'init_value': 58.313777923583984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:50.48[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042668342590332, 'time_algorithm_update': 0.005184144735336304, 'loss': 25.83056549525261, 'time_step': 0.007279161691665649, 'init_value': 65.52344512939453}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:50.57[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034976243972778, 'time_algorithm_update': 0.005157953262329102, 'loss': 28.85088672733307, 'time_step': 0.007244663000106811, 'init_value': 71.6123275756836}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:51.06[0m [[32m[1minfo     [0m] [1mFQE_20250505174940: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034776449203491, 'time_algorithm_update': 0.005158822298049927, 'loss': 26.11539234495163, 'time_step': 0.007245552778244018, 'init_value': 75.82268524169922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.82268524169922
avg return on 5 trajectories of agent8: 1580.0653929999999
Episode generator created
[2m2025-05-05 17:51.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:51.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:51.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:51.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:51.07[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175107[0m
[2m2025-05-05 17:51.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:51.15[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022608757019043, 'time_algorithm_update': 0.005111482620239258, 'loss': 1.3915579233467579, 'time_step': 0.007184984207153321, 'init_value': 9.614898681640625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:51.24[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027984380722046, 'time_algorithm_update': 0.005147627830505371, 'loss': 4.08015325692296, 'time_step': 0.0072267866134643555, 'init_value': 19.796585083007812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:51.33[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041674613952637, 'time_algorithm_update': 0.005157211065292358, 'loss': 8.641561581015587, 'time_step': 0.007250442743301392, 'init_value': 30.42003631591797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:51.41[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039231777191162, 'time_algorithm_update': 0.005151079416275024, 'loss': 13.090704541802406, 'time_step': 0.0072413175106048585, 'init_value': 38.9012336730957}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:51.50[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020395641326904296, 'time_algorithm_update': 0.0051650979518890385, 'loss': 16.917681369423867, 'time_step': 0.007256365060806275, 'init_value': 46.15851974487305}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:51.58[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045865535736084, 'time_algorithm_update': 0.00515307903289795, 'loss': 21.79079594039917, 'time_step': 0.007250350475311279, 'init_value': 53.99342346191406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:52.07[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020437874794006347, 'time_algorithm_update': 0.005152851104736328, 'loss': 22.694619735240938, 'time_step': 0.0072482419013977055, 'init_value': 60.86760330200195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:52.16[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038545846939087, 'time_algorithm_update': 0.005146698236465454, 'loss': 25.77959376513958, 'time_step': 0.007236857891082763, 'init_value': 67.1862564086914}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:52.24[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020394978523254393, 'time_algorithm_update': 0.0051550700664520265, 'loss': 30.851409330368043, 'time_step': 0.00724642276763916, 'init_value': 72.17334747314453}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:52.33[0m [[32m[1minfo     [0m] [1mFQE_20250505175107: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039421796798706, 'time_algorithm_update': 0.005148265123367309, 'loss': 32.829552658557894, 'time_step': 0.0072392733097076415, 'init_value': 77.39653015136719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.39653015136719
avg return on 5 trajectories of agent9: 1768.212573
Episode generator created
[2m2025-05-05 17:52.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:52.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:52.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:52.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:52.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175234[0m
[2m2025-05-05 17:52.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:52.43[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020232343673706053, 'time_algorithm_update': 0.0051145732402801515, 'loss': 1.4658104591816663, 'time_step': 0.007188128709793091, 'init_value': 10.20950698852539}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:52.51[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020410654544830323, 'time_algorithm_update': 0.005196794748306275, 'loss': 4.112568475842476, 'time_step': 0.007289458751678466, 'init_value': 21.082561492919922}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:53.00[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020291452407836916, 'time_algorithm_update': 0.005169807195663452, 'loss': 8.102508589208126, 'time_step': 0.007250144958496094, 'init_value': 30.515396118164062}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:53.08[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038954496383667, 'time_algorithm_update': 0.0051927843093872075, 'loss': 11.397928242564202, 'time_step': 0.007283523559570313, 'init_value': 39.68951416015625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:53.17[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020380256175994873, 'time_algorithm_update': 0.0051904418468475344, 'loss': 15.783787401020527, 'time_step': 0.007280210256576538, 'init_value': 48.0703239440918}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:53.26[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020385332107543943, 'time_algorithm_update': 0.005205412149429321, 'loss': 18.7923298279047, 'time_step': 0.007295819282531738, 'init_value': 55.01972579956055}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:53.34[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020333378314971924, 'time_algorithm_update': 0.005173007726669312, 'loss': 21.485267676115036, 'time_step': 0.007257875204086304, 'init_value': 63.6422119140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:53.43[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042738676071167, 'time_algorithm_update': 0.005191587209701538, 'loss': 22.523128388643265, 'time_step': 0.007286520957946777, 'init_value': 69.8416976928711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:53.52[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020401713848114014, 'time_algorithm_update': 0.005191612005233765, 'loss': 27.304040113329886, 'time_step': 0.007283305406570435, 'init_value': 75.98503875732422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:54.00[0m [[32m[1minfo     [0m] [1mFQE_20250505175234: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040832996368408, 'time_algorithm_update': 0.005185043334960938, 'loss': 27.144334990859033, 'time_step': 0.007277936458587647, 'init_value': 82.60345458984375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.60345458984375
avg return on 5 trajectories of agent10: 1848.883621
Episode generator created
[2m2025-05-05 17:54.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:54.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:54.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:54.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:54.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175402[0m
[2m2025-05-05 17:54.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:54.10[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032057285308838, 'time_algorithm_update': 0.005151391983032227, 'loss': 1.503916959270835, 'time_step': 0.007235268592834473, 'init_value': 9.974303245544434}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:54.19[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020626108646392824, 'time_algorithm_update': 0.005247944355010986, 'loss': 4.3012034029662605, 'time_step': 0.007363708257675171, 'init_value': 20.02033233642578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:54.27[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038515329360962, 'time_algorithm_update': 0.005188711166381836, 'loss': 8.011238303661347, 'time_step': 0.007279373168945312, 'init_value': 30.464740753173828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:54.36[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020172276496887207, 'time_algorithm_update': 0.005145125150680542, 'loss': 12.82602335548401, 'time_step': 0.007213232755661011, 'init_value': 39.32310104370117}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:54.45[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044407844543457, 'time_algorithm_update': 0.005183537483215332, 'loss': 15.706393272638321, 'time_step': 0.007279823541641236, 'init_value': 48.46672439575195}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:54.53[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020343918800354004, 'time_algorithm_update': 0.0051844210624694825, 'loss': 20.092720806658267, 'time_step': 0.0072708683013916016, 'init_value': 55.26573181152344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:55.02[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026045083999634, 'time_algorithm_update': 0.00515876293182373, 'loss': 22.871666576981543, 'time_step': 0.007236332893371582, 'init_value': 61.15867233276367}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:55.11[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041746139526367, 'time_algorithm_update': 0.005186550855636597, 'loss': 26.49427763354778, 'time_step': 0.0072808990478515625, 'init_value': 68.0274658203125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:55.19[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020358359813690188, 'time_algorithm_update': 0.00518480634689331, 'loss': 32.685789678573606, 'time_step': 0.0072727854251861575, 'init_value': 73.8162841796875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:55.28[0m [[32m[1minfo     [0m] [1mFQE_20250505175402: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020402059555053712, 'time_algorithm_update': 0.005202362060546875, 'loss': 34.50742299509049, 'time_step': 0.007294704675674438, 'init_value': 78.26459503173828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.26459503173828
avg return on 5 trajectories of agent11: 2393.849794
Episode generator created
[2m2025-05-05 17:55.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:55.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:55.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:55.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:55.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175530[0m
[2m2025-05-05 17:55.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:55.38[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00201857328414917, 'time_algorithm_update': 0.0051269266605377195, 'loss': 1.4334685921818018, 'time_step': 0.007196116924285889, 'init_value': 10.388702392578125}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:55.47[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020343961715698243, 'time_algorithm_update': 0.005193350791931152, 'loss': 4.290832015484572, 'time_step': 0.007279289245605469, 'init_value': 19.680631637573242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:55.55[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020258057117462157, 'time_algorithm_update': 0.005188015222549439, 'loss': 9.076204189300537, 'time_step': 0.0072654376029968265, 'init_value': 29.259572982788086}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:56.04[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020296194553375245, 'time_algorithm_update': 0.005194004774093628, 'loss': 13.849528093218803, 'time_step': 0.00727516508102417, 'init_value': 38.402523040771484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:56.13[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023674249649048, 'time_algorithm_update': 0.005173245429992676, 'loss': 16.33275224018097, 'time_step': 0.007248058080673218, 'init_value': 45.245384216308594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:56.21[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020377399921417236, 'time_algorithm_update': 0.005205679416656494, 'loss': 19.518690322160722, 'time_step': 0.007295183897018433, 'init_value': 53.43159103393555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:56.30[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035728693008423, 'time_algorithm_update': 0.005196042537689209, 'loss': 22.656211572170257, 'time_step': 0.00728328013420105, 'init_value': 59.342037200927734}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:56.38[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020390324592590332, 'time_algorithm_update': 0.005198731422424317, 'loss': 30.213488827347756, 'time_step': 0.007289641618728638, 'init_value': 65.297607421875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:56.47[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039777994155884, 'time_algorithm_update': 0.005217067956924439, 'loss': 33.55970446968079, 'time_step': 0.007308958292007446, 'init_value': 71.00377655029297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:56.56[0m [[32m[1minfo     [0m] [1mFQE_20250505175530: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372555255889894, 'time_algorithm_update': 0.0052123122215271, 'loss': 27.53372381877899, 'time_step': 0.007301758289337159, 'init_value': 77.04833984375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.04833984375
avg return on 5 trajectories of agent12: 1561.6752886666666
Episode generator created
[2m2025-05-05 17:56.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:56.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:56.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:56.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:56.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175657[0m
[2m2025-05-05 17:56.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:57.05[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020196125507354738, 'time_algorithm_update': 0.005125073432922364, 'loss': 1.4452593772262334, 'time_step': 0.0071951477527618405, 'init_value': 9.985814094543457}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:57.14[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030108690261841, 'time_algorithm_update': 0.005161079883575439, 'loss': 4.014834307551384, 'time_step': 0.007242729425430298, 'init_value': 20.270294189453125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:57.23[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203039813041687, 'time_algorithm_update': 0.005151275634765625, 'loss': 8.98044700729847, 'time_step': 0.007233453512191772, 'init_value': 29.256071090698242}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:57.31[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020362865924835206, 'time_algorithm_update': 0.005149443149566651, 'loss': 14.707151901960373, 'time_step': 0.00723755955696106, 'init_value': 38.21527099609375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:57.40[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031477689743042, 'time_algorithm_update': 0.005153805255889893, 'loss': 19.71401351559162, 'time_step': 0.007237067222595215, 'init_value': 46.677982330322266}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:57.48[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040254831314087, 'time_algorithm_update': 0.0051843316555023194, 'loss': 23.99193672823906, 'time_step': 0.007276681184768677, 'init_value': 53.338951110839844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:57.57[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020295321941375733, 'time_algorithm_update': 0.005144690275192261, 'loss': 25.209559129357338, 'time_step': 0.007225717544555664, 'init_value': 59.966129302978516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:58.06[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036428689956665, 'time_algorithm_update': 0.005178805828094483, 'loss': 30.663622233152388, 'time_step': 0.007267526388168335, 'init_value': 64.88658142089844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:58.14[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020437307357788087, 'time_algorithm_update': 0.005171476364135742, 'loss': 35.26793026447296, 'time_step': 0.0072674484252929685, 'init_value': 69.27896881103516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:58.23[0m [[32m[1minfo     [0m] [1mFQE_20250505175657: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041288137435913, 'time_algorithm_update': 0.005162644624710083, 'loss': 36.89804643678665, 'time_step': 0.0072560648918151855, 'init_value': 73.67156982421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.67156982421875
avg return on 5 trajectories of agent13: 2221.429149333333
Episode generator created
[2m2025-05-05 17:58.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:58.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:58.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:58.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:58.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175825[0m
[2m2025-05-05 17:58.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:58.33[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020203032493591308, 'time_algorithm_update': 0.0051088383197784425, 'loss': 1.4510398372411728, 'time_step': 0.007180105447769165, 'init_value': 10.333283424377441}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:58.42[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034674644470215, 'time_algorithm_update': 0.005152978420257568, 'loss': 4.0376884785592555, 'time_step': 0.007239518165588379, 'init_value': 19.991804122924805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:58.50[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037100553512573, 'time_algorithm_update': 0.005156378984451294, 'loss': 8.241176811218262, 'time_step': 0.007245786905288696, 'init_value': 29.109477996826172}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:58.59[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033764123916626, 'time_algorithm_update': 0.0051392695903778075, 'loss': 11.236689421713352, 'time_step': 0.007225256443023681, 'init_value': 38.449188232421875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:59.07[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034067392349243, 'time_algorithm_update': 0.005151643753051758, 'loss': 15.84878534257412, 'time_step': 0.0072377979755401615, 'init_value': 46.185813903808594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:59.16[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020375497341156004, 'time_algorithm_update': 0.005144814968109131, 'loss': 19.911993829131127, 'time_step': 0.007234356164932251, 'init_value': 53.00525665283203}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:59.24[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020088253021240234, 'time_algorithm_update': 0.005098006725311279, 'loss': 23.430144112825392, 'time_step': 0.007158123016357422, 'init_value': 59.615089416503906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:59.33[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043450117111206, 'time_algorithm_update': 0.005151172399520874, 'loss': 26.270618413090705, 'time_step': 0.007247723579406738, 'init_value': 67.53893280029297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:59.42[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020386662483215332, 'time_algorithm_update': 0.005155236721038819, 'loss': 27.397937791109086, 'time_step': 0.007245707750320435, 'init_value': 73.35086822509766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:59.50[0m [[32m[1minfo     [0m] [1mFQE_20250505175825: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020370218753814695, 'time_algorithm_update': 0.0051485831737518315, 'loss': 31.489242383122445, 'time_step': 0.007237838506698608, 'init_value': 77.335205078125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.335205078125
avg return on 5 trajectories of agent14: 2122.435460666667
Episode generator created
[2m2025-05-05 17:59.52[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:59.52[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:59.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:59.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:59.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175952[0m
[2m2025-05-05 17:59.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:00.01[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020269944667816162, 'time_algorithm_update': 0.005119338989257812, 'loss': 1.6076403390169143, 'time_step': 0.007197307586669922, 'init_value': 10.206584930419922}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:00.09[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037169933319092, 'time_algorithm_update': 0.0051924028396606444, 'loss': 3.8549809007644655, 'time_step': 0.007281396627426147, 'init_value': 20.67888641357422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:00.18[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020373802185058593, 'time_algorithm_update': 0.0051754932403564454, 'loss': 7.880709999978542, 'time_step': 0.0072645523548126225, 'init_value': 30.54973793029785}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:00.26[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010900259017944, 'time_algorithm_update': 0.005091095209121704, 'loss': 13.28740923923254, 'time_step': 0.007152376890182495, 'init_value': 39.421688079833984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:00.35[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020129795074462892, 'time_algorithm_update': 0.0050963294506073, 'loss': 16.464309027433394, 'time_step': 0.007159908056259155, 'init_value': 47.55703353881836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:00.43[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014122486114502, 'time_algorithm_update': 0.0050906150341033934, 'loss': 21.34823842608929, 'time_step': 0.007155038356781006, 'init_value': 54.969112396240234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:00.52[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020174660682678223, 'time_algorithm_update': 0.005096007108688355, 'loss': 23.066435524106026, 'time_step': 0.0071641218662261965, 'init_value': 61.239654541015625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:01.00[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019943909645080567, 'time_algorithm_update': 0.005049347877502441, 'loss': 27.189801196217537, 'time_step': 0.0070935852527618404, 'init_value': 66.96004486083984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:01.09[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022853136062622, 'time_algorithm_update': 0.00513885498046875, 'loss': 30.42881130194664, 'time_step': 0.007213091373443604, 'init_value': 72.06245422363281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:01.17[0m [[32m[1minfo     [0m] [1mFQE_20250505175952: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028308391571045, 'time_algorithm_update': 0.0051806304454803465, 'loss': 27.327002793312072, 'time_step': 0.007260440111160278, 'init_value': 74.66828918457031}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.66828918457031
avg return on 5 trajectories of agent15: 1542.465680666667
Episode generator created
[2m2025-05-05 18:01.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:01.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:01.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:01.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:01.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180119[0m
[2m2025-05-05 18:01.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:01.27[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024792671203613, 'time_algorithm_update': 0.005088296413421631, 'loss': 1.3635790980756284, 'time_step': 0.007164247751235962, 'init_value': 10.226716041564941}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:01.36[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025074005126953, 'time_algorithm_update': 0.005128372192382813, 'loss': 3.8860986270904543, 'time_step': 0.007204852819442749, 'init_value': 20.67111587524414}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:01.44[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025636911392212, 'time_algorithm_update': 0.005141287088394165, 'loss': 8.405407663345336, 'time_step': 0.007218169689178467, 'init_value': 30.350725173950195}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:01.53[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028660774230957, 'time_algorithm_update': 0.005155164480209351, 'loss': 12.756263320505619, 'time_step': 0.00723569107055664, 'init_value': 39.111106872558594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:02.01[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203428316116333, 'time_algorithm_update': 0.0051580266952514645, 'loss': 18.236971979022027, 'time_step': 0.0072441411018371584, 'init_value': 48.02895736694336}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:02.10[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203141713142395, 'time_algorithm_update': 0.005143632173538208, 'loss': 21.28857860779762, 'time_step': 0.007227187395095825, 'init_value': 54.35131072998047}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:02.18[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020297818183898928, 'time_algorithm_update': 0.005144814491271973, 'loss': 21.17996410405636, 'time_step': 0.007226431369781494, 'init_value': 60.24269485473633}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:02.27[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020334217548370363, 'time_algorithm_update': 0.0051524581909179685, 'loss': 25.086660979986192, 'time_step': 0.007237983226776123, 'init_value': 67.0197525024414}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:02.35[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003420352935791, 'time_algorithm_update': 0.005107016086578369, 'loss': 27.87313735830784, 'time_step': 0.007160768985748291, 'init_value': 73.70732116699219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:02.44[0m [[32m[1minfo     [0m] [1mFQE_20250505180119: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203025484085083, 'time_algorithm_update': 0.005149448871612549, 'loss': 32.5025239957571, 'time_step': 0.00723153829574585, 'init_value': 78.84725952148438}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.84725952148438
avg return on 5 trajectories of agent16: 1935.62566
Episode generator created
[2m2025-05-05 18:02.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:02.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:02.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:02.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:02.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180246[0m
[2m2025-05-05 18:02.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:02.54[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00201410436630249, 'time_algorithm_update': 0.005112700939178467, 'loss': 1.522562767803669, 'time_step': 0.007177132606506348, 'init_value': 10.142523765563965}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:03.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031862735748291, 'time_algorithm_update': 0.0051752920150756835, 'loss': 4.297340948343277, 'time_step': 0.007258771181106567, 'init_value': 20.949352264404297}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:03.11[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453908443450928, 'time_algorithm_update': 0.005225369215011597, 'loss': 9.753695142805576, 'time_step': 0.007322879791259765, 'init_value': 30.24250030517578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:03.20[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374770164489748, 'time_algorithm_update': 0.005209369421005249, 'loss': 16.02033347797394, 'time_step': 0.007298601150512695, 'init_value': 39.35193634033203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:03.29[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351033210754396, 'time_algorithm_update': 0.005196083545684815, 'loss': 18.429971507310867, 'time_step': 0.007282340288162231, 'init_value': 47.70152282714844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:03.37[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031932830810547, 'time_algorithm_update': 0.005179874181747437, 'loss': 22.781552396297453, 'time_step': 0.0072629725933074955, 'init_value': 55.53988265991211}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:03.46[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020384113788604738, 'time_algorithm_update': 0.005194318771362305, 'loss': 26.70722335100174, 'time_step': 0.0072846360206604, 'init_value': 61.84331512451172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:03.55[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034355640411377, 'time_algorithm_update': 0.0051984329223632815, 'loss': 30.99570836830139, 'time_step': 0.007284406661987305, 'init_value': 68.18800354003906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:04.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020346226692199705, 'time_algorithm_update': 0.005193146228790283, 'loss': 35.515206587076186, 'time_step': 0.007279592990875244, 'init_value': 75.06153869628906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:04.12[0m [[32m[1minfo     [0m] [1mFQE_20250505180246: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020214283466339113, 'time_algorithm_update': 0.005160876274108887, 'loss': 38.41364747524261, 'time_step': 0.007233436346054077, 'init_value': 81.92445373535156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.92445373535156
avg return on 5 trajectories of agent17: 1965.0519903333334
Episode generator created
[2m2025-05-05 18:04.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:04.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:04.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:04.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:04.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180413[0m
[2m2025-05-05 18:04.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:04.22[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015024185180664, 'time_algorithm_update': 0.005106219530105591, 'loss': 1.3347154275923967, 'time_step': 0.007171880483627319, 'init_value': 10.626197814941406}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:04.30[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227603912353516, 'time_algorithm_update': 0.005155675649642945, 'loss': 3.634786801725626, 'time_step': 0.007229773044586182, 'init_value': 20.654069900512695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:04.39[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020517287254333497, 'time_algorithm_update': 0.005226807117462158, 'loss': 6.947964030265808, 'time_step': 0.007331222295761108, 'init_value': 30.50710678100586}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:04.48[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020416955947875977, 'time_algorithm_update': 0.005169556856155395, 'loss': 11.568262973308563, 'time_step': 0.0072631025314331054, 'init_value': 39.614723205566406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:04.56[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034698724746704, 'time_algorithm_update': 0.005172018051147461, 'loss': 15.03163161635399, 'time_step': 0.0072581772804260255, 'init_value': 47.816959381103516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:05.05[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020319371223449707, 'time_algorithm_update': 0.0051558039188385005, 'loss': 20.602636906266213, 'time_step': 0.007239305257797242, 'init_value': 56.68727111816406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:05.14[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033840894699097, 'time_algorithm_update': 0.005179195642471313, 'loss': 22.265197265386583, 'time_step': 0.007264734983444214, 'init_value': 63.645748138427734}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:05.22[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036857604980469, 'time_algorithm_update': 0.005177026987075806, 'loss': 24.23305095231533, 'time_step': 0.00726613187789917, 'init_value': 68.45989990234375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:05.31[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020350940227508545, 'time_algorithm_update': 0.005173847436904907, 'loss': 23.924743275761603, 'time_step': 0.0072607376575469975, 'init_value': 72.46253204345703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:05.39[0m [[32m[1minfo     [0m] [1mFQE_20250505180413: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038433313369751, 'time_algorithm_update': 0.005170388698577881, 'loss': 24.996144744277, 'time_step': 0.007260481595993042, 'init_value': 78.92266082763672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.92266082763672
avg return on 5 trajectories of agent18: 1750.31454
Episode generator created
[2m2025-05-05 18:05.41[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:05.41[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:05.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:05.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:05.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180541[0m
[2m2025-05-05 18:05.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:05.49[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020164191722869874, 'time_algorithm_update': 0.00509692907333374, 'loss': 1.5586723095178605, 'time_step': 0.007163369417190551, 'init_value': 10.938607215881348}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:05.58[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020226783752441404, 'time_algorithm_update': 0.005170252561569214, 'loss': 4.181133303374052, 'time_step': 0.0072445769309997556, 'init_value': 21.410358428955078}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:06.07[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031688451766968, 'time_algorithm_update': 0.005188631296157837, 'loss': 8.306026057600976, 'time_step': 0.007272082328796387, 'init_value': 31.379831314086914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:06.15[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033608675003052, 'time_algorithm_update': 0.005181395292282105, 'loss': 13.11758433163166, 'time_step': 0.007266902685165405, 'init_value': 40.17034912109375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:06.24[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312888622283937, 'time_algorithm_update': 0.005181517839431763, 'loss': 18.12792328083515, 'time_step': 0.007264134883880616, 'init_value': 48.30767059326172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:06.32[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026872396469116, 'time_algorithm_update': 0.005173306941986084, 'loss': 21.848293204188348, 'time_step': 0.007251845598220825, 'init_value': 56.29676818847656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:06.41[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035004138946533, 'time_algorithm_update': 0.00517671537399292, 'loss': 23.395031656742095, 'time_step': 0.0072634446620941165, 'init_value': 62.843955993652344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:06.49[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045966863632202, 'time_algorithm_update': 0.005188446760177612, 'loss': 25.647007214426996, 'time_step': 0.0072867941856384275, 'init_value': 69.8020248413086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:06.58[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031022310256958, 'time_algorithm_update': 0.005185030698776245, 'loss': 29.39434126508236, 'time_step': 0.007267928600311279, 'init_value': 76.21398162841797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:07.07[0m [[32m[1minfo     [0m] [1mFQE_20250505180541: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029244661331177, 'time_algorithm_update': 0.005182465553283691, 'loss': 32.061617283582684, 'time_step': 0.007263136625289917, 'init_value': 81.77801513671875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.77801513671875
avg return on 5 trajectories of agent19: 2158.8159523333334
Episode generator created
[2m2025-05-05 18:07.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:07.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:07.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:07.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:07.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180708[0m
[2m2025-05-05 18:07.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:07.17[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017427921295166, 'time_algorithm_update': 0.005085602760314941, 'loss': 1.3207782970070838, 'time_step': 0.00715385627746582, 'init_value': 9.822285652160645}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:07.26[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020206961631774904, 'time_algorithm_update': 0.005115108013153076, 'loss': 3.6430186445116997, 'time_step': 0.007186563014984131, 'init_value': 19.474349975585938}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:07.34[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044048309326172, 'time_algorithm_update': 0.0051474800109863285, 'loss': 7.793004887163639, 'time_step': 0.007243465185165405, 'init_value': 28.789806365966797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:07.43[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035942316055298, 'time_algorithm_update': 0.005137917280197144, 'loss': 11.274483323693275, 'time_step': 0.007225265026092529, 'init_value': 37.10566711425781}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:07.51[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020404057502746583, 'time_algorithm_update': 0.005148632049560547, 'loss': 16.005606613516807, 'time_step': 0.007240676403045655, 'init_value': 44.1000862121582}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:08.00[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020438685417175292, 'time_algorithm_update': 0.005137044906616211, 'loss': 18.25541350591183, 'time_step': 0.007233104944229126, 'init_value': 51.33848571777344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:08.08[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059725761413574, 'time_algorithm_update': 0.005193031311035156, 'loss': 23.57877256858349, 'time_step': 0.007305219173431397, 'init_value': 58.17610549926758}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:08.17[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020417230129241943, 'time_algorithm_update': 0.005150350093841552, 'loss': 25.711780728936194, 'time_step': 0.007244148254394531, 'init_value': 64.07156372070312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:08.26[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035109281539917, 'time_algorithm_update': 0.0051323301792144775, 'loss': 21.95231107711792, 'time_step': 0.007219088315963745, 'init_value': 69.58293914794922}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:08.34[0m [[32m[1minfo     [0m] [1mFQE_20250505180708: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020358812808990477, 'time_algorithm_update': 0.005144570827484131, 'loss': 26.25877587175369, 'time_step': 0.007232595443725586, 'init_value': 73.84540557861328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.84540557861328
ave advantage rew: 78.18997993469239, std: 2.9563370006959437
avg cum rews: 1964.6702180999996, std: 449.68213570887985
Pearson correlation coefficient: -0.40794207068361354
Spearman correlation coefficient: -0.3804511278195489
Kendall Tau correlation coefficient: -0.28421052631578947
the best agent: 9, best agent cum rewards: 1768.212573
1958
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01984498763122043
avg return on 5 trajectories of agent0: 1642.7071506666668
Episode generator created
[2m2025-05-05 18:08.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:08.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:08.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:08.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:08.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180846[0m
[2m2025-05-05 18:08.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:08.54[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020049717426300047, 'time_algorithm_update': 0.005081774711608887, 'loss': 1.363897144779563, 'time_step': 0.007137116670608521, 'init_value': 10.600922584533691}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:09.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020287487506866456, 'time_algorithm_update': 0.0051602981090545655, 'loss': 3.8796752651035784, 'time_step': 0.007240545988082886, 'init_value': 21.147523880004883}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:09.11[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032998323440552, 'time_algorithm_update': 0.005175633907318115, 'loss': 8.105209271609784, 'time_step': 0.00726077938079834, 'init_value': 30.802547454833984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:09.20[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020346148014068603, 'time_algorithm_update': 0.005158108234405517, 'loss': 12.67392298167944, 'time_step': 0.007245091199874878, 'init_value': 41.93222427368164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:09.28[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020380327701568605, 'time_algorithm_update': 0.005172966957092285, 'loss': 18.318471187591552, 'time_step': 0.0072635397911071774, 'init_value': 50.20219802856445}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:09.37[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033906936645508, 'time_algorithm_update': 0.0051586713790893555, 'loss': 20.309472113013268, 'time_step': 0.007244710683822632, 'init_value': 57.33609390258789}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:09.46[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020313735008239747, 'time_algorithm_update': 0.0051649389266967775, 'loss': 26.557553122401238, 'time_step': 0.007248605728149414, 'init_value': 64.12662506103516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:09.54[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039008855819702, 'time_algorithm_update': 0.005167831420898437, 'loss': 27.349330538511275, 'time_step': 0.007259017705917358, 'init_value': 70.876953125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:10.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044003486633301, 'time_algorithm_update': 0.005164457559585571, 'loss': 29.023104924440386, 'time_step': 0.007261000633239746, 'init_value': 76.38746643066406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:10.12[0m [[32m[1minfo     [0m] [1mFQE_20250505180846: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042311429977417, 'time_algorithm_update': 0.005159827709197998, 'loss': 31.381529927492142, 'time_step': 0.007254435777664185, 'init_value': 81.3299560546875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.3299560546875
avg return on 5 trajectories of agent1: 1281.3100043333334
Episode generator created
[2m2025-05-05 18:10.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:10.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:10.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:10.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:10.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181012[0m
[2m2025-05-05 18:10.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:10.21[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002225527286529541, 'time_algorithm_update': 0.00511684799194336, 'loss': 1.4745251296758652, 'time_step': 0.007393551826477051, 'init_value': 10.483407020568848}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:10.30[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030414342880249, 'time_algorithm_update': 0.005146050214767456, 'loss': 4.339669296294451, 'time_step': 0.007228619575500488, 'init_value': 20.578962326049805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:10.38[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020394971370697023, 'time_algorithm_update': 0.005165596723556518, 'loss': 8.473979059576989, 'time_step': 0.007256897449493408, 'init_value': 30.211244583129883}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:10.47[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020159437656402587, 'time_algorithm_update': 0.005109638214111328, 'loss': 11.773414782047272, 'time_step': 0.007176795721054077, 'init_value': 39.11328887939453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:10.55[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019420862197876, 'time_algorithm_update': 0.005080605030059814, 'loss': 19.42817237198353, 'time_step': 0.007150923490524292, 'init_value': 47.631282806396484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:11.04[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002009134292602539, 'time_algorithm_update': 0.0050775806903839114, 'loss': 21.215628464221954, 'time_step': 0.007137291431427002, 'init_value': 56.545379638671875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:11.12[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002011436223983765, 'time_algorithm_update': 0.005087880373001098, 'loss': 26.921255436182022, 'time_step': 0.007150148630142212, 'init_value': 63.04281234741211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:11.21[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020129151344299317, 'time_algorithm_update': 0.005093474626541137, 'loss': 30.82884887754917, 'time_step': 0.007157341480255127, 'init_value': 68.31326293945312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:11.29[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020116257667541506, 'time_algorithm_update': 0.005094559669494629, 'loss': 33.86706486833096, 'time_step': 0.007157398223876953, 'init_value': 73.7202377319336}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:11.38[0m [[32m[1minfo     [0m] [1mFQE_20250505181012: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002066887140274048, 'time_algorithm_update': 0.005225875616073608, 'loss': 31.475196064710616, 'time_step': 0.007345976114273072, 'init_value': 77.9531021118164}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.9531021118164
avg return on 5 trajectories of agent2: 1133.3937203333332
Episode generator created
[2m2025-05-05 18:11.39[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:11.39[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:11.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:11.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:11.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181139[0m
[2m2025-05-05 18:11.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:11.47[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022509574890137, 'time_algorithm_update': 0.005097529649734497, 'loss': 1.4910899766385555, 'time_step': 0.007171199560165405, 'init_value': 10.35788345336914}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:11.56[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033562660217285, 'time_algorithm_update': 0.0051593098640441894, 'loss': 4.210568387240172, 'time_step': 0.007244727849960327, 'init_value': 20.426477432250977}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:12.05[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020166964530944826, 'time_algorithm_update': 0.0051330218315124515, 'loss': 8.800786812603473, 'time_step': 0.007200740814208985, 'init_value': 30.0883731842041}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:12.13[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039460897445679, 'time_algorithm_update': 0.005156048059463501, 'loss': 13.057747430741786, 'time_step': 0.007247706890106201, 'init_value': 39.34085464477539}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:12.22[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020365509986877443, 'time_algorithm_update': 0.0051597790718078615, 'loss': 17.310569019794464, 'time_step': 0.007248056411743164, 'init_value': 46.056358337402344}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:12.30[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029700756072998, 'time_algorithm_update': 0.005153578281402588, 'loss': 20.09955177998543, 'time_step': 0.007234568119049072, 'init_value': 53.81642532348633}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:12.39[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034160614013672, 'time_algorithm_update': 0.00515435004234314, 'loss': 23.6270559476614, 'time_step': 0.00724009370803833, 'init_value': 61.30338668823242}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:12.47[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032984495162964, 'time_algorithm_update': 0.0051530091762542725, 'loss': 27.639811070561407, 'time_step': 0.007237314939498901, 'init_value': 67.2809829711914}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:12.56[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020307636260986327, 'time_algorithm_update': 0.005142712354660034, 'loss': 30.925849353551865, 'time_step': 0.007225240230560303, 'init_value': 73.89250183105469}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:13.05[0m [[32m[1minfo     [0m] [1mFQE_20250505181139: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020345935821533202, 'time_algorithm_update': 0.0051463663578033446, 'loss': 37.94404203414917, 'time_step': 0.007232727766036987, 'init_value': 77.40602111816406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.40602111816406
avg return on 5 trajectories of agent3: 2000.890447
Episode generator created
[2m2025-05-05 18:13.06[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:13.06[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:13.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:13.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:13.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181306[0m
[2m2025-05-05 18:13.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:13.15[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020144801139831544, 'time_algorithm_update': 0.005111288785934448, 'loss': 1.4277768541872502, 'time_step': 0.007176795959472656, 'init_value': 10.472943305969238}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:13.23[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020247161388397216, 'time_algorithm_update': 0.005169171094894409, 'loss': 3.8339397075772284, 'time_step': 0.007245505332946777, 'init_value': 21.192092895507812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:13.32[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035402774810791, 'time_algorithm_update': 0.005154453754425049, 'loss': 8.268292211830616, 'time_step': 0.007241140842437744, 'init_value': 30.484312057495117}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:13.40[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022660493850708, 'time_algorithm_update': 0.005138641834259034, 'loss': 11.574784959614277, 'time_step': 0.007212390422821045, 'init_value': 39.6780891418457}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:13.49[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351948738098146, 'time_algorithm_update': 0.005174658536911011, 'loss': 14.116156994760036, 'time_step': 0.007261478662490844, 'init_value': 48.764949798583984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:13.57[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351719856262205, 'time_algorithm_update': 0.005174965858459473, 'loss': 19.443235663533212, 'time_step': 0.007261562824249268, 'init_value': 55.56852722167969}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:14.06[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044584035873413, 'time_algorithm_update': 0.005205979824066162, 'loss': 24.155272852778435, 'time_step': 0.007302593946456909, 'init_value': 63.28853988647461}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:14.15[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047680377960205, 'time_algorithm_update': 0.005196220874786377, 'loss': 25.195741980314256, 'time_step': 0.00729627013206482, 'init_value': 68.08621978759766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:14.23[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037443399429321, 'time_algorithm_update': 0.005178421497344971, 'loss': 25.122926099419594, 'time_step': 0.007267393350601196, 'init_value': 74.60700225830078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:14.32[0m [[32m[1minfo     [0m] [1mFQE_20250505181306: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036243438720703, 'time_algorithm_update': 0.005186172246932984, 'loss': 24.991407196402548, 'time_step': 0.007273972034454346, 'init_value': 78.94682312011719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.94682312011719
avg return on 5 trajectories of agent4: 2710.266410333333
Episode generator created
[2m2025-05-05 18:14.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:14.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:14.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:14.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:14.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181434[0m
[2m2025-05-05 18:14.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:14.43[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015685319900513, 'time_algorithm_update': 0.005116050720214844, 'loss': 1.413486844137311, 'time_step': 0.007182220697402954, 'init_value': 10.811748504638672}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:14.51[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033180236816406, 'time_algorithm_update': 0.005176124095916748, 'loss': 4.175346928328276, 'time_step': 0.007260826587677002, 'init_value': 21.63352394104004}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:15.00[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025246858596802, 'time_algorithm_update': 0.0051699385643005375, 'loss': 9.325590439617633, 'time_step': 0.007246694564819336, 'init_value': 31.87419891357422}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:15.08[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046778917312622, 'time_algorithm_update': 0.005216986417770386, 'loss': 14.060627316772937, 'time_step': 0.007316075086593628, 'init_value': 40.94404602050781}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:15.17[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205022406578064, 'time_algorithm_update': 0.0052223575115203855, 'loss': 19.230194009780885, 'time_step': 0.0073249990940094, 'init_value': 50.3160400390625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:15.26[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020326480865478515, 'time_algorithm_update': 0.005180363178253174, 'loss': 23.162026349067688, 'time_step': 0.007264735460281372, 'init_value': 58.81227111816406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:15.34[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020495879650115965, 'time_algorithm_update': 0.0051830878257751465, 'loss': 26.158542392015455, 'time_step': 0.007284751653671265, 'init_value': 65.33000946044922}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:15.43[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033946990966797, 'time_algorithm_update': 0.005186800241470337, 'loss': 27.293051137208938, 'time_step': 0.0072727324962615966, 'init_value': 71.22745513916016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:15.52[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312340259552, 'time_algorithm_update': 0.00517780876159668, 'loss': 26.558712805867195, 'time_step': 0.007260999917984009, 'init_value': 75.80821990966797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:16.00[0m [[32m[1minfo     [0m] [1mFQE_20250505181434: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038357973098755, 'time_algorithm_update': 0.005191724061965943, 'loss': 30.171543706059456, 'time_step': 0.007281533718109131, 'init_value': 81.40570831298828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.40570831298828
avg return on 5 trajectories of agent5: 1469.6029163333333
Episode generator created
[2m2025-05-05 18:16.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:16.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:16.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:16.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:16.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181601[0m
[2m2025-05-05 18:16.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:16.10[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021270751953125, 'time_algorithm_update': 0.005121554136276245, 'loss': 1.39910760268569, 'time_step': 0.007193771362304688, 'init_value': 9.954538345336914}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:16.19[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029191255569458, 'time_algorithm_update': 0.005171308040618897, 'loss': 3.9695570072233677, 'time_step': 0.007251693248748779, 'init_value': 20.27984619140625}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:16.27[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025822877883911, 'time_algorithm_update': 0.005166789054870605, 'loss': 9.024534346938133, 'time_step': 0.007243942975997925, 'init_value': 30.06804847717285}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:16.36[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029775142669678, 'time_algorithm_update': 0.005176322937011719, 'loss': 13.644413823962212, 'time_step': 0.007258008003234864, 'init_value': 39.53994369506836}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:16.44[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020283358097076417, 'time_algorithm_update': 0.00517948317527771, 'loss': 15.798727889895439, 'time_step': 0.007259529829025268, 'init_value': 46.67912673950195}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:16.53[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044642925262451, 'time_algorithm_update': 0.005198648452758789, 'loss': 20.959303297519686, 'time_step': 0.007295806169509888, 'init_value': 53.80544662475586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:17.02[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062408447265625, 'time_algorithm_update': 0.005251097440719605, 'loss': 23.723363691210746, 'time_step': 0.007366104125976563, 'init_value': 61.27861022949219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:17.10[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204034948348999, 'time_algorithm_update': 0.005209956169128418, 'loss': 26.492842282414436, 'time_step': 0.007301899194717407, 'init_value': 68.03997039794922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:17.19[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036993980407715, 'time_algorithm_update': 0.005181182622909546, 'loss': 31.868653747320174, 'time_step': 0.007271169900894165, 'init_value': 73.8747329711914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:17.28[0m [[32m[1minfo     [0m] [1mFQE_20250505181601: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020335993766784667, 'time_algorithm_update': 0.0051939358711242676, 'loss': 29.082955582618712, 'time_step': 0.007279759168624878, 'init_value': 80.08522033691406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.08522033691406
avg return on 5 trajectories of agent6: 1075.5901676666667
Episode generator created
[2m2025-05-05 18:17.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:17.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:17.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:17.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:17.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181729[0m
[2m2025-05-05 18:17.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:17.37[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026684761047363, 'time_algorithm_update': 0.005144566535949707, 'loss': 1.301843260243535, 'time_step': 0.007222593307495117, 'init_value': 10.168648719787598}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:17.46[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020304822921752928, 'time_algorithm_update': 0.005190476179122925, 'loss': 4.0784535920321945, 'time_step': 0.007272525787353516, 'init_value': 20.10533332824707}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:17.54[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034242630004883, 'time_algorithm_update': 0.00519755482673645, 'loss': 7.240925817370415, 'time_step': 0.007283302783966064, 'init_value': 29.300329208374023}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:18.03[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042893648147583, 'time_algorithm_update': 0.005201614618301391, 'loss': 12.924772102832794, 'time_step': 0.0072963635921478275, 'init_value': 38.736331939697266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:18.12[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204023003578186, 'time_algorithm_update': 0.005206834554672241, 'loss': 17.08968325674534, 'time_step': 0.00729891848564148, 'init_value': 46.623355865478516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:18.20[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035912275314331, 'time_algorithm_update': 0.00520052695274353, 'loss': 21.925613499760626, 'time_step': 0.007288185119628907, 'init_value': 54.43258285522461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:18.29[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036998987197876, 'time_algorithm_update': 0.0051995813846588135, 'loss': 25.14656658089161, 'time_step': 0.007288560390472412, 'init_value': 61.42621612548828}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:18.38[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020519988536834718, 'time_algorithm_update': 0.005206712484359741, 'loss': 26.736803680777548, 'time_step': 0.007310855865478516, 'init_value': 67.83100891113281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:18.46[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034548282623291, 'time_algorithm_update': 0.005198757886886596, 'loss': 27.82231825578213, 'time_step': 0.007284941911697387, 'init_value': 73.48230743408203}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:18.55[0m [[32m[1minfo     [0m] [1mFQE_20250505181729: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020478134155273438, 'time_algorithm_update': 0.005219547986984253, 'loss': 30.113971314787864, 'time_step': 0.0073197722434997555, 'init_value': 79.12044525146484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.12044525146484
avg return on 5 trajectories of agent7: 1070.1041993333333
Episode generator created
[2m2025-05-05 18:18.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:18.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:18.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:18.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:18.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181856[0m
[2m2025-05-05 18:18.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:19.04[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020349156856536866, 'time_algorithm_update': 0.005139063835144043, 'loss': 1.4551136466413737, 'time_step': 0.007225360631942749, 'init_value': 10.204840660095215}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:19.13[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020362505912780763, 'time_algorithm_update': 0.0051895008087158205, 'loss': 4.81125945982337, 'time_step': 0.0072769269943237305, 'init_value': 20.419557571411133}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:19.22[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028423070907593, 'time_algorithm_update': 0.005178680896759033, 'loss': 8.950232537150383, 'time_step': 0.007258544445037842, 'init_value': 29.60834503173828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:19.30[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032582998275757, 'time_algorithm_update': 0.0051769928932189945, 'loss': 15.504431539297103, 'time_step': 0.00726129150390625, 'init_value': 38.890098571777344}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:19.39[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039322853088379, 'time_algorithm_update': 0.005175737380981446, 'loss': 18.454674308538436, 'time_step': 0.007266478776931763, 'init_value': 47.136863708496094}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:19.47[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357069969177246, 'time_algorithm_update': 0.005186032056808471, 'loss': 23.291397414803505, 'time_step': 0.007273202896118164, 'init_value': 53.84910202026367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:19.56[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042936086654663, 'time_algorithm_update': 0.00519066596031189, 'loss': 23.77675246500969, 'time_step': 0.007285759925842285, 'init_value': 60.349151611328125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:20.05[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045865535736084, 'time_algorithm_update': 0.005194576263427735, 'loss': 31.718509007692337, 'time_step': 0.007292595148086548, 'init_value': 67.33344268798828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:20.13[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020365085601806642, 'time_algorithm_update': 0.005173391580581665, 'loss': 29.42370588386059, 'time_step': 0.007261964321136474, 'init_value': 73.41741943359375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:20.22[0m [[32m[1minfo     [0m] [1mFQE_20250505181856: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020270073413848877, 'time_algorithm_update': 0.0051621079444885256, 'loss': 32.2944012387991, 'time_step': 0.007240834474563598, 'init_value': 77.30613708496094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.30613708496094
avg return on 5 trajectories of agent8: 1607.29874
Episode generator created
[2m2025-05-05 18:20.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:20.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:20.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:20.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:20.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182023[0m
[2m2025-05-05 18:20.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:20.32[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020275619029998778, 'time_algorithm_update': 0.005119909048080445, 'loss': 1.4200732609033584, 'time_step': 0.007198098659515381, 'init_value': 10.009617805480957}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:20.40[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020281620025634764, 'time_algorithm_update': 0.005166086196899414, 'loss': 4.231836489349604, 'time_step': 0.007245691061019898, 'init_value': 19.855558395385742}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:20.49[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035825252532959, 'time_algorithm_update': 0.005171497106552124, 'loss': 9.179202883064747, 'time_step': 0.007259135961532593, 'init_value': 29.448076248168945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:20.58[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054096460342407, 'time_algorithm_update': 0.005190676212310791, 'loss': 13.664008864939213, 'time_step': 0.00729712438583374, 'init_value': 38.82142639160156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:21.06[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023103475570679, 'time_algorithm_update': 0.0051546568870544434, 'loss': 19.009717725396158, 'time_step': 0.00722862434387207, 'init_value': 47.126834869384766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:21.15[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020182600021362304, 'time_algorithm_update': 0.005109521627426147, 'loss': 23.339635109066965, 'time_step': 0.007178148508071899, 'init_value': 54.08756637573242}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:21.23[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020185346603393555, 'time_algorithm_update': 0.005100356817245483, 'loss': 25.517611717581747, 'time_step': 0.0071695396900177, 'init_value': 61.69401168823242}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:21.31[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020178792476654053, 'time_algorithm_update': 0.005096616506576538, 'loss': 28.14085787856579, 'time_step': 0.007164974212646485, 'init_value': 68.17613983154297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:21.40[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024712324142456, 'time_algorithm_update': 0.005108808755874634, 'loss': 32.72719261026383, 'time_step': 0.007184406518936157, 'init_value': 73.15620422363281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:21.48[0m [[32m[1minfo     [0m] [1mFQE_20250505182023: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020090482234954832, 'time_algorithm_update': 0.005097992897033691, 'loss': 36.71980998766422, 'time_step': 0.007157671928405762, 'init_value': 76.85009002685547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.85009002685547
avg return on 5 trajectories of agent9: 2611.618681666667
Episode generator created
[2m2025-05-05 18:21.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:21.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:21.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:21.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:21.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182150[0m
[2m2025-05-05 18:21.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:21.59[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019976124763488767, 'time_algorithm_update': 0.005046692848205567, 'loss': 1.5022077836692334, 'time_step': 0.007094823837280274, 'init_value': 9.73166275024414}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:22.08[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020341224670410154, 'time_algorithm_update': 0.005162691593170166, 'loss': 4.295657635837793, 'time_step': 0.00724829888343811, 'init_value': 18.709245681762695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:22.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058619260787964, 'time_algorithm_update': 0.005223411321640015, 'loss': 8.812200271308422, 'time_step': 0.00733509874343872, 'init_value': 28.17573356628418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:22.25[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020284035205841064, 'time_algorithm_update': 0.005140963315963745, 'loss': 14.077412150979042, 'time_step': 0.007220813035964966, 'init_value': 35.418861389160156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:22.33[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033508062362671, 'time_algorithm_update': 0.00516231107711792, 'loss': 18.840573536276818, 'time_step': 0.0072471599578857425, 'init_value': 42.705806732177734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:22.42[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353116989135743, 'time_algorithm_update': 0.005153609037399292, 'loss': 22.98520451784134, 'time_step': 0.007241017341613769, 'init_value': 49.88633728027344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:22.50[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041887998580933, 'time_algorithm_update': 0.005150043725967407, 'loss': 22.25714732980728, 'time_step': 0.007243887186050415, 'init_value': 57.2783317565918}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:22.59[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035125732421875, 'time_algorithm_update': 0.0051644167900085445, 'loss': 27.28105042397976, 'time_step': 0.007251645803451538, 'init_value': 62.23415756225586}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:23.08[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020358357429504396, 'time_algorithm_update': 0.005155609130859375, 'loss': 29.750487436413763, 'time_step': 0.007243091106414795, 'init_value': 68.50639343261719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:23.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182150: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020421433448791506, 'time_algorithm_update': 0.005154380798339844, 'loss': 32.71005229902268, 'time_step': 0.007248550891876221, 'init_value': 74.50951385498047}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.50951385498047
avg return on 5 trajectories of agent10: 2358.660831333333
Episode generator created
[2m2025-05-05 18:23.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:23.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:23.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:23.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:23.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182318[0m
[2m2025-05-05 18:23.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:23.27[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025926113128662, 'time_algorithm_update': 0.005116303920745849, 'loss': 1.3900756340175866, 'time_step': 0.007192987680435181, 'init_value': 10.611987113952637}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:23.35[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017420768737793, 'time_algorithm_update': 0.005151755809783935, 'loss': 3.984543738991022, 'time_step': 0.007220329761505127, 'init_value': 20.682758331298828}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:23.44[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024873971939087, 'time_algorithm_update': 0.005177444458007813, 'loss': 8.2201631321311, 'time_step': 0.007253938913345337, 'init_value': 30.03801727294922}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:23.52[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019773483276367, 'time_algorithm_update': 0.005156596660614013, 'loss': 10.65517591959238, 'time_step': 0.007228073835372925, 'init_value': 37.821136474609375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:24.01[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351588726043703, 'time_algorithm_update': 0.005191436529159546, 'loss': 13.099991916060448, 'time_step': 0.007278443813323975, 'init_value': 45.97396469116211}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:24.10[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030686855316162, 'time_algorithm_update': 0.005183207988739014, 'loss': 17.73944119501114, 'time_step': 0.0072655267715454105, 'init_value': 52.3221321105957}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:24.18[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020388140678405764, 'time_algorithm_update': 0.005182972192764282, 'loss': 24.378628106713293, 'time_step': 0.007273601770401001, 'init_value': 58.29574203491211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:24.27[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020361082553863527, 'time_algorithm_update': 0.005173886775970459, 'loss': 22.77722127664089, 'time_step': 0.007261641502380371, 'init_value': 65.36116027832031}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:24.36[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039370059967041, 'time_algorithm_update': 0.0051802237033844, 'loss': 25.2368792937994, 'time_step': 0.007271763324737549, 'init_value': 68.3624038696289}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:24.44[0m [[32m[1minfo     [0m] [1mFQE_20250505182318: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020389564037323, 'time_algorithm_update': 0.00517096209526062, 'loss': 24.385634801030157, 'time_step': 0.0072619314193725585, 'init_value': 73.4942626953125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.4942626953125
avg return on 5 trajectories of agent11: 2454.699872333333
Episode generator created
[2m2025-05-05 18:24.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:24.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:24.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:24.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:24.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182446[0m
[2m2025-05-05 18:24.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:24.55[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030567407608032, 'time_algorithm_update': 0.005134586811065674, 'loss': 1.5031234128922224, 'time_step': 0.007216597557067871, 'init_value': 9.496185302734375}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:25.03[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353174209594726, 'time_algorithm_update': 0.005197077512741089, 'loss': 3.848749169051647, 'time_step': 0.007284349441528321, 'init_value': 19.569475173950195}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:25.12[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020126233100891113, 'time_algorithm_update': 0.005156041145324707, 'loss': 8.32583404392004, 'time_step': 0.007219746351242066, 'init_value': 28.68310546875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:25.20[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203542947769165, 'time_algorithm_update': 0.005214212417602539, 'loss': 12.305049243450165, 'time_step': 0.007301754236221313, 'init_value': 37.275394439697266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:25.29[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020386359691619872, 'time_algorithm_update': 0.00520664119720459, 'loss': 16.348238232016563, 'time_step': 0.007297051906585693, 'init_value': 45.5096435546875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:25.38[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203971004486084, 'time_algorithm_update': 0.005218516588211059, 'loss': 19.725502332210542, 'time_step': 0.007310349464416504, 'init_value': 52.10985565185547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:25.46[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020411760807037354, 'time_algorithm_update': 0.005238971710205078, 'loss': 21.655521661877632, 'time_step': 0.007332534074783325, 'init_value': 59.199424743652344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:25.55[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203765606880188, 'time_algorithm_update': 0.005200070858001709, 'loss': 26.011918796539305, 'time_step': 0.007289584398269653, 'init_value': 64.24493408203125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:26.04[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031599283218384, 'time_algorithm_update': 0.005206619501113892, 'loss': 25.356802347898483, 'time_step': 0.007289714097976684, 'init_value': 69.0965805053711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:26.12[0m [[32m[1minfo     [0m] [1mFQE_20250505182446: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020336620807647706, 'time_algorithm_update': 0.005191919326782227, 'loss': 32.42936518061161, 'time_step': 0.007276812553405762, 'init_value': 73.23829650878906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.23829650878906
avg return on 5 trajectories of agent12: 2084.9176793333336
Episode generator created
[2m2025-05-05 18:26.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:26.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:26.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:26.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:26.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182614[0m
[2m2025-05-05 18:26.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:26.22[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020225048065185547, 'time_algorithm_update': 0.005111997127532959, 'loss': 1.432137799203396, 'time_step': 0.0071855981349945065, 'init_value': 10.656312942504883}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:26.31[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020329537391662596, 'time_algorithm_update': 0.005157051086425782, 'loss': 4.3499694660604, 'time_step': 0.0072419319152832035, 'init_value': 20.795804977416992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:26.39[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026504039764404, 'time_algorithm_update': 0.005144872188568115, 'loss': 9.407194614768029, 'time_step': 0.007222885370254516, 'init_value': 30.48693084716797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:26.48[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020176239013671876, 'time_algorithm_update': 0.005123798847198486, 'loss': 13.66512153184414, 'time_step': 0.007192477226257325, 'init_value': 38.46287155151367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:26.57[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020416207313537597, 'time_algorithm_update': 0.005156813859939575, 'loss': 18.10716589844227, 'time_step': 0.007250766515731812, 'init_value': 47.239810943603516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:27.05[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020303339958190917, 'time_algorithm_update': 0.005151277303695679, 'loss': 22.767802691221238, 'time_step': 0.007233315467834472, 'init_value': 54.750186920166016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:27.14[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031118154525757, 'time_algorithm_update': 0.005139053821563721, 'loss': 28.413559817790986, 'time_step': 0.007221677303314209, 'init_value': 63.644893646240234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:27.22[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033517360687256, 'time_algorithm_update': 0.00515132212638855, 'loss': 32.73572850513458, 'time_step': 0.00723644757270813, 'init_value': 69.3370590209961}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:27.31[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020340971946716307, 'time_algorithm_update': 0.005157074451446533, 'loss': 38.26131930685043, 'time_step': 0.007242958068847657, 'init_value': 76.82210540771484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:27.39[0m [[32m[1minfo     [0m] [1mFQE_20250505182614: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039923906326294, 'time_algorithm_update': 0.005163841724395752, 'loss': 44.38675485157967, 'time_step': 0.00725587248802185, 'init_value': 82.16393280029297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.16393280029297
avg return on 5 trajectories of agent13: 1288.2385416666666
Episode generator created
[2m2025-05-05 18:27.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:27.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:27.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:27.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:27.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182741[0m
[2m2025-05-05 18:27.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:27.49[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020225043296813964, 'time_algorithm_update': 0.005117551803588867, 'loss': 1.564180963397026, 'time_step': 0.007191348791122437, 'init_value': 9.623600959777832}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:27.58[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020313429832458495, 'time_algorithm_update': 0.005182607889175415, 'loss': 4.831849563032389, 'time_step': 0.007265630960464477, 'init_value': 19.737714767456055}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:28.06[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020347826480865477, 'time_algorithm_update': 0.005201728343963623, 'loss': 10.015736674308776, 'time_step': 0.007288087368011475, 'init_value': 29.704198837280273}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374977588653565, 'time_algorithm_update': 0.0052091355323791505, 'loss': 14.448799648880959, 'time_step': 0.007298110485076904, 'init_value': 38.85306167602539}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:28.24[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020224320888519286, 'time_algorithm_update': 0.0051677472591400144, 'loss': 19.743007186770438, 'time_step': 0.007241837739944458, 'init_value': 47.82093811035156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:28.32[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020337677001953124, 'time_algorithm_update': 0.005194693088531494, 'loss': 25.39908563828468, 'time_step': 0.007280847072601318, 'init_value': 54.96380615234375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:28.41[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043147087097168, 'time_algorithm_update': 0.005200751304626465, 'loss': 29.637454166531562, 'time_step': 0.007296308040618897, 'init_value': 62.62770080566406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:28.49[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020380420684814452, 'time_algorithm_update': 0.0051885745525360105, 'loss': 34.4628645888567, 'time_step': 0.007278820514678955, 'init_value': 70.10456085205078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:28.58[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020424990653991697, 'time_algorithm_update': 0.005200496196746826, 'loss': 36.48841359448433, 'time_step': 0.007295046806335449, 'init_value': 73.92183685302734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:29.07[0m [[32m[1minfo     [0m] [1mFQE_20250505182741: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020390982627868652, 'time_algorithm_update': 0.005205133438110352, 'loss': 39.13504314899445, 'time_step': 0.007296361684799194, 'init_value': 81.6176528930664}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.6176528930664
avg return on 5 trajectories of agent14: 1075.8780523333335
Episode generator created
[2m2025-05-05 18:29.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:29.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:29.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:29.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:29.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182908[0m
[2m2025-05-05 18:29.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:29.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024057865142822, 'time_algorithm_update': 0.005098572492599487, 'loss': 1.429856675505638, 'time_step': 0.007173282623291016, 'init_value': 9.976713180541992}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:29.25[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034678220748901, 'time_algorithm_update': 0.005138271093368531, 'loss': 4.300090232849121, 'time_step': 0.007224596500396728, 'init_value': 19.507356643676758}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:29.33[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023176908493042, 'time_algorithm_update': 0.005130580186843872, 'loss': 7.967600555956364, 'time_step': 0.007205242395401001, 'init_value': 28.83622932434082}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:29.42[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037462472915649, 'time_algorithm_update': 0.005152821779251099, 'loss': 12.069936137795448, 'time_step': 0.0072421345710754394, 'init_value': 38.539615631103516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:29.51[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020310213565826415, 'time_algorithm_update': 0.005155584096908569, 'loss': 17.7044946089983, 'time_step': 0.007237833023071289, 'init_value': 46.15457534790039}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:29.59[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020125226974487304, 'time_algorithm_update': 0.005123214244842529, 'loss': 21.39242424714565, 'time_step': 0.007186626195907593, 'init_value': 54.43872833251953}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:30.08[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351910591125486, 'time_algorithm_update': 0.005156269073486328, 'loss': 24.17595742368698, 'time_step': 0.007242897510528565, 'init_value': 61.625953674316406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:30.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034935235977173, 'time_algorithm_update': 0.005169916391372681, 'loss': 29.03846304833889, 'time_step': 0.007256451845169067, 'init_value': 66.6233139038086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:30.25[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020383942127227784, 'time_algorithm_update': 0.005167105674743652, 'loss': 29.03888131070137, 'time_step': 0.007257187843322754, 'init_value': 71.88182067871094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:30.33[0m [[32m[1minfo     [0m] [1mFQE_20250505182908: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027878999710083, 'time_algorithm_update': 0.005148718595504761, 'loss': 29.536421115398408, 'time_step': 0.007227634906768799, 'init_value': 77.12348175048828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.12348175048828
avg return on 5 trajectories of agent15: 1064.5137803333334
Episode generator created
[2m2025-05-05 18:30.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:30.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:30.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:30.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:30.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183034[0m
[2m2025-05-05 18:30.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:30.43[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002012903928756714, 'time_algorithm_update': 0.005088258743286133, 'loss': 1.5813213923722507, 'time_step': 0.007152215003967285, 'init_value': 10.208019256591797}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:30.52[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020260355472564696, 'time_algorithm_update': 0.005142169713973999, 'loss': 4.381552009880543, 'time_step': 0.007219419240951538, 'init_value': 20.126419067382812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:31.00[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024141550064087, 'time_algorithm_update': 0.005142656803131104, 'loss': 8.453429716348648, 'time_step': 0.0072183234691619875, 'init_value': 30.246456146240234}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:31.09[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031583547592163, 'time_algorithm_update': 0.0051464662551879885, 'loss': 13.395466702699661, 'time_step': 0.00722941541671753, 'init_value': 38.27115249633789}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:31.17[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042080879211426, 'time_algorithm_update': 0.005164823532104492, 'loss': 17.6345055937767, 'time_step': 0.00725818920135498, 'init_value': 46.09379959106445}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031027555465698, 'time_algorithm_update': 0.005139118671417237, 'loss': 22.70072034305334, 'time_step': 0.007221575975418091, 'init_value': 54.475765228271484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:31.34[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019828705787658693, 'time_algorithm_update': 0.005033332824707032, 'loss': 24.777436112642288, 'time_step': 0.007065573930740357, 'init_value': 62.4940071105957}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:31.43[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020090689659118654, 'time_algorithm_update': 0.0050771632194519046, 'loss': 29.497129150509835, 'time_step': 0.007136842489242554, 'init_value': 67.81539154052734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:31.51[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020038414001464842, 'time_algorithm_update': 0.0050728065967559815, 'loss': 28.16446168899536, 'time_step': 0.00712783408164978, 'init_value': 72.36432647705078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:32.00[0m [[32m[1minfo     [0m] [1mFQE_20250505183034: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020088610649108885, 'time_algorithm_update': 0.005080925464630127, 'loss': 30.13112257182598, 'time_step': 0.0071402106285095215, 'init_value': 76.93079376220703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.93079376220703
avg return on 5 trajectories of agent16: 2080.4669879999997
Episode generator created
[2m2025-05-05 18:32.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:32.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:32.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:32.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:32.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183201[0m
[2m2025-05-05 18:32.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:32.10[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994166612625122, 'time_algorithm_update': 0.005033897638320923, 'loss': 1.4465232369303704, 'time_step': 0.00707762861251831, 'init_value': 10.61036491394043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:32.18[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372366905212404, 'time_algorithm_update': 0.005196935892105102, 'loss': 4.216609040409327, 'time_step': 0.007285547733306885, 'init_value': 20.85222816467285}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:32.27[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357451438903808, 'time_algorithm_update': 0.0052200062274932865, 'loss': 8.548404978215695, 'time_step': 0.007307520627975464, 'init_value': 30.568754196166992}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:32.36[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061818599700928, 'time_algorithm_update': 0.005281155347824097, 'loss': 13.998773208141326, 'time_step': 0.007395421504974365, 'init_value': 40.057701110839844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:32.44[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020322027206420897, 'time_algorithm_update': 0.005197373628616333, 'loss': 17.183029773950576, 'time_step': 0.007281673431396484, 'init_value': 48.60535430908203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:32.53[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039121389389038, 'time_algorithm_update': 0.00520894718170166, 'loss': 20.712742760300635, 'time_step': 0.00729955768585205, 'init_value': 56.62796401977539}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:33.01[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020486359596252443, 'time_algorithm_update': 0.005205781221389771, 'loss': 22.24619416356087, 'time_step': 0.00730656909942627, 'init_value': 63.86443328857422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:33.10[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227110385894775, 'time_algorithm_update': 0.005168334007263183, 'loss': 24.789810635566713, 'time_step': 0.007242439985275268, 'init_value': 69.18854522705078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:33.19[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038706302642822, 'time_algorithm_update': 0.0052012097835540776, 'loss': 28.826970301032066, 'time_step': 0.007291931867599488, 'init_value': 76.12223052978516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:33.27[0m [[32m[1minfo     [0m] [1mFQE_20250505183201: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042290449142456, 'time_algorithm_update': 0.005209439992904663, 'loss': 30.67821693992615, 'time_step': 0.007303731679916382, 'init_value': 81.58460235595703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.58460235595703
avg return on 5 trajectories of agent17: 970.1910683333332
Episode generator created
[2m2025-05-05 18:33.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:33.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:33.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:33.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:33.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183328[0m
[2m2025-05-05 18:33.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:33.37[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035644054412842, 'time_algorithm_update': 0.0051316750049591065, 'loss': 1.4343413188904524, 'time_step': 0.007218406200408935, 'init_value': 10.206945419311523}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:33.45[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028889894485474, 'time_algorithm_update': 0.005177932739257813, 'loss': 4.1313995560705665, 'time_step': 0.007258108139038086, 'init_value': 19.526885986328125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:33.54[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344178676605226, 'time_algorithm_update': 0.005190456867218017, 'loss': 9.57712204682827, 'time_step': 0.007276776075363159, 'init_value': 29.784313201904297}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:34.03[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020385334491729735, 'time_algorithm_update': 0.005205532789230347, 'loss': 13.752786955296994, 'time_step': 0.00729582405090332, 'init_value': 39.59098434448242}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:34.11[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202882719039917, 'time_algorithm_update': 0.005173664808273315, 'loss': 19.245294773697854, 'time_step': 0.0072539570331573485, 'init_value': 46.768646240234375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:34.20[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020336594581604004, 'time_algorithm_update': 0.005192020416259766, 'loss': 23.050385155439375, 'time_step': 0.007277829647064209, 'init_value': 52.146671295166016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:34.29[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037860155105591, 'time_algorithm_update': 0.005183604717254639, 'loss': 27.67873487329483, 'time_step': 0.007273184299468994, 'init_value': 59.182796478271484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:34.37[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020418920516967775, 'time_algorithm_update': 0.005194030523300171, 'loss': 29.845881096839904, 'time_step': 0.007287805795669556, 'init_value': 65.14056396484375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:34.46[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026553153991699, 'time_algorithm_update': 0.005173595190048218, 'loss': 34.40585816550255, 'time_step': 0.00725153923034668, 'init_value': 71.92549133300781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:34.54[0m [[32m[1minfo     [0m] [1mFQE_20250505183328: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204060697555542, 'time_algorithm_update': 0.005204339265823364, 'loss': 35.41133998441696, 'time_step': 0.007296720981597901, 'init_value': 76.94332122802734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.94332122802734
avg return on 5 trajectories of agent18: 1079.2887516666667
Episode generator created
[2m2025-05-05 18:34.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:34.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:34.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:34.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:34.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183455[0m
[2m2025-05-05 18:34.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:35.04[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032546043395996, 'time_algorithm_update': 0.005105012416839599, 'loss': 1.4393164661675693, 'time_step': 0.0071886501312255855, 'init_value': 11.130674362182617}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:35.12[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033519506454468, 'time_algorithm_update': 0.005147941827774048, 'loss': 4.540517196118832, 'time_step': 0.007232940196990967, 'init_value': 21.914203643798828}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:35.21[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339319705963135, 'time_algorithm_update': 0.00515699291229248, 'loss': 9.724387953162193, 'time_step': 0.007242548942565918, 'init_value': 31.497440338134766}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:35.30[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020315515995025634, 'time_algorithm_update': 0.005157582998275757, 'loss': 13.951924856901169, 'time_step': 0.007240974426269532, 'init_value': 40.37607192993164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:35.38[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038828134536743, 'time_algorithm_update': 0.005157374143600464, 'loss': 20.261585057854653, 'time_step': 0.0072476396560668946, 'init_value': 48.946651458740234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:35.47[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036145210266113, 'time_algorithm_update': 0.0051584153175354, 'loss': 23.51909157335758, 'time_step': 0.007246626377105713, 'init_value': 54.52001190185547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:35.55[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020402507781982424, 'time_algorithm_update': 0.005156046628952026, 'loss': 27.519741140842438, 'time_step': 0.00724836802482605, 'init_value': 61.26713943481445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:36.04[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020650386810302734, 'time_algorithm_update': 0.00523269510269165, 'loss': 30.41572430038452, 'time_step': 0.007350811004638672, 'init_value': 65.28738403320312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:36.13[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049281358718872, 'time_algorithm_update': 0.005182479858398438, 'loss': 31.688770622849464, 'time_step': 0.007284665584564209, 'init_value': 71.24897766113281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:36.21[0m [[32m[1minfo     [0m] [1mFQE_20250505183455: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036982536315918, 'time_algorithm_update': 0.005146661996841431, 'loss': 37.440255149841306, 'time_step': 0.0072353434562683104, 'init_value': 76.00194549560547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.00194549560547
avg return on 5 trajectories of agent19: 1055.7489679999999
Episode generator created
[2m2025-05-05 18:36.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:36.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:36.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:36.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:36.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183622[0m
[2m2025-05-05 18:36.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:36.31[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020250160694122313, 'time_algorithm_update': 0.005120816946029663, 'loss': 1.4448372148573398, 'time_step': 0.007196457147598267, 'init_value': 10.816330909729004}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:36.39[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020326404571533205, 'time_algorithm_update': 0.005162790060043335, 'loss': 4.8111249717473985, 'time_step': 0.007246639251708984, 'init_value': 21.804548263549805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:36.48[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020337538719177248, 'time_algorithm_update': 0.005183628559112549, 'loss': 8.469359916865825, 'time_step': 0.007268515110015869, 'init_value': 31.83308982849121}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:36.57[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041912317276001, 'time_algorithm_update': 0.005201953411102295, 'loss': 13.666513303637505, 'time_step': 0.007295542240142823, 'init_value': 41.398948669433594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:37.05[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026364803314209, 'time_algorithm_update': 0.005158078670501709, 'loss': 17.963838762044908, 'time_step': 0.007235845804214477, 'init_value': 51.60354995727539}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:37.14[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035482168197632, 'time_algorithm_update': 0.00516801643371582, 'loss': 24.06560877096653, 'time_step': 0.0072549118995666505, 'init_value': 60.19639587402344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:37.23[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044858694076538, 'time_algorithm_update': 0.005176135778427124, 'loss': 27.326729274868963, 'time_step': 0.007272444009780884, 'init_value': 68.48016357421875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:37.31[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039620876312256, 'time_algorithm_update': 0.0051886820793151855, 'loss': 26.919658672451973, 'time_step': 0.0072798821926116945, 'init_value': 74.32295227050781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:37.40[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041905641555786, 'time_algorithm_update': 0.005187212944030762, 'loss': 30.592945468068123, 'time_step': 0.0072812485694885255, 'init_value': 80.29024505615234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:37.48[0m [[32m[1minfo     [0m] [1mFQE_20250505183622: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020415663719177248, 'time_algorithm_update': 0.005185982227325439, 'loss': 38.92365900933743, 'time_step': 0.00727941632270813, 'init_value': 85.56546783447266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.56546783447266
ave advantage rew: 78.4788387298584, std: 3.0777522407339175
avg cum rews: 1605.76934855, std: 578.9990002062236
Pearson correlation coefficient: -0.16120966632440736
Spearman correlation coefficient: -0.058646616541353384
Kendall Tau correlation coefficient: 0.021052631578947368
the best agent: 19, best agent cum rewards: 1055.7489679999999
1959
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01793800618043264
avg return on 5 trajectories of agent0: 1087.0276303333333
Episode generator created
[2m2025-05-05 18:37.59[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:37.59[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:37.59[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:37.59[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:37.59[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183759[0m
[2m2025-05-05 18:37.59[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:38.08[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020328514575958254, 'time_algorithm_update': 0.005138674259185791, 'loss': 1.4193987486213446, 'time_step': 0.007223005533218384, 'init_value': 9.477985382080078}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:38.17[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030362129211426, 'time_algorithm_update': 0.005212970495223999, 'loss': 4.198112956613302, 'time_step': 0.007295174598693848, 'init_value': 19.285598754882812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:38.25[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035757780075073, 'time_algorithm_update': 0.005204462051391602, 'loss': 8.584753559589386, 'time_step': 0.007291729927062988, 'init_value': 28.500741958618164}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:38.34[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020373892784118653, 'time_algorithm_update': 0.005205809831619263, 'loss': 13.012501772284507, 'time_step': 0.00729465126991272, 'init_value': 36.12999725341797}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:38.42[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020405590534210206, 'time_algorithm_update': 0.005214571952819824, 'loss': 18.2473786714077, 'time_step': 0.0073065183162689205, 'init_value': 44.37910079956055}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:38.51[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020426764488220214, 'time_algorithm_update': 0.005222026824951172, 'loss': 22.823427269101142, 'time_step': 0.007316691875457764, 'init_value': 52.01924133300781}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:39.00[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020481257438659667, 'time_algorithm_update': 0.005222423315048218, 'loss': 27.868276606082915, 'time_step': 0.007322154521942139, 'init_value': 58.29540252685547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:39.08[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204103684425354, 'time_algorithm_update': 0.005238190412521362, 'loss': 28.711227682590483, 'time_step': 0.0073311195373535155, 'init_value': 65.16973876953125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:39.17[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043870210647583, 'time_algorithm_update': 0.005230456829071045, 'loss': 33.96587805056572, 'time_step': 0.0073261849880218504, 'init_value': 71.8687515258789}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:39.26[0m [[32m[1minfo     [0m] [1mFQE_20250505183759: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033461570739746, 'time_algorithm_update': 0.005222159862518311, 'loss': 37.09898677539825, 'time_step': 0.0073074762821197506, 'init_value': 77.09380340576172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.09380340576172
avg return on 5 trajectories of agent1: 1057.9412523333333
Episode generator created
[2m2025-05-05 18:39.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:39.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:39.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:39.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:39.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:39.35[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026474952697754, 'time_algorithm_update': 0.005131160020828247, 'loss': 1.4201186684370042, 'time_step': 0.007208413124084473, 'init_value': 10.374979972839355}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:39.44[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045580863952637, 'time_algorithm_update': 0.0052249088287353515, 'loss': 4.614007268160582, 'time_step': 0.007322846174240112, 'init_value': 20.61761474609375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:39.53[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020293912887573242, 'time_algorithm_update': 0.005200330972671509, 'loss': 9.236974754214287, 'time_step': 0.007281139850616455, 'init_value': 30.94029998779297}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:40.01[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020399048328399658, 'time_algorithm_update': 0.005193257093429565, 'loss': 14.276301025807857, 'time_step': 0.007284350872039795, 'init_value': 41.45672607421875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:40.10[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034516334533691, 'time_algorithm_update': 0.005198124408721924, 'loss': 18.980340600967406, 'time_step': 0.007284298181533814, 'init_value': 49.879207611083984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:40.18[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020535621643066404, 'time_algorithm_update': 0.00520529842376709, 'loss': 23.200740216851234, 'time_step': 0.007311353921890259, 'init_value': 57.711299896240234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:40.27[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034066438674927, 'time_algorithm_update': 0.00518795371055603, 'loss': 29.63712798845768, 'time_step': 0.0072734858989715575, 'init_value': 65.4590072631836}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:40.36[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204540753364563, 'time_algorithm_update': 0.005203714609146118, 'loss': 30.36561537706852, 'time_step': 0.007300926208496094, 'init_value': 71.63279724121094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:40.44[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020436444282531737, 'time_algorithm_update': 0.005209402561187744, 'loss': 31.333676670074464, 'time_step': 0.007304849863052368, 'init_value': 78.25182342529297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:40.53[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036158561706543, 'time_algorithm_update': 0.005196203231811523, 'loss': 36.98918226099014, 'time_step': 0.007284581422805786, 'init_value': 83.30229949951172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.30229949951172
avg return on 5 trajectories of agent2: 1064.6840553333332
Episode generator created
[2m2025-05-05 18:40.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:40.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:40.54[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:40.54[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:40.54[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184054[0m
[2m2025-05-05 18:40.54[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:41.03[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020204663276672365, 'time_algorithm_update': 0.005091575145721436, 'loss': 1.4105300133675336, 'time_step': 0.007162974596023559, 'init_value': 10.06124210357666}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:41.11[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020363466739654543, 'time_algorithm_update': 0.005161461114883423, 'loss': 4.73606245687604, 'time_step': 0.007249329090118408, 'init_value': 20.68643569946289}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:41.20[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020386292934417723, 'time_algorithm_update': 0.005176508665084839, 'loss': 8.393101809024811, 'time_step': 0.007266700506210327, 'init_value': 30.205089569091797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:41.28[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036742687225342, 'time_algorithm_update': 0.0051719326972961424, 'loss': 14.331890750288963, 'time_step': 0.00726030421257019, 'init_value': 40.6038818359375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:41.37[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036738634109497, 'time_algorithm_update': 0.005175116300582885, 'loss': 19.612161105155945, 'time_step': 0.0072634537220001225, 'init_value': 49.89164352416992}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:41.45[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038973331451416, 'time_algorithm_update': 0.005166476488113404, 'loss': 21.26692814230919, 'time_step': 0.007256980895996094, 'init_value': 57.624114990234375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:41.54[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200822639465332, 'time_algorithm_update': 0.0051066184043884275, 'loss': 26.76052361345291, 'time_step': 0.007165724754333496, 'init_value': 63.522640228271484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:42.03[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020195930004119874, 'time_algorithm_update': 0.005095621585845947, 'loss': 29.1379238653183, 'time_step': 0.007166357517242432, 'init_value': 72.0534439086914}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:42.11[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002012368679046631, 'time_algorithm_update': 0.005074199438095093, 'loss': 31.076565277576446, 'time_step': 0.007137349605560303, 'init_value': 77.9170150756836}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:42.19[0m [[32m[1minfo     [0m] [1mFQE_20250505184054: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013533115386963, 'time_algorithm_update': 0.005083152532577515, 'loss': 35.372491812705995, 'time_step': 0.007147214412689209, 'init_value': 82.55248260498047}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.55248260498047
avg return on 5 trajectories of agent3: 1070.8581866666666
Episode generator created
[2m2025-05-05 18:42.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:42.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:42.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:42.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:42.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184221[0m
[2m2025-05-05 18:42.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:42.29[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002006842613220215, 'time_algorithm_update': 0.005032280206680298, 'loss': 1.516348029702902, 'time_step': 0.0070890564918518065, 'init_value': 9.074408531188965}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:42.37[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898102283477785, 'time_algorithm_update': 0.005074504613876343, 'loss': 4.2437674777805805, 'time_step': 0.007114265203475952, 'init_value': 18.57400131225586}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:42.46[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020413053035736083, 'time_algorithm_update': 0.005196611642837525, 'loss': 8.454177255749702, 'time_step': 0.007290109634399414, 'init_value': 27.824399948120117}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:42.54[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040078163146973, 'time_algorithm_update': 0.005188586473464965, 'loss': 14.328096414923667, 'time_step': 0.007280139923095703, 'init_value': 38.10426712036133}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:43.03[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493035316467285, 'time_algorithm_update': 0.005189207315444947, 'loss': 17.8201780616045, 'time_step': 0.0072907028198242185, 'init_value': 45.216796875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:43.12[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020465025901794435, 'time_algorithm_update': 0.005214989185333252, 'loss': 21.330798293828963, 'time_step': 0.007314111709594727, 'init_value': 53.68490219116211}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:43.20[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206591272354126, 'time_algorithm_update': 0.0052711966037750245, 'loss': 21.96809856045246, 'time_step': 0.007390106916427612, 'init_value': 60.22380065917969}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:43.29[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020474200248718263, 'time_algorithm_update': 0.005220311403274536, 'loss': 26.36392714691162, 'time_step': 0.0073196542263031005, 'init_value': 66.04519653320312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:43.38[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040135383605957, 'time_algorithm_update': 0.005176090478897095, 'loss': 27.226089350938796, 'time_step': 0.007267699003219604, 'init_value': 71.06150817871094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:43.46[0m [[32m[1minfo     [0m] [1mFQE_20250505184221: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020447356700897218, 'time_algorithm_update': 0.005183371305465698, 'loss': 27.837626784324645, 'time_step': 0.007279962778091431, 'init_value': 77.739013671875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.739013671875
avg return on 5 trajectories of agent4: 1058.7611416666666
Episode generator created
[2m2025-05-05 18:43.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:43.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:43.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:43.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:43.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184347[0m
[2m2025-05-05 18:43.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:43.56[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020215959548950196, 'time_algorithm_update': 0.005106626510620117, 'loss': 1.4035607893913984, 'time_step': 0.007178797483444214, 'init_value': 10.035377502441406}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:44.05[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344622135162354, 'time_algorithm_update': 0.005174638271331787, 'loss': 4.132880043804645, 'time_step': 0.007260841369628906, 'init_value': 20.032791137695312}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:44.13[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014671802520752, 'time_algorithm_update': 0.005136911392211914, 'loss': 8.567054878294467, 'time_step': 0.007202378511428833, 'init_value': 29.51409339904785}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:44.22[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020437593460083006, 'time_algorithm_update': 0.005180746555328369, 'loss': 12.741805108070373, 'time_step': 0.007276492834091187, 'init_value': 38.10996627807617}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:44.30[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042238235473633, 'time_algorithm_update': 0.005186195611953735, 'loss': 16.442969795823096, 'time_step': 0.007279947519302368, 'init_value': 47.110015869140625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:44.39[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020377411842346193, 'time_algorithm_update': 0.005170491933822632, 'loss': 22.935352966070177, 'time_step': 0.007259617328643799, 'init_value': 54.26719284057617}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:44.48[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020389909744262693, 'time_algorithm_update': 0.005174101352691651, 'loss': 25.644099966406824, 'time_step': 0.007265094041824341, 'init_value': 59.607757568359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:44.56[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031507730484009, 'time_algorithm_update': 0.005174852132797241, 'loss': 27.71719932591915, 'time_step': 0.007258083581924439, 'init_value': 64.6797866821289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:45.05[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374853610992433, 'time_algorithm_update': 0.005189384698867798, 'loss': 31.39537030005455, 'time_step': 0.007279449939727783, 'init_value': 71.11245727539062}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:45.13[0m [[32m[1minfo     [0m] [1mFQE_20250505184347: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020410208702087403, 'time_algorithm_update': 0.005180583000183105, 'loss': 32.07304453063011, 'time_step': 0.007273179531097412, 'init_value': 78.48333740234375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.48333740234375
avg return on 5 trajectories of agent5: 1079.259121
Episode generator created
[2m2025-05-05 18:45.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:45.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:45.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:45.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:45.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184514[0m
[2m2025-05-05 18:45.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:45.23[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020334005355835, 'time_algorithm_update': 0.005127262115478515, 'loss': 1.453948836416006, 'time_step': 0.007198493242263794, 'init_value': 9.541041374206543}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:45.31[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202860689163208, 'time_algorithm_update': 0.005208136320114136, 'loss': 4.327194263011217, 'time_step': 0.007288303852081299, 'init_value': 19.124101638793945}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:45.40[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033683776855469, 'time_algorithm_update': 0.005210942983627319, 'loss': 8.803261090934276, 'time_step': 0.00729625391960144, 'init_value': 28.275203704833984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:45.49[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020276310443878174, 'time_algorithm_update': 0.005183480739593506, 'loss': 13.320156219422817, 'time_step': 0.0072620887756347655, 'init_value': 38.29110336303711}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:45.57[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020331058502197265, 'time_algorithm_update': 0.005212313652038574, 'loss': 20.22843935585022, 'time_step': 0.007296821117401123, 'init_value': 46.37334442138672}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:46.06[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020436015129089357, 'time_algorithm_update': 0.005221043348312378, 'loss': 25.830887677550315, 'time_step': 0.007316359758377075, 'init_value': 53.81707000732422}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:46.15[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038733005523682, 'time_algorithm_update': 0.005208424091339111, 'loss': 27.193123036503792, 'time_step': 0.007298709869384766, 'init_value': 60.07905960083008}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:46.23[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020399625301361084, 'time_algorithm_update': 0.005221338987350464, 'loss': 29.115394713640214, 'time_step': 0.007313137769699097, 'init_value': 66.97325134277344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:46.32[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374186038970947, 'time_algorithm_update': 0.005207843542098999, 'loss': 41.55414988529682, 'time_step': 0.007296884536743164, 'init_value': 73.33197021484375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:46.40[0m [[32m[1minfo     [0m] [1mFQE_20250505184514: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020401973724365236, 'time_algorithm_update': 0.0052109603881835935, 'loss': 34.363569034576415, 'time_step': 0.0073031046390533445, 'init_value': 76.98370361328125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.98370361328125
avg return on 5 trajectories of agent6: 1066.559418
Episode generator created
[2m2025-05-05 18:46.41[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:46.41[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:46.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:46.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:46.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184641[0m
[2m2025-05-05 18:46.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:46.50[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021353006362915, 'time_algorithm_update': 0.005128655195236206, 'loss': 1.4683160292059183, 'time_step': 0.007201245069503784, 'init_value': 10.504569053649902}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:46.59[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020458271503448486, 'time_algorithm_update': 0.005227722406387329, 'loss': 4.318382564157248, 'time_step': 0.007325922012329102, 'init_value': 20.950191497802734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:47.07[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027456521987915, 'time_algorithm_update': 0.005164019584655762, 'loss': 8.711310896456242, 'time_step': 0.0072426385879516605, 'init_value': 30.56067657470703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:47.16[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033806324005127, 'time_algorithm_update': 0.00516954255104065, 'loss': 14.686215659618378, 'time_step': 0.007254889011383056, 'init_value': 39.986412048339844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:47.25[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020250656604766846, 'time_algorithm_update': 0.0051615357398986815, 'loss': 20.69156498503685, 'time_step': 0.007237546682357788, 'init_value': 49.519012451171875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:47.33[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020331313610076904, 'time_algorithm_update': 0.005179334878921509, 'loss': 25.373266434431077, 'time_step': 0.007263823986053467, 'init_value': 57.051361083984375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:47.42[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046466112136841, 'time_algorithm_update': 0.005190872430801392, 'loss': 26.800377324819564, 'time_step': 0.007289002656936646, 'init_value': 64.29238891601562}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:47.50[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020382018089294433, 'time_algorithm_update': 0.005191681385040284, 'loss': 31.640114827632903, 'time_step': 0.007281320571899414, 'init_value': 68.73162841796875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:47.59[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029963493347168, 'time_algorithm_update': 0.005190503597259521, 'loss': 31.665852275848387, 'time_step': 0.007271194696426391, 'init_value': 75.5398941040039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:48.07[0m [[32m[1minfo     [0m] [1mFQE_20250505184641: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020442395210266114, 'time_algorithm_update': 0.005210174560546875, 'loss': 34.14603990530968, 'time_step': 0.007306289196014404, 'init_value': 79.84695434570312}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.84695434570312
avg return on 5 trajectories of agent7: 1070.3412260000002
Episode generator created
[2m2025-05-05 18:48.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:48.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:48.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:48.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:48.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184809[0m
[2m2025-05-05 18:48.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:48.17[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020195245742798, 'time_algorithm_update': 0.005116215229034424, 'loss': 1.501257612273097, 'time_step': 0.007187379837036133, 'init_value': 10.285208702087402}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:48.26[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020343759059906004, 'time_algorithm_update': 0.005180531740188598, 'loss': 3.676820351153612, 'time_step': 0.007266393423080444, 'init_value': 20.208209991455078}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:48.34[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030018329620361, 'time_algorithm_update': 0.005171915769577026, 'loss': 7.318876340925693, 'time_step': 0.0072532382011413574, 'init_value': 28.984163284301758}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:48.43[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020304710865020753, 'time_algorithm_update': 0.005168638467788696, 'loss': 10.89695248168707, 'time_step': 0.007250192403793335, 'init_value': 36.50507736206055}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:48.51[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027783393859863, 'time_algorithm_update': 0.0051638162136077885, 'loss': 14.632587523818016, 'time_step': 0.007242966651916504, 'init_value': 43.87113571166992}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:49.00[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026061773300171, 'time_algorithm_update': 0.005166636943817139, 'loss': 18.87192443025112, 'time_step': 0.007244455099105835, 'init_value': 49.76707458496094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:49.09[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020537257194519045, 'time_algorithm_update': 0.005228075742721557, 'loss': 20.4749269002676, 'time_step': 0.007334319114685059, 'init_value': 57.28330612182617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:49.17[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052178382873535, 'time_algorithm_update': 0.005220776319503784, 'loss': 25.80757776093483, 'time_step': 0.007324895143508911, 'init_value': 62.63687515258789}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:49.26[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020258939266204834, 'time_algorithm_update': 0.005157439470291137, 'loss': 29.172837970852854, 'time_step': 0.007234386205673218, 'init_value': 67.50568389892578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:49.34[0m [[32m[1minfo     [0m] [1mFQE_20250505184809: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034175872802734, 'time_algorithm_update': 0.005166505575180054, 'loss': 28.220301408052446, 'time_step': 0.007252166509628296, 'init_value': 73.92066955566406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.92066955566406
avg return on 5 trajectories of agent8: 1082.6615703333334
Episode generator created
[2m2025-05-05 18:49.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:49.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:49.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:49.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:49.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184935[0m
[2m2025-05-05 18:49.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:49.44[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030402660369873, 'time_algorithm_update': 0.005111157655715942, 'loss': 1.3495062291771174, 'time_step': 0.007193106174468994, 'init_value': 10.965157508850098}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:49.53[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020250780582427978, 'time_algorithm_update': 0.005141647100448609, 'loss': 3.9560311273932456, 'time_step': 0.007218212127685547, 'init_value': 21.328624725341797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:50.01[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020364739894866944, 'time_algorithm_update': 0.005175618410110473, 'loss': 9.439880730390549, 'time_step': 0.0072637698650360105, 'init_value': 30.793758392333984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:50.10[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020305371284484864, 'time_algorithm_update': 0.005153030157089233, 'loss': 13.581400316894054, 'time_step': 0.007235180616378784, 'init_value': 39.092376708984375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:50.18[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026728391647339, 'time_algorithm_update': 0.005145675659179687, 'loss': 18.343762641072274, 'time_step': 0.007223451852798462, 'init_value': 47.622314453125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:50.27[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204769229888916, 'time_algorithm_update': 0.005200653314590454, 'loss': 21.55718228042126, 'time_step': 0.007300787210464478, 'init_value': 54.81755065917969}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:50.36[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020613939762115477, 'time_algorithm_update': 0.005233025789260865, 'loss': 28.35738631916046, 'time_step': 0.007347169160842895, 'init_value': 63.232086181640625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:50.44[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020366714000701904, 'time_algorithm_update': 0.005163830518722534, 'loss': 36.269271370172504, 'time_step': 0.007251816749572754, 'init_value': 69.96408081054688}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:50.53[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020162057876586914, 'time_algorithm_update': 0.005145947933197021, 'loss': 34.21616391515732, 'time_step': 0.007213701725006103, 'init_value': 74.8046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:51.01[0m [[32m[1minfo     [0m] [1mFQE_20250505184935: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020340871810913086, 'time_algorithm_update': 0.0051571524143219, 'loss': 37.83309363389015, 'time_step': 0.007243505477905273, 'init_value': 79.21674346923828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.21674346923828
avg return on 5 trajectories of agent9: 1066.5984070000002
Episode generator created
[2m2025-05-05 18:51.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:51.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:51.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:51.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:51.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185102[0m
[2m2025-05-05 18:51.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:51.11[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020211291313171386, 'time_algorithm_update': 0.005118215799331665, 'loss': 1.428075918674469, 'time_step': 0.007190330028533936, 'init_value': 9.441317558288574}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:51.20[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020273451805114745, 'time_algorithm_update': 0.0051831090450286865, 'loss': 4.261432695657015, 'time_step': 0.0072618210315704345, 'init_value': 18.632652282714844}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:51.28[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038501977920532, 'time_algorithm_update': 0.005207807540893555, 'loss': 8.247120389699935, 'time_step': 0.00729807162284851, 'init_value': 27.79791831970215}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:51.37[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020273964405059814, 'time_algorithm_update': 0.005204154491424561, 'loss': 11.95963151139021, 'time_step': 0.007282915353775024, 'init_value': 35.873939514160156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:51.45[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035892963409424, 'time_algorithm_update': 0.005205705881118774, 'loss': 18.330613128900527, 'time_step': 0.007293253183364868, 'init_value': 43.41992950439453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:51.54[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026559591293335, 'time_algorithm_update': 0.005179394483566285, 'loss': 21.663368203401564, 'time_step': 0.007257197380065918, 'init_value': 50.23422622680664}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:52.03[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020349557399749756, 'time_algorithm_update': 0.005217376947402954, 'loss': 23.03536281824112, 'time_step': 0.00730467677116394, 'init_value': 56.284461975097656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:52.11[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020298159122467043, 'time_algorithm_update': 0.005195411443710327, 'loss': 23.457531119227408, 'time_step': 0.00727673864364624, 'init_value': 61.45985412597656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:52.20[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019992125034332276, 'time_algorithm_update': 0.005120241641998291, 'loss': 28.390365090847016, 'time_step': 0.007170103073120117, 'init_value': 67.7039566040039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:52.28[0m [[32m[1minfo     [0m] [1mFQE_20250505185102: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020058255195617674, 'time_algorithm_update': 0.005101774215698242, 'loss': 28.770539849996567, 'time_step': 0.007158477306365967, 'init_value': 71.77397155761719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 71.77397155761719
avg return on 5 trajectories of agent10: 1077.4528286666666
Episode generator created
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:52.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:52.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:52.38[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999307632446289, 'time_algorithm_update': 0.005033521175384521, 'loss': 1.5930270839631557, 'time_step': 0.007082679033279419, 'init_value': 11.008614540100098}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:52.46[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020105719566345217, 'time_algorithm_update': 0.005111485004425049, 'loss': 4.237161768049002, 'time_step': 0.007172410726547241, 'init_value': 22.08616065979004}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:52.55[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003591299057007, 'time_algorithm_update': 0.005097637414932251, 'loss': 8.767501859664916, 'time_step': 0.007151214838027954, 'init_value': 32.60160446166992}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:53.03[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002011335611343384, 'time_algorithm_update': 0.005108790636062622, 'loss': 11.925690804719926, 'time_step': 0.007170713663101196, 'init_value': 42.1259651184082}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:53.12[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029027223587036, 'time_algorithm_update': 0.005175102233886719, 'loss': 15.9285523635149, 'time_step': 0.007255719184875488, 'init_value': 50.698978424072266}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:53.20[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020232062339782713, 'time_algorithm_update': 0.005176589012145996, 'loss': 17.042529724478722, 'time_step': 0.0072516281604766844, 'init_value': 58.64138412475586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:53.29[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020291266441345213, 'time_algorithm_update': 0.005174673557281494, 'loss': 20.968544860243796, 'time_step': 0.007255221366882324, 'init_value': 65.64326477050781}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:53.38[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025546073913574, 'time_algorithm_update': 0.0051653218269348145, 'loss': 26.56073161792755, 'time_step': 0.007242509365081787, 'init_value': 73.41957092285156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:53.46[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034076690673828, 'time_algorithm_update': 0.005185034513473511, 'loss': 27.994150037288666, 'time_step': 0.0072703931331634525, 'init_value': 80.4637451171875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:53.55[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028014659881592, 'time_algorithm_update': 0.005181479692459107, 'loss': 27.88649855518341, 'time_step': 0.007261062622070312, 'init_value': 86.10093688964844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 86.10093688964844
avg return on 5 trajectories of agent11: 1074.1478076666665
Episode generator created
[2m2025-05-05 18:53.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:53.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:53.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:53.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:53.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185356[0m
[2m2025-05-05 18:53.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:54.04[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020264444351196288, 'time_algorithm_update': 0.00513695502281189, 'loss': 1.3751365144699812, 'time_step': 0.007214385747909546, 'init_value': 10.873135566711426}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:54.13[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312442779541018, 'time_algorithm_update': 0.005149896144866943, 'loss': 4.295539137661457, 'time_step': 0.007232052087783813, 'init_value': 21.54264259338379}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:54.21[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020424983501434327, 'time_algorithm_update': 0.00518657374382019, 'loss': 9.691282074153424, 'time_step': 0.007280616998672485, 'init_value': 30.33238983154297}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:54.30[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020296213626861573, 'time_algorithm_update': 0.00515439486503601, 'loss': 12.496530122220516, 'time_step': 0.007235145092010498, 'init_value': 39.313411712646484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:54.39[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020259733200073244, 'time_algorithm_update': 0.005144315719604492, 'loss': 20.18134238362312, 'time_step': 0.007221461057662964, 'init_value': 47.426509857177734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:54.47[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036852836608887, 'time_algorithm_update': 0.005151914358139038, 'loss': 23.595382405519487, 'time_step': 0.007240329265594482, 'init_value': 53.7251091003418}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:54.56[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030465126037598, 'time_algorithm_update': 0.005153633832931518, 'loss': 29.4611891579628, 'time_step': 0.007235818862915039, 'init_value': 61.811927795410156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:55.04[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020299224853515623, 'time_algorithm_update': 0.0051554512977600095, 'loss': 29.894660915613173, 'time_step': 0.007236789464950561, 'init_value': 67.75737762451172}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:55.13[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020275213718414305, 'time_algorithm_update': 0.0051507136821746825, 'loss': 35.441027792930605, 'time_step': 0.007229661226272583, 'init_value': 72.55538940429688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:55.21[0m [[32m[1minfo     [0m] [1mFQE_20250505185356: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020307848453521727, 'time_algorithm_update': 0.00515244460105896, 'loss': 36.96572393965721, 'time_step': 0.007234455823898316, 'init_value': 78.73519134521484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.73519134521484
avg return on 5 trajectories of agent12: 1056.481786
Episode generator created
[2m2025-05-05 18:55.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:55.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:55.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:55.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:55.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185522[0m
[2m2025-05-05 18:55.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:55.31[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015543222427368, 'time_algorithm_update': 0.00511507511138916, 'loss': 1.417140094920993, 'time_step': 0.007181502819061279, 'init_value': 9.944937705993652}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:55.40[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020193490982055662, 'time_algorithm_update': 0.005172866582870484, 'loss': 4.659730726271868, 'time_step': 0.007243263244628906, 'init_value': 21.02707862854004}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:55.48[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032024621963501, 'time_algorithm_update': 0.005205577850341797, 'loss': 10.719203376412391, 'time_step': 0.007289377212524414, 'init_value': 31.023103713989258}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:55.57[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025561809539795, 'time_algorithm_update': 0.005203035593032837, 'loss': 17.786969709634782, 'time_step': 0.007280120611190796, 'init_value': 40.989681243896484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:56.05[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034747362136841, 'time_algorithm_update': 0.005210246562957764, 'loss': 22.428349259495736, 'time_step': 0.007296618461608887, 'init_value': 49.76581573486328}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:56.14[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020260112285614014, 'time_algorithm_update': 0.005187617063522339, 'loss': 26.01677639067173, 'time_step': 0.007265215158462525, 'init_value': 58.395172119140625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:56.23[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020266616344451903, 'time_algorithm_update': 0.0052022461891174316, 'loss': 33.964617531776426, 'time_step': 0.007280593156814575, 'init_value': 65.94793701171875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:56.31[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020301096439361574, 'time_algorithm_update': 0.0051955215930938724, 'loss': 32.85996288800239, 'time_step': 0.0072774701118469235, 'init_value': 71.80522155761719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:56.40[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033114194869995, 'time_algorithm_update': 0.005199495553970337, 'loss': 34.81829913043976, 'time_step': 0.007284258365631104, 'init_value': 77.85774993896484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:56.49[0m [[32m[1minfo     [0m] [1mFQE_20250505185522: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020319325923919677, 'time_algorithm_update': 0.005204389810562134, 'loss': 42.38845186901092, 'time_step': 0.007288169384002685, 'init_value': 83.56627655029297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.56627655029297
avg return on 5 trajectories of agent13: 1326.0382673333334
Episode generator created
[2m2025-05-05 18:56.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:56.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:56.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:56.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:56.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185650[0m
[2m2025-05-05 18:56.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:56.58[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017038106918335, 'time_algorithm_update': 0.005114139080047608, 'loss': 1.410863887667656, 'time_step': 0.00718220591545105, 'init_value': 11.470273971557617}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:57.07[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034255027770996, 'time_algorithm_update': 0.005201871156692505, 'loss': 4.3125588735044005, 'time_step': 0.00728786587715149, 'init_value': 21.97183609008789}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:57.15[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020205726623535158, 'time_algorithm_update': 0.005169217586517334, 'loss': 8.278779336750507, 'time_step': 0.007240672111511231, 'init_value': 31.867338180541992}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:57.24[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035377264022827, 'time_algorithm_update': 0.005206671714782715, 'loss': 13.687438290834427, 'time_step': 0.007293365478515625, 'init_value': 40.485809326171875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:57.33[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451741218566895, 'time_algorithm_update': 0.005246408939361572, 'loss': 17.989933617949486, 'time_step': 0.007344029664993286, 'init_value': 50.08689498901367}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:57.41[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030536413192749, 'time_algorithm_update': 0.005187506914138794, 'loss': 19.23158819901943, 'time_step': 0.007269556760787964, 'init_value': 56.520301818847656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:57.50[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037297487258911, 'time_algorithm_update': 0.0051941733360290525, 'loss': 23.428111048817634, 'time_step': 0.007283295631408691, 'init_value': 64.55757141113281}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:57.59[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029658317565918, 'time_algorithm_update': 0.00517694878578186, 'loss': 25.73942136466503, 'time_step': 0.0072577612400054935, 'init_value': 70.40886688232422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:58.07[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020382397174835204, 'time_algorithm_update': 0.005196105718612671, 'loss': 26.160489287257196, 'time_step': 0.0072859847545623775, 'init_value': 75.58544158935547}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:58.16[0m [[32m[1minfo     [0m] [1mFQE_20250505185650: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202854585647583, 'time_algorithm_update': 0.005184693098068237, 'loss': 27.834009449005126, 'time_step': 0.007265091896057129, 'init_value': 80.04733276367188}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.04733276367188
avg return on 5 trajectories of agent14: 1223.9495266666665
Episode generator created
[2m2025-05-05 18:58.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:58.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:58.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:58.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:58.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185817[0m
[2m2025-05-05 18:58.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:58.25[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020273418426513673, 'time_algorithm_update': 0.005104458093643189, 'loss': 1.3988361949026584, 'time_step': 0.007182789087295532, 'init_value': 10.226000785827637}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:58.34[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031525373458862, 'time_algorithm_update': 0.005140576362609863, 'loss': 4.1289980733990665, 'time_step': 0.007223048448562622, 'init_value': 21.051584243774414}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:58.42[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020277338027954103, 'time_algorithm_update': 0.005144788265228272, 'loss': 9.416989816248417, 'time_step': 0.007223547220230103, 'init_value': 31.393314361572266}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:58.51[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020118238925933836, 'time_algorithm_update': 0.005124625444412232, 'loss': 13.95143799239397, 'time_step': 0.007186736345291138, 'init_value': 40.014896392822266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:58.59[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020337278842926026, 'time_algorithm_update': 0.005155010461807251, 'loss': 21.236309441924096, 'time_step': 0.007240111351013183, 'init_value': 47.7773551940918}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:59.08[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020408155918121337, 'time_algorithm_update': 0.00515972089767456, 'loss': 25.052159202814103, 'time_step': 0.0072520413398742675, 'init_value': 54.8339729309082}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:59.17[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020369269847869873, 'time_algorithm_update': 0.0051542329788208, 'loss': 24.981840279579163, 'time_step': 0.0072422890663146975, 'init_value': 61.96659851074219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:59.25[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020269122123718264, 'time_algorithm_update': 0.005143588542938233, 'loss': 34.48360239934921, 'time_step': 0.007221674680709839, 'init_value': 69.69398498535156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:59.34[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020311551094055174, 'time_algorithm_update': 0.005158657550811767, 'loss': 37.78485983133316, 'time_step': 0.0072407681941986084, 'init_value': 74.92462158203125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:59.42[0m [[32m[1minfo     [0m] [1mFQE_20250505185817: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020258662700653077, 'time_algorithm_update': 0.00515181565284729, 'loss': 34.063631694912914, 'time_step': 0.007229157209396362, 'init_value': 79.98387908935547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.98387908935547
avg return on 5 trajectories of agent15: 1618.9287446666665
Episode generator created
[2m2025-05-05 18:59.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:59.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:59.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:59.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:59.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185944[0m
[2m2025-05-05 18:59.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:59.52[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020182032585144044, 'time_algorithm_update': 0.0050963122844696045, 'loss': 1.365706152960658, 'time_step': 0.007165087461471558, 'init_value': 10.770487785339355}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:00.01[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020332164764404297, 'time_algorithm_update': 0.00516031813621521, 'loss': 4.03291979971528, 'time_step': 0.0072451684474945065, 'init_value': 21.74037742614746}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:00.09[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020373013019561767, 'time_algorithm_update': 0.00516664719581604, 'loss': 7.505792056322098, 'time_step': 0.007255173683166504, 'init_value': 32.21963119506836}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:00.18[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020146131515503, 'time_algorithm_update': 0.005152684926986694, 'loss': 12.416915782868863, 'time_step': 0.0072234227657318115, 'init_value': 40.76165771484375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:00.26[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026303291320801, 'time_algorithm_update': 0.005144266366958618, 'loss': 16.22343458336592, 'time_step': 0.007221444845199585, 'init_value': 48.87055587768555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:00.35[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043853521347046, 'time_algorithm_update': 0.005169965505599975, 'loss': 19.877756890177725, 'time_step': 0.007266790390014649, 'init_value': 55.72480392456055}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:00.44[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020428059101104735, 'time_algorithm_update': 0.005181892156600952, 'loss': 23.275416109085082, 'time_step': 0.007276671409606934, 'init_value': 61.57704162597656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:00.52[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028695344924927, 'time_algorithm_update': 0.005161363601684571, 'loss': 22.525601536154745, 'time_step': 0.007241666078567505, 'init_value': 66.84379577636719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:01.01[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020403480529785157, 'time_algorithm_update': 0.005192183732986451, 'loss': 25.676505735754965, 'time_step': 0.007284590721130371, 'init_value': 74.08177947998047}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:01.09[0m [[32m[1minfo     [0m] [1mFQE_20250505185944: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054131507873535, 'time_algorithm_update': 0.0051780292987823485, 'loss': 27.787859444379805, 'time_step': 0.007284429550170899, 'init_value': 78.09893035888672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.09893035888672
avg return on 5 trajectories of agent16: 1068.929896
Episode generator created
[2m2025-05-05 19:01.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:01.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:01.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:01.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:01.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190111[0m
[2m2025-05-05 19:01.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:01.19[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018171548843384, 'time_algorithm_update': 0.0050936338901519775, 'loss': 1.401946776404977, 'time_step': 0.007163001775741577, 'init_value': 9.360350608825684}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:01.28[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020247271060943603, 'time_algorithm_update': 0.0051504292488098145, 'loss': 4.41918890401721, 'time_step': 0.007226574420928955, 'init_value': 19.068870544433594}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:01.36[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028606653213501, 'time_algorithm_update': 0.005151111125946045, 'loss': 9.132546981215476, 'time_step': 0.007230753660202026, 'init_value': 28.574941635131836}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:01.45[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020322017669677736, 'time_algorithm_update': 0.00515688157081604, 'loss': 13.344358648777009, 'time_step': 0.007240319728851318, 'init_value': 38.161441802978516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:01.53[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204844069480896, 'time_algorithm_update': 0.005204186201095581, 'loss': 17.622270564675333, 'time_step': 0.0073048872947692875, 'init_value': 46.19597625732422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:02.02[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020162479877471923, 'time_algorithm_update': 0.005127471685409546, 'loss': 22.56204770088196, 'time_step': 0.0071945576667785645, 'init_value': 53.1551513671875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:02.11[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020467791557312012, 'time_algorithm_update': 0.005169194936752319, 'loss': 26.211409935474396, 'time_step': 0.007267823219299316, 'init_value': 60.727848052978516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:02.19[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203248929977417, 'time_algorithm_update': 0.005153014421463013, 'loss': 26.759483310222627, 'time_step': 0.007237233638763428, 'init_value': 65.54861450195312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:02.28[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052980184555054, 'time_algorithm_update': 0.005153326272964477, 'loss': 32.67476558184624, 'time_step': 0.0072579867839813236, 'init_value': 71.12107849121094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:02.36[0m [[32m[1minfo     [0m] [1mFQE_20250505190111: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030703783035278, 'time_algorithm_update': 0.005147806167602539, 'loss': 35.71836592411995, 'time_step': 0.007230102300643921, 'init_value': 76.45745086669922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.45745086669922
avg return on 5 trajectories of agent17: 1052.2312003333334
Episode generator created
[2m2025-05-05 19:02.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:02.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:02.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:02.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:02.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190237[0m
[2m2025-05-05 19:02.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:02.46[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996145486831665, 'time_algorithm_update': 0.0050370943546295165, 'loss': 1.5146793631464244, 'time_step': 0.007082949876785278, 'init_value': 11.056150436401367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:02.54[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00201236629486084, 'time_algorithm_update': 0.005094124555587769, 'loss': 4.640391772896051, 'time_step': 0.007156680583953858, 'init_value': 21.65253448486328}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:03.03[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002011593818664551, 'time_algorithm_update': 0.005099076986312867, 'loss': 10.173558380961419, 'time_step': 0.007160571575164795, 'init_value': 31.87690544128418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:03.11[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019601345062256, 'time_algorithm_update': 0.005112361907958984, 'loss': 16.057920651316643, 'time_step': 0.007182870388031006, 'init_value': 41.79615020751953}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:03.20[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013225793838501, 'time_algorithm_update': 0.005090791702270508, 'loss': 21.824325478434563, 'time_step': 0.007154022455215454, 'init_value': 51.24165725708008}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:03.28[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015793323516846, 'time_algorithm_update': 0.005113136529922485, 'loss': 30.8265443110466, 'time_step': 0.007179435253143311, 'init_value': 59.15119171142578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:03.37[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030478000640869, 'time_algorithm_update': 0.005157689571380616, 'loss': 33.505355475902554, 'time_step': 0.007239174127578735, 'init_value': 65.10557556152344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:03.45[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043513059616089, 'time_algorithm_update': 0.005192057132720947, 'loss': 36.24112861740589, 'time_step': 0.007287454605102539, 'init_value': 71.45472717285156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:03.54[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020386834144592286, 'time_algorithm_update': 0.005183032512664795, 'loss': 43.72799742245674, 'time_step': 0.00727363109588623, 'init_value': 77.11502838134766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:04.03[0m [[32m[1minfo     [0m] [1mFQE_20250505190237: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032045841217041, 'time_algorithm_update': 0.005177811622619629, 'loss': 42.34073585605621, 'time_step': 0.0072617862224578856, 'init_value': 83.89991760253906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.89991760253906
avg return on 5 trajectories of agent18: 1056.5717336666667
Episode generator created
[2m2025-05-05 19:04.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:04.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:04.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:04.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:04.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190403[0m
[2m2025-05-05 19:04.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:04.12[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020158612728118897, 'time_algorithm_update': 0.005095776796340943, 'loss': 1.4711113422960043, 'time_step': 0.007163138389587403, 'init_value': 10.036928176879883}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:04.21[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022082805633545, 'time_algorithm_update': 0.005150933027267456, 'loss': 4.398359788030386, 'time_step': 0.0072245757579803465, 'init_value': 20.939958572387695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:04.29[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025269269943237, 'time_algorithm_update': 0.005172083854675293, 'loss': 8.905292446911336, 'time_step': 0.007249137163162231, 'init_value': 30.809980392456055}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:04.38[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020341074466705324, 'time_algorithm_update': 0.005172278165817261, 'loss': 13.174209537923335, 'time_step': 0.007257771492004394, 'init_value': 40.79475021362305}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:04.46[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020207006931304934, 'time_algorithm_update': 0.005170050144195556, 'loss': 21.085725811839104, 'time_step': 0.007242316961288452, 'init_value': 47.32457733154297}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:04.55[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018789768218994, 'time_algorithm_update': 0.005153414964675904, 'loss': 24.781406892180442, 'time_step': 0.007223863124847412, 'init_value': 55.99578094482422}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:05.03[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024500131607056, 'time_algorithm_update': 0.005160815000534057, 'loss': 25.27297587990761, 'time_step': 0.007236924409866333, 'init_value': 62.72689437866211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:05.12[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020155363082885744, 'time_algorithm_update': 0.0051533222198486325, 'loss': 28.212557312726975, 'time_step': 0.007220362663269043, 'init_value': 66.65535736083984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026891231536865, 'time_algorithm_update': 0.005171945095062256, 'loss': 28.578847692966463, 'time_step': 0.007250980138778686, 'init_value': 73.02974700927734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:05.29[0m [[32m[1minfo     [0m] [1mFQE_20250505190403: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022775173187256, 'time_algorithm_update': 0.005163683652877808, 'loss': 31.370781751990318, 'time_step': 0.007238631963729859, 'init_value': 77.19684600830078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.19684600830078
avg return on 5 trajectories of agent19: 910.1266376666666
Episode generator created
[2m2025-05-05 19:05.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:05.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:05.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:05.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:05.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190530[0m
[2m2025-05-05 19:05.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:05.39[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023940086364746, 'time_algorithm_update': 0.005122696161270142, 'loss': 1.500390925809741, 'time_step': 0.007197900533676148, 'init_value': 10.277237892150879}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:05.47[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029930591583252, 'time_algorithm_update': 0.005175153017044068, 'loss': 4.445331759214401, 'time_step': 0.007257333040237427, 'init_value': 20.23455238342285}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:05.56[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00201949405670166, 'time_algorithm_update': 0.005167897701263428, 'loss': 8.712788397729398, 'time_step': 0.007238517284393311, 'init_value': 30.33820152282715}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:06.04[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030190467834473, 'time_algorithm_update': 0.005195024967193603, 'loss': 14.462173304200173, 'time_step': 0.007276877403259278, 'init_value': 40.1188850402832}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:06.13[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020686149597168, 'time_algorithm_update': 0.005193418025970459, 'loss': 18.757701242089272, 'time_step': 0.007266257047653198, 'init_value': 48.365909576416016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:06.22[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020228843688964845, 'time_algorithm_update': 0.005169299602508545, 'loss': 22.28647426700592, 'time_step': 0.007243664026260376, 'init_value': 55.588096618652344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:06.30[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020302221775054933, 'time_algorithm_update': 0.005174581527709961, 'loss': 25.181292372584345, 'time_step': 0.0072570924758911136, 'init_value': 62.748600006103516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:06.39[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028744697570801, 'time_algorithm_update': 0.005188790082931519, 'loss': 26.30188905405998, 'time_step': 0.00726985764503479, 'init_value': 69.19637298583984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:06.47[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020229156017303467, 'time_algorithm_update': 0.0051729576587677, 'loss': 26.478771877646444, 'time_step': 0.007247533559799194, 'init_value': 74.62992858886719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:06.56[0m [[32m[1minfo     [0m] [1mFQE_20250505190530: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020309910774230955, 'time_algorithm_update': 0.005185798645019531, 'loss': 32.543204302072525, 'time_step': 0.007268583536148072, 'init_value': 80.95807647705078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.95807647705078
ave advantage rew: 79.29789085388184, std: 3.3872623808139206
avg cum rews: 1108.4775218666668, std: 139.30915864321543
Pearson correlation coefficient: -0.08284058989980571
Spearman correlation coefficient: -0.28721804511278193
Kendall Tau correlation coefficient: -0.15789473684210525
the best agent: 10, best agent cum rewards: 1077.4528286666666
1960
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.018334909431198976
avg return on 5 trajectories of agent0: 1121.2595476666668
Episode generator created
[2m2025-05-05 19:07.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:07.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:07.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:07.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:07.07[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190707[0m
[2m2025-05-05 19:07.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:07.15[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020183162689208986, 'time_algorithm_update': 0.0051213142871856685, 'loss': 1.3967172960489989, 'time_step': 0.007190602540969849, 'init_value': 11.112164497375488}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:07.24[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020277259349822997, 'time_algorithm_update': 0.005167012214660645, 'loss': 3.628580559939146, 'time_step': 0.007246082305908203, 'init_value': 21.3161678314209}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:07.33[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357694625854493, 'time_algorithm_update': 0.005180087566375733, 'loss': 8.42766958105564, 'time_step': 0.007267314195632935, 'init_value': 30.610315322875977}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:07.41[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020260980129241943, 'time_algorithm_update': 0.005180431365966797, 'loss': 11.540657868444919, 'time_step': 0.007258198976516724, 'init_value': 39.232444763183594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:07.50[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028486967086792, 'time_algorithm_update': 0.00518063759803772, 'loss': 15.40322229450941, 'time_step': 0.0072625987529754635, 'init_value': 45.9210205078125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:07.58[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046766757965088, 'time_algorithm_update': 0.005217546701431274, 'loss': 20.04651257801056, 'time_step': 0.007316766023635865, 'init_value': 53.41330337524414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:08.07[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020541131496429445, 'time_algorithm_update': 0.0052167997360229494, 'loss': 21.486557908296586, 'time_step': 0.007323546409606934, 'init_value': 58.74559783935547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:08.16[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033591032028198, 'time_algorithm_update': 0.005197260856628418, 'loss': 23.921485033750535, 'time_step': 0.007282872438430786, 'init_value': 66.33600616455078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:08.24[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017164707183838, 'time_algorithm_update': 0.005152868032455444, 'loss': 26.465343351960183, 'time_step': 0.007221013307571411, 'init_value': 72.21669006347656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:08.33[0m [[32m[1minfo     [0m] [1mFQE_20250505190707: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039177656173706, 'time_algorithm_update': 0.005191157579421997, 'loss': 28.67762492251396, 'time_step': 0.007282542943954468, 'init_value': 78.23374938964844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.23374938964844
avg return on 5 trajectories of agent1: 1055.1370883333332
Episode generator created
[2m2025-05-05 19:08.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:08.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:08.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:08.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:08.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190834[0m
[2m2025-05-05 19:08.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:08.43[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020282640457153322, 'time_algorithm_update': 0.00512717866897583, 'loss': 1.464690562725067, 'time_step': 0.007205669641494751, 'init_value': 9.168898582458496}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033564329147339, 'time_algorithm_update': 0.005208114862442017, 'loss': 4.200165402710438, 'time_step': 0.007293515682220459, 'init_value': 18.565454483032227}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:09.00[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042133331298828, 'time_algorithm_update': 0.005220027208328247, 'loss': 8.78123605954647, 'time_step': 0.0073136756420135495, 'init_value': 28.759201049804688}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:09.08[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020341598987579346, 'time_algorithm_update': 0.005234848976135254, 'loss': 13.917106552004814, 'time_step': 0.007320354461669922, 'init_value': 37.23806381225586}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:09.17[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357260704040527, 'time_algorithm_update': 0.005216096639633179, 'loss': 16.76866257083416, 'time_step': 0.007303221940994263, 'init_value': 44.68259811401367}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:09.26[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203029465675354, 'time_algorithm_update': 0.005217262268066406, 'loss': 23.736651775479316, 'time_step': 0.007299089193344116, 'init_value': 50.92232894897461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:09.34[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020373558998107912, 'time_algorithm_update': 0.005220942258834839, 'loss': 25.976470298051833, 'time_step': 0.007309875965118408, 'init_value': 57.467411041259766}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:09.43[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020365006923675536, 'time_algorithm_update': 0.005219713687896728, 'loss': 26.707239955186843, 'time_step': 0.007307820558547974, 'init_value': 64.08615112304688}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:09.52[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339975357055663, 'time_algorithm_update': 0.005221333503723145, 'loss': 31.288873812556268, 'time_step': 0.007307338237762451, 'init_value': 69.04652404785156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:10.00[0m [[32m[1minfo     [0m] [1mFQE_20250505190834: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020214283466339113, 'time_algorithm_update': 0.0051792490482330325, 'loss': 32.182406128883365, 'time_step': 0.007252077341079712, 'init_value': 74.71727752685547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.71727752685547
avg return on 5 trajectories of agent2: 1211.6163433333334
Episode generator created
[2m2025-05-05 19:10.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:10.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:10.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:10.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:10.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191001[0m
[2m2025-05-05 19:10.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:10.10[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023848295211792, 'time_algorithm_update': 0.00511956000328064, 'loss': 1.3847762957066299, 'time_step': 0.007194756269454956, 'init_value': 10.562939643859863}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:10.18[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020245890617370606, 'time_algorithm_update': 0.005168007135391235, 'loss': 4.073696113228798, 'time_step': 0.007243762016296387, 'init_value': 20.893386840820312}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:10.27[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020371432304382322, 'time_algorithm_update': 0.005185795783996582, 'loss': 8.01146002960205, 'time_step': 0.0072747600078582764, 'init_value': 30.614347457885742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:10.36[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020337984561920167, 'time_algorithm_update': 0.005194187879562378, 'loss': 10.532804908156395, 'time_step': 0.007280152082443237, 'init_value': 40.25419998168945}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:10.44[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026192665100098, 'time_algorithm_update': 0.005181851148605346, 'loss': 15.926515179395675, 'time_step': 0.007259690046310425, 'init_value': 47.863311767578125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:10.53[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020364036560058594, 'time_algorithm_update': 0.005188141584396362, 'loss': 18.76904279887676, 'time_step': 0.007276148080825806, 'init_value': 53.489280700683594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:11.02[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020341753959655763, 'time_algorithm_update': 0.005197129726409912, 'loss': 21.29849561560154, 'time_step': 0.00728326678276062, 'init_value': 61.154937744140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:11.10[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020363588333129883, 'time_algorithm_update': 0.005207280158996582, 'loss': 27.423790145277977, 'time_step': 0.007295843362808228, 'init_value': 66.42298126220703}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:11.19[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020283305644989012, 'time_algorithm_update': 0.00517954158782959, 'loss': 24.675793481588364, 'time_step': 0.0072598917484283446, 'init_value': 73.85729217529297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:11.27[0m [[32m[1minfo     [0m] [1mFQE_20250505191001: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049134254455566, 'time_algorithm_update': 0.005213786602020263, 'loss': 31.009919047117233, 'time_step': 0.007315448999404907, 'init_value': 78.97064208984375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.97064208984375
avg return on 5 trajectories of agent3: 2453.492384333333
Episode generator created
[2m2025-05-05 19:11.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:11.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:11.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:11.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:11.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191129[0m
[2m2025-05-05 19:11.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:11.38[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032148599624634, 'time_algorithm_update': 0.005157027244567871, 'loss': 1.4538772586137056, 'time_step': 0.007239983797073364, 'init_value': 10.595105171203613}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:11.47[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020271551609039305, 'time_algorithm_update': 0.005177049398422241, 'loss': 4.157759855657816, 'time_step': 0.007255632877349854, 'init_value': 20.68726348876953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:11.55[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034926176071167, 'time_algorithm_update': 0.0051825234889984135, 'loss': 7.496357828915119, 'time_step': 0.007268898963928223, 'init_value': 30.496925354003906}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:12.04[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025974750518799, 'time_algorithm_update': 0.00518456745147705, 'loss': 11.861192092597484, 'time_step': 0.007262025594711304, 'init_value': 39.16580581665039}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:12.12[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020225043296813964, 'time_algorithm_update': 0.005170452356338501, 'loss': 15.01645265853405, 'time_step': 0.007244155406951904, 'init_value': 48.06278610229492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:12.21[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020302646160125734, 'time_algorithm_update': 0.00516890549659729, 'loss': 18.733802127838135, 'time_step': 0.007251060247421265, 'init_value': 53.678863525390625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:12.30[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028111219406128, 'time_algorithm_update': 0.005190823554992676, 'loss': 19.789567180633544, 'time_step': 0.007270957946777344, 'init_value': 61.41217041015625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:12.38[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037231683731079, 'time_algorithm_update': 0.00519244384765625, 'loss': 19.790059243083, 'time_step': 0.007281729459762573, 'init_value': 68.88597106933594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:12.47[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020318667888641357, 'time_algorithm_update': 0.0051775269508361815, 'loss': 25.363731686353685, 'time_step': 0.007260777473449707, 'init_value': 74.85972595214844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:12.55[0m [[32m[1minfo     [0m] [1mFQE_20250505191129: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029652118682861, 'time_algorithm_update': 0.005184002637863159, 'loss': 29.00460825443268, 'time_step': 0.007265844345092773, 'init_value': 78.73323059082031}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.73323059082031
avg return on 5 trajectories of agent4: 1075.0654853333335
Episode generator created
[2m2025-05-05 19:12.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:12.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:12.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:12.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:12.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191256[0m
[2m2025-05-05 19:12.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:13.05[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022771120071411, 'time_algorithm_update': 0.0051118323802948, 'loss': 1.4933033818602561, 'time_step': 0.007185102701187134, 'init_value': 10.170238494873047}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:13.13[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978382110595703, 'time_algorithm_update': 0.005047113418579102, 'loss': 4.451526518821717, 'time_step': 0.0070748450756073, 'init_value': 20.110769271850586}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:13.22[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007701873779297, 'time_algorithm_update': 0.0050961172580719, 'loss': 8.464195244550705, 'time_step': 0.007154302358627319, 'init_value': 29.57672119140625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:13.30[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004388332366943, 'time_algorithm_update': 0.005092440128326416, 'loss': 11.843351564526557, 'time_step': 0.007147260904312134, 'init_value': 39.366092681884766}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:13.39[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020048909187316893, 'time_algorithm_update': 0.0050862419605255125, 'loss': 15.622911071419717, 'time_step': 0.007141547441482544, 'init_value': 48.002567291259766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:13.47[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200943922996521, 'time_algorithm_update': 0.005093566179275513, 'loss': 17.786333092451095, 'time_step': 0.007153669118881226, 'init_value': 55.90613555908203}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:13.56[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020132946968078615, 'time_algorithm_update': 0.0051056380271911625, 'loss': 21.528523211956024, 'time_step': 0.007169372081756592, 'init_value': 62.61275100708008}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:14.04[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034585475921631, 'time_algorithm_update': 0.005173838376998902, 'loss': 24.61738207936287, 'time_step': 0.007259809494018555, 'init_value': 69.9634780883789}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:14.13[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339272022247314, 'time_algorithm_update': 0.005170943975448608, 'loss': 27.284727301359176, 'time_step': 0.007256858110427857, 'init_value': 75.86442565917969}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:14.21[0m [[32m[1minfo     [0m] [1mFQE_20250505191256: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020280897617340086, 'time_algorithm_update': 0.005163093328475952, 'loss': 31.576379418611527, 'time_step': 0.007243033170700073, 'init_value': 80.73954772949219}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.73954772949219
avg return on 5 trajectories of agent5: 1086.3171966666669
Episode generator created
[2m2025-05-05 19:14.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:14.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:14.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:14.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:14.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191422[0m
[2m2025-05-05 19:14.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:14.31[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020160295963287354, 'time_algorithm_update': 0.005110941171646118, 'loss': 1.5517205197513104, 'time_step': 0.007177205801010132, 'init_value': 10.105700492858887}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:14.40[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020270042419433592, 'time_algorithm_update': 0.005161315441131592, 'loss': 4.24051869097352, 'time_step': 0.007239052057266235, 'init_value': 20.612516403198242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:14.48[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020133593082427978, 'time_algorithm_update': 0.0051433279514312745, 'loss': 10.391082427442074, 'time_step': 0.007206965923309326, 'init_value': 30.67452049255371}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:14.57[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021711826324463, 'time_algorithm_update': 0.00515861964225769, 'loss': 13.794151402115823, 'time_step': 0.007231452941894531, 'init_value': 39.679840087890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:15.05[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020581400394439698, 'time_algorithm_update': 0.005256543636322022, 'loss': 20.84225121617317, 'time_step': 0.007367270469665527, 'init_value': 49.327735900878906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:15.14[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020385496616363527, 'time_algorithm_update': 0.005195987224578857, 'loss': 23.96945249211788, 'time_step': 0.007286303758621216, 'init_value': 55.98779296875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:15.23[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020280466079711915, 'time_algorithm_update': 0.0051718239784240725, 'loss': 29.1100503629446, 'time_step': 0.007251244068145752, 'init_value': 64.03800201416016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:15.31[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037003755569458, 'time_algorithm_update': 0.005185947895050049, 'loss': 34.5362699701786, 'time_step': 0.00727443265914917, 'init_value': 70.93646240234375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:15.40[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020457699298858643, 'time_algorithm_update': 0.005183965921401978, 'loss': 38.02222843265533, 'time_step': 0.007281688928604126, 'init_value': 76.99783325195312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mFQE_20250505191422: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020409090518951414, 'time_algorithm_update': 0.0051925630569458, 'loss': 40.6916342856884, 'time_step': 0.007285672903060913, 'init_value': 80.77503204345703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.77503204345703
avg return on 5 trajectories of agent6: 1141.3407556666668
Episode generator created
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:15.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:15.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191549[0m
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:15.58[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020261306762695314, 'time_algorithm_update': 0.005120766401290893, 'loss': 1.4966290851682424, 'time_step': 0.0071980469226837155, 'init_value': 10.450746536254883}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:16.07[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020327384471893312, 'time_algorithm_update': 0.005165954828262329, 'loss': 4.020104066669941, 'time_step': 0.007250049114227295, 'init_value': 20.64002227783203}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:16.15[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034000635147095, 'time_algorithm_update': 0.005162444353103638, 'loss': 8.400934378564358, 'time_step': 0.007247934103012085, 'init_value': 31.17258071899414}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:16.24[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020075623989105223, 'time_algorithm_update': 0.005118367195129395, 'loss': 12.751770011007785, 'time_step': 0.007176289558410645, 'init_value': 39.675716400146484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:16.32[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044536828994751, 'time_algorithm_update': 0.005171839952468872, 'loss': 16.511124915599822, 'time_step': 0.007268467664718628, 'init_value': 47.191627502441406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:16.41[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038102388381958, 'time_algorithm_update': 0.005168114185333252, 'loss': 20.48269766318798, 'time_step': 0.007257688760757447, 'init_value': 53.679840087890625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:16.49[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020217463970184325, 'time_algorithm_update': 0.0051627447605133055, 'loss': 25.979818775177, 'time_step': 0.007235977172851562, 'init_value': 59.788726806640625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:16.58[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351314544677732, 'time_algorithm_update': 0.005165478467941284, 'loss': 23.906573620796202, 'time_step': 0.007252074956893921, 'init_value': 66.576904296875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:17.07[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042187213897705, 'time_algorithm_update': 0.0051747064590454105, 'loss': 28.247579326629637, 'time_step': 0.0072686710357666015, 'init_value': 72.83455657958984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:17.15[0m [[32m[1minfo     [0m] [1mFQE_20250505191549: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451903343200683, 'time_algorithm_update': 0.00518929672241211, 'loss': 30.865945902585985, 'time_step': 0.007286856174468994, 'init_value': 79.12555694580078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.12555694580078
avg return on 5 trajectories of agent7: 1254.3646843333333
Episode generator created
[2m2025-05-05 19:17.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:17.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:17.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:17.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:17.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191716[0m
[2m2025-05-05 19:17.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:17.25[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020306050777435304, 'time_algorithm_update': 0.00513167929649353, 'loss': 1.510006868302822, 'time_step': 0.007212826490402222, 'init_value': 9.721397399902344}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:17.34[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035165071487427, 'time_algorithm_update': 0.005208792686462402, 'loss': 4.012031210631132, 'time_step': 0.007295721769332885, 'init_value': 18.855758666992188}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:17.42[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020379016399383544, 'time_algorithm_update': 0.005205350160598755, 'loss': 8.17053918594122, 'time_step': 0.007294949769973755, 'init_value': 28.900028228759766}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:17.51[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020329473018646242, 'time_algorithm_update': 0.005195154905319214, 'loss': 13.778829946994781, 'time_step': 0.007280045986175537, 'init_value': 38.18956756591797}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:17.59[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015181541442871, 'time_algorithm_update': 0.005162877559661865, 'loss': 16.328680140018463, 'time_step': 0.0072288143634796145, 'init_value': 44.72049331665039}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:18.08[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020397789478302, 'time_algorithm_update': 0.005198076725006103, 'loss': 19.435612316370012, 'time_step': 0.007289608478546142, 'init_value': 51.95285415649414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:18.17[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312507152557375, 'time_algorithm_update': 0.005182262182235718, 'loss': 26.005570258021354, 'time_step': 0.007265276193618774, 'init_value': 56.79646682739258}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:18.25[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020377824306488036, 'time_algorithm_update': 0.005195113897323608, 'loss': 28.824205078959466, 'time_step': 0.007284656047821045, 'init_value': 62.74060821533203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:18.34[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206081748008728, 'time_algorithm_update': 0.005222986221313477, 'loss': 30.174371621370316, 'time_step': 0.007336162328720093, 'init_value': 66.75714111328125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:18.43[0m [[32m[1minfo     [0m] [1mFQE_20250505191716: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035186290740967, 'time_algorithm_update': 0.00518911600112915, 'loss': 32.19226870918274, 'time_step': 0.007276118278503418, 'init_value': 71.79720306396484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 71.79720306396484
avg return on 5 trajectories of agent8: 1068.8772436666666
Episode generator created
[2m2025-05-05 19:18.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:18.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:18.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:18.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:18.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191844[0m
[2m2025-05-05 19:18.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:18.52[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021193027496338, 'time_algorithm_update': 0.005132725954055786, 'loss': 1.4791313158273698, 'time_step': 0.007204959630966187, 'init_value': 10.028685569763184}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:19.01[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020317842960357667, 'time_algorithm_update': 0.005199494123458862, 'loss': 3.87011853736639, 'time_step': 0.007282323837280273, 'init_value': 20.288225173950195}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:19.09[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036789417266846, 'time_algorithm_update': 0.005208370447158814, 'loss': 8.04567064332962, 'time_step': 0.007296556234359741, 'init_value': 29.86067771911621}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:19.18[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032944917678833, 'time_algorithm_update': 0.0052018570899963375, 'loss': 12.355779000163079, 'time_step': 0.007286171674728394, 'init_value': 38.43029022216797}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:19.27[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042317867279053, 'time_algorithm_update': 0.005218461036682129, 'loss': 16.21226285982132, 'time_step': 0.00731206488609314, 'init_value': 47.12750244140625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:19.35[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020323679447174074, 'time_algorithm_update': 0.005190388679504394, 'loss': 18.67696471500397, 'time_step': 0.007273797035217285, 'init_value': 54.79684066772461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:19.44[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034696340560913, 'time_algorithm_update': 0.0052158253192901615, 'loss': 20.622149630665778, 'time_step': 0.007302122354507446, 'init_value': 62.402198791503906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:19.53[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372090339660647, 'time_algorithm_update': 0.005230428218841553, 'loss': 24.433666457414628, 'time_step': 0.007319824934005737, 'init_value': 69.09518432617188}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:20.01[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020384163856506346, 'time_algorithm_update': 0.005227186441421509, 'loss': 27.292959334373474, 'time_step': 0.0073176841735839845, 'init_value': 75.87044525146484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:20.10[0m [[32m[1minfo     [0m] [1mFQE_20250505191844: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020360519886016845, 'time_algorithm_update': 0.005220458984375, 'loss': 31.26471783566475, 'time_step': 0.0073087050914764405, 'init_value': 80.60401916503906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.60401916503906
avg return on 5 trajectories of agent9: 1067.923605
Episode generator created
[2m2025-05-05 19:20.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:20.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:20.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:20.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:20.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192011[0m
[2m2025-05-05 19:20.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:20.19[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020182604789733887, 'time_algorithm_update': 0.005112246036529541, 'loss': 1.4988416899591683, 'time_step': 0.007180742025375366, 'init_value': 9.341510772705078}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:20.28[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344223976135256, 'time_algorithm_update': 0.005177586078643799, 'loss': 4.243530308902264, 'time_step': 0.007263191223144531, 'init_value': 18.73039436340332}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:20.37[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203423810005188, 'time_algorithm_update': 0.005158668756484986, 'loss': 7.993171500444412, 'time_step': 0.007243947505950928, 'init_value': 28.64093589782715}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:20.45[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020317602157592773, 'time_algorithm_update': 0.005164863586425782, 'loss': 12.363204456686974, 'time_step': 0.007247828483581543, 'init_value': 36.75707244873047}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:20.54[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020334193706512452, 'time_algorithm_update': 0.005168685913085938, 'loss': 19.311738844275474, 'time_step': 0.007253337860107422, 'init_value': 45.21445083618164}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:21.02[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038153648376465, 'time_algorithm_update': 0.005160675048828125, 'loss': 24.703862788915636, 'time_step': 0.007249933958053589, 'init_value': 51.136783599853516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:21.11[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020454976558685303, 'time_algorithm_update': 0.005180751323699951, 'loss': 24.488162773132323, 'time_step': 0.007278378963470459, 'init_value': 58.998687744140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:21.20[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056107997894287, 'time_algorithm_update': 0.005220803022384643, 'loss': 28.83916621494293, 'time_step': 0.007329214811325074, 'init_value': 65.37452697753906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:21.28[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028760194778442, 'time_algorithm_update': 0.005168439388275147, 'loss': 31.720527894735337, 'time_step': 0.007248666524887085, 'init_value': 71.49808502197266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:21.37[0m [[32m[1minfo     [0m] [1mFQE_20250505192011: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020301525592803953, 'time_algorithm_update': 0.005156511306762695, 'loss': 36.83916854405403, 'time_step': 0.007237954378128052, 'init_value': 76.2745361328125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.2745361328125
avg return on 5 trajectories of agent10: 859.5098549999999
Episode generator created
[2m2025-05-05 19:21.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:21.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:21.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:21.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:21.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192138[0m
[2m2025-05-05 19:21.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:21.46[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227386951446533, 'time_algorithm_update': 0.005102168321609497, 'loss': 1.440080749347806, 'time_step': 0.007175436496734619, 'init_value': 10.258819580078125}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:21.55[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020423359870910644, 'time_algorithm_update': 0.005196738719940186, 'loss': 4.240746411114931, 'time_step': 0.007292103290557861, 'init_value': 20.114276885986328}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:22.03[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020563590526580812, 'time_algorithm_update': 0.005242830276489258, 'loss': 8.916464646160602, 'time_step': 0.007352221727371216, 'init_value': 29.579450607299805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:22.12[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020415470600128175, 'time_algorithm_update': 0.005190216064453125, 'loss': 13.865602522075177, 'time_step': 0.007283734560012817, 'init_value': 39.65153503417969}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:22.21[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353116989135743, 'time_algorithm_update': 0.005183341264724731, 'loss': 19.787887581348418, 'time_step': 0.007270531892776489, 'init_value': 48.462825775146484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:22.29[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043936014175415, 'time_algorithm_update': 0.005179773330688477, 'loss': 23.89427311050892, 'time_step': 0.007275681972503662, 'init_value': 56.472679138183594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:22.38[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020366034507751465, 'time_algorithm_update': 0.005172920703887939, 'loss': 27.520016892910004, 'time_step': 0.007261710405349731, 'init_value': 63.237937927246094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:22.47[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037506341934204, 'time_algorithm_update': 0.0051846463680267334, 'loss': 32.243578001737596, 'time_step': 0.007274304151535034, 'init_value': 68.12620544433594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:22.55[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204657769203186, 'time_algorithm_update': 0.0051941688060760495, 'loss': 34.813938139915464, 'time_step': 0.007292891025543213, 'init_value': 73.29468536376953}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:23.04[0m [[32m[1minfo     [0m] [1mFQE_20250505192138: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020167651176452635, 'time_algorithm_update': 0.005140928983688354, 'loss': 38.08395361661911, 'time_step': 0.007208425760269165, 'init_value': 77.72235107421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.72235107421875
avg return on 5 trajectories of agent11: 879.8939616666667
Episode generator created
[2m2025-05-05 19:23.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:23.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:23.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:23.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:23.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192305[0m
[2m2025-05-05 19:23.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:23.13[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202595591545105, 'time_algorithm_update': 0.0051200523376464845, 'loss': 1.4872507275640965, 'time_step': 0.0071973235607147214, 'init_value': 10.458888053894043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:23.22[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020261552333831786, 'time_algorithm_update': 0.005148364067077637, 'loss': 4.230055005222559, 'time_step': 0.007225844621658325, 'init_value': 20.414037704467773}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:23.30[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017458200454712, 'time_algorithm_update': 0.005139355659484863, 'loss': 8.615414095401764, 'time_step': 0.007208135843276978, 'init_value': 31.009994506835938}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:23.39[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020116982460021975, 'time_algorithm_update': 0.0050840086936950685, 'loss': 14.664646522223949, 'time_step': 0.007146332502365112, 'init_value': 41.197547912597656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:23.47[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020092127323150634, 'time_algorithm_update': 0.00509039831161499, 'loss': 18.99857130730152, 'time_step': 0.007149930238723755, 'init_value': 49.51301574707031}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:23.56[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015449523925781, 'time_algorithm_update': 0.005090245485305786, 'loss': 24.341271162390708, 'time_step': 0.0071563198566436765, 'init_value': 57.97249984741211}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:24.04[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202315616607666, 'time_algorithm_update': 0.005101128816604615, 'loss': 26.38926303434372, 'time_step': 0.007175153970718383, 'init_value': 65.64875793457031}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:24.13[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020214502811431883, 'time_algorithm_update': 0.00510317587852478, 'loss': 30.489214430332183, 'time_step': 0.007175328016281128, 'init_value': 72.23948669433594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:24.21[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032343864440918, 'time_algorithm_update': 0.005148304462432861, 'loss': 30.310142202615737, 'time_step': 0.007232134580612183, 'init_value': 77.0309829711914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:24.30[0m [[32m[1minfo     [0m] [1mFQE_20250505192305: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020403435230255127, 'time_algorithm_update': 0.005164589881896973, 'loss': 32.09818096446991, 'time_step': 0.0072568321228027345, 'init_value': 82.26483154296875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.26483154296875
avg return on 5 trajectories of agent12: 1072.8138493333333
Episode generator created
[2m2025-05-05 19:24.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:24.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:24.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:24.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:24.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192431[0m
[2m2025-05-05 19:24.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:24.39[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004443407058716, 'time_algorithm_update': 0.005076288223266601, 'loss': 1.4454582931548356, 'time_step': 0.0071306126117706295, 'init_value': 9.668110847473145}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:24.48[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020294828414916992, 'time_algorithm_update': 0.0051679153442382815, 'loss': 4.0889072373509405, 'time_step': 0.007248715877532959, 'init_value': 19.146638870239258}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:24.56[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203423810005188, 'time_algorithm_update': 0.005183321237564087, 'loss': 8.335624974310399, 'time_step': 0.007269288063049316, 'init_value': 27.340415954589844}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:25.05[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036495923995972, 'time_algorithm_update': 0.005176600217819214, 'loss': 10.97232176476717, 'time_step': 0.007264567613601685, 'init_value': 36.21766662597656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:25.14[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020298922061920167, 'time_algorithm_update': 0.0051743507385253905, 'loss': 16.196488832116128, 'time_step': 0.007256115198135376, 'init_value': 44.793968200683594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:25.22[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020298314094543456, 'time_algorithm_update': 0.005164271116256714, 'loss': 19.94459920680523, 'time_step': 0.007245697975158691, 'init_value': 52.592350006103516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:25.31[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020488059520721437, 'time_algorithm_update': 0.005226304292678833, 'loss': 23.63663993358612, 'time_step': 0.007327243328094483, 'init_value': 60.13900375366211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:25.39[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020515522956848146, 'time_algorithm_update': 0.005223141193389892, 'loss': 25.355996667146684, 'time_step': 0.007326901197433472, 'init_value': 65.76946258544922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:25.48[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020291643142700197, 'time_algorithm_update': 0.005172237396240235, 'loss': 28.23988511180878, 'time_step': 0.00725339388847351, 'init_value': 72.98194885253906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:25.57[0m [[32m[1minfo     [0m] [1mFQE_20250505192431: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339574813842774, 'time_algorithm_update': 0.005184537887573242, 'loss': 28.86035743880272, 'time_step': 0.007270675182342529, 'init_value': 78.826904296875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.826904296875
avg return on 5 trajectories of agent13: 1072.7708753333334
Episode generator created
[2m2025-05-05 19:25.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:25.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:25.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:25.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:25.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192558[0m
[2m2025-05-05 19:25.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:26.06[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017808437347412, 'time_algorithm_update': 0.005112906455993652, 'loss': 1.383844295307994, 'time_step': 0.007181589603424072, 'init_value': 10.244842529296875}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:26.15[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008697748184204, 'time_algorithm_update': 0.005109906196594238, 'loss': 4.509104259848595, 'time_step': 0.00716907262802124, 'init_value': 20.6147403717041}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:26.23[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020277628898620606, 'time_algorithm_update': 0.005157741546630859, 'loss': 8.008957902312279, 'time_step': 0.007236727952957153, 'init_value': 30.79747200012207}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:26.32[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042496204376221, 'time_algorithm_update': 0.005164074420928955, 'loss': 13.36470873785019, 'time_step': 0.007258438348770142, 'init_value': 39.282249450683594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:26.40[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023160696029663, 'time_algorithm_update': 0.005135637521743774, 'loss': 17.126085553884508, 'time_step': 0.007210230350494385, 'init_value': 46.94065856933594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:26.49[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020307114124298096, 'time_algorithm_update': 0.005150677680969239, 'loss': 22.711110145688057, 'time_step': 0.007233145236968994, 'init_value': 55.163761138916016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:26.57[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020355238914489746, 'time_algorithm_update': 0.005161482334136963, 'loss': 27.29518355321884, 'time_step': 0.0072487866878509525, 'init_value': 60.57060241699219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:27.06[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020328547954559326, 'time_algorithm_update': 0.005152151346206665, 'loss': 30.167401982665062, 'time_step': 0.007236281156539917, 'init_value': 65.08290100097656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:27.15[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034414768218994, 'time_algorithm_update': 0.0051513612270355225, 'loss': 29.03594209706783, 'time_step': 0.007237513780593872, 'init_value': 70.60494995117188}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:27.23[0m [[32m[1minfo     [0m] [1mFQE_20250505192558: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033566951751709, 'time_algorithm_update': 0.005151691675186157, 'loss': 32.83352014446258, 'time_step': 0.0072369172573089596, 'init_value': 76.0255355834961}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.0255355834961
avg return on 5 trajectories of agent14: 1066.1435330000002
Episode generator created
[2m2025-05-05 19:27.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:27.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:27.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:27.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:27.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192724[0m
[2m2025-05-05 19:27.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:27.33[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025962829589844, 'time_algorithm_update': 0.005125680446624756, 'loss': 1.4277944163233043, 'time_step': 0.007202147006988525, 'init_value': 10.95832633972168}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:27.41[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033907175064087, 'time_algorithm_update': 0.005190654993057251, 'loss': 4.260504245638847, 'time_step': 0.007276178598403931, 'init_value': 21.14910316467285}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:27.50[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020276761054992677, 'time_algorithm_update': 0.005163490533828735, 'loss': 8.649620426774025, 'time_step': 0.007242711782455444, 'init_value': 30.93375015258789}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:27.59[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041351795196533, 'time_algorithm_update': 0.005188498258590698, 'loss': 13.12770437258482, 'time_step': 0.007281637191772461, 'init_value': 41.08537673950195}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:28.07[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020317955017089846, 'time_algorithm_update': 0.005184020757675171, 'loss': 17.485374758064747, 'time_step': 0.007267043352127075, 'init_value': 49.69872283935547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:28.16[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046357870101929, 'time_algorithm_update': 0.005182307958602905, 'loss': 23.83107987987995, 'time_step': 0.007280478000640869, 'init_value': 56.88231658935547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:28.24[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041146993637085, 'time_algorithm_update': 0.005181797742843628, 'loss': 23.677993620038034, 'time_step': 0.0072743000984191895, 'init_value': 62.858375549316406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:28.33[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020407943725585936, 'time_algorithm_update': 0.005191883325576782, 'loss': 29.805204337358475, 'time_step': 0.007285689353942871, 'init_value': 69.93365478515625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:28.42[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035416603088379, 'time_algorithm_update': 0.0051722292900085445, 'loss': 29.02730635404587, 'time_step': 0.007259570121765137, 'init_value': 76.12322998046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:28.50[0m [[32m[1minfo     [0m] [1mFQE_20250505192724: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020412466526031495, 'time_algorithm_update': 0.00518463659286499, 'loss': 33.546615712881085, 'time_step': 0.0072777228355407715, 'init_value': 82.57038116455078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.57038116455078
avg return on 5 trajectories of agent15: 1508.722743
Episode generator created
[2m2025-05-05 19:28.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:28.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:28.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:28.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:28.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192852[0m
[2m2025-05-05 19:28.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:29.00[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033559799194336, 'time_algorithm_update': 0.005118938684463501, 'loss': 1.4748964803516864, 'time_step': 0.0072033097743988035, 'init_value': 10.763235092163086}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:29.09[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020516462326049803, 'time_algorithm_update': 0.005213945627212524, 'loss': 4.088944057047367, 'time_step': 0.007318135976791382, 'init_value': 21.399465560913086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:29.17[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049806833267212, 'time_algorithm_update': 0.005184033393859863, 'loss': 9.21355842912197, 'time_step': 0.007286094188690186, 'init_value': 31.514638900756836}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:29.26[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020221128463745117, 'time_algorithm_update': 0.005150118827819824, 'loss': 11.801729029774666, 'time_step': 0.007223981857299805, 'init_value': 42.086647033691406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:29.35[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020292975902557373, 'time_algorithm_update': 0.005176239728927613, 'loss': 17.259397038698197, 'time_step': 0.007257162094116211, 'init_value': 49.443511962890625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:29.43[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020407752990722655, 'time_algorithm_update': 0.005190114259719849, 'loss': 23.215764768600465, 'time_step': 0.007282671213150025, 'init_value': 55.780696868896484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:29.52[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046408176422119, 'time_algorithm_update': 0.0051861171722412105, 'loss': 22.297236806154253, 'time_step': 0.007284971237182617, 'init_value': 63.0962028503418}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:30.01[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020479540824890137, 'time_algorithm_update': 0.005190334320068359, 'loss': 30.23313570380211, 'time_step': 0.007290494441986084, 'init_value': 68.80744934082031}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:30.09[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043666362762451, 'time_algorithm_update': 0.005190273761749267, 'loss': 31.661082699656486, 'time_step': 0.007285860538482666, 'init_value': 72.45227813720703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:30.18[0m [[32m[1minfo     [0m] [1mFQE_20250505192852: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020467123985290527, 'time_algorithm_update': 0.005194057941436767, 'loss': 28.26035076713562, 'time_step': 0.007292879581451416, 'init_value': 76.36153411865234}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.36153411865234
avg return on 5 trajectories of agent16: 1050.2529216666665
Episode generator created
[2m2025-05-05 19:30.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:30.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:30.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:30.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:30.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193019[0m
[2m2025-05-05 19:30.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:30.27[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027330160140991, 'time_algorithm_update': 0.005126141548156739, 'loss': 1.451256408199668, 'time_step': 0.007204389095306397, 'init_value': 10.64062213897705}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:30.36[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037036657333374, 'time_algorithm_update': 0.0051908230781555174, 'loss': 4.045257884293795, 'time_step': 0.007280836343765259, 'init_value': 20.2941837310791}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:30.44[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035252094268799, 'time_algorithm_update': 0.00519831109046936, 'loss': 8.231877335011959, 'time_step': 0.007285506963729859, 'init_value': 29.544294357299805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:30.53[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372536182403566, 'time_algorithm_update': 0.0051980743408203125, 'loss': 13.052729157805443, 'time_step': 0.007286884307861328, 'init_value': 39.38045120239258}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:31.02[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015481948852539, 'time_algorithm_update': 0.005185099363327027, 'loss': 16.120287899494173, 'time_step': 0.00725204849243164, 'init_value': 46.7652702331543}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:31.10[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040306806564331, 'time_algorithm_update': 0.005232122421264649, 'loss': 19.249360543370248, 'time_step': 0.007324492692947388, 'init_value': 53.31871032714844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:31.19[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020383684635162354, 'time_algorithm_update': 0.00520041799545288, 'loss': 23.957630582809447, 'time_step': 0.0072907860279083254, 'init_value': 59.45756149291992}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:31.28[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028745412826538, 'time_algorithm_update': 0.005180584669113159, 'loss': 26.08904111468792, 'time_step': 0.007261070489883423, 'init_value': 64.90576934814453}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:31.36[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374226570129394, 'time_algorithm_update': 0.005199482917785644, 'loss': 29.711965408086776, 'time_step': 0.007288344860076904, 'init_value': 70.26825714111328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:31.45[0m [[32m[1minfo     [0m] [1mFQE_20250505193019: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020262537002563477, 'time_algorithm_update': 0.005196653366088867, 'loss': 28.054243466615677, 'time_step': 0.007274640083312988, 'init_value': 74.90909576416016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.90909576416016
avg return on 5 trajectories of agent17: 1309.6440953333333
Episode generator created
[2m2025-05-05 19:31.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:31.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:31.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:31.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:31.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193146[0m
[2m2025-05-05 19:31.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:31.54[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020150861740112305, 'time_algorithm_update': 0.0051104741096496585, 'loss': 1.4533806434571743, 'time_step': 0.007176115512847901, 'init_value': 9.839322090148926}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:32.03[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024608612060547, 'time_algorithm_update': 0.005149643182754517, 'loss': 4.518659214675426, 'time_step': 0.007225928068161011, 'init_value': 19.47473907470703}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:32.12[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020274658203125, 'time_algorithm_update': 0.005151019096374511, 'loss': 9.223333023905754, 'time_step': 0.007230604887008667, 'init_value': 28.515869140625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:32.20[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020286471843719484, 'time_algorithm_update': 0.0051444871425628666, 'loss': 13.913438514471054, 'time_step': 0.007224851131439209, 'init_value': 37.04633712768555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:32.29[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032848834991455, 'time_algorithm_update': 0.005163163661956787, 'loss': 19.232876585245133, 'time_step': 0.0072478454113006595, 'init_value': 44.00853729248047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:32.37[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024019002914429, 'time_algorithm_update': 0.005123038530349731, 'loss': 23.54401592862606, 'time_step': 0.007198395729064941, 'init_value': 53.543704986572266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:32.46[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034799575805664, 'time_algorithm_update': 0.005143935918807983, 'loss': 28.094964873075487, 'time_step': 0.007230740308761596, 'init_value': 61.15684127807617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:32.54[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026849031448364, 'time_algorithm_update': 0.005135802984237671, 'loss': 31.962092841863633, 'time_step': 0.007214013338088989, 'init_value': 67.35222625732422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:33.03[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020302793979644776, 'time_algorithm_update': 0.005143798828125, 'loss': 34.06181133210659, 'time_step': 0.007226983070373535, 'init_value': 71.36317443847656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:33.12[0m [[32m[1minfo     [0m] [1mFQE_20250505193146: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203055214881897, 'time_algorithm_update': 0.005138479471206665, 'loss': 36.51799997055531, 'time_step': 0.007220616579055786, 'init_value': 75.93577575683594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.93577575683594
avg return on 5 trajectories of agent18: 1580.6991420000002
Episode generator created
[2m2025-05-05 19:33.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:33.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:33.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:33.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:33.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193313[0m
[2m2025-05-05 19:33.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:33.21[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020168163776397704, 'time_algorithm_update': 0.005104582786560058, 'loss': 1.4706023695021868, 'time_step': 0.007171878576278687, 'init_value': 10.928202629089355}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:33.30[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020264844894409178, 'time_algorithm_update': 0.005171298027038574, 'loss': 4.1257599276006225, 'time_step': 0.00724871301651001, 'init_value': 21.23243522644043}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:33.39[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020346946716308595, 'time_algorithm_update': 0.005180404186248779, 'loss': 8.751621943831443, 'time_step': 0.0072664875984191895, 'init_value': 31.248409271240234}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:33.47[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038142442703247, 'time_algorithm_update': 0.00517479395866394, 'loss': 14.324158606231213, 'time_step': 0.007264458656311036, 'init_value': 40.368404388427734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:33.56[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003054141998291, 'time_algorithm_update': 0.005104206085205078, 'loss': 19.52379478621483, 'time_step': 0.007157687425613403, 'init_value': 47.284934997558594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:34.04[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007941722869873, 'time_algorithm_update': 0.005101300477981567, 'loss': 23.3642134026289, 'time_step': 0.007159531116485596, 'init_value': 55.11126708984375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:34.13[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019828078746795654, 'time_algorithm_update': 0.00504568362236023, 'loss': 22.117919855833055, 'time_step': 0.007078194618225097, 'init_value': 61.93138885498047}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:34.21[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020170786380767822, 'time_algorithm_update': 0.005098788976669311, 'loss': 28.48458930015564, 'time_step': 0.007166165351867676, 'init_value': 66.78827667236328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:34.30[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002012187719345093, 'time_algorithm_update': 0.0050945191383361815, 'loss': 28.52481360256672, 'time_step': 0.0071570613384246825, 'init_value': 72.70411682128906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:34.38[0m [[32m[1minfo     [0m] [1mFQE_20250505193313: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020184404850006102, 'time_algorithm_update': 0.005121806383132935, 'loss': 30.936926229834558, 'time_step': 0.007190876722335816, 'init_value': 76.4083023071289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.4083023071289
avg return on 5 trajectories of agent19: 2640.2337206666666
Episode generator created
[2m2025-05-05 19:34.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:34.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:34.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:34.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:34.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193440[0m
[2m2025-05-05 19:34.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:34.49[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013387441635132, 'time_algorithm_update': 0.005123016119003296, 'loss': 1.4571635018289089, 'time_step': 0.007186864376068115, 'init_value': 10.088090896606445}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:34.57[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025421142578125, 'time_algorithm_update': 0.005176861524581909, 'loss': 4.627641782790422, 'time_step': 0.007253443479537964, 'init_value': 19.945602416992188}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:35.06[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020257582664489748, 'time_algorithm_update': 0.00516453742980957, 'loss': 9.123937759339809, 'time_step': 0.007241827011108398, 'init_value': 29.969980239868164}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:35.15[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020332770347595217, 'time_algorithm_update': 0.00520642614364624, 'loss': 16.24808378314972, 'time_step': 0.007292094230651855, 'init_value': 37.93022537231445}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:35.23[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020280582904815673, 'time_algorithm_update': 0.0051909198760986324, 'loss': 20.193589975476264, 'time_step': 0.007270711898803711, 'init_value': 46.32984161376953}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:35.32[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034476041793823, 'time_algorithm_update': 0.005181779861450195, 'loss': 27.34332240629196, 'time_step': 0.007267640352249145, 'init_value': 52.213844299316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:35.40[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020303628444671633, 'time_algorithm_update': 0.005179738283157349, 'loss': 28.175977191209792, 'time_step': 0.007261717319488525, 'init_value': 59.270713806152344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:35.49[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020243055820465088, 'time_algorithm_update': 0.005158258438110352, 'loss': 27.4807563778162, 'time_step': 0.0072334430217742916, 'init_value': 65.20523834228516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:35.58[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020545992851257323, 'time_algorithm_update': 0.005253732204437256, 'loss': 31.310765067219734, 'time_step': 0.007362835168838501, 'init_value': 70.4189682006836}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:36.06[0m [[32m[1minfo     [0m] [1mFQE_20250505193440: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020302343368530274, 'time_algorithm_update': 0.005191406011581421, 'loss': 33.3204968650341, 'time_step': 0.0072733438014984135, 'init_value': 75.5262222290039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.5262222290039
ave advantage rew: 77.82608642578126, std: 2.695369130737577
avg cum rews: 1278.8039515666667, std: 456.1563132731466
Pearson correlation coefficient: -0.23128712423882564
Spearman correlation coefficient: -0.19398496240601504
Kendall Tau correlation coefficient: -0.1473684210526316
the best agent: 14, best agent cum rewards: 1066.1435330000002
1961
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01820841214180697
avg return on 5 trajectories of agent0: 1158.694461
Episode generator created
[2m2025-05-05 19:36.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:36.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:36.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:36.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:36.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193617[0m
[2m2025-05-05 19:36.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:36.26[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024003505706787, 'time_algorithm_update': 0.005113611221313477, 'loss': 1.4880495427399874, 'time_step': 0.007188176155090332, 'init_value': 10.51201343536377}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:36.35[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040369510650635, 'time_algorithm_update': 0.005162604808807373, 'loss': 4.386025482743978, 'time_step': 0.0072542960643768315, 'init_value': 20.707090377807617}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:36.43[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203367018699646, 'time_algorithm_update': 0.005171743631362915, 'loss': 9.983046186625957, 'time_step': 0.007256649971008301, 'init_value': 31.44091796875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:36.52[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029545068740845, 'time_algorithm_update': 0.005169854879379272, 'loss': 14.74577852845192, 'time_step': 0.00725094747543335, 'init_value': 40.37591552734375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:37.00[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020343961715698243, 'time_algorithm_update': 0.005198914289474488, 'loss': 19.509143242359162, 'time_step': 0.007284837007522583, 'init_value': 50.42747116088867}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:37.09[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027849197387695, 'time_algorithm_update': 0.005172852277755737, 'loss': 24.776074912309646, 'time_step': 0.0072525060176849366, 'init_value': 57.702693939208984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:37.18[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020351130962371826, 'time_algorithm_update': 0.005188446283340454, 'loss': 28.627122121334075, 'time_step': 0.007275485277175904, 'init_value': 65.11415100097656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:37.26[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020290937423706056, 'time_algorithm_update': 0.005179591178894043, 'loss': 31.891080738425256, 'time_step': 0.007260404109954834, 'init_value': 71.43924713134766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:37.35[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372564792633056, 'time_algorithm_update': 0.0051911168098449706, 'loss': 31.125684514284135, 'time_step': 0.007279732227325439, 'init_value': 77.32852172851562}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:37.43[0m [[32m[1minfo     [0m] [1mFQE_20250505193617: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020354974269866945, 'time_algorithm_update': 0.005195186853408813, 'loss': 34.29695320868492, 'time_step': 0.007282762289047241, 'init_value': 83.26432800292969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.26432800292969
avg return on 5 trajectories of agent1: 1125.499317
Episode generator created
[2m2025-05-05 19:37.44[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:37.44[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:37.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:37.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:37.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193744[0m
[2m2025-05-05 19:37.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:37.53[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015700578689575, 'time_algorithm_update': 0.005111512899398804, 'loss': 1.4041797255724668, 'time_step': 0.007178030729293823, 'init_value': 10.539775848388672}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:38.02[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034472703933716, 'time_algorithm_update': 0.005169560194015503, 'loss': 4.083809920936823, 'time_step': 0.0072558152675628665, 'init_value': 20.685962677001953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:38.10[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020278539657592773, 'time_algorithm_update': 0.0051569554805755615, 'loss': 8.186400072276593, 'time_step': 0.007236588001251221, 'init_value': 29.999942779541016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:38.19[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020374372005462645, 'time_algorithm_update': 0.005169356822967529, 'loss': 13.129870730817318, 'time_step': 0.007258869647979736, 'init_value': 38.95814514160156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:38.27[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032398462295532, 'time_algorithm_update': 0.0051628310680389405, 'loss': 17.639376467585564, 'time_step': 0.0072469403743743895, 'init_value': 48.137786865234375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:38.36[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020352981090545653, 'time_algorithm_update': 0.005160259485244751, 'loss': 24.85718315410614, 'time_step': 0.007247661828994751, 'init_value': 55.92304229736328}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:38.44[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203617525100708, 'time_algorithm_update': 0.0051649489402771, 'loss': 27.755691110134126, 'time_step': 0.007253037452697754, 'init_value': 63.52885818481445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:38.53[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020354969501495362, 'time_algorithm_update': 0.005159142732620239, 'loss': 32.42683974921703, 'time_step': 0.007246893882751465, 'init_value': 70.89157104492188}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:39.02[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026467323303223, 'time_algorithm_update': 0.0051471335887908936, 'loss': 32.519218965411184, 'time_step': 0.007225234746932983, 'init_value': 76.56246185302734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:39.10[0m [[32m[1minfo     [0m] [1mFQE_20250505193744: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020285468101501466, 'time_algorithm_update': 0.005162136793136597, 'loss': 35.00143807446957, 'time_step': 0.007242651224136353, 'init_value': 82.95755767822266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.95755767822266
avg return on 5 trajectories of agent2: 1141.361804
Episode generator created
[2m2025-05-05 19:39.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:39.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:39.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:39.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:39.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193911[0m
[2m2025-05-05 19:39.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:39.20[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026491403579712, 'time_algorithm_update': 0.005131653308868408, 'loss': 1.3727342874258757, 'time_step': 0.007209345102310181, 'init_value': 10.707706451416016}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:39.29[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043231010437012, 'time_algorithm_update': 0.005229918003082276, 'loss': 3.73563557690382, 'time_step': 0.007325522184371948, 'init_value': 21.235353469848633}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:39.37[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028088092803955, 'time_algorithm_update': 0.005184280395507813, 'loss': 8.582735617220402, 'time_step': 0.007263880014419555, 'init_value': 30.318449020385742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:39.46[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031390428543091, 'time_algorithm_update': 0.005172591924667358, 'loss': 12.674293137907982, 'time_step': 0.0072571966648101805, 'init_value': 38.5135383605957}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020301716327667235, 'time_algorithm_update': 0.005172790050506592, 'loss': 16.946985485196112, 'time_step': 0.007254562854766846, 'init_value': 47.42707061767578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:40.03[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033287048339844, 'time_algorithm_update': 0.005180575609207153, 'loss': 23.135297723650933, 'time_step': 0.007265340328216552, 'init_value': 55.12195587158203}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:40.11[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020259573459625244, 'time_algorithm_update': 0.005177810668945313, 'loss': 25.547739583969115, 'time_step': 0.007254883050918579, 'init_value': 62.895164489746094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:40.20[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020328614711761475, 'time_algorithm_update': 0.005189661502838135, 'loss': 28.45937797296047, 'time_step': 0.007274253845214844, 'init_value': 69.62590789794922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:40.29[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020212976932525635, 'time_algorithm_update': 0.0051617703437805175, 'loss': 34.09300004267693, 'time_step': 0.007234764099121094, 'init_value': 73.50572967529297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:40.37[0m [[32m[1minfo     [0m] [1mFQE_20250505193911: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020317103862762453, 'time_algorithm_update': 0.005188315153121948, 'loss': 31.245790358662607, 'time_step': 0.007271575450897217, 'init_value': 78.16368865966797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.16368865966797
avg return on 5 trajectories of agent3: 1038.5768293333333
Episode generator created
[2m2025-05-05 19:40.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:40.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:40.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:40.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:40.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194038[0m
[2m2025-05-05 19:40.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:40.47[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025535821914673, 'time_algorithm_update': 0.005131064653396606, 'loss': 1.4455227564871311, 'time_step': 0.007207293272018433, 'init_value': 10.993607521057129}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:40.55[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020310776233673097, 'time_algorithm_update': 0.005176381111145019, 'loss': 3.8387048333287237, 'time_step': 0.007259265661239624, 'init_value': 21.597393035888672}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:41.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203983473777771, 'time_algorithm_update': 0.005195396423339844, 'loss': 6.4344298273324965, 'time_step': 0.007287379026412964, 'init_value': 30.696229934692383}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:41.13[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034806251525879, 'time_algorithm_update': 0.005194491863250732, 'loss': 11.339851178169251, 'time_step': 0.007281206607818604, 'init_value': 39.487247467041016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:41.21[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020447406768798826, 'time_algorithm_update': 0.0051982860565185545, 'loss': 13.875406932115554, 'time_step': 0.007294829368591309, 'init_value': 47.611881256103516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:41.30[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030914306640625, 'time_algorithm_update': 0.005178549289703369, 'loss': 17.941744336366654, 'time_step': 0.007261011600494385, 'init_value': 54.96706771850586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:41.39[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036606550216675, 'time_algorithm_update': 0.005196346998214722, 'loss': 22.237889313578606, 'time_step': 0.007284472703933716, 'init_value': 60.92206573486328}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:41.47[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041905641555786, 'time_algorithm_update': 0.005197126388549805, 'loss': 24.442245639801026, 'time_step': 0.00729069447517395, 'init_value': 67.80939483642578}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:41.56[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020414161682128906, 'time_algorithm_update': 0.005186439275741577, 'loss': 26.562246989965438, 'time_step': 0.007279722213745117, 'init_value': 74.0917739868164}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:42.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194038: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042320966720581, 'time_algorithm_update': 0.005195546627044678, 'loss': 28.627478961110114, 'time_step': 0.007290209293365478, 'init_value': 79.78282928466797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.78282928466797
avg return on 5 trajectories of agent4: 1229.1587633333331
Episode generator created
[2m2025-05-05 19:42.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:42.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:42.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:42.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:42.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194206[0m
[2m2025-05-05 19:42.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:42.14[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025716781616211, 'time_algorithm_update': 0.005134672403335571, 'loss': 1.3687196137607098, 'time_step': 0.00721076488494873, 'init_value': 9.706210136413574}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:42.23[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034862756729126, 'time_algorithm_update': 0.005196942806243897, 'loss': 4.103008128851652, 'time_step': 0.007283238649368286, 'init_value': 19.504913330078125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:42.31[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020324416160583496, 'time_algorithm_update': 0.005198343992233277, 'loss': 7.739136982738971, 'time_step': 0.007282131910324096, 'init_value': 28.795005798339844}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:42.40[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020437638759613036, 'time_algorithm_update': 0.005200244903564453, 'loss': 10.53218107509613, 'time_step': 0.0072958521842956545, 'init_value': 36.76491928100586}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:42.49[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036198616027832, 'time_algorithm_update': 0.005211718320846557, 'loss': 14.816890926599502, 'time_step': 0.007299619436264038, 'init_value': 44.976844787597656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:42.57[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049170970916748, 'time_algorithm_update': 0.00524090051651001, 'loss': 20.86788849437237, 'time_step': 0.007342277288436889, 'init_value': 51.975868225097656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:43.06[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020372753143310545, 'time_algorithm_update': 0.0051943156719207765, 'loss': 23.9822593511343, 'time_step': 0.007283294916152954, 'init_value': 59.3834342956543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:43.15[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039100408554077, 'time_algorithm_update': 0.005197715759277344, 'loss': 28.529895762205125, 'time_step': 0.007288414716720581, 'init_value': 65.28104400634766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:43.23[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020388402938842773, 'time_algorithm_update': 0.005191075563430786, 'loss': 31.673771229743956, 'time_step': 0.007281316518783569, 'init_value': 71.40573120117188}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:43.32[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020384478569030764, 'time_algorithm_update': 0.005194254875183105, 'loss': 28.796905052781106, 'time_step': 0.0072847468852996825, 'init_value': 76.11099243164062}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.11099243164062
avg return on 5 trajectories of agent5: 1672.0051526666666
Episode generator created
[2m2025-05-05 19:43.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:43.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:43.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:43.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:43.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194333[0m
[2m2025-05-05 19:43.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:43.42[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020141448974609374, 'time_algorithm_update': 0.005107622385025024, 'loss': 1.4668775769472122, 'time_step': 0.007172516345977783, 'init_value': 10.188193321228027}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:43.50[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020258572101593017, 'time_algorithm_update': 0.005179543733596801, 'loss': 4.487457960009575, 'time_step': 0.007256962299346924, 'init_value': 21.235889434814453}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:43.59[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020457053184509276, 'time_algorithm_update': 0.005179322719573974, 'loss': 8.76870794415474, 'time_step': 0.007277282953262329, 'init_value': 30.767505645751953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:44.07[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042741060256958, 'time_algorithm_update': 0.0051910896301269535, 'loss': 13.54853289103508, 'time_step': 0.0072864830493927, 'init_value': 40.078033447265625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:44.16[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035654067993164, 'time_algorithm_update': 0.00517383074760437, 'loss': 17.253306356608867, 'time_step': 0.0072611777782440184, 'init_value': 49.280555725097656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:44.25[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008328437805176, 'time_algorithm_update': 0.005074187278747559, 'loss': 21.71923204243183, 'time_step': 0.007133455038070679, 'init_value': 57.730323791503906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:44.33[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020055968761444093, 'time_algorithm_update': 0.005080183982849121, 'loss': 26.71503222608566, 'time_step': 0.0071364867687225345, 'init_value': 64.56016540527344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:44.42[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020195865631103516, 'time_algorithm_update': 0.005101067066192627, 'loss': 25.455134439706804, 'time_step': 0.007171487092971802, 'init_value': 71.91319274902344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:44.50[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020089151859283448, 'time_algorithm_update': 0.005088874340057373, 'loss': 32.977917880535124, 'time_step': 0.007148281097412109, 'init_value': 77.76873779296875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:44.59[0m [[32m[1minfo     [0m] [1mFQE_20250505194333: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014493465423584, 'time_algorithm_update': 0.005089461803436279, 'loss': 36.212339601039886, 'time_step': 0.007154472589492798, 'init_value': 84.39252471923828}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 84.39252471923828
avg return on 5 trajectories of agent6: 2722.9080893333335
Episode generator created
[2m2025-05-05 19:45.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:45.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:45.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:45.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:45.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194501[0m
[2m2025-05-05 19:45.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:45.09[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017812967300415, 'time_algorithm_update': 0.005118493318557739, 'loss': 1.4590162505358457, 'time_step': 0.007187105655670166, 'init_value': 10.020612716674805}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:45.18[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024388313293457, 'time_algorithm_update': 0.005137712955474854, 'loss': 4.013994589149952, 'time_step': 0.007213480472564697, 'init_value': 19.85800552368164}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:45.26[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020329556465148928, 'time_algorithm_update': 0.0051752147674560545, 'loss': 8.031945966899395, 'time_step': 0.007259851217269898, 'init_value': 29.599075317382812}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:45.35[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020312411785125732, 'time_algorithm_update': 0.005161556720733642, 'loss': 13.679443607270718, 'time_step': 0.007244243621826172, 'init_value': 38.97550582885742}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:45.44[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020373473167419436, 'time_algorithm_update': 0.005181796312332153, 'loss': 17.430092033982277, 'time_step': 0.007270957946777344, 'init_value': 48.454917907714844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:45.52[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033240556716919, 'time_algorithm_update': 0.005182408094406128, 'loss': 21.890607909440995, 'time_step': 0.007267738580703735, 'init_value': 54.488887786865234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:46.01[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020438969135284425, 'time_algorithm_update': 0.005173915386199951, 'loss': 27.282057659506798, 'time_step': 0.007270098924636841, 'init_value': 61.72706604003906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:46.09[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038684129714966, 'time_algorithm_update': 0.005173224687576294, 'loss': 25.798778073310853, 'time_step': 0.007263332843780518, 'init_value': 68.17894744873047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:46.18[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020369675159454346, 'time_algorithm_update': 0.005187511682510376, 'loss': 30.12543181860447, 'time_step': 0.00727658748626709, 'init_value': 72.9018325805664}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:46.27[0m [[32m[1minfo     [0m] [1mFQE_20250505194501: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036736726760864, 'time_algorithm_update': 0.005202268600463867, 'loss': 33.975060106754306, 'time_step': 0.007291052103042602, 'init_value': 78.44104766845703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.44104766845703
avg return on 5 trajectories of agent7: 2729.306197
Episode generator created
[2m2025-05-05 19:46.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:46.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:46.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:46.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:46.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194629[0m
[2m2025-05-05 19:46.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:46.37[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034618616104126, 'time_algorithm_update': 0.005145700931549072, 'loss': 1.4825457364171744, 'time_step': 0.007231388807296753, 'init_value': 10.674725532531738}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:46.46[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032663106918335, 'time_algorithm_update': 0.0051677639484405515, 'loss': 4.209601684421301, 'time_step': 0.007252400875091553, 'init_value': 20.976511001586914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:46.55[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020090923309326173, 'time_algorithm_update': 0.005140128850936889, 'loss': 7.9393894659876825, 'time_step': 0.00720022463798523, 'init_value': 30.931232452392578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:47.03[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020241279602050783, 'time_algorithm_update': 0.005162390232086181, 'loss': 13.374172862410544, 'time_step': 0.00723837947845459, 'init_value': 39.3179931640625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:47.12[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020291943550109865, 'time_algorithm_update': 0.005171706914901733, 'loss': 17.874604030132293, 'time_step': 0.007252526760101318, 'init_value': 47.02656173706055}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:47.20[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020471537113189698, 'time_algorithm_update': 0.005176741123199463, 'loss': 20.375367024183273, 'time_step': 0.007276206016540527, 'init_value': 54.85969924926758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:47.29[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020363407135009764, 'time_algorithm_update': 0.005177823305130005, 'loss': 23.59613241326809, 'time_step': 0.007266227722167969, 'init_value': 62.04713821411133}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:47.37[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033012866973877, 'time_algorithm_update': 0.005182993650436401, 'loss': 28.02478336083889, 'time_step': 0.007268155813217163, 'init_value': 67.68051147460938}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:47.46[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020370941162109373, 'time_algorithm_update': 0.005182570219039917, 'loss': 27.395287199139595, 'time_step': 0.007271795511245727, 'init_value': 72.82291412353516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:47.55[0m [[32m[1minfo     [0m] [1mFQE_20250505194629: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020359325408935546, 'time_algorithm_update': 0.005186451435089111, 'loss': 30.429237605333327, 'time_step': 0.007274506330490113, 'init_value': 78.80242156982422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.80242156982422
avg return on 5 trajectories of agent8: 1059.395963
Episode generator created
[2m2025-05-05 19:47.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:47.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:47.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:47.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:47.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194756[0m
[2m2025-05-05 19:47.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:48.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028331518173218, 'time_algorithm_update': 0.005128519773483276, 'loss': 1.4202072018831968, 'time_step': 0.007208117008209228, 'init_value': 10.45758056640625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:48.13[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020319125652313234, 'time_algorithm_update': 0.005184802532196045, 'loss': 3.7852826854288577, 'time_step': 0.007268072128295899, 'init_value': 20.38188934326172}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:48.22[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020389647483825685, 'time_algorithm_update': 0.005177529573440552, 'loss': 7.190690255701542, 'time_step': 0.007268126964569092, 'init_value': 29.836421966552734}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:48.30[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013373374938965, 'time_algorithm_update': 0.005129501819610595, 'loss': 10.574456126928329, 'time_step': 0.007193827152252198, 'init_value': 38.85514450073242}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:48.39[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020320634841918947, 'time_algorithm_update': 0.005181866645812988, 'loss': 14.596916231751441, 'time_step': 0.007265526056289673, 'init_value': 47.702171325683594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:48.47[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035053253173828, 'time_algorithm_update': 0.005176699876785278, 'loss': 18.010136454463005, 'time_step': 0.007263549566268921, 'init_value': 56.90584945678711}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:48.56[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020396959781646727, 'time_algorithm_update': 0.005180988788604736, 'loss': 20.32399626469612, 'time_step': 0.007272395849227905, 'init_value': 64.23399353027344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:49.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020398826599121096, 'time_algorithm_update': 0.00517853045463562, 'loss': 23.038455343008042, 'time_step': 0.00727033805847168, 'init_value': 70.69022369384766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:49.13[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036412000656128, 'time_algorithm_update': 0.0051856784820556645, 'loss': 23.07448043179512, 'time_step': 0.007274280309677124, 'init_value': 77.4370346069336}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:49.22[0m [[32m[1minfo     [0m] [1mFQE_20250505194756: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020510549545288085, 'time_algorithm_update': 0.005187141180038452, 'loss': 26.354685764074326, 'time_step': 0.007290525674819946, 'init_value': 81.5851821899414}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.5851821899414
avg return on 5 trajectories of agent9: 1118.907917
Episode generator created
[2m2025-05-05 19:49.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:49.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:49.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:49.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:49.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194923[0m
[2m2025-05-05 19:49.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:49.31[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020207040309906006, 'time_algorithm_update': 0.005103509902954101, 'loss': 1.4924345223903657, 'time_step': 0.007174693584442139, 'init_value': 10.286340713500977}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:49.40[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020367181301116943, 'time_algorithm_update': 0.005176896333694458, 'loss': 4.1533054191470145, 'time_step': 0.007265580654144287, 'init_value': 20.62643814086914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:49.49[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020352697372436526, 'time_algorithm_update': 0.005171142816543579, 'loss': 8.914165091693402, 'time_step': 0.007258401870727539, 'init_value': 30.041357040405273}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:49.57[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020382909774780272, 'time_algorithm_update': 0.005185268878936768, 'loss': 13.937259033739567, 'time_step': 0.00727578067779541, 'init_value': 40.197452545166016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:50.06[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019965171813965, 'time_algorithm_update': 0.0051448802947998045, 'loss': 19.406512001156806, 'time_step': 0.0072161626815795896, 'init_value': 49.4094123840332}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:50.14[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035393953323364, 'time_algorithm_update': 0.00517128586769104, 'loss': 24.054486533880233, 'time_step': 0.007258750438690185, 'init_value': 57.30070495605469}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:50.23[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020404157638549804, 'time_algorithm_update': 0.00517977499961853, 'loss': 24.73170472598076, 'time_step': 0.0072724902629852295, 'init_value': 64.72753143310547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:50.31[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020339815616607668, 'time_algorithm_update': 0.005169569015502929, 'loss': 28.296463560581206, 'time_step': 0.007255084037780761, 'init_value': 69.63611602783203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:50.40[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020444741249084474, 'time_algorithm_update': 0.005189728021621704, 'loss': 32.33382253694534, 'time_step': 0.007286209344863892, 'init_value': 75.44384765625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:50.49[0m [[32m[1minfo     [0m] [1mFQE_20250505194923: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020303013324737547, 'time_algorithm_update': 0.005176028728485107, 'loss': 30.05350261950493, 'time_step': 0.0072586350440979, 'init_value': 82.17840576171875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.17840576171875
avg return on 5 trajectories of agent10: 1096.8545023333334
Episode generator created
[2m2025-05-05 19:50.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:50.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:50.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:50.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:50.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195050[0m
[2m2025-05-05 19:50.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:50.58[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020215311050415037, 'time_algorithm_update': 0.005126356363296509, 'loss': 1.4205546764284371, 'time_step': 0.007198837280273438, 'init_value': 10.267914772033691}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:51.07[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020378692150115965, 'time_algorithm_update': 0.00519974136352539, 'loss': 4.388367302715778, 'time_step': 0.007289115190505981, 'init_value': 20.53097152709961}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:51.16[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020406792163848875, 'time_algorithm_update': 0.00519383430480957, 'loss': 8.545620176613332, 'time_step': 0.007286581993103027, 'init_value': 30.12027359008789}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:51.24[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020390105247497558, 'time_algorithm_update': 0.005200730800628662, 'loss': 12.555383194088936, 'time_step': 0.0072920389175415035, 'init_value': 39.72373962402344}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:51.33[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020338547229766845, 'time_algorithm_update': 0.00518693995475769, 'loss': 18.340945949077607, 'time_step': 0.007272601366043091, 'init_value': 46.70209503173828}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:51.41[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020201716423034668, 'time_algorithm_update': 0.005151105403900146, 'loss': 21.209738758683205, 'time_step': 0.007222310781478882, 'init_value': 54.630741119384766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:51.50[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020386364459991455, 'time_algorithm_update': 0.005186697959899902, 'loss': 22.890648433923722, 'time_step': 0.007277428865432739, 'init_value': 59.855438232421875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:51.59[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020348711013793946, 'time_algorithm_update': 0.005187263488769531, 'loss': 26.62783734178543, 'time_step': 0.007274040222167969, 'init_value': 65.81141662597656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:52.07[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203981614112854, 'time_algorithm_update': 0.005190710306167603, 'loss': 30.51657379734516, 'time_step': 0.007283302307128906, 'init_value': 70.54528045654297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:52.16[0m [[32m[1minfo     [0m] [1mFQE_20250505195050: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037489652633667, 'time_algorithm_update': 0.005186799764633179, 'loss': 27.370629400730135, 'time_step': 0.0072765002250671385, 'init_value': 75.72451782226562}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.72451782226562
avg return on 5 trajectories of agent11: 805.3228623333334
Episode generator created
[2m2025-05-05 19:52.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:52.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:52.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:52.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:52.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195217[0m
[2m2025-05-05 19:52.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:52.25[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023104190826416, 'time_algorithm_update': 0.005132001638412475, 'loss': 1.4521544867604972, 'time_step': 0.007205716133117676, 'init_value': 10.341143608093262}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:52.34[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038339138031006, 'time_algorithm_update': 0.005203070402145385, 'loss': 3.842765222012997, 'time_step': 0.007293241739273071, 'init_value': 20.448516845703125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:52.42[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042651653289795, 'time_algorithm_update': 0.0052069747447967525, 'loss': 8.12345810008049, 'time_step': 0.007301145076751709, 'init_value': 30.391061782836914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:52.51[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203692626953125, 'time_algorithm_update': 0.0052075514793396, 'loss': 12.772369465231895, 'time_step': 0.0072959368228912354, 'init_value': 40.22084045410156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:53.00[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027656078338623, 'time_algorithm_update': 0.005213683843612671, 'loss': 19.569466742157935, 'time_step': 0.0072927334308624265, 'init_value': 49.49565124511719}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:53.08[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353965759277344, 'time_algorithm_update': 0.005203106641769409, 'loss': 24.71051666176319, 'time_step': 0.007290357112884521, 'init_value': 55.99387741088867}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:53.17[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020402467250823977, 'time_algorithm_update': 0.005213080167770385, 'loss': 24.934604451417922, 'time_step': 0.007305158615112305, 'init_value': 62.952308654785156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:53.26[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020841505527496337, 'time_algorithm_update': 0.0053368151187896725, 'loss': 26.663264186143874, 'time_step': 0.0074750504493713375, 'init_value': 71.19989776611328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:53.34[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020353662967681884, 'time_algorithm_update': 0.0052112510204315185, 'loss': 36.062244373202326, 'time_step': 0.007298243999481201, 'init_value': 78.84275817871094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:53.43[0m [[32m[1minfo     [0m] [1mFQE_20250505195217: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038111209869385, 'time_algorithm_update': 0.005211816549301147, 'loss': 34.65151583576203, 'time_step': 0.007302155017852783, 'init_value': 82.38751220703125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.38751220703125
avg return on 5 trajectories of agent12: 1995.3215819999998
Episode generator created
[2m2025-05-05 19:53.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:53.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:53.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:53.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:53.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195345[0m
[2m2025-05-05 19:53.45[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:53.53[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018709421157837, 'time_algorithm_update': 0.005100494384765625, 'loss': 1.507189377233386, 'time_step': 0.007169705152511596, 'init_value': 10.341333389282227}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:54.02[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038304090499878, 'time_algorithm_update': 0.0051740694046020505, 'loss': 4.205392338097096, 'time_step': 0.007264106035232544, 'init_value': 20.242055892944336}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:54.10[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036945343017578, 'time_algorithm_update': 0.005181784868240356, 'loss': 8.888672204852105, 'time_step': 0.007270660638809204, 'init_value': 29.478111267089844}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:54.19[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020322558879852294, 'time_algorithm_update': 0.005165891408920288, 'loss': 13.869772526144981, 'time_step': 0.00724990701675415, 'init_value': 38.57099533081055}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:54.28[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033277273178101, 'time_algorithm_update': 0.0051774075031280516, 'loss': 16.859021139919758, 'time_step': 0.007262686967849732, 'init_value': 46.28240203857422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:54.36[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020367753505706786, 'time_algorithm_update': 0.005163178205490112, 'loss': 24.11335118818283, 'time_step': 0.007252083301544189, 'init_value': 53.47526931762695}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:54.45[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020354092121124268, 'time_algorithm_update': 0.005160938739776611, 'loss': 21.130818902254106, 'time_step': 0.007247910022735595, 'init_value': 59.84640884399414}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:54.53[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020147688388824463, 'time_algorithm_update': 0.005081232786178589, 'loss': 26.971991531848907, 'time_step': 0.007146510124206543, 'init_value': 65.84188079833984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:55.02[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018939256668091, 'time_algorithm_update': 0.0050911598205566405, 'loss': 30.33831673049927, 'time_step': 0.007160598754882812, 'init_value': 72.89579010009766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:55.10[0m [[32m[1minfo     [0m] [1mFQE_20250505195345: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919230937957763, 'time_algorithm_update': 0.0050424797534942625, 'loss': 32.26256190633774, 'time_step': 0.007084529399871826, 'init_value': 77.62671661376953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.62671661376953
avg return on 5 trajectories of agent13: 1058.0760143333334
Episode generator created
[2m2025-05-05 19:55.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:55.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:55.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:55.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:55.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195511[0m
[2m2025-05-05 19:55.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:55.20[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996469974517822, 'time_algorithm_update': 0.005008084058761597, 'loss': 1.4673951706588269, 'time_step': 0.0070538163185119625, 'init_value': 10.488429069519043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:55.28[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002005906581878662, 'time_algorithm_update': 0.005045554637908936, 'loss': 4.3606872195601465, 'time_step': 0.007101395606994629, 'init_value': 20.133724212646484}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:55.36[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002019914150238037, 'time_algorithm_update': 0.005121548414230346, 'loss': 9.889488417267799, 'time_step': 0.007192379474639893, 'init_value': 29.827777862548828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:55.45[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033799409866333, 'time_algorithm_update': 0.005142022609710693, 'loss': 14.645775827288627, 'time_step': 0.007227544546127319, 'init_value': 37.530494689941406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:55.54[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030334711074829, 'time_algorithm_update': 0.005137328863143921, 'loss': 18.74195736551285, 'time_step': 0.007219011306762695, 'init_value': 44.39729690551758}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:56.02[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037123918533325, 'time_algorithm_update': 0.005150172472000122, 'loss': 22.882036941409112, 'time_step': 0.007239259243011474, 'init_value': 53.31728744506836}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:56.11[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020308642387390136, 'time_algorithm_update': 0.00514156699180603, 'loss': 26.188769067049027, 'time_step': 0.007223888397216797, 'init_value': 58.32027816772461}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:56.19[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020320096015930176, 'time_algorithm_update': 0.005139543771743775, 'loss': 28.317784477114678, 'time_step': 0.007222747325897217, 'init_value': 65.14627075195312}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:56.28[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020337486267089843, 'time_algorithm_update': 0.005139531850814819, 'loss': 27.66887011563778, 'time_step': 0.007225063800811768, 'init_value': 71.01713562011719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:56.36[0m [[32m[1minfo     [0m] [1mFQE_20250505195511: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020277192592620848, 'time_algorithm_update': 0.005132802724838257, 'loss': 31.164535566806794, 'time_step': 0.007212224960327148, 'init_value': 77.38629913330078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.38629913330078
avg return on 5 trajectories of agent14: 1066.2160433333331
Episode generator created
[2m2025-05-05 19:56.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:56.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:56.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:56.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:56.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195637[0m
[2m2025-05-05 19:56.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:56.46[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200523042678833, 'time_algorithm_update': 0.005070494413375854, 'loss': 1.5434296000301837, 'time_step': 0.007125827550888061, 'init_value': 10.376084327697754}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:56.55[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536701679229738, 'time_algorithm_update': 0.005214370250701904, 'loss': 4.719050486505032, 'time_step': 0.007320481061935425, 'init_value': 20.836109161376953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:57.03[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030240774154663, 'time_algorithm_update': 0.005144641637802124, 'loss': 9.230939626872539, 'time_step': 0.00722577166557312, 'init_value': 30.834020614624023}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:57.12[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020316078662872316, 'time_algorithm_update': 0.005138970375061035, 'loss': 14.526181501984595, 'time_step': 0.007222321748733521, 'init_value': 38.999168395996094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:57.20[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020416157245635985, 'time_algorithm_update': 0.005154368877410889, 'loss': 19.585533897280694, 'time_step': 0.007247668027877807, 'init_value': 47.991817474365234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:57.29[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036106109619141, 'time_algorithm_update': 0.005139295101165771, 'loss': 19.905456543803215, 'time_step': 0.007226871490478516, 'init_value': 53.39011001586914}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:57.37[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020383827686309814, 'time_algorithm_update': 0.005155811309814453, 'loss': 24.313006495714188, 'time_step': 0.007245450735092163, 'init_value': 60.31866455078125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:57.46[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453758239746093, 'time_algorithm_update': 0.005156184911727905, 'loss': 26.611757113695145, 'time_step': 0.007253419637680053, 'init_value': 65.52698516845703}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:57.55[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020344018936157226, 'time_algorithm_update': 0.005149265050888061, 'loss': 29.513599704027175, 'time_step': 0.007235405206680298, 'init_value': 71.42638397216797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:58.03[0m [[32m[1minfo     [0m] [1mFQE_20250505195637: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020428764820098876, 'time_algorithm_update': 0.005159381628036499, 'loss': 33.07703328847885, 'time_step': 0.007254611492156982, 'init_value': 76.81982421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.81982421875
avg return on 5 trajectories of agent15: 1056.2271866666667
Episode generator created
[2m2025-05-05 19:58.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:58.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:58.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:58.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:58.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195804[0m
[2m2025-05-05 19:58.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:58.13[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027052640914917, 'time_algorithm_update': 0.005115935802459717, 'loss': 1.4508490222245454, 'time_step': 0.007194084405899048, 'init_value': 9.757928848266602}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:58.21[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202093505859375, 'time_algorithm_update': 0.0051403136253356935, 'loss': 4.123899555802345, 'time_step': 0.007211882114410401, 'init_value': 18.831892013549805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:58.30[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020267961025238037, 'time_algorithm_update': 0.00516172456741333, 'loss': 9.087382708907127, 'time_step': 0.0072394118309021, 'init_value': 28.146799087524414}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:58.38[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020269453525543213, 'time_algorithm_update': 0.005179036617279053, 'loss': 13.30126181101799, 'time_step': 0.007257420063018799, 'init_value': 37.076847076416016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:58.47[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020417110919952394, 'time_algorithm_update': 0.005182863473892212, 'loss': 18.948576745748518, 'time_step': 0.007276281595230103, 'init_value': 45.62222671508789}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:58.56[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020305459499359133, 'time_algorithm_update': 0.005175795793533325, 'loss': 26.466784214258194, 'time_step': 0.007257656335830688, 'init_value': 51.305294036865234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:59.04[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042733907699585, 'time_algorithm_update': 0.0052041149139404295, 'loss': 27.18638277077675, 'time_step': 0.007298705339431763, 'init_value': 58.764041900634766}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:59.13[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032850980758667, 'time_algorithm_update': 0.005186401128768921, 'loss': 33.11910813999176, 'time_step': 0.0072706246376037596, 'init_value': 63.240421295166016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:59.21[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020463607311248778, 'time_algorithm_update': 0.005189770936965942, 'loss': 29.053197067975997, 'time_step': 0.007288156509399414, 'init_value': 69.51528930664062}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:59.30[0m [[32m[1minfo     [0m] [1mFQE_20250505195804: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031553030014038, 'time_algorithm_update': 0.005173218727111816, 'loss': 35.08314451050758, 'time_step': 0.007256327867507934, 'init_value': 74.22186279296875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.22186279296875
avg return on 5 trajectories of agent16: 1079.9103616666666
Episode generator created
[2m2025-05-05 19:59.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:59.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:59.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:59.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:59.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195931[0m
[2m2025-05-05 19:59.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:59.40[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020251171588897706, 'time_algorithm_update': 0.005101047992706299, 'loss': 1.5315604461729526, 'time_step': 0.0071766433715820315, 'init_value': 9.864119529724121}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:59.48[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029857873916626, 'time_algorithm_update': 0.0051478219032287595, 'loss': 4.353590885668993, 'time_step': 0.007228928565979004, 'init_value': 19.41919708251953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:59.57[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020082552433013916, 'time_algorithm_update': 0.005114487886428833, 'loss': 7.925585382938385, 'time_step': 0.007173360347747803, 'init_value': 28.4222412109375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:00.05[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020414519309997557, 'time_algorithm_update': 0.0051848294734954834, 'loss': 11.226912985265255, 'time_step': 0.0072782571315765385, 'init_value': 35.86914825439453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:00.14[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020464067459106446, 'time_algorithm_update': 0.0051914632320404054, 'loss': 17.360576528310776, 'time_step': 0.00728994870185852, 'init_value': 44.28230285644531}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:00.23[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058645725250244, 'time_algorithm_update': 0.005235914945602417, 'loss': 19.95346865963936, 'time_step': 0.007347241163253784, 'init_value': 51.96463394165039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:00.31[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020348451137542725, 'time_algorithm_update': 0.005168525695800781, 'loss': 26.19949379658699, 'time_step': 0.007255225658416748, 'init_value': 59.37993621826172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:00.40[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020236313343048097, 'time_algorithm_update': 0.005122392177581787, 'loss': 29.85575368642807, 'time_step': 0.007196922063827515, 'init_value': 63.88208770751953}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:00.48[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998325347900391, 'time_algorithm_update': 0.005071182250976563, 'loss': 31.88427491426468, 'time_step': 0.00712039041519165, 'init_value': 70.0710220336914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:00.57[0m [[32m[1minfo     [0m] [1mFQE_20250505195931: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019904584884643554, 'time_algorithm_update': 0.005062398910522461, 'loss': 32.845844556331635, 'time_step': 0.007103581666946411, 'init_value': 74.2381362915039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.2381362915039
avg return on 5 trajectories of agent17: 1070.8533226666666
Episode generator created
[2m2025-05-05 20:00.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:00.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:00.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:00.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:00.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200058[0m
[2m2025-05-05 20:00.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:01.06[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019913351535797118, 'time_algorithm_update': 0.004996734380722046, 'loss': 1.4552724272161721, 'time_step': 0.0070382504463195805, 'init_value': 9.32742691040039}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:01.14[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019892590045928957, 'time_algorithm_update': 0.00505155348777771, 'loss': 4.513677629053593, 'time_step': 0.007091278553009033, 'init_value': 19.278615951538086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:01.23[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992473363876343, 'time_algorithm_update': 0.005053781032562256, 'loss': 9.5377950168252, 'time_step': 0.007097143411636353, 'init_value': 28.874753952026367}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:01.31[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019766855239868163, 'time_algorithm_update': 0.005014517068862915, 'loss': 15.443744884729385, 'time_step': 0.007040799856185913, 'init_value': 37.786949157714844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:01.40[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991645574569702, 'time_algorithm_update': 0.005046989917755127, 'loss': 20.791579228162764, 'time_step': 0.007088772535324097, 'init_value': 47.02971649169922}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:01.48[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019835681915283203, 'time_algorithm_update': 0.005038577079772949, 'loss': 21.763713750839234, 'time_step': 0.0070731592178344726, 'init_value': 52.86943435668945}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:01.56[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893391132354736, 'time_algorithm_update': 0.005048064231872559, 'loss': 25.296636728405954, 'time_step': 0.007088122606277466, 'init_value': 59.6971321105957}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:02.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019959335327148437, 'time_algorithm_update': 0.00505642294883728, 'loss': 27.244464514374734, 'time_step': 0.007103052616119385, 'init_value': 63.852210998535156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:02.13[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198768949508667, 'time_algorithm_update': 0.0050143544673919675, 'loss': 32.06462117099762, 'time_step': 0.007052585124969483, 'init_value': 68.69303131103516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:02.22[0m [[32m[1minfo     [0m] [1mFQE_20250505200058: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994814157485962, 'time_algorithm_update': 0.0050307435989379885, 'loss': 31.93142975687981, 'time_step': 0.007076197147369385, 'init_value': 74.99771118164062}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.99771118164062
avg return on 5 trajectories of agent18: 1083.4593233333335
Episode generator created
[2m2025-05-05 20:02.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:02.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:02.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:02.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:02.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200223[0m
[2m2025-05-05 20:02.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:02.31[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019764342308044433, 'time_algorithm_update': 0.005000693321228027, 'loss': 1.4010263812988997, 'time_step': 0.007026139259338379, 'init_value': 9.978740692138672}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:02.39[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982922554016113, 'time_algorithm_update': 0.005067249298095703, 'loss': 4.138379164278507, 'time_step': 0.0071001842021942135, 'init_value': 20.273475646972656}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:02.48[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019775850772857668, 'time_algorithm_update': 0.0050745906829833985, 'loss': 7.852605573415756, 'time_step': 0.007102735757827759, 'init_value': 30.029830932617188}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:02.56[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019732675552368165, 'time_algorithm_update': 0.005069241285324096, 'loss': 12.685817948579789, 'time_step': 0.007092474222183227, 'init_value': 39.29130554199219}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:03.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019641547203063966, 'time_algorithm_update': 0.005038809537887573, 'loss': 15.10815662574768, 'time_step': 0.007052207469940185, 'init_value': 47.0921745300293}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:03.13[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984196662902832, 'time_algorithm_update': 0.005060887813568115, 'loss': 18.815898917675018, 'time_step': 0.007095156192779541, 'init_value': 54.94936752319336}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:03.21[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019839353561401365, 'time_algorithm_update': 0.005072578907012939, 'loss': 19.191385442256927, 'time_step': 0.0071071674823760984, 'init_value': 61.30885696411133}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:03.30[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019899935722351076, 'time_algorithm_update': 0.005073775291442871, 'loss': 24.982014379143713, 'time_step': 0.007114043712615967, 'init_value': 67.49508666992188}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:03.38[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989495038986206, 'time_algorithm_update': 0.0050691220760345455, 'loss': 27.48323026072979, 'time_step': 0.007109091520309448, 'init_value': 74.3475570678711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:03.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200223: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008944511413574, 'time_algorithm_update': 0.005120027303695679, 'loss': 28.876018927574158, 'time_step': 0.00718052339553833, 'init_value': 78.21588134765625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.21588134765625
avg return on 5 trajectories of agent19: 1068.242026
Episode generator created
[2m2025-05-05 20:03.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:03.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:03.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:03.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:03.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200348[0m
[2m2025-05-05 20:03.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:03.56[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976850509643555, 'time_algorithm_update': 0.0049925589561462405, 'loss': 1.5482283057272435, 'time_step': 0.007019053220748902, 'init_value': 9.777122497558594}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:04.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004283428192139, 'time_algorithm_update': 0.0050676255226135255, 'loss': 4.098805187284946, 'time_step': 0.007122705459594727, 'init_value': 19.95425796508789}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:04.13[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992016315460205, 'time_algorithm_update': 0.005049312829971313, 'loss': 7.974333287000656, 'time_step': 0.0070918014049530026, 'init_value': 30.014318466186523}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:04.21[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019803082942962645, 'time_algorithm_update': 0.005041495561599731, 'loss': 13.268670580983162, 'time_step': 0.007072062015533447, 'init_value': 39.24276351928711}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:04.30[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019894540309906006, 'time_algorithm_update': 0.005052894115447998, 'loss': 18.17406806612015, 'time_step': 0.007092963218688965, 'init_value': 48.53478240966797}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:04.38[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964155912399292, 'time_algorithm_update': 0.005005388736724853, 'loss': 23.280923770308494, 'time_step': 0.007019755840301514, 'init_value': 55.58559036254883}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:04.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986764669418335, 'time_algorithm_update': 0.005057873487472534, 'loss': 26.291733132958413, 'time_step': 0.007095376253128052, 'init_value': 63.04685592651367}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:04.55[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019904401302337647, 'time_algorithm_update': 0.005051783323287964, 'loss': 29.289411300182344, 'time_step': 0.007092943668365478, 'init_value': 68.2791976928711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:05.03[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196830153465271, 'time_algorithm_update': 0.0050042026042938234, 'loss': 27.85117630803585, 'time_step': 0.007022070407867432, 'init_value': 73.76171875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:05.12[0m [[32m[1minfo     [0m] [1mFQE_20250505200348: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961944818496704, 'time_algorithm_update': 0.004964621782302857, 'loss': 31.0764338619709, 'time_step': 0.006975771427154541, 'init_value': 78.75177001953125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.75177001953125
ave advantage rew: 78.80246047973633, std: 3.0214978372693957
avg cum rews: 1318.8148859166665, std: 528.304967192887
Pearson correlation coefficient: 0.02934025528172371
Spearman correlation coefficient: 0.18345864661654135
Kendall Tau correlation coefficient: 0.1473684210526316
the best agent: 5, best agent cum rewards: 1672.0051526666666
1962
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01732923697296738
avg return on 5 trajectories of agent0: 2258.0561336666665
Episode generator created
[2m2025-05-05 20:05.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:05.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:05.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:05.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:05.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200523[0m
[2m2025-05-05 20:05.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:05.32[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019591562747955323, 'time_algorithm_update': 0.004914836645126343, 'loss': 1.564034671843052, 'time_step': 0.0069219694137573244, 'init_value': 10.83648681640625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:05.40[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967106342315674, 'time_algorithm_update': 0.005002460241317749, 'loss': 4.53266722548008, 'time_step': 0.007018323659896851, 'init_value': 21.668256759643555}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:05.48[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019662628173828123, 'time_algorithm_update': 0.005023241996765137, 'loss': 8.494785608351231, 'time_step': 0.007039673805236816, 'init_value': 31.658077239990234}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:05.57[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995657444000244, 'time_algorithm_update': 0.005111238479614258, 'loss': 14.683758088946343, 'time_step': 0.007157154321670532, 'init_value': 41.0087890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:06.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020091140270233152, 'time_algorithm_update': 0.0051250004768371585, 'loss': 18.08967580664158, 'time_step': 0.007184958934783935, 'init_value': 48.07863235473633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:06.13[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019740121364593506, 'time_algorithm_update': 0.00507320237159729, 'loss': 21.57714185333252, 'time_step': 0.007096502065658569, 'init_value': 56.561824798583984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:06.22[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990870475769043, 'time_algorithm_update': 0.005084581136703491, 'loss': 25.190669073581695, 'time_step': 0.007126038551330567, 'init_value': 61.99273681640625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:06.31[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003873348236084, 'time_algorithm_update': 0.005112201929092407, 'loss': 27.48481105899811, 'time_step': 0.007166739702224732, 'init_value': 67.1495361328125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:06.39[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998753070831299, 'time_algorithm_update': 0.005106658697128296, 'loss': 28.91341809153557, 'time_step': 0.007156290769577026, 'init_value': 72.19108581542969}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:06.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200523: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996694326400757, 'time_algorithm_update': 0.005100304365158081, 'loss': 32.553546234607694, 'time_step': 0.007147259950637817, 'init_value': 77.73462677001953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.73462677001953
avg return on 5 trajectories of agent1: 2423.262886666667
Episode generator created
[2m2025-05-05 20:06.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:06.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:06.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:06.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:06.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200649[0m
[2m2025-05-05 20:06.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:06.58[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981818437576294, 'time_algorithm_update': 0.005000699281692505, 'loss': 1.375719001993537, 'time_step': 0.0070321009159088135, 'init_value': 10.269927978515625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:07.06[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019937865734100343, 'time_algorithm_update': 0.00506191086769104, 'loss': 3.9091846930086613, 'time_step': 0.007105915069580078, 'init_value': 21.060054779052734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:07.15[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020004491806030274, 'time_algorithm_update': 0.0051077456474304195, 'loss': 7.821638505041599, 'time_step': 0.007158722400665283, 'init_value': 31.09500503540039}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:07.23[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020018291473388673, 'time_algorithm_update': 0.005076357841491699, 'loss': 12.79532252216339, 'time_step': 0.007128782272338867, 'init_value': 39.349002838134766}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:07.32[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199537467956543, 'time_algorithm_update': 0.005078299999237061, 'loss': 16.23254201388359, 'time_step': 0.007124477148056031, 'init_value': 48.14204406738281}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:07.40[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019865565299987792, 'time_algorithm_update': 0.005062614679336548, 'loss': 20.743859597325326, 'time_step': 0.007098957777023316, 'init_value': 55.11280059814453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:07.48[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983708143234253, 'time_algorithm_update': 0.005048212051391602, 'loss': 25.950296382546426, 'time_step': 0.007081775903701782, 'init_value': 60.97160720825195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:07.57[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001896381378174, 'time_algorithm_update': 0.005085668802261353, 'loss': 22.773741508960725, 'time_step': 0.007138254880905151, 'init_value': 67.17822265625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:08.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020058300495147704, 'time_algorithm_update': 0.0050917818546295165, 'loss': 26.922310155749322, 'time_step': 0.007148538112640381, 'init_value': 72.658935546875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:08.14[0m [[32m[1minfo     [0m] [1mFQE_20250505200649: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992199182510376, 'time_algorithm_update': 0.00506642484664917, 'loss': 29.137590455770493, 'time_step': 0.00710910964012146, 'init_value': 77.86647033691406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.86647033691406
avg return on 5 trajectories of agent2: 3067.7426333333333
Episode generator created
[2m2025-05-05 20:08.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:08.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:08.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:08.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:08.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200816[0m
[2m2025-05-05 20:08.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:08.24[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019815025329589842, 'time_algorithm_update': 0.004983538866043091, 'loss': 1.3516362575292586, 'time_step': 0.007014595985412598, 'init_value': 10.36916732788086}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:08.33[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019907426834106447, 'time_algorithm_update': 0.005046009063720703, 'loss': 4.016674202233553, 'time_step': 0.0070875084400177, 'init_value': 20.573747634887695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:08.41[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019840455055236818, 'time_algorithm_update': 0.0050443651676177976, 'loss': 8.408850707113743, 'time_step': 0.007078957796096802, 'init_value': 30.42129898071289}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:08.50[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019920525550842284, 'time_algorithm_update': 0.00507194972038269, 'loss': 13.619408561587333, 'time_step': 0.007114693641662597, 'init_value': 40.00630187988281}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:08.58[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893746376037596, 'time_algorithm_update': 0.005061427354812622, 'loss': 17.767036772251128, 'time_step': 0.0071010847091674805, 'init_value': 48.42253875732422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:09.07[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019821362495422365, 'time_algorithm_update': 0.005055058956146241, 'loss': 23.88385208272934, 'time_step': 0.007087197065353394, 'init_value': 56.604331970214844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:09.15[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019921388626098634, 'time_algorithm_update': 0.005053842544555664, 'loss': 28.232062745809554, 'time_step': 0.007096166372299194, 'init_value': 62.076988220214844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:09.23[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019885609149932863, 'time_algorithm_update': 0.005058759212493896, 'loss': 26.84811692285538, 'time_step': 0.007097546577453613, 'init_value': 67.86053466796875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:09.32[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019825799465179443, 'time_algorithm_update': 0.005047342777252197, 'loss': 28.975693495512008, 'time_step': 0.007080132722854614, 'init_value': 72.423095703125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:09.40[0m [[32m[1minfo     [0m] [1mFQE_20250505200816: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198907732963562, 'time_algorithm_update': 0.0050577552318573, 'loss': 29.34463971400261, 'time_step': 0.007097503662109375, 'init_value': 78.31800079345703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.31800079345703
avg return on 5 trajectories of agent3: 3086.1671950000004
Episode generator created
[2m2025-05-05 20:09.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:09.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:09.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:09.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:09.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200943[0m
[2m2025-05-05 20:09.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:09.51[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983250856399536, 'time_algorithm_update': 0.005004516124725342, 'loss': 1.537113969027996, 'time_step': 0.007037627220153809, 'init_value': 9.963203430175781}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:09.59[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019923062324523925, 'time_algorithm_update': 0.005048043251037597, 'loss': 4.353920554220676, 'time_step': 0.007090569496154785, 'init_value': 19.766786575317383}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:10.08[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988373756408691, 'time_algorithm_update': 0.005072568893432617, 'loss': 8.533745496690273, 'time_step': 0.007111285209655762, 'init_value': 29.442218780517578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:10.16[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019927878379821778, 'time_algorithm_update': 0.005067787170410156, 'loss': 12.837869911491872, 'time_step': 0.007111274242401123, 'init_value': 38.68736267089844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:10.25[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019983532428741453, 'time_algorithm_update': 0.005074725866317749, 'loss': 16.725706025838853, 'time_step': 0.0071239213943481445, 'init_value': 47.44089126586914}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:10.33[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019825479984283446, 'time_algorithm_update': 0.005054397344589233, 'loss': 22.611112871527673, 'time_step': 0.00708707332611084, 'init_value': 56.824562072753906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:10.41[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019931774139404297, 'time_algorithm_update': 0.0050547590255737304, 'loss': 26.906691412091256, 'time_step': 0.0070983548164367674, 'init_value': 62.815711975097656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:10.50[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019838428497314453, 'time_algorithm_update': 0.005055017948150635, 'loss': 27.16060924208164, 'time_step': 0.007089256048202514, 'init_value': 70.8365707397461}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:10.58[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019880886077880858, 'time_algorithm_update': 0.005044193744659424, 'loss': 29.414955497980117, 'time_step': 0.007082759380340576, 'init_value': 76.42569732666016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:11.07[0m [[32m[1minfo     [0m] [1mFQE_20250505200943: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019933810234069823, 'time_algorithm_update': 0.005062853813171387, 'loss': 33.00849305486679, 'time_step': 0.007107003688812256, 'init_value': 82.90351104736328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.90351104736328
avg return on 5 trajectories of agent4: 2172.880878666667
Episode generator created
[2m2025-05-05 20:11.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:11.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:11.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:11.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:11.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201108[0m
[2m2025-05-05 20:11.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:11.17[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019834890365600585, 'time_algorithm_update': 0.005018567800521851, 'loss': 1.4270448480844498, 'time_step': 0.007052077531814575, 'init_value': 9.600831031799316}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:11.25[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019947669506072997, 'time_algorithm_update': 0.005102468252182007, 'loss': 3.7056071682274343, 'time_step': 0.007147960901260376, 'init_value': 18.645299911499023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:11.34[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991053581237793, 'time_algorithm_update': 0.0050907740592956545, 'loss': 7.141472234964371, 'time_step': 0.007132429361343384, 'init_value': 27.74872398376465}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:11.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019877912998199463, 'time_algorithm_update': 0.005095526456832886, 'loss': 11.099340406894683, 'time_step': 0.007133603096008301, 'init_value': 36.626129150390625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:11.51[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020007696151733397, 'time_algorithm_update': 0.005101267099380493, 'loss': 15.659346743822098, 'time_step': 0.007153268337249756, 'init_value': 43.81180953979492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:11.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019940078258514405, 'time_algorithm_update': 0.0050997834205627444, 'loss': 19.99509948706627, 'time_step': 0.007144118785858154, 'init_value': 50.763816833496094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:12.08[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019987857341766356, 'time_algorithm_update': 0.005103957891464233, 'loss': 23.652162925243378, 'time_step': 0.00715379524230957, 'init_value': 58.029415130615234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:12.16[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020025568008422852, 'time_algorithm_update': 0.005100919008255005, 'loss': 27.554373806715013, 'time_step': 0.007154419660568238, 'init_value': 63.485130310058594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:12.25[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019873406887054444, 'time_algorithm_update': 0.005072742223739624, 'loss': 28.92083863902092, 'time_step': 0.0071102848052978515, 'init_value': 67.37305450439453}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:12.33[0m [[32m[1minfo     [0m] [1mFQE_20250505201108: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020002338886260986, 'time_algorithm_update': 0.005104761123657226, 'loss': 35.62783351898193, 'time_step': 0.007155884027481079, 'init_value': 72.34806060791016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 72.34806060791016
avg return on 5 trajectories of agent5: 2186.6156523333334
Episode generator created
[2m2025-05-05 20:12.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:12.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:12.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:12.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:12.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201235[0m
[2m2025-05-05 20:12.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:12.43[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981242418289185, 'time_algorithm_update': 0.004997200965881347, 'loss': 1.3290184861570598, 'time_step': 0.0070282907485961915, 'init_value': 10.18388557434082}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:12.51[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019862780570983887, 'time_algorithm_update': 0.005050096273422241, 'loss': 4.046824264585972, 'time_step': 0.007086822986602783, 'init_value': 20.186607360839844}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:13.00[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987632513046265, 'time_algorithm_update': 0.005060209035873413, 'loss': 7.748397349596024, 'time_step': 0.0070978736877441405, 'init_value': 29.715126037597656}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:13.08[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994688034057617, 'time_algorithm_update': 0.005057340860366822, 'loss': 12.861422276496887, 'time_step': 0.007102615118026733, 'init_value': 38.17627716064453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:13.17[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982912302017212, 'time_algorithm_update': 0.005052013874053955, 'loss': 15.851025339603424, 'time_step': 0.007085691690444946, 'init_value': 46.0255126953125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:13.25[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019978322982788085, 'time_algorithm_update': 0.005061909675598144, 'loss': 21.730180815815924, 'time_step': 0.007110571146011353, 'init_value': 53.38456344604492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:13.33[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019894251823425295, 'time_algorithm_update': 0.0050586342811584474, 'loss': 26.433959589600562, 'time_step': 0.007099266529083252, 'init_value': 58.6992301940918}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:13.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019880738258361815, 'time_algorithm_update': 0.00505628776550293, 'loss': 28.361438953876494, 'time_step': 0.007095261573791504, 'init_value': 67.18257904052734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:13.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019877376556396483, 'time_algorithm_update': 0.005050738334655761, 'loss': 29.101695528626443, 'time_step': 0.007088788270950317, 'init_value': 73.92313385009766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:13.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201235: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019697580337524412, 'time_algorithm_update': 0.0050266671180725095, 'loss': 31.99409943675995, 'time_step': 0.007046564340591431, 'init_value': 79.2293472290039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.2293472290039
avg return on 5 trajectories of agent6: 1610.2784510000001
Episode generator created
[2m2025-05-05 20:14.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:14.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:14.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:14.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:14.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201400[0m
[2m2025-05-05 20:14.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:14.09[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020149588584899903, 'time_algorithm_update': 0.005078502893447876, 'loss': 1.3888730134367944, 'time_step': 0.007144321680068969, 'init_value': 10.050904273986816}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:14.17[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984283447265625, 'time_algorithm_update': 0.005047949314117431, 'loss': 4.944290937036276, 'time_step': 0.007082247734069824, 'init_value': 20.248796463012695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:14.25[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019960317611694336, 'time_algorithm_update': 0.005064730167388916, 'loss': 9.658867923259734, 'time_step': 0.007111630201339722, 'init_value': 29.518117904663086}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:14.34[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019863131046295164, 'time_algorithm_update': 0.005065787553787232, 'loss': 16.275344421982766, 'time_step': 0.007102505683898926, 'init_value': 38.261478424072266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:14.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019879267215728758, 'time_algorithm_update': 0.005062703609466553, 'loss': 20.38797480070591, 'time_step': 0.007101223230361938, 'init_value': 45.227657318115234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:14.51[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990039348602295, 'time_algorithm_update': 0.0050755970478057865, 'loss': 26.651240232348442, 'time_step': 0.007116148948669434, 'init_value': 53.04375457763672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:14.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019918198585510256, 'time_algorithm_update': 0.0050699348449707035, 'loss': 31.315998646378517, 'time_step': 0.007112318992614746, 'init_value': 59.59914779663086}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:15.08[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019864327907562255, 'time_algorithm_update': 0.005052364110946656, 'loss': 33.996569031715396, 'time_step': 0.007089014768600464, 'init_value': 65.49751281738281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:15.16[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019529986381530762, 'time_algorithm_update': 0.004973438978195191, 'loss': 36.887194608688354, 'time_step': 0.006975220680236816, 'init_value': 72.62675476074219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:15.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201400: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019575300216674806, 'time_algorithm_update': 0.004981028318405151, 'loss': 41.1974192956686, 'time_step': 0.00698801851272583, 'init_value': 78.46034240722656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.46034240722656
avg return on 5 trajectories of agent7: 1586.6799103333333
Episode generator created
[2m2025-05-05 20:15.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:15.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:15.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:15.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:15.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201525[0m
[2m2025-05-05 20:15.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:15.34[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019318695068359375, 'time_algorithm_update': 0.004860467672348022, 'loss': 1.5196545704603195, 'time_step': 0.006840054750442505, 'init_value': 10.74541187286377}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:15.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019577183723449706, 'time_algorithm_update': 0.004984431505203247, 'loss': 4.51451328971982, 'time_step': 0.006991210699081421, 'init_value': 20.91806983947754}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:15.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019616522789001464, 'time_algorithm_update': 0.00499088191986084, 'loss': 9.743733699202538, 'time_step': 0.007001467227935791, 'init_value': 30.130990982055664}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:15.58[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989729642868042, 'time_algorithm_update': 0.00506731915473938, 'loss': 14.339165869116783, 'time_step': 0.0071071736812591555, 'init_value': 39.29618453979492}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:16.07[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019998815059661867, 'time_algorithm_update': 0.005081021785736084, 'loss': 21.30747826254368, 'time_step': 0.0071316173076629635, 'init_value': 46.75586700439453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:16.15[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199043607711792, 'time_algorithm_update': 0.005065745592117309, 'loss': 23.85828660738468, 'time_step': 0.007106555938720703, 'init_value': 54.28009796142578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:16.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019873595237731934, 'time_algorithm_update': 0.0050540902614593505, 'loss': 28.978062253952025, 'time_step': 0.007091759204864502, 'init_value': 61.11879348754883}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:16.32[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991854667663574, 'time_algorithm_update': 0.005070154428482056, 'loss': 32.1428851659298, 'time_step': 0.0071125469207763675, 'init_value': 67.10746002197266}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:16.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019895076751708985, 'time_algorithm_update': 0.005059069871902465, 'loss': 34.531651930570604, 'time_step': 0.007098918437957764, 'init_value': 72.39430236816406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:16.49[0m [[32m[1minfo     [0m] [1mFQE_20250505201525: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992485761642456, 'time_algorithm_update': 0.005070029735565185, 'loss': 35.69917054748535, 'time_step': 0.007112550735473633, 'init_value': 76.5680160522461}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.5680160522461
avg return on 5 trajectories of agent8: 1568.298501
Episode generator created
[2m2025-05-05 20:16.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:16.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:16.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:16.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:16.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201650[0m
[2m2025-05-05 20:16.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:16.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019829108715057374, 'time_algorithm_update': 0.004987409353256225, 'loss': 1.4195700342357158, 'time_step': 0.007019800901412964, 'init_value': 9.564476013183594}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:17.07[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972024202346802, 'time_algorithm_update': 0.005030539035797119, 'loss': 3.976231026083231, 'time_step': 0.007051846981048584, 'init_value': 19.6030216217041}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:17.16[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019845988750457765, 'time_algorithm_update': 0.005038483858108521, 'loss': 7.7143529117703435, 'time_step': 0.007072829008102417, 'init_value': 28.216785430908203}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:17.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994119882583618, 'time_algorithm_update': 0.005059324502944947, 'loss': 13.094431955993176, 'time_step': 0.007103814363479614, 'init_value': 36.70042419433594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:17.32[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020025491714477537, 'time_algorithm_update': 0.0050837030410766605, 'loss': 18.660094661355018, 'time_step': 0.007137201309204102, 'init_value': 44.534706115722656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:17.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199123740196228, 'time_algorithm_update': 0.005054245710372925, 'loss': 23.213370172142984, 'time_step': 0.007095746517181397, 'init_value': 52.263999938964844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:17.49[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995368003845215, 'time_algorithm_update': 0.005050325870513916, 'loss': 24.573935930609704, 'time_step': 0.007095934391021729, 'init_value': 58.36415481567383}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:17.58[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992213249206543, 'time_algorithm_update': 0.005055072784423828, 'loss': 26.765783723950385, 'time_step': 0.007097598075866699, 'init_value': 65.39923858642578}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:18.06[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019962239265441896, 'time_algorithm_update': 0.005063904285430908, 'loss': 28.130707898736, 'time_step': 0.007110397100448609, 'init_value': 70.26152801513672}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:18.15[0m [[32m[1minfo     [0m] [1mFQE_20250505201650: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992553949356079, 'time_algorithm_update': 0.005041277885437011, 'loss': 31.956802314519884, 'time_step': 0.007084329128265381, 'init_value': 74.5623550415039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.5623550415039
avg return on 5 trajectories of agent9: 1563.9130906666667
Episode generator created
[2m2025-05-05 20:18.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:18.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:18.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:18.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:18.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201816[0m
[2m2025-05-05 20:18.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:18.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975165843963623, 'time_algorithm_update': 0.004987422466278076, 'loss': 1.48420573797822, 'time_step': 0.007012087345123291, 'init_value': 10.707829475402832}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:18.33[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994429349899292, 'time_algorithm_update': 0.005070047616958618, 'loss': 3.557529113382101, 'time_step': 0.007114625692367553, 'init_value': 21.564979553222656}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:18.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019657320976257326, 'time_algorithm_update': 0.005023549795150756, 'loss': 8.47089740383625, 'time_step': 0.007038576126098633, 'init_value': 31.832019805908203}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:18.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019889419078826906, 'time_algorithm_update': 0.005074653148651123, 'loss': 10.61008427989483, 'time_step': 0.0071141993999481205, 'init_value': 40.79647445678711}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:18.58[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199212384223938, 'time_algorithm_update': 0.005077709674835205, 'loss': 15.354124244689942, 'time_step': 0.00712037467956543, 'init_value': 49.511940002441406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:19.06[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989321708679199, 'time_algorithm_update': 0.005075077056884766, 'loss': 18.690930215716364, 'time_step': 0.007114768028259277, 'init_value': 57.748573303222656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:19.15[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019942123889923097, 'time_algorithm_update': 0.005083031177520752, 'loss': 23.356553580284118, 'time_step': 0.007128312587738037, 'init_value': 64.34728240966797}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:19.23[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996624231338501, 'time_algorithm_update': 0.00508006763458252, 'loss': 19.349517230510713, 'time_step': 0.0071273396015167235, 'init_value': 69.98149871826172}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:19.32[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996723175048828, 'time_algorithm_update': 0.005084871530532837, 'loss': 24.087707540631293, 'time_step': 0.0071320788860321045, 'init_value': 76.95468139648438}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:19.40[0m [[32m[1minfo     [0m] [1mFQE_20250505201816: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983908176422119, 'time_algorithm_update': 0.005061420202255249, 'loss': 29.443830847144127, 'time_step': 0.007095900774002076, 'init_value': 82.4182357788086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.4182357788086
avg return on 5 trajectories of agent10: 2521.811984
Episode generator created
[2m2025-05-05 20:19.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:19.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:19.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:19.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:19.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201942[0m
[2m2025-05-05 20:19.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:19.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019846391677856446, 'time_algorithm_update': 0.004980030059814453, 'loss': 1.4933532577306032, 'time_step': 0.007013671875, 'init_value': 10.061983108520508}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:19.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989534854888916, 'time_algorithm_update': 0.005023685216903687, 'loss': 4.8399918377399445, 'time_step': 0.007063073635101318, 'init_value': 20.103374481201172}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:20.07[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019861729145050047, 'time_algorithm_update': 0.005037235498428345, 'loss': 8.717996655762196, 'time_step': 0.007073909997940064, 'init_value': 29.369535446166992}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:20.16[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964532136917114, 'time_algorithm_update': 0.004994432926177978, 'loss': 14.039124224603176, 'time_step': 0.0070084333419799805, 'init_value': 38.1711540222168}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:20.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019843697547912596, 'time_algorithm_update': 0.00503572678565979, 'loss': 17.76439692032337, 'time_step': 0.007070127964019775, 'init_value': 45.691314697265625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:20.32[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019767975807189943, 'time_algorithm_update': 0.0050324459075927735, 'loss': 21.66817118060589, 'time_step': 0.007059546947479248, 'init_value': 50.94502639770508}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:20.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980725288391113, 'time_algorithm_update': 0.005031465768814087, 'loss': 25.08100908613205, 'time_step': 0.007062098026275635, 'init_value': 56.888641357421875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:20.49[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986328363418579, 'time_algorithm_update': 0.005046213865280151, 'loss': 23.29846987056732, 'time_step': 0.007082471370697022, 'init_value': 63.03960037231445}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:20.57[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991565704345703, 'time_algorithm_update': 0.00504166841506958, 'loss': 28.993884288311005, 'time_step': 0.007083620309829712, 'init_value': 68.7604751586914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:21.06[0m [[32m[1minfo     [0m] [1mFQE_20250505201942: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019938907623291017, 'time_algorithm_update': 0.005049819469451904, 'loss': 30.786255384802818, 'time_step': 0.007094263553619385, 'init_value': 73.4699478149414}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.4699478149414
avg return on 5 trajectories of agent11: 1736.2896380000002
Episode generator created
[2m2025-05-05 20:21.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:21.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:21.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:21.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:21.07[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202107[0m
[2m2025-05-05 20:21.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:21.16[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019812440872192384, 'time_algorithm_update': 0.00499708890914917, 'loss': 1.3731501899957657, 'time_step': 0.00702791166305542, 'init_value': 10.560206413269043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:21.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993337631225586, 'time_algorithm_update': 0.005073736190795899, 'loss': 4.280461630612612, 'time_step': 0.007117721319198608, 'init_value': 20.508647918701172}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:21.33[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987575531005859, 'time_algorithm_update': 0.005057541370391846, 'loss': 9.71174675911665, 'time_step': 0.007095805883407593, 'init_value': 31.021242141723633}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:21.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990442752838135, 'time_algorithm_update': 0.005059136152267456, 'loss': 14.151645297765732, 'time_step': 0.007100430250167847, 'init_value': 39.739784240722656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:21.49[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971196174621582, 'time_algorithm_update': 0.0050377209186553955, 'loss': 19.176126057624817, 'time_step': 0.0070582771301269534, 'init_value': 47.46006774902344}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:21.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019857397079467774, 'time_algorithm_update': 0.0050586252212524415, 'loss': 24.26453585445881, 'time_step': 0.007095738887786866, 'init_value': 55.44386291503906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:22.06[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019906716346740723, 'time_algorithm_update': 0.005060846090316772, 'loss': 26.813824950575828, 'time_step': 0.007101789236068725, 'init_value': 61.57998275756836}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:22.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997629642486572, 'time_algorithm_update': 0.005065901041030884, 'loss': 28.97413811683655, 'time_step': 0.007114073514938354, 'init_value': 67.90507507324219}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:22.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993844747543335, 'time_algorithm_update': 0.005055799007415772, 'loss': 32.74928158831597, 'time_step': 0.007099559545516968, 'init_value': 74.1443862915039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:22.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202107: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020020289421081544, 'time_algorithm_update': 0.005070508003234863, 'loss': 35.75845726561546, 'time_step': 0.007123855113983155, 'init_value': 78.84906005859375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.84906005859375
avg return on 5 trajectories of agent12: 1654.2539496666668
Episode generator created
[2m2025-05-05 20:22.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:22.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:22.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:22.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:22.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202233[0m
[2m2025-05-05 20:22.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:22.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984521150588989, 'time_algorithm_update': 0.004982301950454712, 'loss': 1.4045256863832474, 'time_step': 0.007016713857650757, 'init_value': 10.021191596984863}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:22.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019915080070495605, 'time_algorithm_update': 0.005029748916625976, 'loss': 4.068872985750437, 'time_step': 0.00707150936126709, 'init_value': 19.73761558532715}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:22.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989734649658203, 'time_algorithm_update': 0.005037266492843628, 'loss': 8.791348905086517, 'time_step': 0.007077453851699829, 'init_value': 29.162992477416992}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:23.06[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019916794300079347, 'time_algorithm_update': 0.005042670726776123, 'loss': 12.552640689730644, 'time_step': 0.00708481764793396, 'init_value': 36.57231521606445}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:23.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909331798553466, 'time_algorithm_update': 0.005046808719635009, 'loss': 17.06206847691536, 'time_step': 0.007088081836700439, 'init_value': 43.953651428222656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:23.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019558749198913573, 'time_algorithm_update': 0.004994807958602905, 'loss': 18.633635343790054, 'time_step': 0.007000157594680786, 'init_value': 52.67433166503906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:23.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199528431892395, 'time_algorithm_update': 0.005048743724822998, 'loss': 23.64446848654747, 'time_step': 0.007095127582550049, 'init_value': 59.40349578857422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:23.40[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019851722717285154, 'time_algorithm_update': 0.005046039581298828, 'loss': 27.04789160168171, 'time_step': 0.007082045793533325, 'init_value': 64.64599609375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:23.48[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198830771446228, 'time_algorithm_update': 0.005040002584457397, 'loss': 28.194598346471786, 'time_step': 0.007079115390777588, 'init_value': 69.50714874267578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:23.57[0m [[32m[1minfo     [0m] [1mFQE_20250505202233: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019914700984954834, 'time_algorithm_update': 0.005049858808517456, 'loss': 29.398220516204834, 'time_step': 0.007092262506484985, 'init_value': 74.9808120727539}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.9808120727539
avg return on 5 trajectories of agent13: 2237.5753753333333
Episode generator created
[2m2025-05-05 20:23.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:23.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:23.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:23.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:23.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202358[0m
[2m2025-05-05 20:23.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:24.07[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019793660640716553, 'time_algorithm_update': 0.005008626937866211, 'loss': 1.4092304429411888, 'time_step': 0.007037680387496948, 'init_value': 10.668493270874023}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:24.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019870765209198, 'time_algorithm_update': 0.005066130399703979, 'loss': 4.26995518258214, 'time_step': 0.007103724479675293, 'init_value': 21.937509536743164}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:24.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953808784484864, 'time_algorithm_update': 0.005087407827377319, 'loss': 8.09366579514742, 'time_step': 0.007133389711380005, 'init_value': 32.30216979980469}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:24.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020130646228790285, 'time_algorithm_update': 0.005132093191146851, 'loss': 12.23723730957508, 'time_step': 0.007196676254272461, 'init_value': 41.37015151977539}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:24.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001985599756240845, 'time_algorithm_update': 0.005080699443817139, 'loss': 15.024577956676483, 'time_step': 0.007116256237030029, 'init_value': 50.398555755615234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:24.49[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019903852939605715, 'time_algorithm_update': 0.005084766387939453, 'loss': 20.630340876698494, 'time_step': 0.007125678300857544, 'init_value': 59.19464874267578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:24.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008049726486206, 'time_algorithm_update': 0.00509992241859436, 'loss': 24.575478302001954, 'time_step': 0.007158786535263062, 'init_value': 66.14247131347656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:25.06[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020297300815582276, 'time_algorithm_update': 0.00516199803352356, 'loss': 27.16933489060402, 'time_step': 0.007243536472320557, 'init_value': 70.61807250976562}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:25.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019561965465545654, 'time_algorithm_update': 0.0050093867778778075, 'loss': 29.213968450307846, 'time_step': 0.007014854907989502, 'init_value': 75.50213623046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:25.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202358: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966999292373657, 'time_algorithm_update': 0.005001158714294434, 'loss': 28.0224084905386, 'time_step': 0.007018059015274048, 'init_value': 80.47254943847656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.47254943847656
avg return on 5 trajectories of agent14: 3207.8477980000002
Episode generator created
[2m2025-05-05 20:25.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:25.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:25.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:25.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:25.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202525[0m
[2m2025-05-05 20:25.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:25.34[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001947408676147461, 'time_algorithm_update': 0.004914061307907104, 'loss': 1.5383677460551262, 'time_step': 0.006910361289978027, 'init_value': 10.2962007522583}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:25.42[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019609570503234864, 'time_algorithm_update': 0.004982050180435181, 'loss': 3.681891440451145, 'time_step': 0.0069925217628479, 'init_value': 20.53657341003418}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:25.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019672064781188965, 'time_algorithm_update': 0.004988212585449219, 'loss': 8.79624758476019, 'time_step': 0.007004865884780884, 'init_value': 31.390663146972656}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:25.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019769065380096434, 'time_algorithm_update': 0.0050278480052948, 'loss': 12.82368086975813, 'time_step': 0.007055087089538574, 'init_value': 40.94571304321289}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:26.07[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980386972427368, 'time_algorithm_update': 0.005058825254440308, 'loss': 19.853291372299193, 'time_step': 0.007089655876159668, 'init_value': 48.6996955871582}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:26.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019941813945770263, 'time_algorithm_update': 0.005068844556808472, 'loss': 23.424102272033693, 'time_step': 0.007113771438598633, 'init_value': 56.22380065917969}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:26.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982055187225342, 'time_algorithm_update': 0.005046179056167602, 'loss': 25.838672769427298, 'time_step': 0.0070788729190826415, 'init_value': 62.949459075927734}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:26.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991920471191406, 'time_algorithm_update': 0.00506905746459961, 'loss': 27.21986733198166, 'time_step': 0.007111997604370117, 'init_value': 69.76423645019531}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:26.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019817516803741454, 'time_algorithm_update': 0.005059995174407959, 'loss': 31.878106979370116, 'time_step': 0.007092299938201904, 'init_value': 73.6893310546875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:26.49[0m [[32m[1minfo     [0m] [1mFQE_20250505202525: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978171110153198, 'time_algorithm_update': 0.005031946659088135, 'loss': 30.018194812059402, 'time_step': 0.007060473203659058, 'init_value': 75.9154281616211}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.9154281616211
avg return on 5 trajectories of agent15: 2027.6696953333333
Episode generator created
[2m2025-05-05 20:26.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:26.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:26.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:26.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:26.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202651[0m
[2m2025-05-05 20:26.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:26.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019888038635253904, 'time_algorithm_update': 0.005009001970291137, 'loss': 1.4624305806308984, 'time_step': 0.007047398328781128, 'init_value': 10.083060264587402}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:27.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019876563549041746, 'time_algorithm_update': 0.005083277702331543, 'loss': 4.069232561945915, 'time_step': 0.00712092924118042, 'init_value': 21.03338050842285}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:27.16[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001101493835449, 'time_algorithm_update': 0.0050885329246520995, 'loss': 7.971017952620983, 'time_step': 0.007139922142028809, 'init_value': 30.8289794921875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:27.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996788263320923, 'time_algorithm_update': 0.005076065301895142, 'loss': 11.911568394184112, 'time_step': 0.007123266935348511, 'init_value': 40.028900146484375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:27.33[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008169174194336, 'time_algorithm_update': 0.005106595516204834, 'loss': 17.309581859350203, 'time_step': 0.0071656668186187746, 'init_value': 48.361785888671875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:27.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002530574798584, 'time_algorithm_update': 0.005093958139419556, 'loss': 21.65266330242157, 'time_step': 0.007147523164749145, 'init_value': 55.28178787231445}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:27.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020143115520477295, 'time_algorithm_update': 0.005126869916915894, 'loss': 27.16524209332466, 'time_step': 0.007192371606826782, 'init_value': 64.1138687133789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:27.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019936954975128176, 'time_algorithm_update': 0.0050954511165618895, 'loss': 29.2410685403347, 'time_step': 0.007140017986297607, 'init_value': 70.28255462646484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:28.07[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020007054805755613, 'time_algorithm_update': 0.0051000118255615234, 'loss': 30.00312206029892, 'time_step': 0.00715238618850708, 'init_value': 76.85713195800781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202651: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020013439655303957, 'time_algorithm_update': 0.005096382141113282, 'loss': 31.45710043311119, 'time_step': 0.007148859739303589, 'init_value': 84.23006439208984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 84.23006439208984
avg return on 5 trajectories of agent16: 2533.4645226666667
Episode generator created
[2m2025-05-05 20:28.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:28.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:28.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:28.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:28.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202817[0m
[2m2025-05-05 20:28.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:28.26[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966499090194702, 'time_algorithm_update': 0.004975048065185547, 'loss': 1.4028587581813334, 'time_step': 0.00698989987373352, 'init_value': 10.169661521911621}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:28.34[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995145082473755, 'time_algorithm_update': 0.0050859456062316896, 'loss': 4.305900772929191, 'time_step': 0.007131772756576538, 'init_value': 20.692232131958008}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:28.43[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988523006439209, 'time_algorithm_update': 0.005078827142715454, 'loss': 8.655917082965374, 'time_step': 0.007117934465408325, 'init_value': 31.817413330078125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:28.51[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995129346847534, 'time_algorithm_update': 0.005087234497070312, 'loss': 14.37436769849062, 'time_step': 0.007134379386901856, 'init_value': 40.82709884643555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:28.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019907948970794677, 'time_algorithm_update': 0.005079685926437378, 'loss': 19.10084369683266, 'time_step': 0.007120907068252563, 'init_value': 49.84449768066406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:29.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019810140132904054, 'time_algorithm_update': 0.005079761505126953, 'loss': 24.8247160500288, 'time_step': 0.007111100196838379, 'init_value': 58.476036071777344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:29.17[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020335373878479003, 'time_algorithm_update': 0.005168497562408447, 'loss': 29.433992470383643, 'time_step': 0.007254057407379151, 'init_value': 66.0161361694336}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:29.25[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999387979507446, 'time_algorithm_update': 0.005080855846405029, 'loss': 32.29090120494366, 'time_step': 0.007131041765213013, 'init_value': 71.05330657958984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:29.33[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002011488676071167, 'time_algorithm_update': 0.005090073108673095, 'loss': 30.18088815045357, 'time_step': 0.007152889728546143, 'init_value': 74.59978485107422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:29.42[0m [[32m[1minfo     [0m] [1mFQE_20250505202817: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019993698596954346, 'time_algorithm_update': 0.005080882310867309, 'loss': 38.35208579480648, 'time_step': 0.007131374597549438, 'init_value': 81.53532409667969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.53532409667969
avg return on 5 trajectories of agent17: 2183.354744333333
Episode generator created
[2m2025-05-05 20:29.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:29.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:29.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:29.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:29.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202943[0m
[2m2025-05-05 20:29.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:29.52[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994873523712158, 'time_algorithm_update': 0.004996633291244507, 'loss': 1.4180866704881192, 'time_step': 0.007040804862976075, 'init_value': 9.72208309173584}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:30.00[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019710917472839356, 'time_algorithm_update': 0.0050384244918823245, 'loss': 4.386811162143946, 'time_step': 0.007058840990066528, 'init_value': 19.87427520751953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:30.09[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019923293590545653, 'time_algorithm_update': 0.0050489590167999265, 'loss': 10.0640671569705, 'time_step': 0.0070922222137451175, 'init_value': 29.92519187927246}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:30.17[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019998018741607666, 'time_algorithm_update': 0.005057336568832398, 'loss': 13.91703567647934, 'time_step': 0.007107809543609619, 'init_value': 40.292484283447266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:30.25[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019942052364349365, 'time_algorithm_update': 0.005066329479217529, 'loss': 21.576014347195624, 'time_step': 0.007110930442810058, 'init_value': 49.58464813232422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:30.34[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019993913173675538, 'time_algorithm_update': 0.005080922842025757, 'loss': 28.700894352316855, 'time_step': 0.0071312556266784665, 'init_value': 56.73895263671875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:30.42[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984138250350952, 'time_algorithm_update': 0.005063938140869141, 'loss': 30.28818028950691, 'time_step': 0.007098311424255371, 'init_value': 61.93679428100586}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:30.51[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019978833198547362, 'time_algorithm_update': 0.00507725977897644, 'loss': 32.64687661516666, 'time_step': 0.007126073837280273, 'init_value': 66.80744934082031}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:30.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019993934631347657, 'time_algorithm_update': 0.005072474479675293, 'loss': 30.58622396802902, 'time_step': 0.007122717618942261, 'init_value': 71.37861633300781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:31.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202943: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991421937942505, 'time_algorithm_update': 0.005061724901199341, 'loss': 34.878240000724794, 'time_step': 0.007103470087051392, 'init_value': 76.6189956665039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.6189956665039
avg return on 5 trajectories of agent18: 1518.2308486666668
Episode generator created
[2m2025-05-05 20:31.09[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:31.09[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:31.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:31.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:31.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203109[0m
[2m2025-05-05 20:31.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:31.17[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893839359283448, 'time_algorithm_update': 0.005019627094268799, 'loss': 1.445957448348403, 'time_step': 0.007059180974960327, 'init_value': 10.312995910644531}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002016261339187622, 'time_algorithm_update': 0.005131670236587524, 'loss': 4.72750052317977, 'time_step': 0.0071995360851287845, 'init_value': 20.844074249267578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:31.34[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019770655632019045, 'time_algorithm_update': 0.005044110298156738, 'loss': 9.344769994437694, 'time_step': 0.007071135044097901, 'init_value': 29.58095359802246}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:31.43[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992449998855591, 'time_algorithm_update': 0.005070041894912719, 'loss': 13.202882407009602, 'time_step': 0.007113202571868897, 'init_value': 38.2410774230957}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:31.51[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991537570953369, 'time_algorithm_update': 0.0050788593292236325, 'loss': 18.81424369132519, 'time_step': 0.007121105194091797, 'init_value': 47.10881042480469}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:32.00[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019887611865997312, 'time_algorithm_update': 0.005075846910476685, 'loss': 22.52360807800293, 'time_step': 0.007116489887237549, 'init_value': 54.41660690307617}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:32.08[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997227668762207, 'time_algorithm_update': 0.00508340311050415, 'loss': 26.503480399250986, 'time_step': 0.007131093263626099, 'init_value': 61.30110549926758}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:32.16[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994480848312378, 'time_algorithm_update': 0.005092188119888306, 'loss': 26.679920739412307, 'time_step': 0.007137259006500244, 'init_value': 68.03231811523438}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:32.25[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019984235763549803, 'time_algorithm_update': 0.005084933996200561, 'loss': 31.462810065507888, 'time_step': 0.0071342577934265135, 'init_value': 73.84751892089844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:32.33[0m [[32m[1minfo     [0m] [1mFQE_20250505203109: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020063467025756834, 'time_algorithm_update': 0.005088370561599731, 'loss': 34.78758912408352, 'time_step': 0.007145784616470337, 'init_value': 79.83699035644531}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.83699035644531
avg return on 5 trajectories of agent19: 2132.229805
Episode generator created
[2m2025-05-05 20:32.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:32.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:32.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:32.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:32.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203235[0m
[2m2025-05-05 20:32.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:32.43[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973987340927124, 'time_algorithm_update': 0.004993508338928223, 'loss': 1.2807671964019538, 'time_step': 0.007017130851745605, 'init_value': 9.953764915466309}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:32.52[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992518186569214, 'time_algorithm_update': 0.005069669246673584, 'loss': 3.940355854511261, 'time_step': 0.007112915754318237, 'init_value': 20.110824584960938}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:33.00[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987422466278076, 'time_algorithm_update': 0.0050552902221679685, 'loss': 8.841834416747092, 'time_step': 0.007093280553817749, 'init_value': 29.780315399169922}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:33.09[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969095230102539, 'time_algorithm_update': 0.005027790784835815, 'loss': 12.920212927699088, 'time_step': 0.007046815872192383, 'init_value': 38.90542984008789}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:33.17[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986602544784546, 'time_algorithm_update': 0.005064850807189942, 'loss': 17.01073830986023, 'time_step': 0.007102671861648559, 'init_value': 48.30079650878906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:33.25[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019758780002593996, 'time_algorithm_update': 0.005041290044784546, 'loss': 21.02363944685459, 'time_step': 0.007067450284957886, 'init_value': 55.62006378173828}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:33.34[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019822468757629396, 'time_algorithm_update': 0.005066915035247803, 'loss': 26.445951561927796, 'time_step': 0.007099564790725708, 'init_value': 62.7168083190918}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:33.42[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994914770126343, 'time_algorithm_update': 0.005068634271621704, 'loss': 30.94039348101616, 'time_step': 0.007113885402679443, 'init_value': 69.71784210205078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:33.51[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019913079738616943, 'time_algorithm_update': 0.005077670335769654, 'loss': 29.665845096111298, 'time_step': 0.0071194348335266115, 'init_value': 76.73883819580078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:33.59[0m [[32m[1minfo     [0m] [1mFQE_20250505203235: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990720748901367, 'time_algorithm_update': 0.005066309928894043, 'loss': 32.79146804726124, 'time_step': 0.007108044385910034, 'init_value': 81.31790161132812}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.31790161132812
ave advantage rew: 78.38180198669434, std: 3.1368285610797217
avg cum rews: 2163.8311846833335, std: 516.6235169905177
Pearson correlation coefficient: 0.04307725456817332
Spearman correlation coefficient: -0.012030075187969926
Kendall Tau correlation coefficient: 0.021052631578947368
the best agent: 15, best agent cum rewards: 2027.6696953333333
1963
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01730825916246278
avg return on 5 trajectories of agent0: 2062.8841076666668
Episode generator created
[2m2025-05-05 20:34.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:34.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:34.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:34.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:34.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203411[0m
[2m2025-05-05 20:34.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:34.19[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019783124923706055, 'time_algorithm_update': 0.004987327575683593, 'loss': 1.3879066945016385, 'time_step': 0.007015270471572876, 'init_value': 10.673782348632812}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:34.28[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019912433624267576, 'time_algorithm_update': 0.0050617561340332035, 'loss': 3.897852151930332, 'time_step': 0.007103585481643677, 'init_value': 21.95756721496582}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:34.36[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019844963550567627, 'time_algorithm_update': 0.005058465957641601, 'loss': 9.257187150418758, 'time_step': 0.007092962503433228, 'init_value': 32.093994140625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:34.44[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019814982414245604, 'time_algorithm_update': 0.005052719593048096, 'loss': 14.368262988328933, 'time_step': 0.007084686756134034, 'init_value': 42.52050018310547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:34.53[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200197172164917, 'time_algorithm_update': 0.005093630075454712, 'loss': 18.110646680235863, 'time_step': 0.007147063493728637, 'init_value': 51.307220458984375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:35.01[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019890875816345214, 'time_algorithm_update': 0.005072705030441284, 'loss': 20.762160583734513, 'time_step': 0.007112434148788452, 'init_value': 58.4480094909668}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:35.10[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998213768005371, 'time_algorithm_update': 0.0050685939788818355, 'loss': 27.076127207279207, 'time_step': 0.007117791891098023, 'init_value': 64.26873016357422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:35.18[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196669340133667, 'time_algorithm_update': 0.0050207810401916506, 'loss': 30.31968762397766, 'time_step': 0.007036948204040527, 'init_value': 70.48963165283203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:35.26[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019646379947662355, 'time_algorithm_update': 0.004991530179977417, 'loss': 30.05187882733345, 'time_step': 0.007005382537841797, 'init_value': 75.92037963867188}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:35.35[0m [[32m[1minfo     [0m] [1mFQE_20250505203411: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019671096801757815, 'time_algorithm_update': 0.004994157791137695, 'loss': 34.92136296772957, 'time_step': 0.00701120924949646, 'init_value': 80.00894927978516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.00894927978516
avg return on 5 trajectories of agent1: 2233.3536433333334
Episode generator created
[2m2025-05-05 20:35.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:35.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:35.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:35.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:35.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203536[0m
[2m2025-05-05 20:35.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:35.45[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019455347061157226, 'time_algorithm_update': 0.004902018547058106, 'loss': 1.4314057144373655, 'time_step': 0.006895601749420166, 'init_value': 10.007161140441895}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:35.53[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00195982027053833, 'time_algorithm_update': 0.004955448150634765, 'loss': 4.549084442347288, 'time_step': 0.006964588165283203, 'init_value': 19.962018966674805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:36.01[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019536793231964113, 'time_algorithm_update': 0.004963205099105835, 'loss': 9.145835424304009, 'time_step': 0.006966242074966431, 'init_value': 30.783220291137695}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:36.10[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975032091140747, 'time_algorithm_update': 0.005044015169143677, 'loss': 14.86607525753975, 'time_step': 0.007069245338439941, 'init_value': 39.864585876464844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:36.18[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988745927810669, 'time_algorithm_update': 0.005063786983489991, 'loss': 19.03131114566326, 'time_step': 0.007103069543838501, 'init_value': 46.88032150268555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:36.26[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019752388000488282, 'time_algorithm_update': 0.005054508924484253, 'loss': 22.03650005567074, 'time_step': 0.0070798490047454836, 'init_value': 54.39876174926758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:36.35[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984025478363037, 'time_algorithm_update': 0.005049260139465332, 'loss': 27.52923028707504, 'time_step': 0.007083903551101684, 'init_value': 63.2896842956543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:36.43[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019799017906188964, 'time_algorithm_update': 0.005052726984024048, 'loss': 30.61853496980667, 'time_step': 0.007083090543746948, 'init_value': 69.9556655883789}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:36.52[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019867749214172365, 'time_algorithm_update': 0.005070748329162597, 'loss': 31.702590872406958, 'time_step': 0.007108350276947021, 'init_value': 75.95365142822266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:37.00[0m [[32m[1minfo     [0m] [1mFQE_20250505203536: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019764301776885986, 'time_algorithm_update': 0.005043165445327759, 'loss': 33.887869811534884, 'time_step': 0.007069955110549927, 'init_value': 80.78832244873047}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.78832244873047
avg return on 5 trajectories of agent2: 1787.8964253333334
Episode generator created
[2m2025-05-05 20:37.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:37.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:37.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:37.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:37.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203702[0m
[2m2025-05-05 20:37.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:37.10[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019768497943878174, 'time_algorithm_update': 0.004991835117340088, 'loss': 1.3306607801914214, 'time_step': 0.007018729448318482, 'init_value': 10.105555534362793}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:37.18[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991235017776489, 'time_algorithm_update': 0.0050879459381103515, 'loss': 4.5034262185394764, 'time_step': 0.007129715442657471, 'init_value': 19.661861419677734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:37.27[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019916989803314207, 'time_algorithm_update': 0.005071156263351441, 'loss': 9.558266718149186, 'time_step': 0.007113472461700439, 'init_value': 30.254993438720703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:37.35[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020040366649627687, 'time_algorithm_update': 0.005092475891113281, 'loss': 16.531839940428736, 'time_step': 0.007147670984268189, 'init_value': 38.95854187011719}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:37.44[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019859428405761717, 'time_algorithm_update': 0.0050596997737884526, 'loss': 21.233886072039603, 'time_step': 0.007095939397811889, 'init_value': 47.79423522949219}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:37.52[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992769002914429, 'time_algorithm_update': 0.005076250791549683, 'loss': 27.774274389863013, 'time_step': 0.007119649410247802, 'init_value': 55.990726470947266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:38.00[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019834022521972657, 'time_algorithm_update': 0.005070983409881592, 'loss': 30.830966827273368, 'time_step': 0.007105038166046142, 'init_value': 63.23145294189453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:38.09[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990932464599609, 'time_algorithm_update': 0.005083634614944458, 'loss': 35.37427117836475, 'time_step': 0.007125970840454102, 'init_value': 70.96644592285156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:38.18[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019999310970306395, 'time_algorithm_update': 0.005081553936004638, 'loss': 41.55791251730919, 'time_step': 0.007132672548294068, 'init_value': 78.2653579711914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:38.26[0m [[32m[1minfo     [0m] [1mFQE_20250505203702: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020156600475311278, 'time_algorithm_update': 0.005135727643966675, 'loss': 41.439705842494966, 'time_step': 0.007204866170883179, 'init_value': 83.5870361328125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.5870361328125
avg return on 5 trajectories of agent3: 1810.6790290000001
Episode generator created
[2m2025-05-05 20:38.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:38.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:38.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:38.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:38.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203827[0m
[2m2025-05-05 20:38.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:38.36[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019797658920288085, 'time_algorithm_update': 0.005004622936248779, 'loss': 1.4943564734384418, 'time_step': 0.007034739255905151, 'init_value': 10.221031188964844}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:38.44[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019864418506622314, 'time_algorithm_update': 0.005036694288253784, 'loss': 4.589297422289849, 'time_step': 0.007073905467987061, 'init_value': 20.227458953857422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:38.53[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019896547794342042, 'time_algorithm_update': 0.005029754161834717, 'loss': 9.867354831814765, 'time_step': 0.007069817304611206, 'init_value': 30.98897361755371}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:39.01[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988861799240112, 'time_algorithm_update': 0.0050421936511993405, 'loss': 17.584162306845187, 'time_step': 0.007081397771835327, 'init_value': 40.36933898925781}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:39.09[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019921576976776123, 'time_algorithm_update': 0.005058290481567383, 'loss': 21.252265735149383, 'time_step': 0.007101174116134644, 'init_value': 48.63393783569336}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:39.18[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019729177951812744, 'time_algorithm_update': 0.005035472631454468, 'loss': 28.25749294614792, 'time_step': 0.007058807134628296, 'init_value': 55.93981170654297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:39.26[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019942867755889894, 'time_algorithm_update': 0.005046868562698364, 'loss': 31.29591403591633, 'time_step': 0.007092133045196534, 'init_value': 64.17218780517578}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:39.35[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020049195289611817, 'time_algorithm_update': 0.005063934326171875, 'loss': 37.45622808909416, 'time_step': 0.00712034296989441, 'init_value': 70.29100036621094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:39.43[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989217519760132, 'time_algorithm_update': 0.005046685218811035, 'loss': 36.81603393054009, 'time_step': 0.007086816549301147, 'init_value': 74.60807800292969}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:39.52[0m [[32m[1minfo     [0m] [1mFQE_20250505203827: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019823954105377198, 'time_algorithm_update': 0.005036181211471558, 'loss': 37.42078855252266, 'time_step': 0.007069286108016968, 'init_value': 79.84846496582031}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.84846496582031
avg return on 5 trajectories of agent4: 2225.507916666667
Episode generator created
[2m2025-05-05 20:39.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:39.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:39.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:39.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:39.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203953[0m
[2m2025-05-05 20:39.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:40.02[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982588768005371, 'time_algorithm_update': 0.005008345127105713, 'loss': 1.562794216439128, 'time_step': 0.007040972709655762, 'init_value': 11.602913856506348}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:40.10[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909863471984863, 'time_algorithm_update': 0.005066957712173462, 'loss': 4.792133705854416, 'time_step': 0.0071089727878570555, 'init_value': 22.272932052612305}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:40.19[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997596263885498, 'time_algorithm_update': 0.005056830167770386, 'loss': 9.605899146318436, 'time_step': 0.007105624914169312, 'init_value': 32.788421630859375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:40.27[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992460012435913, 'time_algorithm_update': 0.005061940193176269, 'loss': 13.943755853056908, 'time_step': 0.0071053140163421635, 'init_value': 40.453208923339844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:40.35[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019994938373565675, 'time_algorithm_update': 0.005068278074264527, 'loss': 17.5414948772192, 'time_step': 0.007118663549423218, 'init_value': 50.13404846191406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:40.44[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019835944175720216, 'time_algorithm_update': 0.005046884775161744, 'loss': 25.143936765670777, 'time_step': 0.007080952882766724, 'init_value': 59.19618225097656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:40.52[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019643194675445555, 'time_algorithm_update': 0.005026675462722778, 'loss': 26.82290262937546, 'time_step': 0.007040621042251587, 'init_value': 66.69617462158203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:41.01[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993520259857178, 'time_algorithm_update': 0.005068413496017456, 'loss': 36.695458601355554, 'time_step': 0.007113122701644897, 'init_value': 74.32099914550781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:41.09[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909307956695555, 'time_algorithm_update': 0.005067716836929321, 'loss': 40.2355033223629, 'time_step': 0.007109716892242431, 'init_value': 78.79261016845703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:41.17[0m [[32m[1minfo     [0m] [1mFQE_20250505203953: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019846532344818114, 'time_algorithm_update': 0.005049652814865112, 'loss': 37.59678704833984, 'time_step': 0.0070848801136016845, 'init_value': 83.09144592285156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.09144592285156
avg return on 5 trajectories of agent5: 2273.841518333333
Episode generator created
[2m2025-05-05 20:41.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:41.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:41.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:41.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:41.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204119[0m
[2m2025-05-05 20:41.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:41.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019776179790496826, 'time_algorithm_update': 0.005003438234329223, 'loss': 1.597295574247837, 'time_step': 0.007030537366867065, 'init_value': 9.553282737731934}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:41.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019914562702178953, 'time_algorithm_update': 0.00507706356048584, 'loss': 4.546363623470068, 'time_step': 0.007119299173355103, 'init_value': 19.833559036254883}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:41.44[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001979565620422363, 'time_algorithm_update': 0.005060305118560791, 'loss': 9.12141982370615, 'time_step': 0.007090343236923218, 'init_value': 29.89448356628418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:41.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898180961608887, 'time_algorithm_update': 0.005081031799316406, 'loss': 12.92664793485403, 'time_step': 0.007121522188186646, 'init_value': 38.308353424072266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:42.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200123929977417, 'time_algorithm_update': 0.005108330726623535, 'loss': 18.1796962184906, 'time_step': 0.007160542488098144, 'init_value': 46.44451141357422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:42.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019846343994140625, 'time_algorithm_update': 0.005068535566329956, 'loss': 20.833703390955925, 'time_step': 0.007103142261505127, 'init_value': 54.273807525634766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:42.18[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999160051345825, 'time_algorithm_update': 0.005084627151489258, 'loss': 23.00108758020401, 'time_step': 0.007134242057800293, 'init_value': 59.55986404418945}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:42.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972714185714722, 'time_algorithm_update': 0.005051156044006347, 'loss': 29.23328544020653, 'time_step': 0.007073881387710571, 'init_value': 67.07917022705078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:42.35[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019962470531463623, 'time_algorithm_update': 0.005082441806793213, 'loss': 31.926007710456847, 'time_step': 0.007129489421844482, 'init_value': 73.72236633300781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:42.44[0m [[32m[1minfo     [0m] [1mFQE_20250505204119: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998737096786499, 'time_algorithm_update': 0.005095404148101806, 'loss': 35.24701251912117, 'time_step': 0.007146196126937866, 'init_value': 80.37384796142578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.37384796142578
avg return on 5 trajectories of agent6: 2329.3424143333336
Episode generator created
[2m2025-05-05 20:42.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:42.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:42.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:42.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:42.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204245[0m
[2m2025-05-05 20:42.45[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:42.54[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991759777069092, 'time_algorithm_update': 0.005032168626785278, 'loss': 1.4690682193487883, 'time_step': 0.0070736825466156, 'init_value': 10.972519874572754}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:43.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019902188777923585, 'time_algorithm_update': 0.005089786767959595, 'loss': 4.366934606283903, 'time_step': 0.007130513906478882, 'init_value': 21.654409408569336}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:43.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002006136894226074, 'time_algorithm_update': 0.00508776068687439, 'loss': 7.785109211981297, 'time_step': 0.007144962787628174, 'init_value': 31.584211349487305}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:43.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019989523887634277, 'time_algorithm_update': 0.005085456132888794, 'loss': 11.385163693904877, 'time_step': 0.007134909868240356, 'init_value': 40.644126892089844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:43.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019962234497070313, 'time_algorithm_update': 0.005084675073623657, 'loss': 16.209263381004334, 'time_step': 0.007131615400314331, 'init_value': 49.82209014892578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:43.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019958207607269286, 'time_algorithm_update': 0.00508224868774414, 'loss': 21.80498955273628, 'time_step': 0.007128644466400147, 'init_value': 57.785301208496094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:43.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019936017990112307, 'time_algorithm_update': 0.005075357437133789, 'loss': 24.22389818799496, 'time_step': 0.007119624376296997, 'init_value': 63.552711486816406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:43.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990290403366089, 'time_algorithm_update': 0.005078870534896851, 'loss': 25.60594815659523, 'time_step': 0.0071202473640441894, 'init_value': 67.7745361328125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:44.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019679064750671386, 'time_algorithm_update': 0.005042639255523682, 'loss': 26.306815816879272, 'time_step': 0.0070602593421936035, 'init_value': 72.57112884521484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:44.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204245: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019938948154449463, 'time_algorithm_update': 0.005075099945068359, 'loss': 25.2453518396616, 'time_step': 0.00711979341506958, 'init_value': 78.37663269042969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.37663269042969
avg return on 5 trajectories of agent7: 1706.058558
Episode generator created
[2m2025-05-05 20:44.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:44.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:44.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:44.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:44.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204411[0m
[2m2025-05-05 20:44.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:44.20[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019818365573883055, 'time_algorithm_update': 0.005021871089935303, 'loss': 1.4709505389928819, 'time_step': 0.007053192377090454, 'init_value': 10.661138534545898}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:44.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019873669147491453, 'time_algorithm_update': 0.005065603733062744, 'loss': 4.285785686731338, 'time_step': 0.007103374719619751, 'init_value': 21.019826889038086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:44.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999074459075928, 'time_algorithm_update': 0.005080183744430542, 'loss': 8.443161897659301, 'time_step': 0.007129805326461792, 'init_value': 31.106781005859375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:44.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019910995960235596, 'time_algorithm_update': 0.005074596881866455, 'loss': 14.647458167672157, 'time_step': 0.007116412162780762, 'init_value': 40.34324645996094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:44.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019834015369415282, 'time_algorithm_update': 0.0050588552951812745, 'loss': 17.799146674156187, 'time_step': 0.0070923340320587155, 'init_value': 48.272743225097656}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:45.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019916667938232424, 'time_algorithm_update': 0.005069599866867065, 'loss': 23.09184140431881, 'time_step': 0.007111864328384399, 'init_value': 56.008853912353516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:45.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019876205921173094, 'time_algorithm_update': 0.005059632539749145, 'loss': 22.487471595168113, 'time_step': 0.0070977632999420165, 'init_value': 62.90143966674805}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:45.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953200817108153, 'time_algorithm_update': 0.005076344013214111, 'loss': 28.396624364852904, 'time_step': 0.007122359275817871, 'init_value': 68.30220794677734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:45.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019468622207641601, 'time_algorithm_update': 0.004963126420974732, 'loss': 29.311241571426393, 'time_step': 0.006959121227264404, 'init_value': 74.6893310546875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:45.35[0m [[32m[1minfo     [0m] [1mFQE_20250505204411: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019645256996154783, 'time_algorithm_update': 0.004994468212127685, 'loss': 33.00314486169815, 'time_step': 0.007008985519409179, 'init_value': 81.0053939819336}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.0053939819336
avg return on 5 trajectories of agent8: 1552.2553446666668
Episode generator created
[2m2025-05-05 20:45.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:45.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:45.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:45.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:45.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204536[0m
[2m2025-05-05 20:45.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:45.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019564149379730227, 'time_algorithm_update': 0.004903962135314941, 'loss': 1.428148990660906, 'time_step': 0.006908951997756958, 'init_value': 9.999307632446289}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:45.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963974952697754, 'time_algorithm_update': 0.004984403133392334, 'loss': 4.248054331153631, 'time_step': 0.006997320890426636, 'init_value': 20.094432830810547}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:46.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965833902359009, 'time_algorithm_update': 0.004999184131622315, 'loss': 9.09144884043932, 'time_step': 0.007014225006103516, 'init_value': 30.303285598754883}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:46.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019802906513214113, 'time_algorithm_update': 0.00504026198387146, 'loss': 14.515121978759765, 'time_step': 0.0070701918601989745, 'init_value': 39.155948638916016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:46.18[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020038621425628664, 'time_algorithm_update': 0.005089356899261475, 'loss': 17.812741423130035, 'time_step': 0.00714439845085144, 'init_value': 46.44506072998047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:46.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997610807418823, 'time_algorithm_update': 0.005075715303421021, 'loss': 20.612236233592032, 'time_step': 0.007124103784561157, 'init_value': 53.734004974365234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:46.35[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995811462402344, 'time_algorithm_update': 0.005070292949676513, 'loss': 26.62764165878296, 'time_step': 0.007116427659988403, 'init_value': 59.30037307739258}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:46.43[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953639507293702, 'time_algorithm_update': 0.005064640998840332, 'loss': 29.493230588436127, 'time_step': 0.007110551357269287, 'init_value': 65.43541717529297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:46.52[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019915006160736086, 'time_algorithm_update': 0.005069805860519409, 'loss': 34.335933938264844, 'time_step': 0.007111010074615479, 'init_value': 70.92372131347656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:47.00[0m [[32m[1minfo     [0m] [1mFQE_20250505204536: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002734899520874, 'time_algorithm_update': 0.005068562030792236, 'loss': 36.56177292561531, 'time_step': 0.0071215593814849855, 'init_value': 75.27888488769531}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.27888488769531
avg return on 5 trajectories of agent9: 2671.4681856666666
Episode generator created
[2m2025-05-05 20:47.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:47.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:47.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:47.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:47.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204702[0m
[2m2025-05-05 20:47.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:47.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967931509017944, 'time_algorithm_update': 0.004966300249099731, 'loss': 1.5878383164405823, 'time_step': 0.006982979774475098, 'init_value': 10.468807220458984}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990814208984375, 'time_algorithm_update': 0.00507315444946289, 'loss': 4.43968708628416, 'time_step': 0.0071144626140594485, 'init_value': 20.646032333374023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:47.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993525743484497, 'time_algorithm_update': 0.005078566074371338, 'loss': 7.929485798418522, 'time_step': 0.007122676372528076, 'init_value': 31.340978622436523}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:47.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019903295040130616, 'time_algorithm_update': 0.0050741124153137205, 'loss': 13.361793190002441, 'time_step': 0.007115118026733399, 'init_value': 39.533138275146484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:47.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993544816970825, 'time_algorithm_update': 0.00508215594291687, 'loss': 17.37150190448761, 'time_step': 0.007126998662948608, 'init_value': 48.19148254394531}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:47.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019875526428222655, 'time_algorithm_update': 0.005087683200836182, 'loss': 22.735195428848268, 'time_step': 0.007125425815582276, 'init_value': 54.89386749267578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:48.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004620552062988, 'time_algorithm_update': 0.005086366653442383, 'loss': 24.59488311314583, 'time_step': 0.007141941785812378, 'init_value': 61.415313720703125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:48.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002008911848068237, 'time_algorithm_update': 0.00509505558013916, 'loss': 26.282529153347017, 'time_step': 0.0071544692516326905, 'init_value': 66.14221954345703}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:48.18[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200422739982605, 'time_algorithm_update': 0.0050963168144226075, 'loss': 32.02174143481255, 'time_step': 0.007151394128799438, 'init_value': 71.90933227539062}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:48.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204702: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020010530948638915, 'time_algorithm_update': 0.005086150169372559, 'loss': 30.490990992069243, 'time_step': 0.007138344526290893, 'init_value': 76.45765686035156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.45765686035156
avg return on 5 trajectories of agent10: 1920.4575313333332
Episode generator created
[2m2025-05-05 20:48.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:48.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:48.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:48.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:48.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204828[0m
[2m2025-05-05 20:48.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:48.37[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992816209793091, 'time_algorithm_update': 0.005006621599197388, 'loss': 1.5263731878399849, 'time_step': 0.0070496764183044435, 'init_value': 10.503877639770508}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:48.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019737861156463622, 'time_algorithm_update': 0.004999089479446411, 'loss': 4.39993269905448, 'time_step': 0.007022705316543579, 'init_value': 20.872976303100586}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:48.54[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019860658645629884, 'time_algorithm_update': 0.0050392203330993654, 'loss': 8.492783529281617, 'time_step': 0.007075844526290893, 'init_value': 30.31451988220215}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:49.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020155277252197267, 'time_algorithm_update': 0.005078126668930053, 'loss': 12.968327177524566, 'time_step': 0.007145000696182251, 'init_value': 38.52967834472656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:49.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026496171951294, 'time_algorithm_update': 0.005134917736053467, 'loss': 15.773783301234245, 'time_step': 0.007213382005691528, 'init_value': 46.692710876464844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:49.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020079588890075683, 'time_algorithm_update': 0.00508252763748169, 'loss': 20.5614836974144, 'time_step': 0.007141267061233521, 'init_value': 55.28020095825195}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:49.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995641231536865, 'time_algorithm_update': 0.005036416530609131, 'loss': 26.01473489189148, 'time_step': 0.007082478046417236, 'init_value': 62.199554443359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:49.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020097520351409913, 'time_algorithm_update': 0.005059217691421509, 'loss': 29.66113070034981, 'time_step': 0.0071200809478759765, 'init_value': 67.6780014038086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:49.44[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020048577785491944, 'time_algorithm_update': 0.005053424835205078, 'loss': 36.161466515302656, 'time_step': 0.007109340190887451, 'init_value': 73.82767486572266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:49.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204828: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020011892318725585, 'time_algorithm_update': 0.005040939092636108, 'loss': 32.019514148235324, 'time_step': 0.007093296766281128, 'init_value': 79.66567993164062}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.66567993164062
avg return on 5 trajectories of agent11: 2530.448948333333
Episode generator created
[2m2025-05-05 20:49.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:49.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:49.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:49.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:49.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204955[0m
[2m2025-05-05 20:49.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:50.03[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984468698501587, 'time_algorithm_update': 0.005002003192901611, 'loss': 1.6713153869956732, 'time_step': 0.007035766124725342, 'init_value': 10.369392395019531}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:50.12[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969186782836912, 'time_algorithm_update': 0.0050778167247772215, 'loss': 4.7536163191497325, 'time_step': 0.007125474214553833, 'init_value': 20.99893569946289}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:50.20[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001977295875549316, 'time_algorithm_update': 0.005044548511505127, 'loss': 9.504542921900748, 'time_step': 0.007071317195892334, 'init_value': 30.6108341217041}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:50.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020000753402709963, 'time_algorithm_update': 0.005069534301757813, 'loss': 15.462691064119339, 'time_step': 0.007120216131210327, 'init_value': 39.697898864746094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:50.37[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002009373188018799, 'time_algorithm_update': 0.005078579187393188, 'loss': 20.02187841153145, 'time_step': 0.007138601779937744, 'init_value': 49.87420654296875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:50.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999117612838745, 'time_algorithm_update': 0.005078595161437988, 'loss': 26.552942809700966, 'time_step': 0.007127951860427856, 'init_value': 57.74624252319336}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:50.54[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994823217391968, 'time_algorithm_update': 0.0050502936840057374, 'loss': 30.51200349211693, 'time_step': 0.007095612049102783, 'init_value': 65.09220123291016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:51.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020075480937957763, 'time_algorithm_update': 0.005077343225479126, 'loss': 31.673394818544388, 'time_step': 0.00713631796836853, 'init_value': 71.59520721435547}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:51.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200351095199585, 'time_algorithm_update': 0.005074852705001831, 'loss': 34.802750052690506, 'time_step': 0.0071295351982116695, 'init_value': 76.68245697021484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:51.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204955: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953439235687255, 'time_algorithm_update': 0.005065054416656494, 'loss': 39.5969434568882, 'time_step': 0.0071112895011901855, 'init_value': 84.7481460571289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 84.7481460571289
avg return on 5 trajectories of agent12: 1960.6635563333332
Episode generator created
[2m2025-05-05 20:51.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:51.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:51.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:51.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:51.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205121[0m
[2m2025-05-05 20:51.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:51.29[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019858551025390627, 'time_algorithm_update': 0.005015891313552856, 'loss': 1.3985469555705785, 'time_step': 0.007051737785339356, 'init_value': 10.102457046508789}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:51.37[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020042750835418703, 'time_algorithm_update': 0.0051197164058685305, 'loss': 4.387298179775477, 'time_step': 0.007174578428268433, 'init_value': 20.142749786376953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:51.46[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019980511665344237, 'time_algorithm_update': 0.005112765550613403, 'loss': 7.981735343337059, 'time_step': 0.007161409616470337, 'init_value': 29.771976470947266}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:51.54[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001985872030258179, 'time_algorithm_update': 0.0050957086086273196, 'loss': 14.58040754890442, 'time_step': 0.007131368637084961, 'init_value': 38.242042541503906}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:52.03[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019995243549346922, 'time_algorithm_update': 0.005120667457580566, 'loss': 18.633214156389236, 'time_step': 0.0071703758239746096, 'init_value': 46.3780632019043}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:52.11[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919021129608154, 'time_algorithm_update': 0.005122973442077637, 'loss': 21.275853257894514, 'time_step': 0.0071651084423065186, 'init_value': 52.76943588256836}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:52.20[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020047338008880615, 'time_algorithm_update': 0.005138522386550904, 'loss': 25.425204967856406, 'time_step': 0.007193943977355957, 'init_value': 59.89476013183594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:52.28[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997673273086548, 'time_algorithm_update': 0.0051256327629089354, 'loss': 28.086553024053572, 'time_step': 0.007173949241638183, 'init_value': 65.66900634765625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:52.37[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003234148025513, 'time_algorithm_update': 0.005134516954421997, 'loss': 30.320773221969606, 'time_step': 0.0071885533332824705, 'init_value': 68.75394439697266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:52.45[0m [[32m[1minfo     [0m] [1mFQE_20250505205121: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020287036895752, 'time_algorithm_update': 0.005168840169906617, 'loss': 32.619087604880335, 'time_step': 0.0072405846118927, 'init_value': 73.56329345703125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.56329345703125
avg return on 5 trajectories of agent13: 1725.2268623333332
Episode generator created
[2m2025-05-05 20:52.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:52.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:52.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:52.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:52.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205247[0m
[2m2025-05-05 20:52.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:52.55[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019937820434570313, 'time_algorithm_update': 0.005003342866897583, 'loss': 1.5189074614197016, 'time_step': 0.007046957731246948, 'init_value': 10.58326244354248}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:53.04[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020076978206634523, 'time_algorithm_update': 0.005076076745986939, 'loss': 3.8102131574749944, 'time_step': 0.007134205818176269, 'init_value': 20.428714752197266}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:53.12[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019924445152282714, 'time_algorithm_update': 0.005058462858200073, 'loss': 8.147302576839923, 'time_step': 0.007101659059524536, 'init_value': 31.054157257080078}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:53.21[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001023769378662, 'time_algorithm_update': 0.0050727128982543945, 'loss': 13.204265842974186, 'time_step': 0.007124781608581543, 'init_value': 40.088523864746094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:53.29[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019921820163726804, 'time_algorithm_update': 0.005058182239532471, 'loss': 16.92498251366615, 'time_step': 0.007100263595581055, 'init_value': 48.71474838256836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:53.37[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019959626197814944, 'time_algorithm_update': 0.005071034431457519, 'loss': 22.03222962129116, 'time_step': 0.007117194652557373, 'init_value': 55.67892837524414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:53.46[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003972291946411, 'time_algorithm_update': 0.005075734138488769, 'loss': 25.199594937682154, 'time_step': 0.007129967927932739, 'init_value': 62.7994270324707}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:53.54[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200543475151062, 'time_algorithm_update': 0.005086670637130738, 'loss': 27.878259157419205, 'time_step': 0.007142556190490723, 'init_value': 67.84616088867188}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:54.03[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200551700592041, 'time_algorithm_update': 0.005083154678344726, 'loss': 28.201884549975397, 'time_step': 0.007139848709106445, 'init_value': 72.38143157958984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:54.11[0m [[32m[1minfo     [0m] [1mFQE_20250505205247: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200683331489563, 'time_algorithm_update': 0.005086870908737183, 'loss': 30.92979009640217, 'time_step': 0.007144503355026245, 'init_value': 78.15458679199219}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.15458679199219
avg return on 5 trajectories of agent14: 2024.9951056666669
Episode generator created
[2m2025-05-05 20:54.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:54.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:54.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:54.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:54.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205413[0m
[2m2025-05-05 20:54.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:54.21[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019897508621215822, 'time_algorithm_update': 0.004997146368026733, 'loss': 1.4877883435338735, 'time_step': 0.007036885738372803, 'init_value': 9.580531120300293}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:54.30[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019964351654052736, 'time_algorithm_update': 0.00505880880355835, 'loss': 3.9027612447738647, 'time_step': 0.00710579252243042, 'init_value': 19.865245819091797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:54.38[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019987602233886717, 'time_algorithm_update': 0.0050645582675933835, 'loss': 8.00890951937437, 'time_step': 0.00711380386352539, 'init_value': 29.733949661254883}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:54.46[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998828887939453, 'time_algorithm_update': 0.0050730562210083005, 'loss': 14.235653830885887, 'time_step': 0.007122258663177491, 'init_value': 39.366573333740234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:54.55[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992957353591919, 'time_algorithm_update': 0.005060633897781372, 'loss': 17.849224965691565, 'time_step': 0.007104061365127564, 'init_value': 46.5878791809082}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:55.03[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987539529800415, 'time_algorithm_update': 0.005076698780059815, 'loss': 20.844723172545432, 'time_step': 0.007114463329315186, 'init_value': 54.306114196777344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:55.12[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986663579940796, 'time_algorithm_update': 0.005064066171646118, 'loss': 27.058283415317536, 'time_step': 0.007101247549057007, 'init_value': 61.82337951660156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:55.20[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992821216583252, 'time_algorithm_update': 0.00506604790687561, 'loss': 29.033870427966118, 'time_step': 0.007109502077102661, 'init_value': 68.74598693847656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:55.29[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960611343383789, 'time_algorithm_update': 0.005011044502258301, 'loss': 31.902073625087738, 'time_step': 0.0070206234455108645, 'init_value': 74.65165710449219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:55.37[0m [[32m[1minfo     [0m] [1mFQE_20250505205413: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968214988708496, 'time_algorithm_update': 0.004993850708007812, 'loss': 34.28019692826271, 'time_step': 0.007011445760726928, 'init_value': 80.71971130371094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.71971130371094
avg return on 5 trajectories of agent15: 2817.8036276666667
Episode generator created
[2m2025-05-05 20:55.39[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:55.39[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:55.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:55.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:55.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205539[0m
[2m2025-05-05 20:55.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:55.47[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019512197971343994, 'time_algorithm_update': 0.004898558139801026, 'loss': 1.4094553882330656, 'time_step': 0.006898029088973999, 'init_value': 10.817241668701172}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:55.56[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962754249572754, 'time_algorithm_update': 0.0049685463905334475, 'loss': 4.613258939474821, 'time_step': 0.006980591773986816, 'init_value': 22.069015502929688}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:56.04[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019636332988739015, 'time_algorithm_update': 0.004985568761825562, 'loss': 9.170434563815594, 'time_step': 0.006998750448226928, 'init_value': 31.611595153808594}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:56.12[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961508274078369, 'time_algorithm_update': 0.004990683794021606, 'loss': 12.256798434555531, 'time_step': 0.007001649379730224, 'init_value': 41.10945510864258}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:56.21[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020197455883026122, 'time_algorithm_update': 0.005115933656692505, 'loss': 18.936131663203238, 'time_step': 0.007186897754669189, 'init_value': 50.67628479003906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:56.29[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909090995788572, 'time_algorithm_update': 0.005066092014312744, 'loss': 22.96601321387291, 'time_step': 0.007107330560684204, 'init_value': 58.647789001464844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:56.38[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021559715270996, 'time_algorithm_update': 0.0051161484718322756, 'loss': 29.127252037167548, 'time_step': 0.007188815593719483, 'init_value': 65.32258605957031}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:56.46[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002015939712524414, 'time_algorithm_update': 0.005124918460845947, 'loss': 32.63746219444275, 'time_step': 0.007191769599914551, 'init_value': 72.94631958007812}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:56.55[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019900708198547362, 'time_algorithm_update': 0.005056793212890625, 'loss': 32.22443506705761, 'time_step': 0.007096670150756836, 'init_value': 78.29112243652344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:57.03[0m [[32m[1minfo     [0m] [1mFQE_20250505205539: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020004649162292483, 'time_algorithm_update': 0.005086555242538452, 'loss': 35.05045171403885, 'time_step': 0.007137645959854126, 'init_value': 83.87877655029297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 83.87877655029297
avg return on 5 trajectories of agent16: 2862.9529366666666
Episode generator created
[2m2025-05-05 20:57.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:57.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:57.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:57.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:57.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205705[0m
[2m2025-05-05 20:57.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:57.14[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019720959663391113, 'time_algorithm_update': 0.004978985548019409, 'loss': 1.5753552376329898, 'time_step': 0.007000644445419311, 'init_value': 10.816571235656738}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:57.22[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992535591125488, 'time_algorithm_update': 0.00505452823638916, 'loss': 4.446622217178345, 'time_step': 0.0070976588726043705, 'init_value': 21.414365768432617}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:57.30[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019873895645141602, 'time_algorithm_update': 0.005057297468185425, 'loss': 8.641463534474372, 'time_step': 0.007094671249389648, 'init_value': 32.37739181518555}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:57.39[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992767810821533, 'time_algorithm_update': 0.005059614181518555, 'loss': 13.574100322306156, 'time_step': 0.007102919340133667, 'init_value': 41.95304489135742}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:57.47[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199220609664917, 'time_algorithm_update': 0.00506389594078064, 'loss': 20.11190869176388, 'time_step': 0.007106586217880249, 'init_value': 49.114166259765625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:57.56[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997328758239746, 'time_algorithm_update': 0.005077619314193726, 'loss': 23.52645030939579, 'time_step': 0.007125443935394287, 'init_value': 56.735652923583984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:58.04[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020228755474090577, 'time_algorithm_update': 0.005133273839950561, 'loss': 22.40331010067463, 'time_step': 0.00720800256729126, 'init_value': 63.78779220581055}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:58.13[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019917898178100587, 'time_algorithm_update': 0.005064350843429565, 'loss': 27.226894833922387, 'time_step': 0.0071069104671478275, 'init_value': 71.47613525390625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:58.21[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994359731674194, 'time_algorithm_update': 0.005066375970840454, 'loss': 33.718916037321094, 'time_step': 0.0071118886470794675, 'init_value': 77.13770294189453}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:58.30[0m [[32m[1minfo     [0m] [1mFQE_20250505205705: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988736391067505, 'time_algorithm_update': 0.005063265800476074, 'loss': 33.35161384415626, 'time_step': 0.007102698564529419, 'init_value': 82.62725067138672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.62725067138672
avg return on 5 trajectories of agent17: 1842.9844823333333
Episode generator created
[2m2025-05-05 20:58.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:58.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:58.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:58.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:58.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205831[0m
[2m2025-05-05 20:58.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:58.39[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019848098754882814, 'time_algorithm_update': 0.005007234573364258, 'loss': 1.442270774692297, 'time_step': 0.007041383981704712, 'init_value': 10.88665771484375}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:58.48[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919161796569823, 'time_algorithm_update': 0.0050856611728668216, 'loss': 3.7985502749085427, 'time_step': 0.007128267526626587, 'init_value': 21.217559814453125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:58.56[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969563484191896, 'time_algorithm_update': 0.005082536935806275, 'loss': 8.242374011397361, 'time_step': 0.007129820585250854, 'init_value': 31.749826431274414}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:59.05[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019897401332855226, 'time_algorithm_update': 0.005085955619812012, 'loss': 12.418827077507972, 'time_step': 0.007126617193222046, 'init_value': 41.6633415222168}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:59.13[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019957470893859864, 'time_algorithm_update': 0.005083840847015381, 'loss': 15.787991196393966, 'time_step': 0.007130341529846191, 'init_value': 48.394287109375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:59.22[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994983673095703, 'time_algorithm_update': 0.00510124683380127, 'loss': 16.191744563579558, 'time_step': 0.00714728856086731, 'init_value': 57.074344635009766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:59.30[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019902236461639402, 'time_algorithm_update': 0.005090840339660644, 'loss': 19.524722007513045, 'time_step': 0.007131629467010498, 'init_value': 63.796443939208984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:59.39[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996035099029541, 'time_algorithm_update': 0.0050934703350067135, 'loss': 21.964327761888505, 'time_step': 0.00714037823677063, 'init_value': 68.92876434326172}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:59.47[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002005788564682007, 'time_algorithm_update': 0.005112957954406738, 'loss': 25.94250621509552, 'time_step': 0.0071699378490448, 'init_value': 73.71434020996094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:59.55[0m [[32m[1minfo     [0m] [1mFQE_20250505205831: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198929500579834, 'time_algorithm_update': 0.005080344200134278, 'loss': 28.219437132835388, 'time_step': 0.007120351552963257, 'init_value': 80.2704086303711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.2704086303711
avg return on 5 trajectories of agent18: 2171.0854853333335
Episode generator created
[2m2025-05-05 20:59.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:59.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:59.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:59.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:59.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205957[0m
[2m2025-05-05 20:59.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:00.06[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019829769134521486, 'time_algorithm_update': 0.005004966020584106, 'loss': 1.413831136494875, 'time_step': 0.0070378129482269285, 'init_value': 10.050233840942383}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:00.14[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001336336135864, 'time_algorithm_update': 0.005085647583007813, 'loss': 4.391391177088022, 'time_step': 0.0071379015445709225, 'init_value': 20.007299423217773}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:00.23[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001349687576294, 'time_algorithm_update': 0.0050857994556427, 'loss': 8.42217295140028, 'time_step': 0.007137639284133911, 'init_value': 29.7862548828125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:00.31[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019957919120788576, 'time_algorithm_update': 0.005076826810836792, 'loss': 14.474484964251518, 'time_step': 0.00712329626083374, 'init_value': 39.34486389160156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:00.39[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019993462562561035, 'time_algorithm_update': 0.005080420255661011, 'loss': 19.35348370218277, 'time_step': 0.007132530689239502, 'init_value': 46.56117630004883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:00.48[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989182233810425, 'time_algorithm_update': 0.005081938505172729, 'loss': 24.110409079909324, 'time_step': 0.007121924161911011, 'init_value': 53.64655685424805}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:00.56[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019915213584899903, 'time_algorithm_update': 0.005075003385543823, 'loss': 26.330952857732772, 'time_step': 0.00711691665649414, 'init_value': 57.61185073852539}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:01.05[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019968366622924805, 'time_algorithm_update': 0.005084076642990112, 'loss': 26.803984040737152, 'time_step': 0.007131612539291382, 'init_value': 63.21596908569336}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:01.13[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019959578514099122, 'time_algorithm_update': 0.005076250791549683, 'loss': 31.14437430691719, 'time_step': 0.007123041152954102, 'init_value': 68.78580474853516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:01.22[0m [[32m[1minfo     [0m] [1mFQE_20250505205957: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200344181060791, 'time_algorithm_update': 0.005082526922225952, 'loss': 33.474043209314345, 'time_step': 0.007136743545532226, 'init_value': 74.59343719482422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.59343719482422
avg return on 5 trajectories of agent19: 1776.3132333333333
Episode generator created
[2m2025-05-05 21:01.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:01.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:01.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:01.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:01.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210123[0m
[2m2025-05-05 21:01.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:01.32[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196342134475708, 'time_algorithm_update': 0.004989312171936035, 'loss': 1.4409168670624495, 'time_step': 0.0070016770362854005, 'init_value': 9.506503105163574}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:01.40[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019923717975616454, 'time_algorithm_update': 0.005101341009140015, 'loss': 4.923513829559088, 'time_step': 0.0071443281173706056, 'init_value': 19.83968734741211}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:01.48[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019929916858673095, 'time_algorithm_update': 0.005103907585144043, 'loss': 11.093626296460629, 'time_step': 0.007147613525390625, 'init_value': 29.998340606689453}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:01.57[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019943561553955077, 'time_algorithm_update': 0.005097704172134399, 'loss': 15.2332734375, 'time_step': 0.007142712593078613, 'init_value': 39.00994873046875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:02.05[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019943459033966065, 'time_algorithm_update': 0.005106808185577393, 'loss': 20.32372145843506, 'time_step': 0.007150764226913452, 'init_value': 47.00053405761719}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:02.14[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993816614151001, 'time_algorithm_update': 0.005100022315979004, 'loss': 26.03169485092163, 'time_step': 0.007144500970840454, 'init_value': 54.571380615234375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:02.22[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019949870109558106, 'time_algorithm_update': 0.005083311319351197, 'loss': 29.555104056954384, 'time_step': 0.007128814458847046, 'init_value': 61.43281555175781}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:02.31[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019940233230590822, 'time_algorithm_update': 0.00510203218460083, 'loss': 34.215175507068636, 'time_step': 0.007146834850311279, 'init_value': 67.0743179321289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:02.39[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993481159210205, 'time_algorithm_update': 0.005101296901702881, 'loss': 37.860292192578314, 'time_step': 0.0071455657482147215, 'init_value': 72.81731414794922}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:02.48[0m [[32m[1minfo     [0m] [1mFQE_20250505210123: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019894373416900635, 'time_algorithm_update': 0.005088923692703247, 'loss': 39.75390028631687, 'time_step': 0.0071292037963867185, 'init_value': 79.1387710571289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.1387710571289
ave advantage rew: 79.80883483886718, std: 3.008030917034493
avg cum rews: 2114.3109456166667, std: 369.64716619514576
Pearson correlation coefficient: 0.340946493681804
Spearman correlation coefficient: 0.3233082706766917
Kendall Tau correlation coefficient: 0.23157894736842105
the best agent: 11, best agent cum rewards: 2530.448948333333
1964
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.018711354087812472
avg return on 5 trajectories of agent0: 2492.5045576666666
Episode generator created
[2m2025-05-05 21:03.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:03.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:03.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:03.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:03.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210300[0m
[2m2025-05-05 21:03.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:03.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019813547134399415, 'time_algorithm_update': 0.005027544260025024, 'loss': 1.4430037294924258, 'time_step': 0.007059118986129761, 'init_value': 10.739738464355469}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:03.17[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986508846282959, 'time_algorithm_update': 0.005058246850967407, 'loss': 4.290312841951847, 'time_step': 0.007095969438552856, 'init_value': 22.200942993164062}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:03.25[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998058795928955, 'time_algorithm_update': 0.0050854325294494625, 'loss': 9.598737285435199, 'time_step': 0.007134967803955078, 'init_value': 32.09769058227539}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:03.33[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953987598419188, 'time_algorithm_update': 0.0050737009048461915, 'loss': 13.736236824572087, 'time_step': 0.007120187044143677, 'init_value': 42.07975769042969}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:03.42[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020042901039123537, 'time_algorithm_update': 0.005075744152069092, 'loss': 19.365088962435724, 'time_step': 0.00713156533241272, 'init_value': 50.75395584106445}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:03.50[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019798872470855712, 'time_algorithm_update': 0.005063429355621338, 'loss': 24.154697139024734, 'time_step': 0.007093574523925781, 'init_value': 59.12961959838867}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:03.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001985960245132446, 'time_algorithm_update': 0.005074369668960571, 'loss': 26.372071296811104, 'time_step': 0.00711074423789978, 'init_value': 66.93199920654297}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:04.07[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019950225353240966, 'time_algorithm_update': 0.00508042573928833, 'loss': 29.806835792422294, 'time_step': 0.007126199722290039, 'init_value': 74.2851791381836}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:04.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986607789993286, 'time_algorithm_update': 0.0050715913772583, 'loss': 34.0595832798481, 'time_step': 0.007108983755111695, 'init_value': 81.18773651123047}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:04.24[0m [[32m[1minfo     [0m] [1mFQE_20250505210300: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002120018005371, 'time_algorithm_update': 0.005079690933227539, 'loss': 33.271989557027815, 'time_step': 0.007133020401000977, 'init_value': 89.0146255493164}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 89.0146255493164
avg return on 5 trajectories of agent1: 2232.74916
Episode generator created
[2m2025-05-05 21:04.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:04.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:04.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:04.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:04.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210426[0m
[2m2025-05-05 21:04.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:04.34[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001977527379989624, 'time_algorithm_update': 0.004997302055358887, 'loss': 1.4415602902770042, 'time_step': 0.007024669408798217, 'init_value': 10.531087875366211}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:04.43[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019641950130462648, 'time_algorithm_update': 0.005017925977706909, 'loss': 4.354876664668321, 'time_step': 0.007032106161117554, 'init_value': 20.855857849121094}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:04.51[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019894640445709227, 'time_algorithm_update': 0.005073530435562134, 'loss': 10.303217378258704, 'time_step': 0.007114007711410523, 'init_value': 30.873903274536133}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:04.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019901001453399656, 'time_algorithm_update': 0.00506856894493103, 'loss': 14.292057935833931, 'time_step': 0.007109334707260132, 'init_value': 40.0860710144043}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:05.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988684415817261, 'time_algorithm_update': 0.005065218210220337, 'loss': 20.95111509859562, 'time_step': 0.007104758024215698, 'init_value': 48.01377487182617}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:05.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988390684127808, 'time_algorithm_update': 0.005070319652557373, 'loss': 24.065378100275993, 'time_step': 0.007109147548675537, 'init_value': 56.41402816772461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:05.25[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986706018447876, 'time_algorithm_update': 0.005069188594818115, 'loss': 27.694213621020317, 'time_step': 0.007106676816940307, 'init_value': 62.94639205932617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:05.33[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988210916519165, 'time_algorithm_update': 0.005071046113967895, 'loss': 30.388359194278717, 'time_step': 0.0071107509136199955, 'init_value': 69.59736633300781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:05.41[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019471035003662109, 'time_algorithm_update': 0.004970505237579346, 'loss': 38.482815397381785, 'time_step': 0.006966948747634888, 'init_value': 76.05655670166016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:05.50[0m [[32m[1minfo     [0m] [1mFQE_20250505210426: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019599504470825197, 'time_algorithm_update': 0.00497923755645752, 'loss': 38.311664535760876, 'time_step': 0.006989148378372193, 'init_value': 81.20314025878906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.20314025878906
avg return on 5 trajectories of agent2: 2756.7657646666667
Episode generator created
[2m2025-05-05 21:05.52[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:05.52[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:05.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:05.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:05.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210552[0m
[2m2025-05-05 21:05.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:06.00[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019439973831176759, 'time_algorithm_update': 0.0048997349739074705, 'loss': 1.460580706104636, 'time_step': 0.006892047643661499, 'init_value': 10.140218734741211}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:06.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019596340656280516, 'time_algorithm_update': 0.004973264217376709, 'loss': 4.473379343897104, 'time_step': 0.006982516527175903, 'init_value': 20.175928115844727}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:06.17[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019396765232086181, 'time_algorithm_update': 0.004947886705398559, 'loss': 9.174993829607963, 'time_step': 0.00693597149848938, 'init_value': 29.176374435424805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:06.25[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978419780731201, 'time_algorithm_update': 0.005031841516494751, 'loss': 14.266188364744187, 'time_step': 0.007060277462005615, 'init_value': 38.21547317504883}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:06.33[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019933869838714598, 'time_algorithm_update': 0.005073363304138183, 'loss': 17.840321841061115, 'time_step': 0.007117533445358276, 'init_value': 46.779685974121094}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:06.42[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028522253036499, 'time_algorithm_update': 0.00515291166305542, 'loss': 23.66671308898926, 'time_step': 0.007233439445495605, 'init_value': 53.81284713745117}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:06.51[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028143882751465, 'time_algorithm_update': 0.0051357226371765135, 'loss': 26.07273720371723, 'time_step': 0.007215917348861694, 'init_value': 60.47034454345703}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:06.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019917559623718263, 'time_algorithm_update': 0.005068739414215088, 'loss': 27.77034373664856, 'time_step': 0.007111122608184814, 'init_value': 66.69973754882812}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:07.07[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019961633682250976, 'time_algorithm_update': 0.005071825742721557, 'loss': 28.715844732403756, 'time_step': 0.007118889331817627, 'init_value': 71.20835876464844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:07.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210552: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995227575302124, 'time_algorithm_update': 0.005072109699249268, 'loss': 30.447194120645523, 'time_step': 0.0071176068782806395, 'init_value': 78.0007553100586}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.0007553100586
avg return on 5 trajectories of agent3: 1758.0944016666665
Episode generator created
[2m2025-05-05 21:07.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:07.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:07.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:07.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:07.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210717[0m
[2m2025-05-05 21:07.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:07.26[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019859039783477785, 'time_algorithm_update': 0.005012235641479492, 'loss': 1.52820610229671, 'time_step': 0.007047705411911011, 'init_value': 10.66222858428955}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:07.34[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987996816635132, 'time_algorithm_update': 0.00507342529296875, 'loss': 4.200719215542078, 'time_step': 0.007111656665802002, 'init_value': 21.886306762695312}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:07.43[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992493152618408, 'time_algorithm_update': 0.005077661752700806, 'loss': 8.945440899908542, 'time_step': 0.007120469808578491, 'init_value': 32.8709602355957}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:07.51[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969841718673706, 'time_algorithm_update': 0.005030786514282227, 'loss': 12.62294046741724, 'time_step': 0.007050127029418945, 'init_value': 40.05949401855469}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:07.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893507957458494, 'time_algorithm_update': 0.005070495128631592, 'loss': 14.798399994254112, 'time_step': 0.007110344886779785, 'init_value': 47.7325553894043}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:08.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983769655227661, 'time_algorithm_update': 0.005071696281433106, 'loss': 21.437647888302802, 'time_step': 0.007106270790100098, 'init_value': 54.33756637573242}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:08.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989333868026733, 'time_algorithm_update': 0.005064589977264404, 'loss': 22.115328244566918, 'time_step': 0.007104146242141724, 'init_value': 61.8737907409668}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:08.25[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020006470680236817, 'time_algorithm_update': 0.005084932565689087, 'loss': 23.92711678659916, 'time_step': 0.007136582851409912, 'init_value': 67.87382507324219}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:08.33[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019961628913879393, 'time_algorithm_update': 0.005073999881744385, 'loss': 27.95715164017677, 'time_step': 0.007121288776397705, 'init_value': 73.13514709472656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:08.42[0m [[32m[1minfo     [0m] [1mFQE_20250505210717: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019955203533172606, 'time_algorithm_update': 0.005078738927841187, 'loss': 29.331654323220253, 'time_step': 0.007125152349472046, 'init_value': 79.15849304199219}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.15849304199219
avg return on 5 trajectories of agent4: 2423.0753676666664
Episode generator created
[2m2025-05-05 21:08.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:08.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:08.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:08.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:08.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210844[0m
[2m2025-05-05 21:08.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:08.52[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019825525283813476, 'time_algorithm_update': 0.004991817951202393, 'loss': 1.4744977079480885, 'time_step': 0.007024256706237793, 'init_value': 11.122624397277832}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:09.00[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019917504787445067, 'time_algorithm_update': 0.005053943395614624, 'loss': 4.305716288626194, 'time_step': 0.007096207141876221, 'init_value': 21.620431900024414}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:09.09[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019946768283843996, 'time_algorithm_update': 0.005068618535995484, 'loss': 7.358950341284275, 'time_step': 0.007113342761993408, 'init_value': 31.510263442993164}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:09.17[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989281415939331, 'time_algorithm_update': 0.0050515692234039304, 'loss': 12.59965678024292, 'time_step': 0.007091485500335694, 'init_value': 42.221004486083984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:09.26[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019875848293304443, 'time_algorithm_update': 0.005047170877456665, 'loss': 17.68120301783085, 'time_step': 0.007085257768630981, 'init_value': 52.382896423339844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:09.34[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019957923889160154, 'time_algorithm_update': 0.005062243700027466, 'loss': 21.391056851387024, 'time_step': 0.007108590602874756, 'init_value': 60.526710510253906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:09.42[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019935688972473145, 'time_algorithm_update': 0.005058066368103027, 'loss': 25.529901218295098, 'time_step': 0.007102887868881225, 'init_value': 68.01331329345703}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:09.51[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995067834854126, 'time_algorithm_update': 0.005055019617080689, 'loss': 30.686439066767694, 'time_step': 0.007100455522537232, 'init_value': 74.1827163696289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:09.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019950499534606933, 'time_algorithm_update': 0.0050575056076049806, 'loss': 29.96161776161194, 'time_step': 0.007103128910064697, 'init_value': 80.29692077636719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:10.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210844: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995478391647339, 'time_algorithm_update': 0.00506638503074646, 'loss': 35.34166743862629, 'time_step': 0.007112388610839844, 'init_value': 87.8766860961914}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 87.8766860961914
avg return on 5 trajectories of agent5: 2836.076188333333
Episode generator created
[2m2025-05-05 21:10.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:10.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:10.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:10.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:10.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211010[0m
[2m2025-05-05 21:10.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:10.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019944016933441163, 'time_algorithm_update': 0.005045953750610351, 'loss': 1.424305240869522, 'time_step': 0.0070906498432159425, 'init_value': 10.776289939880371}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:10.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953696727752685, 'time_algorithm_update': 0.005090624094009399, 'loss': 4.336462731778622, 'time_step': 0.00713668417930603, 'init_value': 21.548078536987305}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:10.35[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019860022068023684, 'time_algorithm_update': 0.005081100463867188, 'loss': 9.2331888615489, 'time_step': 0.007118062973022461, 'init_value': 32.31014633178711}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:10.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991826057434082, 'time_algorithm_update': 0.005076226711273194, 'loss': 17.02733004426956, 'time_step': 0.00711840295791626, 'init_value': 42.2647819519043}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:10.52[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198067045211792, 'time_algorithm_update': 0.005069225788116455, 'loss': 19.238411406755446, 'time_step': 0.007100436449050903, 'init_value': 52.41841125488281}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:11.00[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019849679470062254, 'time_algorithm_update': 0.005072140455245971, 'loss': 25.72411092865467, 'time_step': 0.007107471227645874, 'init_value': 61.817195892333984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:11.09[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019935054779052735, 'time_algorithm_update': 0.005070524454116821, 'loss': 30.424725458025932, 'time_step': 0.00711464524269104, 'init_value': 67.78099822998047}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:11.17[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019933357238769533, 'time_algorithm_update': 0.005082192182540893, 'loss': 31.2029235227108, 'time_step': 0.007125956296920776, 'init_value': 74.74181365966797}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:11.26[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019990925788879394, 'time_algorithm_update': 0.005084794282913208, 'loss': 33.16716393303871, 'time_step': 0.0071346526145935054, 'init_value': 81.23368072509766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:11.34[0m [[32m[1minfo     [0m] [1mFQE_20250505211010: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988654375076294, 'time_algorithm_update': 0.0050664303302764896, 'loss': 33.64761486053467, 'time_step': 0.00710567045211792, 'init_value': 87.61036682128906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 87.61036682128906
avg return on 5 trajectories of agent6: 2341.6307833333335
Episode generator created
[2m2025-05-05 21:11.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:11.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:11.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:11.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:11.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211136[0m
[2m2025-05-05 21:11.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:11.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987360954284668, 'time_algorithm_update': 0.00501491379737854, 'loss': 1.4874708833545447, 'time_step': 0.00705194878578186, 'init_value': 9.885984420776367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:11.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984652042388916, 'time_algorithm_update': 0.005074413776397705, 'loss': 4.2928333401679994, 'time_step': 0.007109660148620606, 'init_value': 20.571306228637695}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:12.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983949899673462, 'time_algorithm_update': 0.005065829277038574, 'loss': 10.711587663948537, 'time_step': 0.00709970736503601, 'init_value': 30.362442016601562}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:12.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199005126953125, 'time_algorithm_update': 0.005090588331222534, 'loss': 16.028973051011562, 'time_step': 0.007130817174911499, 'init_value': 39.68983840942383}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:12.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989661693572998, 'time_algorithm_update': 0.005093305826187134, 'loss': 19.43919234275818, 'time_step': 0.007133386850357056, 'init_value': 47.47663497924805}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:12.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981940507888794, 'time_algorithm_update': 0.005072168827056885, 'loss': 22.285835488796234, 'time_step': 0.007109705924987793, 'init_value': 53.865394592285156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:12.35[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019878542423248293, 'time_algorithm_update': 0.005079988718032837, 'loss': 29.239080551028252, 'time_step': 0.007118007659912109, 'init_value': 62.51166915893555}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:12.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019872002601623536, 'time_algorithm_update': 0.005096426010131836, 'loss': 31.10745478117466, 'time_step': 0.007134261131286621, 'init_value': 70.14617919921875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:12.52[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198302960395813, 'time_algorithm_update': 0.005090765237808228, 'loss': 38.75905908358097, 'time_step': 0.007124450445175171, 'init_value': 77.23294830322266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:13.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211136: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019827234745025636, 'time_algorithm_update': 0.00508223032951355, 'loss': 39.28969077038765, 'time_step': 0.007115359783172607, 'init_value': 82.3778305053711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 82.3778305053711
avg return on 5 trajectories of agent7: 2179.497751333334
Episode generator created
[2m2025-05-05 21:13.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:13.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:13.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:13.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:13.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211302[0m
[2m2025-05-05 21:13.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:13.11[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197609806060791, 'time_algorithm_update': 0.004999014616012573, 'loss': 1.4438070448487996, 'time_step': 0.007025303840637207, 'init_value': 10.136514663696289}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:13.19[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986575365066528, 'time_algorithm_update': 0.005059690952301026, 'loss': 4.732678743511438, 'time_step': 0.007096909761428833, 'init_value': 20.838333129882812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:13.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019886696338653562, 'time_algorithm_update': 0.005053593873977661, 'loss': 9.887532153964044, 'time_step': 0.007092957258224487, 'init_value': 31.453067779541016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:13.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019790225028991698, 'time_algorithm_update': 0.005064120292663574, 'loss': 16.260300962805747, 'time_step': 0.007093706369400024, 'init_value': 38.63494110107422}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:13.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991213321685791, 'time_algorithm_update': 0.005076213359832764, 'loss': 19.55322719615698, 'time_step': 0.0071187424659729, 'init_value': 49.130062103271484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:13.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992912769317627, 'time_algorithm_update': 0.005088598728179932, 'loss': 25.257341695189474, 'time_step': 0.007132770299911499, 'init_value': 56.26811599731445}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:14.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019743905067443846, 'time_algorithm_update': 0.005036468505859375, 'loss': 32.99122237741947, 'time_step': 0.007061537027359009, 'init_value': 63.0810661315918}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:14.09[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019908649921417236, 'time_algorithm_update': 0.005057727575302124, 'loss': 34.93830438029766, 'time_step': 0.007099387168884278, 'init_value': 68.53125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:14.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989416599273682, 'time_algorithm_update': 0.005058121919631958, 'loss': 38.19989082813263, 'time_step': 0.00709841775894165, 'init_value': 74.9590835571289}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:14.26[0m [[32m[1minfo     [0m] [1mFQE_20250505211302: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988199710845947, 'time_algorithm_update': 0.005061237335205078, 'loss': 35.40117425954342, 'time_step': 0.007100434541702271, 'init_value': 78.7161636352539}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.7161636352539
avg return on 5 trajectories of agent8: 1886.2132380000003
Episode generator created
[2m2025-05-05 21:14.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:14.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:14.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:14.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:14.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211428[0m
[2m2025-05-05 21:14.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:14.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987318754196167, 'time_algorithm_update': 0.004992614507675171, 'loss': 1.58280317735672, 'time_step': 0.007029564619064331, 'init_value': 10.7551851272583}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:14.45[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991215229034424, 'time_algorithm_update': 0.005038028478622437, 'loss': 4.449296712398529, 'time_step': 0.00707971453666687, 'init_value': 20.755521774291992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:14.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019885239601135254, 'time_algorithm_update': 0.005017690658569336, 'loss': 7.699970234036446, 'time_step': 0.0070561420917510985, 'init_value': 30.437931060791016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:15.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019957332611083983, 'time_algorithm_update': 0.0050266761779785155, 'loss': 14.151519593536854, 'time_step': 0.007073071241378784, 'init_value': 39.58054733276367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:15.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989835023880005, 'time_algorithm_update': 0.005027470350265503, 'loss': 18.96100570857525, 'time_step': 0.007067921638488769, 'init_value': 46.8399772644043}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:15.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019850802421569826, 'time_algorithm_update': 0.005023172855377197, 'loss': 20.856886333465575, 'time_step': 0.007058584928512573, 'init_value': 54.336669921875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:15.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019987523555755615, 'time_algorithm_update': 0.005036091566085816, 'loss': 25.539390420556067, 'time_step': 0.007085704565048217, 'init_value': 60.985008239746094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:15.35[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019837825298309325, 'time_algorithm_update': 0.005017128944396973, 'loss': 29.1113435331583, 'time_step': 0.007051430463790894, 'init_value': 66.4717788696289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:15.43[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019936919212341308, 'time_algorithm_update': 0.0050426054000854495, 'loss': 28.05621576333046, 'time_step': 0.007087035417556763, 'init_value': 73.13097381591797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:15.52[0m [[32m[1minfo     [0m] [1mFQE_20250505211428: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019482042789459228, 'time_algorithm_update': 0.004933231353759766, 'loss': 36.78436647748947, 'time_step': 0.00693041205406189, 'init_value': 77.94966888427734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.94966888427734
avg return on 5 trajectories of agent9: 1905.123198
Episode generator created
[2m2025-05-05 21:15.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:15.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:15.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:15.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:15.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211553[0m
[2m2025-05-05 21:15.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:16.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019504435062408447, 'time_algorithm_update': 0.0049071586132049564, 'loss': 1.4489059313833714, 'time_step': 0.006906497716903687, 'init_value': 10.39335823059082}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:16.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196287202835083, 'time_algorithm_update': 0.004987936735153198, 'loss': 3.8945735338628293, 'time_step': 0.007000196933746338, 'init_value': 20.583471298217773}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:16.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196185827255249, 'time_algorithm_update': 0.004996077060699463, 'loss': 8.143282958090305, 'time_step': 0.007007142305374145, 'init_value': 31.50067710876465}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:16.26[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019617202281951903, 'time_algorithm_update': 0.005000488758087158, 'loss': 14.660843778431415, 'time_step': 0.00701203989982605, 'init_value': 42.57027053833008}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:16.35[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976477861404419, 'time_algorithm_update': 0.005045992612838745, 'loss': 18.65502851295471, 'time_step': 0.007072466611862183, 'init_value': 51.10248565673828}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:16.43[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019793906211853026, 'time_algorithm_update': 0.005072134256362915, 'loss': 22.377213304162026, 'time_step': 0.007101916790008545, 'init_value': 59.95391082763672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:16.51[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019892420768737795, 'time_algorithm_update': 0.005078441381454467, 'loss': 29.402466057896614, 'time_step': 0.0071186585426330565, 'init_value': 66.25249481201172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:17.00[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983100175857544, 'time_algorithm_update': 0.005062168598175049, 'loss': 27.35787480866909, 'time_step': 0.007095558404922485, 'init_value': 71.89912414550781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:17.08[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019799556732177735, 'time_algorithm_update': 0.005073164939880371, 'loss': 31.02918989431858, 'time_step': 0.00710365891456604, 'init_value': 78.1561279296875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:17.17[0m [[32m[1minfo     [0m] [1mFQE_20250505211553: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027066469192505, 'time_algorithm_update': 0.005170530557632446, 'loss': 34.20152394735813, 'time_step': 0.007250117063522339, 'init_value': 85.43579864501953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.43579864501953
avg return on 5 trajectories of agent10: 2918.1883453333335
Episode generator created
[2m2025-05-05 21:17.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:17.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:17.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:17.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:17.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211719[0m
[2m2025-05-05 21:17.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:17.28[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019842679500579833, 'time_algorithm_update': 0.004996310472488403, 'loss': 1.5791908100545407, 'time_step': 0.007030014514923096, 'init_value': 10.027388572692871}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:17.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019948716163635254, 'time_algorithm_update': 0.00507307243347168, 'loss': 4.603256869018078, 'time_step': 0.007118782043457031, 'init_value': 21.022172927856445}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:17.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019999053478240965, 'time_algorithm_update': 0.0050765910148620605, 'loss': 10.438849807202816, 'time_step': 0.007127790927886963, 'init_value': 31.810251235961914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:17.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996500015258789, 'time_algorithm_update': 0.0050805253982543945, 'loss': 13.4972477658391, 'time_step': 0.007128122091293335, 'init_value': 40.39435577392578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:18.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019904563426971435, 'time_algorithm_update': 0.0050765395164489744, 'loss': 18.092038303852082, 'time_step': 0.007117254018783569, 'init_value': 48.604957580566406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:18.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019964566230773924, 'time_algorithm_update': 0.005085254192352295, 'loss': 22.07981054389477, 'time_step': 0.00713401198387146, 'init_value': 56.51049041748047}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:18.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993445873260498, 'time_algorithm_update': 0.005080886363983154, 'loss': 24.325764703035354, 'time_step': 0.007125456571578979, 'init_value': 62.302764892578125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:18.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019930219650268555, 'time_algorithm_update': 0.005079075574874878, 'loss': 29.38630972325802, 'time_step': 0.007122523546218872, 'init_value': 68.31524658203125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:18.35[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993331670761108, 'time_algorithm_update': 0.005079653978347779, 'loss': 35.90661857807636, 'time_step': 0.007124114990234375, 'init_value': 74.46961212158203}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:18.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211719: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974611043930054, 'time_algorithm_update': 0.005044488906860351, 'loss': 35.944358342528346, 'time_step': 0.007069374322891235, 'init_value': 79.76397705078125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.76397705078125
avg return on 5 trajectories of agent11: 2402.3497009999996
Episode generator created
[2m2025-05-05 21:18.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:18.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:18.45[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:18.45[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:18.45[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211845[0m
[2m2025-05-05 21:18.45[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:18.54[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019773657321929933, 'time_algorithm_update': 0.0049945154190063476, 'loss': 1.5548990269601346, 'time_step': 0.007021838188171386, 'init_value': 10.542903900146484}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:19.02[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987640380859375, 'time_algorithm_update': 0.00506829047203064, 'loss': 4.320815143167972, 'time_step': 0.007106619358062744, 'init_value': 20.77913475036621}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:19.11[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995248556137085, 'time_algorithm_update': 0.005073343276977539, 'loss': 8.920784136116504, 'time_step': 0.007119187355041504, 'init_value': 31.342498779296875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:19.19[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019865658283233644, 'time_algorithm_update': 0.0050792829990386965, 'loss': 14.150676146328449, 'time_step': 0.007116254568099976, 'init_value': 39.33029556274414}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:19.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988713264465332, 'time_algorithm_update': 0.005077980518341065, 'loss': 20.16652028787136, 'time_step': 0.007117162466049195, 'init_value': 48.70451354980469}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:19.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019965434074401857, 'time_algorithm_update': 0.005076591730117798, 'loss': 25.195389800667762, 'time_step': 0.007124162197113037, 'init_value': 56.88675308227539}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:19.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019956419467926025, 'time_algorithm_update': 0.00506822943687439, 'loss': 27.782157860398293, 'time_step': 0.0071144883632659915, 'init_value': 63.218223571777344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:19.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019792158603668215, 'time_algorithm_update': 0.005053945541381836, 'loss': 28.592781787514685, 'time_step': 0.0070835669040679936, 'init_value': 69.48344421386719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:20.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019854576587677, 'time_algorithm_update': 0.005069735288619995, 'loss': 31.050275730848313, 'time_step': 0.007105485200881958, 'init_value': 75.34532165527344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:20.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211845: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019868180751800536, 'time_algorithm_update': 0.005081337690353393, 'loss': 35.008126571297645, 'time_step': 0.007119085788726807, 'init_value': 81.71150207519531}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.71150207519531
avg return on 5 trajectories of agent12: 2186.0189173333333
Episode generator created
[2m2025-05-05 21:20.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:20.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:20.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:20.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:20.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212011[0m
[2m2025-05-05 21:20.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:20.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019522433280944823, 'time_algorithm_update': 0.004968761920928955, 'loss': 1.3525354898869992, 'time_step': 0.006968919277191162, 'init_value': 11.252150535583496}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:20.28[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019956581592559816, 'time_algorithm_update': 0.005094639778137207, 'loss': 4.236278445571661, 'time_step': 0.007140849113464355, 'init_value': 22.405710220336914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:20.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019883129596710205, 'time_algorithm_update': 0.005092275619506836, 'loss': 8.492317847251892, 'time_step': 0.007131168603897095, 'init_value': 32.53425598144531}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:20.45[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003401279449463, 'time_algorithm_update': 0.005118627786636352, 'loss': 13.043252115607261, 'time_step': 0.007173070907592774, 'init_value': 42.50643539428711}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:20.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019954655170440674, 'time_algorithm_update': 0.0051077790260314945, 'loss': 16.929183408260347, 'time_step': 0.007154215335845948, 'init_value': 50.999603271484375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:21.02[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019886367321014405, 'time_algorithm_update': 0.005093382596969604, 'loss': 24.635725287914276, 'time_step': 0.007131916284561157, 'init_value': 60.29936599731445}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:21.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993999481201172, 'time_algorithm_update': 0.005101220607757568, 'loss': 24.632953117132185, 'time_step': 0.007145979166030884, 'init_value': 66.75350952148438}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:21.19[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019910504817962646, 'time_algorithm_update': 0.005082197666168213, 'loss': 28.106688568115235, 'time_step': 0.007123430728912353, 'init_value': 73.61840057373047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:21.27[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019922235012054443, 'time_algorithm_update': 0.005092963218688965, 'loss': 35.19544447803497, 'time_step': 0.007136002302169799, 'init_value': 81.00389099121094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:21.36[0m [[32m[1minfo     [0m] [1mFQE_20250505212011: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994473934173584, 'time_algorithm_update': 0.005090648651123047, 'loss': 33.41496337854862, 'time_step': 0.007135611295700073, 'init_value': 86.896484375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 86.896484375
avg return on 5 trajectories of agent13: 2461.2312603333335
Episode generator created
[2m2025-05-05 21:21.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:21.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:21.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:21.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:21.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212138[0m
[2m2025-05-05 21:21.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:21.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019840469360351562, 'time_algorithm_update': 0.0050062077045440675, 'loss': 1.4661007504463195, 'time_step': 0.007039984703063965, 'init_value': 9.87256908416748}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:21.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019794158935546877, 'time_algorithm_update': 0.005047064304351806, 'loss': 3.898179726779461, 'time_step': 0.007075802803039551, 'init_value': 19.401004791259766}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:22.03[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019963440895080565, 'time_algorithm_update': 0.005069494485855103, 'loss': 8.239834699749947, 'time_step': 0.00711614727973938, 'init_value': 29.164045333862305}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:22.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019955179691314696, 'time_algorithm_update': 0.00506782603263855, 'loss': 13.393148454308509, 'time_step': 0.007113993406295776, 'init_value': 38.6279411315918}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:22.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999556541442871, 'time_algorithm_update': 0.005065690279006958, 'loss': 16.243478066921234, 'time_step': 0.007115670442581177, 'init_value': 46.804195404052734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:22.28[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019972546100616457, 'time_algorithm_update': 0.005063872575759887, 'loss': 23.194832198023796, 'time_step': 0.0071117253303527835, 'init_value': 54.868038177490234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:22.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019943044185638426, 'time_algorithm_update': 0.005058891296386718, 'loss': 24.524757498145103, 'time_step': 0.007103773117065429, 'init_value': 61.93840026855469}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:22.45[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019868032932281493, 'time_algorithm_update': 0.00505249285697937, 'loss': 29.01687204837799, 'time_step': 0.0070893530845642086, 'init_value': 68.2155990600586}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:22.53[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994838714599609, 'time_algorithm_update': 0.005064981937408447, 'loss': 35.03404915595055, 'time_step': 0.0071105890274047855, 'init_value': 73.02852630615234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:23.02[0m [[32m[1minfo     [0m] [1mFQE_20250505212138: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969315528869627, 'time_algorithm_update': 0.0050625004768371585, 'loss': 38.636517008304594, 'time_step': 0.007109903812408448, 'init_value': 77.23121643066406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.23121643066406
avg return on 5 trajectories of agent14: 2343.578368
Episode generator created
[2m2025-05-05 21:23.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:23.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:23.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:23.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:23.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212304[0m
[2m2025-05-05 21:23.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:23.12[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974193572998047, 'time_algorithm_update': 0.0049764752388000485, 'loss': 1.4301701272577048, 'time_step': 0.00700010871887207, 'init_value': 9.792767524719238}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:23.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992353677749634, 'time_algorithm_update': 0.005064266681671143, 'loss': 4.098258891046047, 'time_step': 0.007106678485870361, 'init_value': 20.689682006835938}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:23.29[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019735424518585207, 'time_algorithm_update': 0.005045730352401734, 'loss': 9.081473232269287, 'time_step': 0.0070688905715942385, 'init_value': 30.270639419555664}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:23.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019934794902801514, 'time_algorithm_update': 0.00506367826461792, 'loss': 13.91244583851099, 'time_step': 0.0071072509288787845, 'init_value': 38.449398040771484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:23.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019978954792022707, 'time_algorithm_update': 0.005058798789978027, 'loss': 16.9941450009346, 'time_step': 0.0071072642803192134, 'init_value': 47.52485656738281}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:23.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019901106357574465, 'time_algorithm_update': 0.005063810348510742, 'loss': 20.43474453496933, 'time_step': 0.0071044137477874756, 'init_value': 54.00010681152344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:24.03[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019931902885437012, 'time_algorithm_update': 0.00506581449508667, 'loss': 22.971695136785506, 'time_step': 0.007109867811203003, 'init_value': 60.602294921875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:24.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019883050918579103, 'time_algorithm_update': 0.00506964111328125, 'loss': 21.88389172780514, 'time_step': 0.007108719348907471, 'init_value': 64.97888946533203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:24.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018918037414551, 'time_algorithm_update': 0.005144893884658813, 'loss': 28.923963075280188, 'time_step': 0.007215851783752441, 'init_value': 69.62225341796875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:24.28[0m [[32m[1minfo     [0m] [1mFQE_20250505212304: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020006449222564698, 'time_algorithm_update': 0.005089515209197998, 'loss': 27.027148401141165, 'time_step': 0.007141388177871704, 'init_value': 75.64079284667969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 75.64079284667969
avg return on 5 trajectories of agent15: 1770.9148986666667
Episode generator created
[2m2025-05-05 21:24.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:24.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:24.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:24.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:24.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212429[0m
[2m2025-05-05 21:24.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:24.38[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974945068359375, 'time_algorithm_update': 0.004981715679168702, 'loss': 1.373997340887785, 'time_step': 0.007006233930587769, 'init_value': 10.804818153381348}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:24.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019887778759002687, 'time_algorithm_update': 0.005053349256515503, 'loss': 4.058110869467258, 'time_step': 0.007092480182647705, 'init_value': 21.23876190185547}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:24.55[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986265182495117, 'time_algorithm_update': 0.0050579745769500735, 'loss': 8.126021417200565, 'time_step': 0.007094453096389771, 'init_value': 31.626569747924805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:25.03[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019776148796081545, 'time_algorithm_update': 0.005032336235046387, 'loss': 13.400595113515854, 'time_step': 0.0070592546463012695, 'init_value': 40.84822082519531}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:25.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020004112720489503, 'time_algorithm_update': 0.005050141572952271, 'loss': 16.635293313264846, 'time_step': 0.007101503372192383, 'init_value': 47.6863899230957}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:25.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019925191402435302, 'time_algorithm_update': 0.005056867837905884, 'loss': 20.192635055065153, 'time_step': 0.007099848985671997, 'init_value': 56.57724380493164}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:25.28[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019924728870391846, 'time_algorithm_update': 0.0050620436668396, 'loss': 24.542811161637307, 'time_step': 0.007105367183685303, 'init_value': 62.15723419189453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:25.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019885272979736327, 'time_algorithm_update': 0.0050478620529174805, 'loss': 27.890361318826674, 'time_step': 0.007087117195129395, 'init_value': 68.68814849853516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:25.45[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019951021671295167, 'time_algorithm_update': 0.005060184955596924, 'loss': 29.560394296765327, 'time_step': 0.007105876445770263, 'init_value': 73.20182037353516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:25.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212429: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993204116821289, 'time_algorithm_update': 0.005058155059814453, 'loss': 32.1008021197319, 'time_step': 0.0071024420261383055, 'init_value': 78.65231323242188}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.65231323242188
avg return on 5 trajectories of agent16: 2438.7832676666667
Episode generator created
[2m2025-05-05 21:25.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:25.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:25.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:25.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:25.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212555[0m
[2m2025-05-05 21:25.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:26.04[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969482660293579, 'time_algorithm_update': 0.004974117517471313, 'loss': 1.4654096970260144, 'time_step': 0.006992955446243286, 'init_value': 10.319257736206055}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:26.12[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965282678604126, 'time_algorithm_update': 0.005007866144180298, 'loss': 4.930879155427218, 'time_step': 0.007022680044174195, 'init_value': 20.453399658203125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:26.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971489667892456, 'time_algorithm_update': 0.005003292083740235, 'loss': 9.324062890648841, 'time_step': 0.007024517774581909, 'init_value': 31.0033016204834}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:26.29[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975029706954956, 'time_algorithm_update': 0.005016173601150513, 'loss': 15.346186281442643, 'time_step': 0.00704092526435852, 'init_value': 39.327754974365234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:26.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960235595703125, 'time_algorithm_update': 0.004986823558807373, 'loss': 20.063472707033156, 'time_step': 0.00699610447883606, 'init_value': 47.591712951660156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:26.45[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989241600036621, 'time_algorithm_update': 0.005053215026855469, 'loss': 23.517236655116083, 'time_step': 0.007092838764190674, 'init_value': 57.172786712646484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:26.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020000364780426026, 'time_algorithm_update': 0.005089427471160889, 'loss': 31.74668194794655, 'time_step': 0.007140220165252686, 'init_value': 65.2286376953125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:27.02[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019932148456573485, 'time_algorithm_update': 0.005084785223007202, 'loss': 32.01936248350143, 'time_step': 0.007129184484481812, 'init_value': 70.98040771484375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:27.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020026376247406007, 'time_algorithm_update': 0.005097494602203369, 'loss': 33.33136974036694, 'time_step': 0.007151225566864014, 'init_value': 75.66374969482422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:27.19[0m [[32m[1minfo     [0m] [1mFQE_20250505212555: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019928085803985595, 'time_algorithm_update': 0.005076505422592163, 'loss': 35.126484424829485, 'time_step': 0.007120243787765503, 'init_value': 81.17082977294922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.17082977294922
avg return on 5 trajectories of agent17: 2894.716952
Episode generator created
[2m2025-05-05 21:27.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:27.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:27.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:27.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:27.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212721[0m
[2m2025-05-05 21:27.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:27.30[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019826071262359617, 'time_algorithm_update': 0.005010165691375732, 'loss': 1.4922945016175508, 'time_step': 0.007043255567550659, 'init_value': 9.852583885192871}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:27.38[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019906742572784425, 'time_algorithm_update': 0.005088157415390014, 'loss': 4.038844678431749, 'time_step': 0.007129648685455322, 'init_value': 19.32295799255371}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:27.47[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020053691864013673, 'time_algorithm_update': 0.0051282718181610105, 'loss': 7.436538748085499, 'time_step': 0.007184779405593872, 'init_value': 28.003738403320312}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:27.55[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019907283782958983, 'time_algorithm_update': 0.005080336570739746, 'loss': 10.654739273250103, 'time_step': 0.007121921539306641, 'init_value': 36.507850646972656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:28.04[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986266136169434, 'time_algorithm_update': 0.005067857027053833, 'loss': 15.549213979005813, 'time_step': 0.007104886531829834, 'init_value': 44.8937873840332}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:28.12[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020296926498413084, 'time_algorithm_update': 0.005160979747772217, 'loss': 20.325760894775392, 'time_step': 0.007242828845977783, 'init_value': 50.6373291015625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:28.21[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020223004817962647, 'time_algorithm_update': 0.005146501541137695, 'loss': 19.256885229945183, 'time_step': 0.0072207262516021725, 'init_value': 57.788780212402344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:28.29[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019829590320587158, 'time_algorithm_update': 0.005050876140594482, 'loss': 23.154675068736076, 'time_step': 0.007084267854690552, 'init_value': 63.87595748901367}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:28.38[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001097202301025, 'time_algorithm_update': 0.005088066101074219, 'loss': 24.087863999247553, 'time_step': 0.007140350818634033, 'init_value': 70.52879333496094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:28.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212721: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989882230758667, 'time_algorithm_update': 0.00507705807685852, 'loss': 26.516151584267615, 'time_step': 0.007118008375167847, 'init_value': 73.68572998046875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 73.68572998046875
avg return on 5 trajectories of agent18: 2551.019029
Episode generator created
[2m2025-05-05 21:28.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:28.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:28.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:28.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:28.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212848[0m
[2m2025-05-05 21:28.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:28.57[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983619213104248, 'time_algorithm_update': 0.005008485078811646, 'loss': 1.3577037798464298, 'time_step': 0.0070420000553131105, 'init_value': 10.918057441711426}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:29.05[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993879795074463, 'time_algorithm_update': 0.005077853679656983, 'loss': 3.8126598580181597, 'time_step': 0.007123447179794311, 'init_value': 21.37786293029785}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:29.13[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019869811534881593, 'time_algorithm_update': 0.005082256555557251, 'loss': 8.065060774326325, 'time_step': 0.007120063304901123, 'init_value': 31.629642486572266}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:29.22[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019930598735809326, 'time_algorithm_update': 0.005085098266601563, 'loss': 12.52331349182129, 'time_step': 0.007129353284835815, 'init_value': 40.292381286621094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:29.30[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020010309219360353, 'time_algorithm_update': 0.005084932804107666, 'loss': 17.424154487729073, 'time_step': 0.0071369514465332035, 'init_value': 49.066986083984375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:29.39[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019899818897247314, 'time_algorithm_update': 0.005065631866455078, 'loss': 20.615147405982018, 'time_step': 0.007106263637542725, 'init_value': 57.57324981689453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:29.47[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002002042293548584, 'time_algorithm_update': 0.00508777666091919, 'loss': 24.047935243725778, 'time_step': 0.007140559673309326, 'init_value': 64.1639404296875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:29.56[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019965968132019045, 'time_algorithm_update': 0.005080987215042115, 'loss': 26.72116567349434, 'time_step': 0.00712836217880249, 'init_value': 70.1877212524414}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:30.04[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983675003051758, 'time_algorithm_update': 0.0050679221153259275, 'loss': 31.599195545196533, 'time_step': 0.0071016566753387455, 'init_value': 75.37166595458984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:30.12[0m [[32m[1minfo     [0m] [1mFQE_20250505212848: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019957926273345946, 'time_algorithm_update': 0.00508669114112854, 'loss': 32.170333202004436, 'time_step': 0.007133577585220337, 'init_value': 80.16834259033203}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.16834259033203
avg return on 5 trajectories of agent19: 2790.208845333333
Episode generator created
[2m2025-05-05 21:30.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:30.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:30.15[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:30.15[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:30.15[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213015[0m
[2m2025-05-05 21:30.15[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:30.23[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019885618686676025, 'time_algorithm_update': 0.0050073878765106205, 'loss': 1.432034962594509, 'time_step': 0.007045939207077027, 'init_value': 9.966838836669922}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:30.31[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990886926651001, 'time_algorithm_update': 0.005080704927444458, 'loss': 4.60933241468668, 'time_step': 0.007122162580490112, 'init_value': 20.48136329650879}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:30.40[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019903268814086914, 'time_algorithm_update': 0.005055167436599731, 'loss': 9.693658351361751, 'time_step': 0.007095640182495117, 'init_value': 31.192100524902344}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:30.48[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019962120056152342, 'time_algorithm_update': 0.005075302839279175, 'loss': 15.185312318623065, 'time_step': 0.007122040987014771, 'init_value': 40.28776168823242}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:30.57[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991591215133667, 'time_algorithm_update': 0.005078696966171264, 'loss': 20.711889511227607, 'time_step': 0.007121071100234986, 'init_value': 48.571205139160156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:31.05[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019904820919036865, 'time_algorithm_update': 0.005072979688644409, 'loss': 25.41509752213955, 'time_step': 0.007113780498504639, 'init_value': 57.154781341552734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:31.14[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200290584564209, 'time_algorithm_update': 0.005109177350997925, 'loss': 27.098278002023697, 'time_step': 0.007162995100021362, 'init_value': 64.65580749511719}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:31.22[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198478102684021, 'time_algorithm_update': 0.005069108247756958, 'loss': 32.985278193950656, 'time_step': 0.007104243755340576, 'init_value': 69.60014343261719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:31.31[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019789438247680663, 'time_algorithm_update': 0.005059688329696655, 'loss': 35.356581745624545, 'time_step': 0.007088648080825806, 'init_value': 76.0853042602539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:31.39[0m [[32m[1minfo     [0m] [1mFQE_20250505213015: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980617046356201, 'time_algorithm_update': 0.005060673236846924, 'loss': 36.756297667503354, 'time_step': 0.007091644763946533, 'init_value': 81.88787841796875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.88787841796875
ave advantage rew: 81.20762977600097, std: 4.142025529666471
avg cum rews: 2378.4369997666668, std: 350.4618599751042
Pearson correlation coefficient: 8.478247744965443e-05
Spearman correlation coefficient: 0.04661654135338346
Kendall Tau correlation coefficient: 0.021052631578947368
the best agent: 0, best agent cum rewards: 2492.5045576666666
1965
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.01632195594431969
avg return on 5 trajectories of agent0: 3207.186178666667
Episode generator created
[2m2025-05-05 21:31.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:31.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:31.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:31.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:31.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213151[0m
[2m2025-05-05 21:31.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:32.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984794616699219, 'time_algorithm_update': 0.0049882962703704835, 'loss': 1.4989118397086858, 'time_step': 0.007022879123687744, 'init_value': 10.53325080871582}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:32.08[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020075068473815916, 'time_algorithm_update': 0.0050776245594024655, 'loss': 4.689359688907862, 'time_step': 0.007135990142822265, 'init_value': 21.41297721862793}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:32.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020042340755462647, 'time_algorithm_update': 0.005083897829055786, 'loss': 8.657389118283987, 'time_step': 0.0071392240524291994, 'init_value': 30.89734649658203}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:32.25[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019949636459350587, 'time_algorithm_update': 0.005070373296737671, 'loss': 13.592698631823064, 'time_step': 0.007116222143173217, 'init_value': 40.771141052246094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:32.33[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020025136470794677, 'time_algorithm_update': 0.005087090253829956, 'loss': 17.81207060110569, 'time_step': 0.007140060424804687, 'init_value': 48.8524284362793}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:32.42[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020001206398010253, 'time_algorithm_update': 0.005069514274597168, 'loss': 22.692985699653626, 'time_step': 0.007120409250259399, 'init_value': 56.302978515625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:32.50[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996588468551636, 'time_algorithm_update': 0.005075814008712769, 'loss': 26.568098043322564, 'time_step': 0.007122926473617554, 'init_value': 65.00830841064453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:32.59[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019915637969970704, 'time_algorithm_update': 0.005073956489562988, 'loss': 31.1989351593256, 'time_step': 0.007116009950637817, 'init_value': 69.78783416748047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:33.07[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980844497680664, 'time_algorithm_update': 0.0050406730175018314, 'loss': 35.3186557033062, 'time_step': 0.007071397542953491, 'init_value': 75.29374694824219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:33.16[0m [[32m[1minfo     [0m] [1mFQE_20250505213151: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003528594970703, 'time_algorithm_update': 0.0050833110809326175, 'loss': 38.65213568043709, 'time_step': 0.007138015747070313, 'init_value': 78.60327911376953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 78.60327911376953
avg return on 5 trajectories of agent1: 2803.0377163333337
Episode generator created
[2m2025-05-05 21:33.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:33.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:33.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:33.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:33.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213318[0m
[2m2025-05-05 21:33.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:33.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973877191543579, 'time_algorithm_update': 0.004984309196472168, 'loss': 1.4576582779437304, 'time_step': 0.00700766396522522, 'init_value': 9.938475608825684}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:33.35[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019935569763183596, 'time_algorithm_update': 0.005066330909729004, 'loss': 4.04914834973216, 'time_step': 0.007110702991485596, 'init_value': 20.343677520751953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:33.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019897096157073975, 'time_algorithm_update': 0.005057746648788452, 'loss': 9.209076193928718, 'time_step': 0.0070982036590576175, 'init_value': 30.529956817626953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:33.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019884223937988283, 'time_algorithm_update': 0.005062450885772705, 'loss': 15.114045056819915, 'time_step': 0.007101413249969483, 'init_value': 40.00630187988281}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:34.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989952325820923, 'time_algorithm_update': 0.005062322139739991, 'loss': 19.743379698634147, 'time_step': 0.0071032378673553465, 'init_value': 46.99479675292969}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:34.08[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001991246223449707, 'time_algorithm_update': 0.00506967830657959, 'loss': 23.668518413424493, 'time_step': 0.0071118583679199215, 'init_value': 54.665679931640625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:34.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994846820831299, 'time_algorithm_update': 0.00506483793258667, 'loss': 26.07219812464714, 'time_step': 0.007110536813735962, 'init_value': 60.78737258911133}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:34.25[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909899234771726, 'time_algorithm_update': 0.00505739426612854, 'loss': 29.06800140786171, 'time_step': 0.007099018335342407, 'init_value': 65.73405456542969}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:34.34[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019931623935699463, 'time_algorithm_update': 0.005066552639007568, 'loss': 31.477932897090913, 'time_step': 0.007110896825790405, 'init_value': 69.69731140136719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:34.42[0m [[32m[1minfo     [0m] [1mFQE_20250505213318: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019976303577423095, 'time_algorithm_update': 0.005089323759078979, 'loss': 31.044402918338776, 'time_step': 0.0071381094455719, 'init_value': 76.08451080322266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.08451080322266
avg return on 5 trajectories of agent2: 1992.6608596666665
Episode generator created
[2m2025-05-05 21:34.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:34.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:34.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:34.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:34.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213444[0m
[2m2025-05-05 21:34.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:34.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019993293285369873, 'time_algorithm_update': 0.005019817590713501, 'loss': 1.517106810107827, 'time_step': 0.007069579124450684, 'init_value': 10.364840507507324}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:35.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019952406883239748, 'time_algorithm_update': 0.005059428453445434, 'loss': 4.821715492904186, 'time_step': 0.007104977607727051, 'init_value': 20.533687591552734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:35.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002000284194946289, 'time_algorithm_update': 0.005068175554275513, 'loss': 8.62883836710453, 'time_step': 0.007119311571121216, 'init_value': 30.567472457885742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:35.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992512226104736, 'time_algorithm_update': 0.005042532205581665, 'loss': 13.252546391189098, 'time_step': 0.0070853190422058105, 'init_value': 40.69021224975586}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:35.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019946742057800294, 'time_algorithm_update': 0.00506529712677002, 'loss': 19.717484184741974, 'time_step': 0.0071108400821685794, 'init_value': 48.65534591674805}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:35.34[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020014641284942626, 'time_algorithm_update': 0.0050621523857116695, 'loss': 22.206079889059065, 'time_step': 0.007114563703536987, 'init_value': 55.8714714050293}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:35.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019917259216308595, 'time_algorithm_update': 0.005049233675003052, 'loss': 23.950307819128035, 'time_step': 0.007091286420822143, 'init_value': 63.365821838378906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:35.51[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969685077667236, 'time_algorithm_update': 0.005049915075302124, 'loss': 28.685688247442247, 'time_step': 0.0070976362228393555, 'init_value': 69.45696258544922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:35.59[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019954631328582763, 'time_algorithm_update': 0.005048428297042847, 'loss': 34.179562671899795, 'time_step': 0.007094348907470703, 'init_value': 75.67868041992188}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:36.08[0m [[32m[1minfo     [0m] [1mFQE_20250505213444: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019854965209960937, 'time_algorithm_update': 0.005041698694229126, 'loss': 33.0067808265686, 'time_step': 0.0070778605937957765, 'init_value': 81.0234375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.0234375
avg return on 5 trajectories of agent3: 3297.462338
Episode generator created
[2m2025-05-05 21:36.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:36.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:36.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:36.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:36.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213610[0m
[2m2025-05-05 21:36.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:36.19[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001922487735748291, 'time_algorithm_update': 0.004861903190612793, 'loss': 1.5621221746057272, 'time_step': 0.006831875801086426, 'init_value': 10.036176681518555}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:36.27[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019597129821777343, 'time_algorithm_update': 0.0049837234020233155, 'loss': 4.409013162970543, 'time_step': 0.006992711067199707, 'init_value': 20.142330169677734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:36.35[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019628565311431883, 'time_algorithm_update': 0.004987485885620117, 'loss': 9.527960687577725, 'time_step': 0.007000056028366089, 'init_value': 30.92269515991211}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:36.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959876537322998, 'time_algorithm_update': 0.004987236022949219, 'loss': 13.89099358344078, 'time_step': 0.006996418714523315, 'init_value': 40.278831481933594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:36.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019605095386505127, 'time_algorithm_update': 0.004988357305526734, 'loss': 17.978523759007455, 'time_step': 0.006998536348342896, 'init_value': 47.22300338745117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:37.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019805092811584473, 'time_algorithm_update': 0.005028538703918457, 'loss': 24.49939389836788, 'time_step': 0.0070592985153198244, 'init_value': 54.89463806152344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:37.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019915573596954346, 'time_algorithm_update': 0.005063462495803833, 'loss': 26.96651798224449, 'time_step': 0.007105595588684082, 'init_value': 60.69738006591797}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:37.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020007553100585937, 'time_algorithm_update': 0.005072423696517944, 'loss': 29.126736043214798, 'time_step': 0.0071240317821502685, 'init_value': 66.9523696899414}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:37.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898366928100585, 'time_algorithm_update': 0.005058750152587891, 'loss': 32.75418733048439, 'time_step': 0.007099437236785889, 'init_value': 71.80941772460938}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:37.34[0m [[32m[1minfo     [0m] [1mFQE_20250505213610: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001943826675415, 'time_algorithm_update': 0.005067359685897827, 'loss': 33.74819328808785, 'time_step': 0.007120126962661743, 'init_value': 76.50627899169922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.50627899169922
avg return on 5 trajectories of agent4: 1674.915282
Episode generator created
[2m2025-05-05 21:37.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:37.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:37.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:37.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:37.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213735[0m
[2m2025-05-05 21:37.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:37.44[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001979261636734009, 'time_algorithm_update': 0.004988393545150757, 'loss': 1.546973525673151, 'time_step': 0.007017235040664673, 'init_value': 9.994830131530762}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:37.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019776012897491455, 'time_algorithm_update': 0.005009698629379273, 'loss': 4.412973317116499, 'time_step': 0.007037168025970459, 'init_value': 19.838207244873047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:38.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980661869049072, 'time_algorithm_update': 0.005034869194030762, 'loss': 8.188413455843925, 'time_step': 0.007067548751831055, 'init_value': 28.75381088256836}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:38.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982475757598877, 'time_algorithm_update': 0.00503999137878418, 'loss': 12.112296318292618, 'time_step': 0.007073054552078247, 'init_value': 37.739437103271484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:38.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007354974746704, 'time_algorithm_update': 0.005115308284759521, 'loss': 16.713542546153068, 'time_step': 0.0071741418838500975, 'init_value': 45.59764862060547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:38.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020171756744384764, 'time_algorithm_update': 0.005118314027786255, 'loss': 20.097732575654984, 'time_step': 0.007187458753585815, 'init_value': 52.30175018310547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:38.34[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019849624633789063, 'time_algorithm_update': 0.00506264066696167, 'loss': 22.755640409827233, 'time_step': 0.007098850727081299, 'init_value': 59.13773727416992}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:38.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019853131771087646, 'time_algorithm_update': 0.0050524847507476805, 'loss': 29.48935315990448, 'time_step': 0.007088656187057495, 'init_value': 65.20782470703125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:38.51[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982027530670166, 'time_algorithm_update': 0.005049355268478393, 'loss': 32.50486998105049, 'time_step': 0.007081647157669067, 'init_value': 72.00833892822266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:38.59[0m [[32m[1minfo     [0m] [1mFQE_20250505213735: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019865052700042724, 'time_algorithm_update': 0.005054382085800171, 'loss': 31.29220457673073, 'time_step': 0.007091663360595703, 'init_value': 77.64798736572266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.64798736572266
avg return on 5 trajectories of agent5: 2623.380336
Episode generator created
[2m2025-05-05 21:39.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:39.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:39.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:39.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:39.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213902[0m
[2m2025-05-05 21:39.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:39.10[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988152503967285, 'time_algorithm_update': 0.004996514081954956, 'loss': 1.3961774093061685, 'time_step': 0.007035127401351929, 'init_value': 10.912184715270996}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:39.18[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001986203908920288, 'time_algorithm_update': 0.005043762445449829, 'loss': 4.144146604061127, 'time_step': 0.007080666542053223, 'init_value': 21.071014404296875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:39.27[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974616289138794, 'time_algorithm_update': 0.005020006895065308, 'loss': 9.119334375441074, 'time_step': 0.007044503450393677, 'init_value': 31.968156814575195}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:39.35[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019866349697113036, 'time_algorithm_update': 0.005057768583297729, 'loss': 12.537178557157516, 'time_step': 0.007095185041427613, 'init_value': 40.65280532836914}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:39.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019847581386566162, 'time_algorithm_update': 0.005055749177932739, 'loss': 18.074752019405366, 'time_step': 0.007090844869613647, 'init_value': 48.78676223754883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:39.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990375518798828, 'time_algorithm_update': 0.005044185400009156, 'loss': 21.52115103983879, 'time_step': 0.0070858955383300785, 'init_value': 57.09051513671875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:40.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001985262393951416, 'time_algorithm_update': 0.005056471347808838, 'loss': 28.810320469379427, 'time_step': 0.007091901063919067, 'init_value': 64.72393798828125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:40.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983968734741211, 'time_algorithm_update': 0.0050550813674926755, 'loss': 32.51319873332977, 'time_step': 0.007089303493499756, 'init_value': 68.95782470703125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:40.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019797289371490476, 'time_algorithm_update': 0.005055723428726197, 'loss': 30.430443726062773, 'time_step': 0.0070858545303344725, 'init_value': 75.42687225341797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:40.25[0m [[32m[1minfo     [0m] [1mFQE_20250505213902: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019858758449554444, 'time_algorithm_update': 0.0050589549541473385, 'loss': 35.342225756645206, 'time_step': 0.007095149517059326, 'init_value': 79.84099578857422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.84099578857422
avg return on 5 trajectories of agent6: 2779.562771333334
Episode generator created
[2m2025-05-05 21:40.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:40.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:40.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:40.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:40.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214028[0m
[2m2025-05-05 21:40.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:40.36[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982635736465454, 'time_algorithm_update': 0.005000250101089477, 'loss': 1.4693223714530468, 'time_step': 0.0070325927734375, 'init_value': 10.541463851928711}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:40.44[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019764471054077148, 'time_algorithm_update': 0.005018039464950562, 'loss': 4.399176325708628, 'time_step': 0.007044971227645874, 'init_value': 21.243982315063477}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:40.53[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989245653152466, 'time_algorithm_update': 0.005026252031326294, 'loss': 10.420974167108536, 'time_step': 0.0070659580230712895, 'init_value': 31.294082641601562}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:41.01[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019762771129608154, 'time_algorithm_update': 0.005019853115081787, 'loss': 15.117999067425728, 'time_step': 0.007046273946762085, 'init_value': 40.5836067199707}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:41.09[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019803888797760008, 'time_algorithm_update': 0.005035837888717651, 'loss': 18.917228902459144, 'time_step': 0.007066289901733399, 'init_value': 48.96957015991211}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:41.18[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019888777732849122, 'time_algorithm_update': 0.005023802995681763, 'loss': 22.018972495794298, 'time_step': 0.0070632085800170896, 'init_value': 55.67850875854492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:41.26[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993751049041748, 'time_algorithm_update': 0.005046432018280029, 'loss': 24.619372861266136, 'time_step': 0.007091012954711914, 'init_value': 63.52125549316406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:41.35[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019898817539215088, 'time_algorithm_update': 0.005040398597717285, 'loss': 28.39653178358078, 'time_step': 0.007081120014190674, 'init_value': 69.86526489257812}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:41.43[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982184410095215, 'time_algorithm_update': 0.005025895357131958, 'loss': 35.13929484260082, 'time_step': 0.0070587718486785885, 'init_value': 76.09867095947266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:41.52[0m [[32m[1minfo     [0m] [1mFQE_20250505214028: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020104568004608156, 'time_algorithm_update': 0.005093412399291992, 'loss': 34.727595061540605, 'time_step': 0.00715565538406372, 'init_value': 80.09671783447266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.09671783447266
avg return on 5 trajectories of agent7: 1953.9607943333333
Episode generator created
[2m2025-05-05 21:41.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:41.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:41.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:41.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:41.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214153[0m
[2m2025-05-05 21:41.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:42.02[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010645866394043, 'time_algorithm_update': 0.005099016666412354, 'loss': 1.3911166289299726, 'time_step': 0.007161325216293335, 'init_value': 10.46947193145752}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:42.10[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019896440505981446, 'time_algorithm_update': 0.005071622610092163, 'loss': 4.067613085716963, 'time_step': 0.007112191915512085, 'init_value': 21.092601776123047}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:42.19[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019849324226379394, 'time_algorithm_update': 0.005066400766372681, 'loss': 7.596687429726124, 'time_step': 0.007101890087127686, 'init_value': 31.359453201293945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:42.27[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019822375774383545, 'time_algorithm_update': 0.005071671009063721, 'loss': 14.22590261888504, 'time_step': 0.007104795694351196, 'init_value': 41.39509582519531}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:42.35[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019851205348968507, 'time_algorithm_update': 0.005054948568344117, 'loss': 18.117230952382087, 'time_step': 0.007090249061584473, 'init_value': 50.5989990234375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:42.44[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976158142089844, 'time_algorithm_update': 0.005044915199279785, 'loss': 18.581120024442672, 'time_step': 0.007071156740188598, 'init_value': 58.69588851928711}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:42.52[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019871678352355957, 'time_algorithm_update': 0.0050673213005065915, 'loss': 26.249781351923943, 'time_step': 0.007105185270309448, 'init_value': 66.99027252197266}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:43.01[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019849517345428467, 'time_algorithm_update': 0.0050571620464324955, 'loss': 27.111620123624803, 'time_step': 0.007092440605163574, 'init_value': 72.60157775878906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:43.09[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001982025146484375, 'time_algorithm_update': 0.00505010437965393, 'loss': 29.580959139347076, 'time_step': 0.007083086729049682, 'init_value': 77.90450286865234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:43.17[0m [[32m[1minfo     [0m] [1mFQE_20250505214153: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019872868061065673, 'time_algorithm_update': 0.0050627169609069825, 'loss': 30.586679027199747, 'time_step': 0.007100617408752442, 'init_value': 85.15351104736328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.15351104736328
avg return on 5 trajectories of agent8: 2533.601087
Episode generator created
[2m2025-05-05 21:43.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:43.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:43.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:43.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:43.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214319[0m
[2m2025-05-05 21:43.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:43.28[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019746320247650147, 'time_algorithm_update': 0.004993723392486572, 'loss': 1.4764679938405751, 'time_step': 0.007017871141433716, 'init_value': 10.085461616516113}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:43.36[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019755795001983644, 'time_algorithm_update': 0.005061650991439819, 'loss': 4.268725051641464, 'time_step': 0.007087707042694092, 'init_value': 20.10187339782715}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:43.45[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019917144775390624, 'time_algorithm_update': 0.005073843002319336, 'loss': 7.858954271793365, 'time_step': 0.007116114377975464, 'init_value': 30.203866958618164}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:43.53[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019940369129180908, 'time_algorithm_update': 0.005073915481567383, 'loss': 12.10612207520008, 'time_step': 0.007118648290634156, 'init_value': 39.443214416503906}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:44.02[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972790002822876, 'time_algorithm_update': 0.005054532289505005, 'loss': 18.144129952192305, 'time_step': 0.007077165365219116, 'init_value': 49.119747161865234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:44.10[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001984756946563721, 'time_algorithm_update': 0.005066526412963867, 'loss': 24.259275943517686, 'time_step': 0.0071014509201049805, 'init_value': 57.56173324584961}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:44.18[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019921722412109375, 'time_algorithm_update': 0.00507800817489624, 'loss': 29.36438851416111, 'time_step': 0.0071213066577911375, 'init_value': 65.0515365600586}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:44.27[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992748975753784, 'time_algorithm_update': 0.005076460123062134, 'loss': 30.846746862769127, 'time_step': 0.0071202142238616945, 'init_value': 72.17448425292969}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:44.35[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953012466430663, 'time_algorithm_update': 0.005076908588409424, 'loss': 35.354021477341654, 'time_step': 0.007123053073883057, 'init_value': 78.6043930053711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:44.44[0m [[32m[1minfo     [0m] [1mFQE_20250505214319: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992872953414917, 'time_algorithm_update': 0.005072550058364868, 'loss': 38.70174870574474, 'time_step': 0.007116580724716186, 'init_value': 85.42044830322266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.42044830322266
avg return on 5 trajectories of agent9: 2813.2389043333333
Episode generator created
[2m2025-05-05 21:44.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:44.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:44.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:44.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:44.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214446[0m
[2m2025-05-05 21:44.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:44.54[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019852113723754883, 'time_algorithm_update': 0.00501534366607666, 'loss': 1.502376300305128, 'time_step': 0.007050062417984009, 'init_value': 10.387770652770996}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:45.03[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019831786155700684, 'time_algorithm_update': 0.005078599691390991, 'loss': 4.85337008690834, 'time_step': 0.007112412452697754, 'init_value': 20.347320556640625}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:45.11[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893801212310792, 'time_algorithm_update': 0.0050854945182800294, 'loss': 9.310865733265876, 'time_step': 0.007125930309295654, 'init_value': 30.576732635498047}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:45.20[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019953005313873293, 'time_algorithm_update': 0.005092065811157226, 'loss': 13.746045762360096, 'time_step': 0.007138020515441894, 'init_value': 39.99087142944336}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:45.28[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993253469467163, 'time_algorithm_update': 0.00510926604270935, 'loss': 20.915208446502685, 'time_step': 0.007153104543685913, 'init_value': 48.10707092285156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:45.37[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002005722761154175, 'time_algorithm_update': 0.005144399881362915, 'loss': 21.896074629187584, 'time_step': 0.007201701879501343, 'init_value': 55.91341018676758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:45.45[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919729232788087, 'time_algorithm_update': 0.005095647096633911, 'loss': 29.294021136045455, 'time_step': 0.007138140201568603, 'init_value': 62.106727600097656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:45.54[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993091821670532, 'time_algorithm_update': 0.00509217357635498, 'loss': 28.945332674503327, 'time_step': 0.00713594126701355, 'init_value': 68.72573852539062}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:46.02[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019955925941467284, 'time_algorithm_update': 0.005086172342300415, 'loss': 33.33179075729847, 'time_step': 0.007132482528686523, 'init_value': 75.83370971679688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:46.10[0m [[32m[1minfo     [0m] [1mFQE_20250505214446: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994677782058716, 'time_algorithm_update': 0.00507556939125061, 'loss': 38.27480603599548, 'time_step': 0.007120931625366211, 'init_value': 81.70196533203125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.70196533203125
avg return on 5 trajectories of agent10: 2786.121583
Episode generator created
[2m2025-05-05 21:46.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:46.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:46.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:46.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:46.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214613[0m
[2m2025-05-05 21:46.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:46.21[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019644081592559816, 'time_algorithm_update': 0.004958766460418701, 'loss': 1.4382178189754486, 'time_step': 0.006972103834152222, 'init_value': 10.035440444946289}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:46.29[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00195342755317688, 'time_algorithm_update': 0.00494360613822937, 'loss': 4.267894819676876, 'time_step': 0.0069459137916564944, 'init_value': 20.217105865478516}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:46.38[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957794427871704, 'time_algorithm_update': 0.004960106372833252, 'loss': 8.994717964172363, 'time_step': 0.006967152833938599, 'init_value': 29.241653442382812}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:46.46[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001954738140106201, 'time_algorithm_update': 0.00495277738571167, 'loss': 13.002856692731381, 'time_step': 0.006956178188323975, 'init_value': 37.98373794555664}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:46.54[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019578185081481933, 'time_algorithm_update': 0.004963137149810791, 'loss': 17.925306616544724, 'time_step': 0.006969820499420166, 'init_value': 45.96250534057617}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:47.02[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001953152894973755, 'time_algorithm_update': 0.0049504988193511965, 'loss': 20.49998746085167, 'time_step': 0.006952933311462402, 'init_value': 51.8121337890625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:47.11[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019597370624542237, 'time_algorithm_update': 0.0049941022396087645, 'loss': 24.527855199575423, 'time_step': 0.007003255605697632, 'init_value': 59.206172943115234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019965317249298095, 'time_algorithm_update': 0.005059960603713989, 'loss': 22.702065651774408, 'time_step': 0.007107313632965088, 'init_value': 64.22953796386719}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:47.27[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019951088428497316, 'time_algorithm_update': 0.005044310092926025, 'loss': 29.104172320365905, 'time_step': 0.007090297222137451, 'init_value': 70.03689575195312}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:47.36[0m [[32m[1minfo     [0m] [1mFQE_20250505214613: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019920856952667237, 'time_algorithm_update': 0.005040607690811157, 'loss': 32.75937996518612, 'time_step': 0.007083361625671387, 'init_value': 74.21363067626953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.21363067626953
avg return on 5 trajectories of agent11: 2884.8165296666666
Episode generator created
[2m2025-05-05 21:47.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:47.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:47.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:47.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:47.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214738[0m
[2m2025-05-05 21:47.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:47.47[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019816811084747313, 'time_algorithm_update': 0.005016970634460449, 'loss': 1.6155649790912867, 'time_step': 0.007048354864120483, 'init_value': 10.188179969787598}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:47.55[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989349603652954, 'time_algorithm_update': 0.0051148045063018795, 'loss': 4.671969511926174, 'time_step': 0.007154929876327515, 'init_value': 21.185836791992188}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:48.04[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019918854236602784, 'time_algorithm_update': 0.005091720819473266, 'loss': 9.992144988894463, 'time_step': 0.007133925914764404, 'init_value': 31.493568420410156}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:48.12[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019929516315460205, 'time_algorithm_update': 0.005094892978668213, 'loss': 15.452433523058891, 'time_step': 0.007139015674591065, 'init_value': 40.44984817504883}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:48.20[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995210647583008, 'time_algorithm_update': 0.005106120347976684, 'loss': 19.246270858168604, 'time_step': 0.00715187668800354, 'init_value': 48.091094970703125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:48.29[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019911587238311767, 'time_algorithm_update': 0.005097659826278686, 'loss': 26.98357030069828, 'time_step': 0.007139219760894776, 'init_value': 55.95532989501953}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:48.37[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996427297592163, 'time_algorithm_update': 0.005106199979782105, 'loss': 27.30502575492859, 'time_step': 0.007153861284255982, 'init_value': 62.704647064208984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:48.46[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019716899394989014, 'time_algorithm_update': 0.0050799140930175785, 'loss': 30.620020277500153, 'time_step': 0.007102030277252197, 'init_value': 67.94014739990234}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:48.54[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020067789554595945, 'time_algorithm_update': 0.005115415096282959, 'loss': 32.784630167245865, 'time_step': 0.007173240900039673, 'init_value': 73.88809967041016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:49.03[0m [[32m[1minfo     [0m] [1mFQE_20250505214738: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020061182975769044, 'time_algorithm_update': 0.005130557775497436, 'loss': 34.658345692157745, 'time_step': 0.007188009262084961, 'init_value': 79.4288101196289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.4288101196289
avg return on 5 trajectories of agent12: 2817.361668
Episode generator created
[2m2025-05-05 21:49.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:49.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:49.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:49.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:49.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214905[0m
[2m2025-05-05 21:49.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:49.13[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019870839118957518, 'time_algorithm_update': 0.005020502805709839, 'loss': 1.5388420411497354, 'time_step': 0.007057752370834351, 'init_value': 10.951868057250977}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:49.22[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198756742477417, 'time_algorithm_update': 0.005071927785873413, 'loss': 4.9512386996150015, 'time_step': 0.007109697103500366, 'init_value': 21.606821060180664}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:49.30[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019883542060852052, 'time_algorithm_update': 0.005070596933364868, 'loss': 10.283534926652909, 'time_step': 0.007109273195266724, 'init_value': 31.42270851135254}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:49.39[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992802858352661, 'time_algorithm_update': 0.005089640140533447, 'loss': 14.460759172618388, 'time_step': 0.007133365631103516, 'init_value': 40.496578216552734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:49.47[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019909992218017578, 'time_algorithm_update': 0.005097087621688843, 'loss': 21.66089337706566, 'time_step': 0.007138561964035034, 'init_value': 48.261863708496094}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:49.56[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019935500621795655, 'time_algorithm_update': 0.005090677738189697, 'loss': 23.919182444691657, 'time_step': 0.00713489842414856, 'init_value': 56.283058166503906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:50.04[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019966659545898437, 'time_algorithm_update': 0.0050850648880004885, 'loss': 29.273811883926392, 'time_step': 0.007132091522216797, 'init_value': 62.26890182495117}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:50.12[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993830442428589, 'time_algorithm_update': 0.005079641103744507, 'loss': 32.729518201828, 'time_step': 0.0071234431266784665, 'init_value': 66.86670684814453}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:50.21[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970301628112793, 'time_algorithm_update': 0.0050478835105896, 'loss': 33.85705156421661, 'time_step': 0.007068148851394653, 'init_value': 72.06822967529297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:50.29[0m [[32m[1minfo     [0m] [1mFQE_20250505214905: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019893167018890383, 'time_algorithm_update': 0.005076744318008423, 'loss': 34.94169530963898, 'time_step': 0.007116718530654907, 'init_value': 74.47809600830078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 74.47809600830078
avg return on 5 trajectories of agent13: 2776.9549079999997
Episode generator created
[2m2025-05-05 21:50.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:50.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:50.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:50.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:50.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215031[0m
[2m2025-05-05 21:50.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:50.40[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019934849739074705, 'time_algorithm_update': 0.004989772319793701, 'loss': 1.4911310265213251, 'time_step': 0.007033433675765991, 'init_value': 11.280902862548828}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:50.48[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987540006637573, 'time_algorithm_update': 0.005047244310379028, 'loss': 3.8944129832088947, 'time_step': 0.007084892034530639, 'init_value': 21.611360549926758}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:50.57[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019920766353607178, 'time_algorithm_update': 0.005050366640090943, 'loss': 8.340993006587029, 'time_step': 0.00709280800819397, 'init_value': 31.701597213745117}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:51.05[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019942216873168944, 'time_algorithm_update': 0.005054463386535644, 'loss': 12.419832798123359, 'time_step': 0.007099239110946655, 'init_value': 41.232337951660156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:51.14[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019970767498016357, 'time_algorithm_update': 0.00505306077003479, 'loss': 16.007165601253508, 'time_step': 0.007100908517837524, 'init_value': 49.32972717285156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:51.22[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019944407939910887, 'time_algorithm_update': 0.005048825740814209, 'loss': 20.516614931464197, 'time_step': 0.007094034194946289, 'init_value': 57.0977897644043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:51.30[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002003307819366455, 'time_algorithm_update': 0.005063851118087768, 'loss': 27.180888768553732, 'time_step': 0.007118275880813599, 'init_value': 64.54061889648438}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:51.39[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020063214302062987, 'time_algorithm_update': 0.005067225694656372, 'loss': 28.164544122338295, 'time_step': 0.007124879837036133, 'init_value': 70.84281158447266}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:51.47[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019937169551849363, 'time_algorithm_update': 0.005062205791473389, 'loss': 30.5485811316967, 'time_step': 0.007106676816940307, 'init_value': 77.52315521240234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:51.56[0m [[32m[1minfo     [0m] [1mFQE_20250505215031: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019747040271759033, 'time_algorithm_update': 0.005036123752593994, 'loss': 34.33271676325798, 'time_step': 0.007061153888702393, 'init_value': 84.03018188476562}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 84.03018188476562
avg return on 5 trajectories of agent14: 1898.099123
Episode generator created
[2m2025-05-05 21:51.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:51.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:51.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:51.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:51.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215157[0m
[2m2025-05-05 21:51.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:52.06[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981822967529297, 'time_algorithm_update': 0.004996020078659058, 'loss': 1.4725789301395416, 'time_step': 0.007027753353118896, 'init_value': 9.896932601928711}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:52.14[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019983212947845457, 'time_algorithm_update': 0.0050832717418670655, 'loss': 4.78627758038044, 'time_step': 0.0071321241855621335, 'init_value': 19.717668533325195}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:52.22[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019827823638916015, 'time_algorithm_update': 0.005059839487075806, 'loss': 9.278716859936715, 'time_step': 0.007092790842056274, 'init_value': 29.176441192626953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:52.31[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020167908668518066, 'time_algorithm_update': 0.005142625570297241, 'loss': 14.18038349556923, 'time_step': 0.007211033582687378, 'init_value': 38.12863540649414}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:52.39[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020187044143676757, 'time_algorithm_update': 0.0051313798427581785, 'loss': 19.938277562618257, 'time_step': 0.0072019615173339845, 'init_value': 45.730953216552734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:52.48[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019810988903045655, 'time_algorithm_update': 0.00504645848274231, 'loss': 22.504850037455558, 'time_step': 0.007077714681625366, 'init_value': 52.425086975097656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:52.56[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001995028495788574, 'time_algorithm_update': 0.005066870212554931, 'loss': 26.60333534312248, 'time_step': 0.007112575054168701, 'init_value': 58.62910461425781}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:53.05[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199312949180603, 'time_algorithm_update': 0.005073411703109741, 'loss': 28.154048128843307, 'time_step': 0.007117388248443604, 'init_value': 63.55198669433594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:53.13[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988182067871094, 'time_algorithm_update': 0.005060704708099365, 'loss': 31.643655405759812, 'time_step': 0.007099771022796631, 'init_value': 67.59912109375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:53.22[0m [[32m[1minfo     [0m] [1mFQE_20250505215157: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996962070465088, 'time_algorithm_update': 0.0050733788013458255, 'loss': 32.05001343560219, 'time_step': 0.007121250867843628, 'init_value': 72.8742904663086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 72.8742904663086
avg return on 5 trajectories of agent15: 2523.1650723333332
Episode generator created
[2m2025-05-05 21:53.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:53.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:53.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:53.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:53.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215324[0m
[2m2025-05-05 21:53.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:53.32[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019721503257751466, 'time_algorithm_update': 0.00496759033203125, 'loss': 1.534281776189804, 'time_step': 0.006989395141601563, 'init_value': 10.794523239135742}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:53.40[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019934513568878173, 'time_algorithm_update': 0.005038946151733398, 'loss': 4.349453507304192, 'time_step': 0.007082786083221436, 'init_value': 21.95224380493164}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:53.49[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989567518234253, 'time_algorithm_update': 0.005046140909194946, 'loss': 9.373215178251266, 'time_step': 0.007085937738418579, 'init_value': 33.08110427856445}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:53.57[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020022172927856444, 'time_algorithm_update': 0.005046291828155518, 'loss': 13.483493777871132, 'time_step': 0.007098743438720703, 'init_value': 43.09272384643555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:54.05[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019891273975372313, 'time_algorithm_update': 0.005040542602539062, 'loss': 18.46197485303879, 'time_step': 0.007079751014709473, 'init_value': 52.22336196899414}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:54.14[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980846643447876, 'time_algorithm_update': 0.005027076721191406, 'loss': 22.0070039383173, 'time_step': 0.0070582165718078614, 'init_value': 59.0775260925293}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:54.22[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019888460636138918, 'time_algorithm_update': 0.00504056715965271, 'loss': 21.644471652150155, 'time_step': 0.0070796639919281, 'init_value': 64.92677307128906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:54.31[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019965035915374754, 'time_algorithm_update': 0.005054271221160889, 'loss': 26.170567143321037, 'time_step': 0.007101486444473267, 'init_value': 72.2526626586914}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:54.39[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019936866760253908, 'time_algorithm_update': 0.005052122831344604, 'loss': 31.54487087535858, 'time_step': 0.007096036434173584, 'init_value': 78.55915832519531}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:54.48[0m [[32m[1minfo     [0m] [1mFQE_20250505215324: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00199306058883667, 'time_algorithm_update': 0.0050548453330993654, 'loss': 29.241078288912774, 'time_step': 0.007098341941833496, 'init_value': 84.47229766845703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 84.47229766845703
avg return on 5 trajectories of agent16: 3207.395856333333
Episode generator created
[2m2025-05-05 21:54.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:54.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:54.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:54.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:54.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215450[0m
[2m2025-05-05 21:54.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:54.58[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976990222930908, 'time_algorithm_update': 0.004975292682647705, 'loss': 1.37743159173429, 'time_step': 0.0070014743804931645, 'init_value': 11.101459503173828}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:55.07[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983896017074585, 'time_algorithm_update': 0.005044943571090698, 'loss': 4.526591121196747, 'time_step': 0.007078524112701416, 'init_value': 22.414813995361328}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:55.15[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001837730407715, 'time_algorithm_update': 0.005060788631439209, 'loss': 10.305585361659526, 'time_step': 0.0071130282878875736, 'init_value': 32.02839279174805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:55.23[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019882564544677736, 'time_algorithm_update': 0.005049303293228149, 'loss': 15.18031071794033, 'time_step': 0.007087451934814453, 'init_value': 41.449951171875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:55.32[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020111637115478517, 'time_algorithm_update': 0.005102968454360962, 'loss': 19.656117873311043, 'time_step': 0.007164976119995117, 'init_value': 48.87263870239258}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:55.41[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020076165199279785, 'time_algorithm_update': 0.005093810081481934, 'loss': 23.993885045289993, 'time_step': 0.007152406215667725, 'init_value': 56.31464385986328}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:55.49[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019897620677947997, 'time_algorithm_update': 0.005057341814041137, 'loss': 30.783474247694016, 'time_step': 0.00709726881980896, 'init_value': 63.63047409057617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:55.57[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019998087882995607, 'time_algorithm_update': 0.005071922063827515, 'loss': 32.665578258275985, 'time_step': 0.007122262716293335, 'init_value': 70.04135131835938}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:56.06[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020184576511383056, 'time_algorithm_update': 0.0051009078025817875, 'loss': 33.68680629301071, 'time_step': 0.007170584201812744, 'init_value': 75.67597198486328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:56.14[0m [[32m[1minfo     [0m] [1mFQE_20250505215450: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019970734119415284, 'time_algorithm_update': 0.005073561429977417, 'loss': 36.03567724680901, 'time_step': 0.007120752334594726, 'init_value': 80.86530303955078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 80.86530303955078
avg return on 5 trajectories of agent17: 2793.5072163333334
Episode generator created
[2m2025-05-05 21:56.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:56.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:56.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:56.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:56.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215617[0m
[2m2025-05-05 21:56.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:56.25[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987285614013672, 'time_algorithm_update': 0.005005270719528198, 'loss': 1.4842209065258503, 'time_step': 0.007042584657669068, 'init_value': 10.402604103088379}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:56.33[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019331858158111572, 'time_algorithm_update': 0.004947587966918945, 'loss': 4.142663671672344, 'time_step': 0.006929177761077881, 'init_value': 20.00572395324707}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:56.41[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971089839935303, 'time_algorithm_update': 0.005005896091461182, 'loss': 8.022115702748298, 'time_step': 0.007025723695755005, 'init_value': 30.126449584960938}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:56.50[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963231325149536, 'time_algorithm_update': 0.004990698099136353, 'loss': 12.228784717559815, 'time_step': 0.007003106594085693, 'init_value': 38.6395378112793}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:56.58[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966549634933472, 'time_algorithm_update': 0.004991492986679077, 'loss': 16.58052536892891, 'time_step': 0.007007325172424316, 'init_value': 47.58418655395508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:57.06[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960667133331299, 'time_algorithm_update': 0.004990841865539551, 'loss': 18.47423816239834, 'time_step': 0.007000566720962525, 'init_value': 55.98982620239258}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:57.15[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966099739074707, 'time_algorithm_update': 0.004999192476272583, 'loss': 22.189368911981582, 'time_step': 0.00701459550857544, 'init_value': 63.73129653930664}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:57.23[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001998492479324341, 'time_algorithm_update': 0.005075140953063965, 'loss': 25.85697970867157, 'time_step': 0.0071242709159851075, 'init_value': 70.14103698730469}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:57.32[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994802474975586, 'time_algorithm_update': 0.005067605018615723, 'loss': 28.33083218348026, 'time_step': 0.007112930297851563, 'init_value': 76.83134460449219}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:57.40[0m [[32m[1minfo     [0m] [1mFQE_20250505215617: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001994009017944336, 'time_algorithm_update': 0.005078167676925659, 'loss': 30.034046666264533, 'time_step': 0.007122606992721558, 'init_value': 81.91778564453125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.91778564453125
avg return on 5 trajectories of agent18: 2694.0707773333334
Episode generator created
[2m2025-05-05 21:57.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:57.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:57.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:57.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:57.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215742[0m
[2m2025-05-05 21:57.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:57.51[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988461971282959, 'time_algorithm_update': 0.0050068900585174565, 'loss': 1.5368267618641258, 'time_step': 0.007044775009155273, 'init_value': 10.059476852416992}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:57.59[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019950380325317383, 'time_algorithm_update': 0.005077723264694214, 'loss': 4.74722184330225, 'time_step': 0.007122744798660278, 'init_value': 20.252639770507812}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:58.07[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970971345901489, 'time_algorithm_update': 0.005045181989669799, 'loss': 9.869339070796967, 'time_step': 0.0070655009746551515, 'init_value': 30.305591583251953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:58.16[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019934217929840087, 'time_algorithm_update': 0.005069693088531494, 'loss': 14.532053876399994, 'time_step': 0.007113363027572632, 'init_value': 39.08012008666992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:58.24[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200022554397583, 'time_algorithm_update': 0.005082401752471924, 'loss': 19.852860037326813, 'time_step': 0.007132937908172607, 'init_value': 48.82271194458008}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:58.33[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020008864402770994, 'time_algorithm_update': 0.005081488370895386, 'loss': 25.02082771575451, 'time_step': 0.007132863998413086, 'init_value': 56.58110427856445}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:58.41[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019964480400085447, 'time_algorithm_update': 0.005059929370880127, 'loss': 27.823266174674036, 'time_step': 0.00710677695274353, 'init_value': 62.94031524658203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:58.50[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019969217777252198, 'time_algorithm_update': 0.005066657543182373, 'loss': 31.264956611633302, 'time_step': 0.007113656759262085, 'init_value': 69.02741241455078}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:58.58[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919993877410887, 'time_algorithm_update': 0.005077963829040528, 'loss': 30.071114768505097, 'time_step': 0.007120652437210083, 'init_value': 73.65156555175781}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:59.06[0m [[32m[1minfo     [0m] [1mFQE_20250505215742: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997251510620117, 'time_algorithm_update': 0.005070345401763916, 'loss': 35.5208580622673, 'time_step': 0.00711776614189148, 'init_value': 77.72222137451172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.72222137451172
avg return on 5 trajectories of agent19: 2669.9560100000003
Episode generator created
[2m2025-05-05 21:59.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:59.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:59.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:59.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:59.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215909[0m
[2m2025-05-05 21:59.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:59.17[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198410964012146, 'time_algorithm_update': 0.005010480642318725, 'loss': 1.4756546005308628, 'time_step': 0.007044148921966553, 'init_value': 10.86304759979248}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:59.25[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019880287647247316, 'time_algorithm_update': 0.005069609880447388, 'loss': 4.107196098268032, 'time_step': 0.007107887029647827, 'init_value': 21.294410705566406}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:59.34[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010219097137451, 'time_algorithm_update': 0.005108322858810425, 'loss': 7.651734668254853, 'time_step': 0.007169275760650635, 'init_value': 31.48858642578125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:59.43[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030177354812622, 'time_algorithm_update': 0.005150063991546631, 'loss': 12.890216812491417, 'time_step': 0.007232067346572876, 'init_value': 40.559329986572266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:59.51[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020272614955902097, 'time_algorithm_update': 0.005142684936523438, 'loss': 17.755752395391465, 'time_step': 0.007221693515777588, 'init_value': 50.075992584228516}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:59.59[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020132410526275636, 'time_algorithm_update': 0.0051096978187561036, 'loss': 21.039693917155265, 'time_step': 0.0071735365390777584, 'init_value': 58.326927185058594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:00.08[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019870872497558595, 'time_algorithm_update': 0.005062495231628418, 'loss': 25.005767228245734, 'time_step': 0.007099910020828247, 'init_value': 65.0457992553711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:00.16[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989121437072754, 'time_algorithm_update': 0.00508459210395813, 'loss': 30.578334508419037, 'time_step': 0.007124471187591553, 'init_value': 71.44755554199219}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:00.25[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019879631996154784, 'time_algorithm_update': 0.00506589412689209, 'loss': 27.504710498571395, 'time_step': 0.007104405879974365, 'init_value': 76.64058685302734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:00.33[0m [[32m[1minfo     [0m] [1mFQE_20250505215909: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001979429006576538, 'time_algorithm_update': 0.005063822507858276, 'loss': 32.39987978386879, 'time_step': 0.007093398809432983, 'init_value': 81.67261505126953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 81.67261505126953
ave advantage rew: 79.68771820068359, std: 3.5827369936451805
avg cum rews: 2636.5227505833336, std: 430.54386290999565
Pearson correlation coefficient: -0.060925029257578305
Spearman correlation coefficient: -0.23458646616541354
Kendall Tau correlation coefficient: -0.17894736842105263
the best agent: 8, best agent cum rewards: 2533.601087
1966
---------------------------------
Searching empty space policies
(10, 5708)
(20, 5708)
(20, 5708)
Average distance of agents to nearest neighbors: 0.017404666460336164
avg return on 5 trajectories of agent0: 3356.3216376666664
Episode generator created
[2m2025-05-05 22:00.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:00.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:00.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:00.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:00.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220046[0m
[2m2025-05-05 22:00.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:00.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019770870208740236, 'time_algorithm_update': 0.004988039493560791, 'loss': 1.4470096266120671, 'time_step': 0.007014771699905395, 'init_value': 10.518048286437988}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:01.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021902396678924563, 'time_algorithm_update': 0.0050236561298370366, 'loss': 4.589093752294779, 'time_step': 0.007264495372772217, 'init_value': 20.682893753051758}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:01.11[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997035026550293, 'time_algorithm_update': 0.005039298772811889, 'loss': 8.48741907709837, 'time_step': 0.0070873558521270755, 'init_value': 30.15938949584961}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:01.19[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010019063949585, 'time_algorithm_update': 0.005043391704559326, 'loss': 12.119445675194264, 'time_step': 0.007104700565338135, 'init_value': 40.05207061767578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:01.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019940385818481444, 'time_algorithm_update': 0.005046571969985962, 'loss': 17.640726353287697, 'time_step': 0.007091219186782837, 'init_value': 47.75209045410156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:01.36[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019820828437805177, 'time_algorithm_update': 0.00501981520652771, 'loss': 22.848646992087364, 'time_step': 0.007051926851272583, 'init_value': 55.78834915161133}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:01.44[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020024688243865966, 'time_algorithm_update': 0.005061757326126098, 'loss': 23.943769925117493, 'time_step': 0.00711518931388855, 'init_value': 63.273292541503906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:01.53[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019947376251220703, 'time_algorithm_update': 0.005056512117385864, 'loss': 27.04431960439682, 'time_step': 0.007102223634719848, 'init_value': 69.3631362915039}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:02.01[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999173879623413, 'time_algorithm_update': 0.0050645885467529295, 'loss': 31.09891176891327, 'time_step': 0.00711525559425354, 'init_value': 76.1176528930664}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:02.10[0m [[32m[1minfo     [0m] [1mFQE_20250505220046: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020029547214508057, 'time_algorithm_update': 0.005058916568756103, 'loss': 31.805949055910112, 'time_step': 0.007113153219223022, 'init_value': 79.72977447509766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 79.72977447509766
avg return on 5 trajectories of agent1: 2975.8017336666667
Episode generator created
[2m2025-05-05 22:02.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:02.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:02.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:02.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:02.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220212[0m
[2m2025-05-05 22:02.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:02.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989919662475586, 'time_algorithm_update': 0.005005418062210083, 'loss': 1.4307224659621716, 'time_step': 0.007045518636703491, 'init_value': 10.672391891479492}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:02.29[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00198724627494812, 'time_algorithm_update': 0.005054314374923706, 'loss': 4.225228982567788, 'time_step': 0.007092242956161499, 'init_value': 21.077299118041992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:02.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019961535930633546, 'time_algorithm_update': 0.005072364330291748, 'loss': 8.539095340549945, 'time_step': 0.007119657754898071, 'init_value': 31.399005889892578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:02.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997013807296753, 'time_algorithm_update': 0.005072203636169434, 'loss': 13.120709712982178, 'time_step': 0.007120021343231201, 'init_value': 39.876766204833984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:02.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019919815063476564, 'time_algorithm_update': 0.005056095838546753, 'loss': 18.853599870562554, 'time_step': 0.007098833322525025, 'init_value': 49.27622604370117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:03.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019949054718017578, 'time_algorithm_update': 0.005075047492980957, 'loss': 21.042915600061416, 'time_step': 0.007120904922485352, 'init_value': 59.65115737915039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:03.11[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020176849365234374, 'time_algorithm_update': 0.005128922224044799, 'loss': 26.814791714668274, 'time_step': 0.007198298215866089, 'init_value': 67.90079498291016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:03.20[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020128047466278077, 'time_algorithm_update': 0.005104142427444458, 'loss': 30.69280552792549, 'time_step': 0.007168468236923218, 'init_value': 73.7479476928711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:03.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019870872497558595, 'time_algorithm_update': 0.005056022882461548, 'loss': 35.28128036403656, 'time_step': 0.007093829870223999, 'init_value': 80.23304748535156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:03.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220212: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001993889093399048, 'time_algorithm_update': 0.005068838834762573, 'loss': 35.21551185584068, 'time_step': 0.0071137771606445315, 'init_value': 85.62381744384766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 85.62381744384766
avg return on 5 trajectories of agent2: 2556.8948063333332
Episode generator created
[2m2025-05-05 22:03.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:03.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:03.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:03.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:03.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220339[0m
[2m2025-05-05 22:03.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:03.47[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019814114570617675, 'time_algorithm_update': 0.00500811219215393, 'loss': 1.432183741658926, 'time_step': 0.00703925895690918, 'init_value': 10.05423641204834}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:03.55[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019857084751129152, 'time_algorithm_update': 0.005060491800308228, 'loss': 4.179674806267023, 'time_step': 0.007096435308456421, 'init_value': 19.96656036376953}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:04.04[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020051560401916505, 'time_algorithm_update': 0.0050827527046203615, 'loss': 8.975159794330597, 'time_step': 0.00713866376876831, 'init_value': 29.8001708984375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:04.12[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019911384582519532, 'time_algorithm_update': 0.005071367502212524, 'loss': 14.06281480294466, 'time_step': 0.007112895488739014, 'init_value': 38.686431884765625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:04.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019931044578552245, 'time_algorithm_update': 0.005074903249740601, 'loss': 19.857793759465217, 'time_step': 0.007118904590606689, 'init_value': 47.842018127441406}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:04.29[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001992882013320923, 'time_algorithm_update': 0.005073323726654053, 'loss': 21.59279440009594, 'time_step': 0.0071172618865966795, 'init_value': 55.821659088134766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:04.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020043556690216065, 'time_algorithm_update': 0.00506851601600647, 'loss': 27.038396336317064, 'time_step': 0.007124351739883423, 'init_value': 60.53480911254883}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:04.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019818551540374757, 'time_algorithm_update': 0.005048359155654907, 'loss': 30.882810626268387, 'time_step': 0.007080362796783447, 'init_value': 67.38107299804688}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:04.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019885666370391846, 'time_algorithm_update': 0.0050665240287780765, 'loss': 34.47793035209179, 'time_step': 0.007105818033218384, 'init_value': 73.16277313232422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:05.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220339: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997869968414307, 'time_algorithm_update': 0.00508156967163086, 'loss': 36.672415289282796, 'time_step': 0.0071305053234100345, 'init_value': 76.35877990722656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.35877990722656
avg return on 5 trajectories of agent3: 1724.3878833333335
Episode generator created
[2m2025-05-05 22:05.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:05.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:05.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:05.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:05.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220504[0m
[2m2025-05-05 22:05.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:05.13[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019799456596374513, 'time_algorithm_update': 0.004985119104385376, 'loss': 1.443499020859599, 'time_step': 0.007015169382095337, 'init_value': 9.888071060180664}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019949944019317625, 'time_algorithm_update': 0.005052285671234131, 'loss': 4.6977678170204165, 'time_step': 0.007098401069641113, 'init_value': 19.4744873046875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:05.29[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019904553890228273, 'time_algorithm_update': 0.005063880205154419, 'loss': 9.894315309166908, 'time_step': 0.007104511022567749, 'init_value': 29.044166564941406}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:05.38[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019813196659088134, 'time_algorithm_update': 0.005059352874755859, 'loss': 14.083086670517922, 'time_step': 0.007090639352798462, 'init_value': 37.00632858276367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:05.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019947752952575682, 'time_algorithm_update': 0.005048428535461426, 'loss': 21.178114981293678, 'time_step': 0.007093746900558471, 'init_value': 45.34976577758789}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:05.55[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020037198066711424, 'time_algorithm_update': 0.005061097145080566, 'loss': 24.87394769847393, 'time_step': 0.00711597990989685, 'init_value': 53.076961517333984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:06.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004513740539551, 'time_algorithm_update': 0.005076323986053467, 'loss': 31.350414754152297, 'time_step': 0.007132018089294433, 'init_value': 58.828269958496094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:06.12[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020028741359710694, 'time_algorithm_update': 0.005064515352249145, 'loss': 32.201348903179166, 'time_step': 0.007118550539016724, 'init_value': 65.04518127441406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:06.20[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019875862598419188, 'time_algorithm_update': 0.005028442144393921, 'loss': 38.092608931303026, 'time_step': 0.007066339492797852, 'init_value': 70.38047790527344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:06.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220504: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001996785879135132, 'time_algorithm_update': 0.005061497449874878, 'loss': 42.543049506664275, 'time_step': 0.0071091272830963136, 'init_value': 76.18303680419922}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 76.18303680419922
avg return on 5 trajectories of agent4: 2803.794013666667
Episode generator created
[2m2025-05-05 22:06.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:06.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:06.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:06.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:06.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220631[0m
[2m2025-05-05 22:06.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:06.39[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019984097480773926, 'time_algorithm_update': 0.005028400659561157, 'loss': 1.4354596532434225, 'time_step': 0.007077194929122925, 'init_value': 10.374812126159668}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:06.47[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967458486557007, 'time_algorithm_update': 0.005003242969512939, 'loss': 3.9422667089402674, 'time_step': 0.007020378112792968, 'init_value': 20.818689346313477}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:06.55[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019671306610107423, 'time_algorithm_update': 0.004983120441436768, 'loss': 8.67731495219469, 'time_step': 0.0069997115135192875, 'init_value': 31.524612426757812}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:07.04[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019660110473632814, 'time_algorithm_update': 0.004993158340454102, 'loss': 12.876828013002873, 'time_step': 0.007008790016174316, 'init_value': 41.740047454833984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:07.12[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963383197784424, 'time_algorithm_update': 0.004994370698928833, 'loss': 18.43734548699856, 'time_step': 0.007007093906402588, 'init_value': 51.90193176269531}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:07.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965928792953491, 'time_algorithm_update': 0.005003173112869263, 'loss': 24.156766541361808, 'time_step': 0.007018975019454956, 'init_value': 58.929447174072266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:07.29[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019769015312194826, 'time_algorithm_update': 0.005036641359329224, 'loss': 29.31036581015587, 'time_step': 0.007064013242721557, 'init_value': 67.33731079101562}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:07.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019916007518768312, 'time_algorithm_update': 0.005081474781036377, 'loss': 29.209225105166436, 'time_step': 0.00712370753288269, 'init_value': 74.84857940673828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:07.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997565031051636, 'time_algorithm_update': 0.005083152770996094, 'loss': 32.5440843873024, 'time_step': 0.007131618022918701, 'init_value': 80.49972534179688}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:07.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220631: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019812581539154052, 'time_algorithm_update': 0.005048970699310303, 'loss': 31.21771901202202, 'time_step': 0.00708035397529602, 'init_value': 86.14801788330078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 86.14801788330078
avg return on 5 trajectories of agent5: 2662.0048673333336
Episode generator created
[2m2025-05-05 22:07.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:07.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:07.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:07.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:07.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220756[0m
[2m2025-05-05 22:07.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:08.05[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019819583892822265, 'time_algorithm_update': 0.005005338191986084, 'loss': 1.3832560182064773, 'time_step': 0.007037556648254394, 'init_value': 9.904415130615234}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:08.13[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001989828586578369, 'time_algorithm_update': 0.005080826759338379, 'loss': 4.2361915737688545, 'time_step': 0.007121502637863159, 'init_value': 19.54448890686035}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:08.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019800353050231936, 'time_algorithm_update': 0.005069110155105591, 'loss': 7.32468126386404, 'time_step': 0.0070997030735015865, 'init_value': 27.93338394165039}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:08.30[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019878761768341064, 'time_algorithm_update': 0.005078161001205444, 'loss': 11.96420468068123, 'time_step': 0.007116528272628785, 'init_value': 35.75325393676758}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:08.38[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001988417387008667, 'time_algorithm_update': 0.005069681882858276, 'loss': 14.906497159719468, 'time_step': 0.007108433485031128, 'init_value': 44.237937927246094}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:08.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001851057529449463, 'time_algorithm_update': 0.004738492012023926, 'loss': 18.842380392193796, 'time_step': 0.006634786128997803, 'init_value': 52.00347900390625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:08.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018463432788848877, 'time_algorithm_update': 0.004725752115249634, 'loss': 22.292014236092566, 'time_step': 0.00661626935005188, 'init_value': 58.7160530090332}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:09.02[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018497142791748047, 'time_algorithm_update': 0.004742045402526856, 'loss': 24.568651463866235, 'time_step': 0.006636939287185669, 'init_value': 64.43605041503906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:09.10[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018519887924194336, 'time_algorithm_update': 0.00473539400100708, 'loss': 30.316131906509398, 'time_step': 0.006632568359375, 'init_value': 69.96595001220703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:09.18[0m [[32m[1minfo     [0m] [1mFQE_20250505220756: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018492166996002197, 'time_algorithm_update': 0.004736578941345214, 'loss': 31.663732245445253, 'time_step': 0.0066308057308197025, 'init_value': 77.47663116455078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.47663116455078
avg return on 5 trajectories of agent6: 2424.643298666667
Episode generator created
[2m2025-05-05 22:09.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:09.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:09.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:09.20[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:09.20[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:09.27[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018434250354766846, 'time_algorithm_update': 0.004635553359985351, 'loss': 1.4725521653592586, 'time_step': 0.006522707462310791, 'init_value': 10.155359268188477}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:09.35[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018198187351226806, 'time_algorithm_update': 0.004634778976440429, 'loss': 4.296017877519131, 'time_step': 0.006496611356735229, 'init_value': 20.459205627441406}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:09.43[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017863173484802247, 'time_algorithm_update': 0.0045544102191925045, 'loss': 8.710540897130967, 'time_step': 0.00638065791130066, 'init_value': 30.080482482910156}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:09.50[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017856447696685792, 'time_algorithm_update': 0.004541302680969238, 'loss': 14.548842371940612, 'time_step': 0.006366922616958618, 'init_value': 40.095787048339844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:09.58[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017823238372802735, 'time_algorithm_update': 0.0045455341339111326, 'loss': 20.89459880697727, 'time_step': 0.006367463350296021, 'init_value': 47.363372802734375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:10.06[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00179109787940979, 'time_algorithm_update': 0.004555084228515625, 'loss': 22.40348859989643, 'time_step': 0.006386674880981445, 'init_value': 53.667633056640625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:10.13[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017950150966644287, 'time_algorithm_update': 0.004558771848678589, 'loss': 27.479935871005058, 'time_step': 0.00639503264427185, 'init_value': 60.10242462158203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:10.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017484760284423829, 'time_algorithm_update': 0.004410761594772339, 'loss': 31.81056578016281, 'time_step': 0.00619614839553833, 'init_value': 65.9576416015625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:10.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001710555076599121, 'time_algorithm_update': 0.004304049015045166, 'loss': 31.032688476324083, 'time_step': 0.006049480438232422, 'init_value': 71.21602630615234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:10.35[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0017143900394439697, 'time_algorithm_update': 0.0043201944828033445, 'loss': 35.22356464457512, 'time_step': 0.006069792747497559, 'init_value': 77.15288543701172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 77.15288543701172
avg return on 5 trajectories of agent7: 3328.4622533333336
Episode generator created
[2m2025-05-05 22:10.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:10.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m6[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:10.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:10.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:10.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505221037[0m
[2m2025-05-05 22:10.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [17], 'action_size': 6, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
