No devices were found
---------------------------------
Environment created
Box(-1.0, 1.0, (8,), float32) Box(-inf, inf, (105,), float64)
Loading Initial saved model
Model loaded
Loading replay buffer
Replay buffer loaded
Replay buffer shape:  (100000, 105) (100000, 8) (100000, 1) (100000, 1)
Starting evaluation
1953
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.01687846629133075
avg return on 5 trajectories of agent0: 947.7010389999999
Episode generator created
[2m2025-05-05 15:41.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:41.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:41.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:41.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:41.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154132[0m
[2m2025-05-05 15:41.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:41.40[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019319570064544678, 'time_algorithm_update': 0.005218427658081054, 'loss': 1.7283182612210513, 'time_step': 0.00719856071472168, 'init_value': 3.5961220264434814}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:41.49[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019442455768585204, 'time_algorithm_update': 0.005210123300552368, 'loss': 3.999720262169838, 'time_step': 0.0072032341957092285, 'init_value': 8.037761688232422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:41.58[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019411916732788087, 'time_algorithm_update': 0.00521579384803772, 'loss': 4.679858110785484, 'time_step': 0.007205757617950439, 'init_value': 14.682650566101074}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:42.06[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019562366008758544, 'time_algorithm_update': 0.005243821144104004, 'loss': 5.167224268436432, 'time_step': 0.007248689174652099, 'init_value': 20.469694137573242}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:42.15[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019521946907043457, 'time_algorithm_update': 0.005226922035217285, 'loss': 5.706389422178268, 'time_step': 0.007227704048156738, 'init_value': 26.662921905517578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:42.24[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001949362277984619, 'time_algorithm_update': 0.005213377237319947, 'loss': 6.091411009311676, 'time_step': 0.007212088584899902, 'init_value': 33.15370178222656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:42.32[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019398083686828613, 'time_algorithm_update': 0.005204576015472412, 'loss': 6.704789409160614, 'time_step': 0.007192822694778442, 'init_value': 37.70800018310547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:42.41[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019503242969512939, 'time_algorithm_update': 0.005224831342697143, 'loss': 7.415177654027939, 'time_step': 0.007224145650863647, 'init_value': 42.47203063964844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:42.50[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019519567489624024, 'time_algorithm_update': 0.005220468044281006, 'loss': 7.98510121846199, 'time_step': 0.007221279859542846, 'init_value': 49.45247268676758}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:42.58[0m [[32m[1minfo     [0m] [1mFQE_20250505154132: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019488050937652589, 'time_algorithm_update': 0.0052286674976348875, 'loss': 9.054274036169051, 'time_step': 0.007226067543029785, 'init_value': 53.91625213623047}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.91625213623047
avg return on 5 trajectories of agent1: 975.1428523333334
Episode generator created
[2m2025-05-05 15:43.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:43.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:43.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:43.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:43.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154302[0m
[2m2025-05-05 15:43.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:43.10[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019333302974700929, 'time_algorithm_update': 0.005227010011672974, 'loss': 1.6748306498378516, 'time_step': 0.0072080731391906735, 'init_value': 3.2534031867980957}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:43.19[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001943239450454712, 'time_algorithm_update': 0.00522950291633606, 'loss': 4.147224175453186, 'time_step': 0.007220918178558349, 'init_value': 8.756994247436523}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:43.28[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019442534446716309, 'time_algorithm_update': 0.0052388134002685546, 'loss': 4.8860704543590545, 'time_step': 0.007231446981430053, 'init_value': 15.204241752624512}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:43.36[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001944622039794922, 'time_algorithm_update': 0.005220094680786133, 'loss': 5.469811333179474, 'time_step': 0.007212704658508301, 'init_value': 21.16629981994629}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:43.45[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001947824239730835, 'time_algorithm_update': 0.005223111867904663, 'loss': 5.9654434909820555, 'time_step': 0.0072187881469726566, 'init_value': 28.64023780822754}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:43.54[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019357357025146485, 'time_algorithm_update': 0.005225512981414795, 'loss': 6.318013029336929, 'time_step': 0.007209366798400879, 'init_value': 33.68141174316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:44.02[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019455978870391846, 'time_algorithm_update': 0.005231906175613404, 'loss': 6.631720989227295, 'time_step': 0.0072259347438812255, 'init_value': 39.81889724731445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:44.11[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019805591106414793, 'time_algorithm_update': 0.005306117773056031, 'loss': 7.399412977933884, 'time_step': 0.0073365478515625, 'init_value': 44.12474060058594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:44.20[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019405455589294434, 'time_algorithm_update': 0.005225430250167847, 'loss': 8.846204686403274, 'time_step': 0.007214048147201538, 'init_value': 47.465667724609375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:44.28[0m [[32m[1minfo     [0m] [1mFQE_20250505154302: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019497010707855225, 'time_algorithm_update': 0.005233289003372193, 'loss': 8.750618816852569, 'time_step': 0.0072318165302276615, 'init_value': 52.044395446777344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.044395446777344
avg return on 5 trajectories of agent2: 998.0943026666667
Episode generator created
[2m2025-05-05 15:44.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:44.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:44.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:44.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:44.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154432[0m
[2m2025-05-05 15:44.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:44.40[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019292314052581788, 'time_algorithm_update': 0.005201208591461182, 'loss': 1.5557017291337252, 'time_step': 0.007178019762039184, 'init_value': 3.161956310272217}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:44.49[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019368789196014405, 'time_algorithm_update': 0.005222588062286377, 'loss': 3.4830516291856766, 'time_step': 0.0072073922157287595, 'init_value': 8.09957504272461}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:44.58[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019464302062988281, 'time_algorithm_update': 0.005251574993133545, 'loss': 4.371626657843589, 'time_step': 0.0072471764087677, 'init_value': 13.273882865905762}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:45.06[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001945676565170288, 'time_algorithm_update': 0.00524894642829895, 'loss': 4.659399445533753, 'time_step': 0.007242984294891357, 'init_value': 19.095014572143555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:45.15[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019379873275756835, 'time_algorithm_update': 0.005226448774337768, 'loss': 5.333985169410705, 'time_step': 0.007212592363357544, 'init_value': 25.573518753051758}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:45.24[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019455101490020751, 'time_algorithm_update': 0.005250245571136475, 'loss': 5.764625289201737, 'time_step': 0.0072442786693572995, 'init_value': 31.862255096435547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:45.32[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019517498016357422, 'time_algorithm_update': 0.00525758171081543, 'loss': 6.198752394914627, 'time_step': 0.007257771492004394, 'init_value': 37.67180633544922}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:45.41[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001943537950515747, 'time_algorithm_update': 0.005243524789810181, 'loss': 7.431359010219574, 'time_step': 0.007235485076904297, 'init_value': 42.413795471191406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:45.50[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019385221004486084, 'time_algorithm_update': 0.005239658355712891, 'loss': 8.110230928897858, 'time_step': 0.007226441144943237, 'init_value': 47.65018844604492}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:45.58[0m [[32m[1minfo     [0m] [1mFQE_20250505154432: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019454400539398193, 'time_algorithm_update': 0.005238328695297241, 'loss': 9.143852729558946, 'time_step': 0.007232168674468994, 'init_value': 52.289974212646484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.289974212646484
avg return on 5 trajectories of agent3: 961.0815980000001
Episode generator created
[2m2025-05-05 15:46.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:46.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:46.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:46.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:46.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154602[0m
[2m2025-05-05 15:46.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:46.10[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001935887336730957, 'time_algorithm_update': 0.0052008144855499264, 'loss': 1.6517090756595134, 'time_step': 0.0071842877864837645, 'init_value': 3.6761577129364014}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:46.19[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019375298023223877, 'time_algorithm_update': 0.005222458600997925, 'loss': 3.9043477149009704, 'time_step': 0.007208185911178589, 'init_value': 8.822800636291504}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:46.28[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001948415994644165, 'time_algorithm_update': 0.005243647813796997, 'loss': 4.612385898947716, 'time_step': 0.007240634202957153, 'init_value': 14.63503646850586}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:46.36[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019369945526123047, 'time_algorithm_update': 0.0052246031761169435, 'loss': 5.351596678495407, 'time_step': 0.007209513664245605, 'init_value': 21.328889846801758}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:46.45[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019472267627716065, 'time_algorithm_update': 0.005228415727615356, 'loss': 5.5671680419445035, 'time_step': 0.0072243320941925045, 'init_value': 27.276058197021484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:46.54[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019426195621490478, 'time_algorithm_update': 0.005221211194992066, 'loss': 6.296728847503662, 'time_step': 0.0072120044231414795, 'init_value': 34.57276153564453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:47.03[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001999828100204468, 'time_algorithm_update': 0.005413466453552246, 'loss': 7.046425472021103, 'time_step': 0.007463435888290406, 'init_value': 38.97412109375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:47.12[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205906343460083, 'time_algorithm_update': 0.005545006513595581, 'loss': 7.388320471763611, 'time_step': 0.007656342267990112, 'init_value': 45.314395904541016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:47.21[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002030292272567749, 'time_algorithm_update': 0.005441639423370361, 'loss': 8.69618992114067, 'time_step': 0.0075226686000823976, 'init_value': 49.51041793823242}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:47.30[0m [[32m[1minfo     [0m] [1mFQE_20250505154602: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022949457168579, 'time_algorithm_update': 0.005436191558837891, 'loss': 9.179167271614075, 'time_step': 0.007509776830673218, 'init_value': 52.83743667602539}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.83743667602539
avg return on 5 trajectories of agent4: 943.4953333333333
Episode generator created
[2m2025-05-05 15:47.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:47.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:47.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:47.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:47.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154733[0m
[2m2025-05-05 15:47.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:47.42[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200768518447876, 'time_algorithm_update': 0.0054070670604705814, 'loss': 1.6712018440961838, 'time_step': 0.007464601039886475, 'init_value': 3.852332592010498}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:47.51[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013806104660034, 'time_algorithm_update': 0.005419061660766601, 'loss': 4.177824916362763, 'time_step': 0.0074832684993743894, 'init_value': 9.401585578918457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:48.00[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020197887420654297, 'time_algorithm_update': 0.0054319117069244385, 'loss': 4.694527737259865, 'time_step': 0.007501878976821899, 'init_value': 15.336580276489258}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:48.09[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020187363624572753, 'time_algorithm_update': 0.005428711891174317, 'loss': 5.361095848321915, 'time_step': 0.007497599363327026, 'init_value': 21.839126586914062}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:48.18[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014765739440918, 'time_algorithm_update': 0.0054357006549835205, 'loss': 5.510669122934342, 'time_step': 0.007501150131225586, 'init_value': 27.50064468383789}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:48.27[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018836736679077, 'time_algorithm_update': 0.005419460773468018, 'loss': 6.116414535999298, 'time_step': 0.00748884892463684, 'init_value': 33.21488952636719}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:48.36[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002024494171142578, 'time_algorithm_update': 0.005432073831558228, 'loss': 6.3354161920547485, 'time_step': 0.007507061958312989, 'init_value': 38.565860748291016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:48.45[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020186824798583986, 'time_algorithm_update': 0.005417253017425537, 'loss': 7.420884367227554, 'time_step': 0.007486538410186767, 'init_value': 43.729270935058594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:48.54[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020200517177581786, 'time_algorithm_update': 0.0054250168800354, 'loss': 8.10839178442955, 'time_step': 0.0074956693649292, 'init_value': 45.868743896484375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:49.03[0m [[32m[1minfo     [0m] [1mFQE_20250505154733: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020248770713806154, 'time_algorithm_update': 0.005440753698348999, 'loss': 8.50842830491066, 'time_step': 0.007516582012176514, 'init_value': 51.62215042114258}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.62215042114258
avg return on 5 trajectories of agent5: 907.678397
Episode generator created
[2m2025-05-05 15:49.06[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:49.06[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:49.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:49.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:49.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505154906[0m
[2m2025-05-05 15:49.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:49.15[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020169689655303957, 'time_algorithm_update': 0.005424546957015991, 'loss': 1.6112087332457303, 'time_step': 0.007491530418395996, 'init_value': 3.9644343852996826}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:49.24[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020194110870361327, 'time_algorithm_update': 0.005447202920913696, 'loss': 3.804218255996704, 'time_step': 0.00751726508140564, 'init_value': 8.437349319458008}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:49.33[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203039026260376, 'time_algorithm_update': 0.005446861505508423, 'loss': 4.455730993747711, 'time_step': 0.007527885437011719, 'init_value': 14.040716171264648}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:49.42[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029866695404053, 'time_algorithm_update': 0.005449345111846924, 'loss': 5.006033917665482, 'time_step': 0.007530224084854126, 'init_value': 20.00094223022461}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:49.51[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031569004058838, 'time_algorithm_update': 0.00543718433380127, 'loss': 5.411430797338486, 'time_step': 0.007519759178161621, 'init_value': 27.787099838256836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:50.00[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029223918914795, 'time_algorithm_update': 0.005435302972793579, 'loss': 6.258836281538009, 'time_step': 0.007515292644500732, 'init_value': 34.016624450683594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:50.09[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020180699825286864, 'time_algorithm_update': 0.005424689769744873, 'loss': 6.812863765001297, 'time_step': 0.007493079900741577, 'init_value': 40.537864685058594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:50.18[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019848735332489015, 'time_algorithm_update': 0.005326729297637939, 'loss': 7.862260762929917, 'time_step': 0.007360592126846314, 'init_value': 47.31163024902344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:50.27[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020060105323791502, 'time_algorithm_update': 0.005365720748901367, 'loss': 8.788231559515, 'time_step': 0.007421833276748657, 'init_value': 51.42347717285156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:50.36[0m [[32m[1minfo     [0m] [1mFQE_20250505154906: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020029218196868895, 'time_algorithm_update': 0.005357801675796509, 'loss': 9.83650093793869, 'time_step': 0.0074106562137603756, 'init_value': 54.67350769042969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.67350769042969
avg return on 5 trajectories of agent6: 960.5974686666667
Episode generator created
[2m2025-05-05 15:50.39[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:50.39[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:50.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:50.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:50.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155039[0m
[2m2025-05-05 15:50.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:50.48[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019831554889678956, 'time_algorithm_update': 0.005335457563400268, 'loss': 1.6629337921738625, 'time_step': 0.007367585182189941, 'init_value': 3.4454879760742188}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:50.57[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019964098930358885, 'time_algorithm_update': 0.00535885763168335, 'loss': 4.04024669444561, 'time_step': 0.007404698133468628, 'init_value': 7.41119909286499}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:51.06[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058783292770386, 'time_algorithm_update': 0.005528313636779785, 'loss': 4.687812582015991, 'time_step': 0.007639284133911133, 'init_value': 13.006852149963379}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:51.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020504765510559082, 'time_algorithm_update': 0.00551704478263855, 'loss': 4.922892447710037, 'time_step': 0.007620161294937134, 'init_value': 17.72601890563965}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:51.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020263760089874266, 'time_algorithm_update': 0.0054510002136230465, 'loss': 5.272630509376526, 'time_step': 0.007528514385223389, 'init_value': 23.827316284179688}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:51.33[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020220904350280763, 'time_algorithm_update': 0.005439512014389038, 'loss': 5.59355724477768, 'time_step': 0.007512229681015015, 'init_value': 30.912878036499023}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:51.42[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019644227027893067, 'time_algorithm_update': 0.005213830709457397, 'loss': 6.52956384062767, 'time_step': 0.007227235317230225, 'init_value': 36.21168518066406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:51.50[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019578258991241456, 'time_algorithm_update': 0.005218127489089966, 'loss': 7.798745405197144, 'time_step': 0.0072249178886413575, 'init_value': 44.69314956665039}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:51.59[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955796718597412, 'time_algorithm_update': 0.005218568086624145, 'loss': 8.524714218378067, 'time_step': 0.00722378396987915, 'init_value': 51.16838455200195}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:52.08[0m [[32m[1minfo     [0m] [1mFQE_20250505155039: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963238000869751, 'time_algorithm_update': 0.0052169663906097416, 'loss': 10.250915153265, 'time_step': 0.00722918701171875, 'init_value': 54.768856048583984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.768856048583984
avg return on 5 trajectories of agent7: 979.5109096666666
Episode generator created
[2m2025-05-05 15:52.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:52.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:52.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:52.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:52.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155211[0m
[2m2025-05-05 15:52.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:52.19[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019415769577026368, 'time_algorithm_update': 0.005181046962738037, 'loss': 1.6716904340833425, 'time_step': 0.007171130180358887, 'init_value': 3.4825265407562256}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:52.28[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019484996795654298, 'time_algorithm_update': 0.005200706005096436, 'loss': 4.010458826899528, 'time_step': 0.007198624610900879, 'init_value': 8.698346138000488}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:52.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00194870924949646, 'time_algorithm_update': 0.005206518411636353, 'loss': 4.692790686607361, 'time_step': 0.0072043538093566895, 'init_value': 14.995553016662598}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:52.45[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019481606483459472, 'time_algorithm_update': 0.005208408117294312, 'loss': 5.137511652708054, 'time_step': 0.007205410718917847, 'init_value': 20.863571166992188}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:52.54[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001940433979034424, 'time_algorithm_update': 0.005187243700027466, 'loss': 5.342417182922364, 'time_step': 0.00717629075050354, 'init_value': 25.064062118530273}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:53.03[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019565830230712893, 'time_algorithm_update': 0.005211385011672974, 'loss': 5.64472429895401, 'time_step': 0.007217113494873047, 'init_value': 30.837020874023438}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:53.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957983493804932, 'time_algorithm_update': 0.005207469940185547, 'loss': 6.689362389326096, 'time_step': 0.007214533090591431, 'init_value': 37.44084548950195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:53.20[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955530881881714, 'time_algorithm_update': 0.005206652879714966, 'loss': 8.447337543964386, 'time_step': 0.007210931062698364, 'init_value': 45.308231353759766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:53.29[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019655408859252928, 'time_algorithm_update': 0.005219472646713257, 'loss': 9.08298897767067, 'time_step': 0.0072345705032348636, 'init_value': 50.77559280395508}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:53.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155211: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956531286239624, 'time_algorithm_update': 0.005214623689651489, 'loss': 9.72234250831604, 'time_step': 0.007220247268676758, 'init_value': 56.507266998291016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.507266998291016
avg return on 5 trajectories of agent8: 945.7594453333332
Episode generator created
[2m2025-05-05 15:53.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:53.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:53.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:53.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:53.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155341[0m
[2m2025-05-05 15:53.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:53.49[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019510564804077148, 'time_algorithm_update': 0.005190546751022339, 'loss': 1.6360889591425658, 'time_step': 0.007190222978591919, 'init_value': 3.628352403640747}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:53.58[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956132411956787, 'time_algorithm_update': 0.005198121786117554, 'loss': 3.834397310137749, 'time_step': 0.00720301079750061, 'init_value': 7.629601001739502}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:54.07[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960554838180542, 'time_algorithm_update': 0.005231346368789673, 'loss': 4.458736168384552, 'time_step': 0.007240837574005127, 'init_value': 13.19827938079834}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:54.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019524669647216796, 'time_algorithm_update': 0.0051975870132446285, 'loss': 5.172432077169418, 'time_step': 0.0071985583305358885, 'init_value': 20.249319076538086}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:54.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019564788341522215, 'time_algorithm_update': 0.005208507299423217, 'loss': 5.591401038646698, 'time_step': 0.007214194774627686, 'init_value': 26.289934158325195}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:54.33[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957653045654297, 'time_algorithm_update': 0.005207956552505493, 'loss': 6.206119560718537, 'time_step': 0.0072150216102600095, 'init_value': 32.83919906616211}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:54.41[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987663745880127, 'time_algorithm_update': 0.005263298511505127, 'loss': 6.875531668424606, 'time_step': 0.007301345586776733, 'init_value': 37.267154693603516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:54.50[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019596009254455567, 'time_algorithm_update': 0.005208309650421143, 'loss': 7.17886821436882, 'time_step': 0.007217026472091674, 'init_value': 42.12337112426758}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:54.59[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019630279541015625, 'time_algorithm_update': 0.005213789224624634, 'loss': 8.199493421792983, 'time_step': 0.0072262871265411375, 'init_value': 47.488800048828125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:55.07[0m [[32m[1minfo     [0m] [1mFQE_20250505155341: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019542665481567384, 'time_algorithm_update': 0.005200929880142212, 'loss': 9.541624839544296, 'time_step': 0.007203919410705566, 'init_value': 52.806419372558594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.806419372558594
avg return on 5 trajectories of agent9: 946.9635233333333
Episode generator created
[2m2025-05-05 15:55.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:55.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:55.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:55.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:55.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155511[0m
[2m2025-05-05 15:55.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:55.19[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019489181041717528, 'time_algorithm_update': 0.0051991410255432125, 'loss': 1.5886336265653371, 'time_step': 0.007196389675140381, 'init_value': 3.514517307281494}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:55.28[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019585130214691162, 'time_algorithm_update': 0.005204096078872681, 'loss': 3.8972798751592634, 'time_step': 0.007211652278900147, 'init_value': 8.195381164550781}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:55.36[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019446744918823241, 'time_algorithm_update': 0.005187532424926758, 'loss': 4.537636369943619, 'time_step': 0.007180546998977661, 'init_value': 13.140388488769531}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:55.45[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955773115158081, 'time_algorithm_update': 0.005207157611846923, 'loss': 5.3254968354702, 'time_step': 0.007212043523788452, 'init_value': 20.82818603515625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:55.54[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019531188011169434, 'time_algorithm_update': 0.00519673752784729, 'loss': 5.763976147651673, 'time_step': 0.007198899269104004, 'init_value': 27.28780174255371}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:56.03[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961941957473755, 'time_algorithm_update': 0.005226163864135742, 'loss': 6.076919978618622, 'time_step': 0.007237230777740479, 'init_value': 34.0622673034668}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:56.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019609973430633545, 'time_algorithm_update': 0.005212355852127076, 'loss': 6.793448610067368, 'time_step': 0.007222376346588135, 'init_value': 39.393123626708984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:56.20[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019639346599578857, 'time_algorithm_update': 0.005216823577880859, 'loss': 7.870648793935776, 'time_step': 0.007229729175567627, 'init_value': 46.60087203979492}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:56.29[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019563384056091307, 'time_algorithm_update': 0.005214109659194947, 'loss': 8.7647080013752, 'time_step': 0.007219706773757935, 'init_value': 51.62104797363281}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:56.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155511: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019603681564331053, 'time_algorithm_update': 0.005208677053451538, 'loss': 9.509381814956665, 'time_step': 0.007218126535415649, 'init_value': 55.86338806152344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.86338806152344
avg return on 5 trajectories of agent10: 957.9594703333333
Episode generator created
[2m2025-05-05 15:56.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:56.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:56.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:56.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:56.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155640[0m
[2m2025-05-05 15:56.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:56.49[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001954685688018799, 'time_algorithm_update': 0.0052122118473052976, 'loss': 1.5720252387672662, 'time_step': 0.0072152245044708255, 'init_value': 3.4959003925323486}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:56.58[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019514782428741455, 'time_algorithm_update': 0.005212341547012329, 'loss': 3.8287523317337038, 'time_step': 0.00721235179901123, 'init_value': 8.193906784057617}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:57.06[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019667141437530516, 'time_algorithm_update': 0.005229788541793823, 'loss': 4.890652456760407, 'time_step': 0.007245268106460571, 'init_value': 13.297961235046387}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:57.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019597015380859377, 'time_algorithm_update': 0.005249366521835327, 'loss': 4.994728706359863, 'time_step': 0.007258432149887085, 'init_value': 19.013137817382812}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:57.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019616143703460693, 'time_algorithm_update': 0.005233901500701904, 'loss': 5.314875941038132, 'time_step': 0.007244758367538452, 'init_value': 26.53557777404785}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:57.33[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965169668197632, 'time_algorithm_update': 0.005233710527420044, 'loss': 6.139291315436363, 'time_step': 0.007247983455657959, 'init_value': 31.321699142456055}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:57.41[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019561779499053956, 'time_algorithm_update': 0.005230577945709228, 'loss': 6.4161427319049835, 'time_step': 0.007235732316970825, 'init_value': 37.40331268310547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:57.50[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019577004909515383, 'time_algorithm_update': 0.005222039461135864, 'loss': 7.825196273803711, 'time_step': 0.007228459119796753, 'init_value': 44.24799728393555}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:57.59[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019712178707122804, 'time_algorithm_update': 0.005236124038696289, 'loss': 7.9733630068302155, 'time_step': 0.0072567760944366455, 'init_value': 49.40921401977539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:58.08[0m [[32m[1minfo     [0m] [1mFQE_20250505155640: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019980108737945555, 'time_algorithm_update': 0.0053059298992156985, 'loss': 9.061486968755721, 'time_step': 0.007354431867599488, 'init_value': 54.21966552734375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.21966552734375
avg return on 5 trajectories of agent11: 964.2386740000001
Episode generator created
[2m2025-05-05 15:58.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:58.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:58.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:58.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:58.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155811[0m
[2m2025-05-05 15:58.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:58.19[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019463179111480712, 'time_algorithm_update': 0.005190279006958008, 'loss': 1.6820407194942235, 'time_step': 0.00718437933921814, 'init_value': 4.075706481933594}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:58.28[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019469866752624511, 'time_algorithm_update': 0.005204911947250366, 'loss': 4.300732140183449, 'time_step': 0.007200693130493164, 'init_value': 8.99541187286377}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 15:58.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001953204154968262, 'time_algorithm_update': 0.005212025165557861, 'loss': 4.8976033446788785, 'time_step': 0.007214067459106445, 'init_value': 15.045670509338379}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 15:58.45[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019527928829193115, 'time_algorithm_update': 0.005216816186904907, 'loss': 5.098112071514129, 'time_step': 0.007218666791915893, 'init_value': 20.370969772338867}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 15:58.54[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019522550106048583, 'time_algorithm_update': 0.005205794334411621, 'loss': 5.464089721918106, 'time_step': 0.007206906795501709, 'init_value': 27.375551223754883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 15:59.03[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956351280212402, 'time_algorithm_update': 0.005219974994659424, 'loss': 5.763330558538437, 'time_step': 0.007225503206253051, 'init_value': 33.52859878540039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 15:59.11[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019514641761779784, 'time_algorithm_update': 0.005208754062652588, 'loss': 6.068751019716263, 'time_step': 0.007209124565124511, 'init_value': 37.608917236328125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 15:59.20[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956108331680298, 'time_algorithm_update': 0.00521882700920105, 'loss': 7.133803979635239, 'time_step': 0.007224126100540161, 'init_value': 41.67898941040039}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 15:59.29[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019651601314544676, 'time_algorithm_update': 0.005221474170684815, 'loss': 7.83700803899765, 'time_step': 0.0072357583045959475, 'init_value': 46.303627014160156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 15:59.37[0m [[32m[1minfo     [0m] [1mFQE_20250505155811: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001953908681869507, 'time_algorithm_update': 0.0052144756317138675, 'loss': 8.317474899291993, 'time_step': 0.0072175395488739014, 'init_value': 51.03915023803711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.03915023803711
avg return on 5 trajectories of agent12: 941.731384
Episode generator created
[2m2025-05-05 15:59.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 15:59.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 15:59.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 15:59.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 15:59.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505155941[0m
[2m2025-05-05 15:59.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 15:59.49[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019410223960876466, 'time_algorithm_update': 0.005190330743789673, 'loss': 1.6485704544633626, 'time_step': 0.007179409980773926, 'init_value': 3.53341007232666}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 15:59.58[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955270528793335, 'time_algorithm_update': 0.0052123343944549564, 'loss': 3.939064004659653, 'time_step': 0.007216855049133301, 'init_value': 8.474117279052734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:00.06[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019192109107971191, 'time_algorithm_update': 0.005144206762313842, 'loss': 4.785334182500839, 'time_step': 0.007110394239425659, 'init_value': 14.981589317321777}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:00.15[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019191789627075195, 'time_algorithm_update': 0.005145657300949097, 'loss': 5.184691672801971, 'time_step': 0.007113964080810547, 'init_value': 21.158981323242188}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:00.24[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019191136360168456, 'time_algorithm_update': 0.005136558294296265, 'loss': 6.073987377166748, 'time_step': 0.007103954315185547, 'init_value': 27.334686279296875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:00.32[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019235131740570068, 'time_algorithm_update': 0.005136692047119141, 'loss': 6.249988954305649, 'time_step': 0.007108710765838623, 'init_value': 32.613792419433594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:00.41[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019197442531585693, 'time_algorithm_update': 0.005140714168548584, 'loss': 6.630069303274155, 'time_step': 0.007109226226806641, 'init_value': 38.01494216918945}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:00.49[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001941741704940796, 'time_algorithm_update': 0.005199512243270874, 'loss': 6.9457258856296535, 'time_step': 0.0071901605129241946, 'init_value': 43.95972442626953}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:00.58[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963649034500122, 'time_algorithm_update': 0.005239691495895386, 'loss': 8.202865161180496, 'time_step': 0.007252931594848633, 'init_value': 47.96595001220703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:01.07[0m [[32m[1minfo     [0m] [1mFQE_20250505155941: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019478161334991455, 'time_algorithm_update': 0.005232724666595459, 'loss': 9.575112699270248, 'time_step': 0.007229269981384278, 'init_value': 54.64720153808594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.64720153808594
avg return on 5 trajectories of agent13: 947.5307079999999
Episode generator created
[2m2025-05-05 16:01.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:01.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:01.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:01.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:01.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160110[0m
[2m2025-05-05 16:01.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:01.19[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001954028367996216, 'time_algorithm_update': 0.005207955837249756, 'loss': 1.5731807252764702, 'time_step': 0.007210418701171875, 'init_value': 3.6340253353118896}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:01.27[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019623515605926515, 'time_algorithm_update': 0.005230738639831543, 'loss': 4.004797211766243, 'time_step': 0.007242398262023926, 'init_value': 9.256819725036621}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:01.36[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001981893062591553, 'time_algorithm_update': 0.005279415130615235, 'loss': 4.734805720925331, 'time_step': 0.007311813592910767, 'init_value': 14.192976951599121}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:01.45[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967807769775391, 'time_algorithm_update': 0.005252432107925415, 'loss': 5.462171071052551, 'time_step': 0.007270348072052002, 'init_value': 20.482364654541016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:01.54[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019684133529663085, 'time_algorithm_update': 0.005243978023529053, 'loss': 5.631566233634949, 'time_step': 0.007262317895889282, 'init_value': 26.026655197143555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:02.02[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019771511554718016, 'time_algorithm_update': 0.0052703280448913575, 'loss': 6.110854295730591, 'time_step': 0.007297677755355835, 'init_value': 32.01233673095703}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:02.11[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019618427753448488, 'time_algorithm_update': 0.00523004412651062, 'loss': 6.018867351055145, 'time_step': 0.007241313695907593, 'init_value': 35.55491638183594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:02.20[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019758374691009523, 'time_algorithm_update': 0.005243580818176269, 'loss': 6.665853075027465, 'time_step': 0.007268983364105225, 'init_value': 40.335205078125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:02.28[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969944715499878, 'time_algorithm_update': 0.005251980304718017, 'loss': 7.653558525085449, 'time_step': 0.0072723360061645505, 'init_value': 44.02649688720703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:02.37[0m [[32m[1minfo     [0m] [1mFQE_20250505160110: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019764068126678466, 'time_algorithm_update': 0.005270088672637939, 'loss': 8.389258962392807, 'time_step': 0.007296433687210083, 'init_value': 48.724700927734375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 48.724700927734375
avg return on 5 trajectories of agent14: 952.6541506666666
Episode generator created
[2m2025-05-05 16:02.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:02.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:02.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:02.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:02.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160240[0m
[2m2025-05-05 16:02.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:02.50[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044776916503906, 'time_algorithm_update': 0.0054721317291259765, 'loss': 1.618507375150919, 'time_step': 0.007568111181259155, 'init_value': 3.6724627017974854}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:02.59[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029816150665283, 'time_algorithm_update': 0.005396763324737549, 'loss': 3.820068175435066, 'time_step': 0.0074775867462158205, 'init_value': 8.647982597351074}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:03.07[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019652035236358643, 'time_algorithm_update': 0.005224929332733154, 'loss': 4.819197451591491, 'time_step': 0.007239222526550293, 'init_value': 13.815537452697754}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:03.16[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019736437797546386, 'time_algorithm_update': 0.005240932464599609, 'loss': 5.259023079037666, 'time_step': 0.007263943433761597, 'init_value': 20.466915130615234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:03.25[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001980669736862183, 'time_algorithm_update': 0.0052427370548248295, 'loss': 5.549129592895508, 'time_step': 0.007272917985916138, 'init_value': 26.4129581451416}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:03.33[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019694766998291017, 'time_algorithm_update': 0.005233656167984008, 'loss': 5.506561250448227, 'time_step': 0.007252311229705811, 'init_value': 31.172521591186523}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:03.42[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019751102924346923, 'time_algorithm_update': 0.00524070405960083, 'loss': 6.123323312520981, 'time_step': 0.007265463829040527, 'init_value': 37.425689697265625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:03.51[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019836344718933106, 'time_algorithm_update': 0.005238115549087524, 'loss': 7.254053015470505, 'time_step': 0.007271197080612183, 'init_value': 42.373634338378906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:03.59[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019703543186187743, 'time_algorithm_update': 0.005239119291305542, 'loss': 7.95728872346878, 'time_step': 0.007259155511856079, 'init_value': 46.44374084472656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:04.08[0m [[32m[1minfo     [0m] [1mFQE_20250505160240: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019890003204345703, 'time_algorithm_update': 0.005267039537429809, 'loss': 8.736772898435593, 'time_step': 0.007306599378585815, 'init_value': 51.14915084838867}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.14915084838867
avg return on 5 trajectories of agent15: 972.190169
Episode generator created
[2m2025-05-05 16:04.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:04.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:04.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:04.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:04.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160411[0m
[2m2025-05-05 16:04.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:04.20[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956209659576416, 'time_algorithm_update': 0.005209481716156006, 'loss': 1.6465369732826949, 'time_step': 0.0072140533924102785, 'init_value': 3.770880699157715}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:04.29[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019564669132232666, 'time_algorithm_update': 0.005215649366378784, 'loss': 3.860905808568001, 'time_step': 0.007220802545547486, 'init_value': 8.846386909484863}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:04.38[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019657764434814454, 'time_algorithm_update': 0.005235821723937988, 'loss': 4.620847921848297, 'time_step': 0.00725088906288147, 'init_value': 15.490242958068848}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:04.46[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967604160308838, 'time_algorithm_update': 0.0052456407546997074, 'loss': 4.893524205088616, 'time_step': 0.007262537479400635, 'init_value': 19.648210525512695}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:04.55[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963789701461792, 'time_algorithm_update': 0.005218190193176269, 'loss': 5.4668326374292375, 'time_step': 0.007230958938598633, 'init_value': 25.710386276245117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:05.04[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965993881225586, 'time_algorithm_update': 0.005225856304168702, 'loss': 5.901634943246841, 'time_step': 0.007241403341293335, 'init_value': 31.418399810791016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:05.12[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020071544647216797, 'time_algorithm_update': 0.005326091766357422, 'loss': 6.173164525508881, 'time_step': 0.007384734869003296, 'init_value': 38.10243225097656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973297357559204, 'time_algorithm_update': 0.005235778570175171, 'loss': 7.214423553943634, 'time_step': 0.007258381128311157, 'init_value': 43.09239959716797}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:05.30[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019729304313659667, 'time_algorithm_update': 0.005226279258728027, 'loss': 8.353962091207505, 'time_step': 0.007249245882034302, 'init_value': 49.315818786621094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:05.39[0m [[32m[1minfo     [0m] [1mFQE_20250505160411: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019717280864715576, 'time_algorithm_update': 0.005230401515960693, 'loss': 9.152876160144807, 'time_step': 0.007251698255538941, 'init_value': 54.67046356201172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.67046356201172
avg return on 5 trajectories of agent16: 933.8940036666667
Episode generator created
[2m2025-05-05 16:05.41[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:05.41[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:05.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:05.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:05.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160542[0m
[2m2025-05-05 16:05.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:05.50[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957984685897827, 'time_algorithm_update': 0.0051904137134552, 'loss': 1.650003295391798, 'time_step': 0.00719690489768982, 'init_value': 4.147167682647705}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:05.59[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197124719619751, 'time_algorithm_update': 0.005226246356964111, 'loss': 3.8515078235864637, 'time_step': 0.0072468481063842774, 'init_value': 8.930181503295898}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:06.08[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001983466148376465, 'time_algorithm_update': 0.005249906301498413, 'loss': 4.643701481819153, 'time_step': 0.007282898664474487, 'init_value': 13.887595176696777}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:06.17[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965397357940674, 'time_algorithm_update': 0.005245583772659302, 'loss': 5.087840228319168, 'time_step': 0.007260318756103516, 'init_value': 20.340091705322266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:06.25[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972721815109253, 'time_algorithm_update': 0.005240498065948486, 'loss': 5.547609721660614, 'time_step': 0.0072625911235809325, 'init_value': 27.155994415283203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:06.34[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966233491897583, 'time_algorithm_update': 0.005243658781051636, 'loss': 6.280812355756759, 'time_step': 0.0072594771385192875, 'init_value': 34.1151237487793}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:06.43[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963275194168091, 'time_algorithm_update': 0.005222529411315918, 'loss': 7.310134302139282, 'time_step': 0.007234581232070923, 'init_value': 40.3209342956543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:06.51[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019799184799194334, 'time_algorithm_update': 0.005247565746307373, 'loss': 7.851224000930786, 'time_step': 0.00727679443359375, 'init_value': 44.56129837036133}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:07.00[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019806053638458253, 'time_algorithm_update': 0.00524118423461914, 'loss': 9.165835651397705, 'time_step': 0.007271480083465576, 'init_value': 50.400272369384766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:07.09[0m [[32m[1minfo     [0m] [1mFQE_20250505160542: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019661135673522947, 'time_algorithm_update': 0.0052230916023254395, 'loss': 9.813308790445328, 'time_step': 0.007238499641418457, 'init_value': 54.638824462890625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.638824462890625
avg return on 5 trajectories of agent17: 924.4614363333334
Episode generator created
[2m2025-05-05 16:07.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:07.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:07.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:07.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:07.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160712[0m
[2m2025-05-05 16:07.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:07.21[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963547468185425, 'time_algorithm_update': 0.005216874361038208, 'loss': 1.5848622499108314, 'time_step': 0.007229063510894775, 'init_value': 3.858837366104126}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:07.29[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973421096801758, 'time_algorithm_update': 0.005227577924728393, 'loss': 3.908903160572052, 'time_step': 0.0072502286434173585, 'init_value': 8.599095344543457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:07.38[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019766530990600584, 'time_algorithm_update': 0.005220120668411255, 'loss': 4.528750653862954, 'time_step': 0.0072456014156341555, 'init_value': 14.49942398071289}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:07.47[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019783339500427247, 'time_algorithm_update': 0.005245222806930542, 'loss': 4.993068159818649, 'time_step': 0.007272965669631958, 'init_value': 20.935604095458984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:07.56[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019757556915283203, 'time_algorithm_update': 0.005225988626480102, 'loss': 5.559653095960617, 'time_step': 0.007251040458679199, 'init_value': 26.564876556396484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:08.04[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019646804332733156, 'time_algorithm_update': 0.005228564977645874, 'loss': 5.980042792081833, 'time_step': 0.007242601633071899, 'init_value': 32.55287170410156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:08.13[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970105171203613, 'time_algorithm_update': 0.0052337713241577145, 'loss': 6.900102171182632, 'time_step': 0.0072531776428222654, 'init_value': 36.846275329589844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:08.22[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019759132862091065, 'time_algorithm_update': 0.005241798162460327, 'loss': 7.519960587263108, 'time_step': 0.007266797542572021, 'init_value': 42.53718948364258}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:08.31[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978260517120361, 'time_algorithm_update': 0.005233242273330689, 'loss': 8.078514408111571, 'time_step': 0.007261087656021118, 'init_value': 49.46747589111328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:08.39[0m [[32m[1minfo     [0m] [1mFQE_20250505160712: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974012613296509, 'time_algorithm_update': 0.005234973907470703, 'loss': 8.93747971701622, 'time_step': 0.00725829553604126, 'init_value': 54.55660629272461}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.55660629272461
avg return on 5 trajectories of agent18: 953.541826
Episode generator created
[2m2025-05-05 16:08.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:08.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:08.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:08.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:08.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505160842[0m
[2m2025-05-05 16:08.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002001387596130371, 'time_algorithm_update': 0.005310707569122315, 'loss': 1.639238140925765, 'time_step': 0.007363075971603393, 'init_value': 3.301386594772339}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:09.00[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019652996063232423, 'time_algorithm_update': 0.005225287437438965, 'loss': 3.5919239861965178, 'time_step': 0.007239616394042968, 'init_value': 7.890835762023926}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:09.09[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976404905319214, 'time_algorithm_update': 0.005241187810897827, 'loss': 4.581309589147568, 'time_step': 0.007266493320465088, 'init_value': 14.08714771270752}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:09.17[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019758174419403076, 'time_algorithm_update': 0.005249130010604858, 'loss': 5.336444287657738, 'time_step': 0.007274640321731567, 'init_value': 20.67462921142578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:09.26[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962759256362915, 'time_algorithm_update': 0.005223555088043213, 'loss': 5.514698394298554, 'time_step': 0.007235599040985107, 'init_value': 26.380212783813477}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:09.35[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019752969741821287, 'time_algorithm_update': 0.005242591142654419, 'loss': 6.35474687051773, 'time_step': 0.007267033576965332, 'init_value': 33.81282424926758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:09.44[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019682066440582274, 'time_algorithm_update': 0.0052301504611968995, 'loss': 7.712245278596878, 'time_step': 0.007247180223464966, 'init_value': 41.24637222290039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:09.52[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019257431030273438, 'time_algorithm_update': 0.005122256278991699, 'loss': 8.503235797643661, 'time_step': 0.007095141172409058, 'init_value': 47.356781005859375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:10.01[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019326896667480468, 'time_algorithm_update': 0.005149170160293579, 'loss': 9.496117153406143, 'time_step': 0.007130913972854615, 'init_value': 52.901519775390625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:10.09[0m [[32m[1minfo     [0m] [1mFQE_20250505160842: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019352173805236817, 'time_algorithm_update': 0.005141837596893311, 'loss': 10.056382056236266, 'time_step': 0.007126031160354615, 'init_value': 57.450714111328125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.450714111328125
avg return on 5 trajectories of agent19: 932.1613653333334
Episode generator created
[2m2025-05-05 16:10.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:10.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:10.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:10.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:10.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161013[0m
[2m2025-05-05 16:10.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:10.21[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001928004026412964, 'time_algorithm_update': 0.00512024712562561, 'loss': 1.6791646048128606, 'time_step': 0.0070965633392333985, 'init_value': 3.6028294563293457}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:10.30[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019283626079559326, 'time_algorithm_update': 0.005127903938293457, 'loss': 3.8217405463457106, 'time_step': 0.007104981660842896, 'init_value': 8.334734916687012}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:10.38[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973557710647583, 'time_algorithm_update': 0.0052401871681213375, 'loss': 4.717595842838287, 'time_step': 0.007262542486190796, 'init_value': 14.898460388183594}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:10.47[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959768772125244, 'time_algorithm_update': 0.005223609209060669, 'loss': 5.2150301256179805, 'time_step': 0.007232345342636108, 'init_value': 21.662616729736328}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:10.56[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965638637542725, 'time_algorithm_update': 0.005221155643463135, 'loss': 5.6552526144981385, 'time_step': 0.0072358958721160885, 'init_value': 27.300338745117188}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:11.04[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019627456665039064, 'time_algorithm_update': 0.00523501443862915, 'loss': 6.105626385211945, 'time_step': 0.007246793031692505, 'init_value': 33.95479965209961}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:11.13[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019713072776794435, 'time_algorithm_update': 0.005232163906097412, 'loss': 7.06211299943924, 'time_step': 0.007252755641937256, 'init_value': 39.02125930786133}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:11.22[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019715993404388426, 'time_algorithm_update': 0.0052224364280700685, 'loss': 7.6409319624900816, 'time_step': 0.007243041515350342, 'init_value': 44.090030670166016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:11.31[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019712891578674316, 'time_algorithm_update': 0.005219581842422485, 'loss': 8.319241240501404, 'time_step': 0.007239998579025269, 'init_value': 48.20915603637695}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:11.39[0m [[32m[1minfo     [0m] [1mFQE_20250505161013: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019668047428131104, 'time_algorithm_update': 0.005229694128036499, 'loss': 8.901078123807908, 'time_step': 0.007245764970779419, 'init_value': 53.44905090332031}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.44905090332031
ave advantage rew: 53.593758773803714, std: 2.015650527921149
avg cum rews: 952.3194028333334, std: 19.86446842756776
Pearson correlation coefficient: -0.10568185648099394
Spearman correlation coefficient: -0.08721804511278196
Kendall Tau correlation coefficient: -0.06315789473684211
the best agent: 18, best agent cum rewards: 953.541826
1954
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.01753184792706594
avg return on 5 trajectories of agent0: 971.0673856666667
Episode generator created
[2m2025-05-05 16:12.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:12.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:12.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:12.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:12.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161202[0m
[2m2025-05-05 16:12.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:12.11[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958885669708252, 'time_algorithm_update': 0.005209410429000854, 'loss': 1.6471860075742006, 'time_step': 0.007216718673706055, 'init_value': 3.808847427368164}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:12.20[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019816880226135253, 'time_algorithm_update': 0.005267160892486572, 'loss': 3.9957481619119646, 'time_step': 0.007298825740814209, 'init_value': 8.767134666442871}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:12.28[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020027565956115723, 'time_algorithm_update': 0.00529969048500061, 'loss': 4.646692784905434, 'time_step': 0.007353060245513916, 'init_value': 15.362191200256348}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:12.37[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019700887203216552, 'time_algorithm_update': 0.005230681657791138, 'loss': 4.933503507733345, 'time_step': 0.0072497262954711915, 'init_value': 21.611221313476562}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:12.46[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019763720035552977, 'time_algorithm_update': 0.005230987787246704, 'loss': 5.342059496998787, 'time_step': 0.007256810188293457, 'init_value': 26.23653221130371}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:12.54[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970148801803589, 'time_algorithm_update': 0.005232450962066651, 'loss': 5.764336304306984, 'time_step': 0.007251756191253662, 'init_value': 32.99455642700195}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:13.03[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019751529693603515, 'time_algorithm_update': 0.005252172470092773, 'loss': 6.422915248632431, 'time_step': 0.007276986598968506, 'init_value': 37.9447021484375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:13.12[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019757583141326905, 'time_algorithm_update': 0.005254228353500366, 'loss': 7.427488091230392, 'time_step': 0.007279637575149536, 'init_value': 44.48094940185547}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:13.21[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969552516937256, 'time_algorithm_update': 0.005237472772598267, 'loss': 8.139002389430999, 'time_step': 0.007256317377090454, 'init_value': 47.84193420410156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:13.29[0m [[32m[1minfo     [0m] [1mFQE_20250505161202: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019755067825317383, 'time_algorithm_update': 0.005243054628372192, 'loss': 9.46296352171898, 'time_step': 0.007267738103866577, 'init_value': 54.46628189086914}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.46628189086914
avg return on 5 trajectories of agent1: 981.9404803333333
Episode generator created
[2m2025-05-05 16:13.32[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:13.32[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:13.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:13.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:13.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161332[0m
[2m2025-05-05 16:13.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:13.41[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019711441993713378, 'time_algorithm_update': 0.005221995592117309, 'loss': 1.6144171045422555, 'time_step': 0.007242009878158569, 'init_value': 4.121601104736328}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:13.50[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955191373825073, 'time_algorithm_update': 0.0052244865894317625, 'loss': 4.034519153237343, 'time_step': 0.00722868800163269, 'init_value': 8.395780563354492}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:13.59[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019671630859375, 'time_algorithm_update': 0.0052389481067657475, 'loss': 4.815809056401252, 'time_step': 0.007255385875701905, 'init_value': 14.142097473144531}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:14.07[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019706251621246338, 'time_algorithm_update': 0.005251984596252441, 'loss': 5.251380635976791, 'time_step': 0.007272408008575439, 'init_value': 21.021469116210938}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:14.16[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019624109268188477, 'time_algorithm_update': 0.005221709251403809, 'loss': 5.769169724464416, 'time_step': 0.0072333929538726804, 'init_value': 28.18428611755371}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:14.25[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019699835777282713, 'time_algorithm_update': 0.0052238254547119145, 'loss': 6.337987977981568, 'time_step': 0.007243055820465088, 'init_value': 32.74720764160156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:14.33[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019689569473266603, 'time_algorithm_update': 0.005238808393478393, 'loss': 6.63009559249878, 'time_step': 0.007257488489151001, 'init_value': 37.35403060913086}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:14.42[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961761474609375, 'time_algorithm_update': 0.0052267897129058835, 'loss': 7.72148580622673, 'time_step': 0.007237576246261597, 'init_value': 45.0518913269043}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:14.51[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019651637077331544, 'time_algorithm_update': 0.00523395323753357, 'loss': 7.9627514054775235, 'time_step': 0.007248779773712158, 'init_value': 47.31529235839844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:15.00[0m [[32m[1minfo     [0m] [1mFQE_20250505161332: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019861559867858885, 'time_algorithm_update': 0.005291597604751587, 'loss': 9.12559591126442, 'time_step': 0.007328326463699341, 'init_value': 52.29948043823242}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.29948043823242
avg return on 5 trajectories of agent2: 975.4216313333333
Episode generator created
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:15.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:15.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161503[0m
[2m2025-05-05 16:15.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:15.12[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959629774093628, 'time_algorithm_update': 0.005215247392654419, 'loss': 1.5858299688845874, 'time_step': 0.007223762035369873, 'init_value': 3.6730053424835205}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:15.20[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196986985206604, 'time_algorithm_update': 0.005249333143234253, 'loss': 3.8135733919143675, 'time_step': 0.007268736600875855, 'init_value': 8.071085929870605}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:15.29[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196637225151062, 'time_algorithm_update': 0.005240562677383423, 'loss': 4.355514909505844, 'time_step': 0.0072563297748565675, 'init_value': 13.715034484863281}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:15.38[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019648048877716063, 'time_algorithm_update': 0.005227015256881714, 'loss': 4.956613284826279, 'time_step': 0.007240935325622559, 'init_value': 20.48895835876465}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:15.46[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019680638313293456, 'time_algorithm_update': 0.005243307113647461, 'loss': 5.605340326547623, 'time_step': 0.007260853767395019, 'init_value': 26.980113983154297}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:15.55[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019814772605895995, 'time_algorithm_update': 0.005264448404312134, 'loss': 6.145248148441315, 'time_step': 0.007295885562896729, 'init_value': 33.24542999267578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:16.04[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976456642150879, 'time_algorithm_update': 0.0052598795890808105, 'loss': 6.931221421003341, 'time_step': 0.007285658121109009, 'init_value': 40.01612091064453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:16.13[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019710302352905274, 'time_algorithm_update': 0.005238140344619751, 'loss': 8.594691082477569, 'time_step': 0.007258640766143799, 'init_value': 47.62627029418945}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:16.21[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019725215435028075, 'time_algorithm_update': 0.005232229232788086, 'loss': 9.376880619764329, 'time_step': 0.0072540159225463864, 'init_value': 51.22998046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:16.30[0m [[32m[1minfo     [0m] [1mFQE_20250505161503: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019532108306884767, 'time_algorithm_update': 0.005214739561080933, 'loss': 10.721283966064453, 'time_step': 0.007216871500015259, 'init_value': 57.763736724853516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.763736724853516
avg return on 5 trajectories of agent3: 928.0047466666666
Episode generator created
[2m2025-05-05 16:16.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:16.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:16.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:16.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:16.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161633[0m
[2m2025-05-05 16:16.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:16.42[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966268301010132, 'time_algorithm_update': 0.005210795164108276, 'loss': 1.6277702864706516, 'time_step': 0.0072261102199554445, 'init_value': 3.994027614593506}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:16.51[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969142198562622, 'time_algorithm_update': 0.005235399007797241, 'loss': 3.8864110479354856, 'time_step': 0.007253790140151977, 'init_value': 8.937824249267578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:16.59[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019597220420837403, 'time_algorithm_update': 0.005222630977630615, 'loss': 4.715568483233452, 'time_step': 0.007231630563735962, 'init_value': 14.106321334838867}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:17.08[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019725308418273926, 'time_algorithm_update': 0.005240946531295776, 'loss': 5.333210663080216, 'time_step': 0.007262908697128296, 'init_value': 20.388324737548828}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:17.17[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970405101776123, 'time_algorithm_update': 0.0052347853183746336, 'loss': 6.000496323347091, 'time_step': 0.0072543597221374516, 'init_value': 27.784717559814453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:17.25[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019697384834289552, 'time_algorithm_update': 0.005233047723770141, 'loss': 6.583516299247742, 'time_step': 0.007252198934555054, 'init_value': 34.48225784301758}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:17.34[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019727742671966555, 'time_algorithm_update': 0.005248037338256836, 'loss': 7.219680709838867, 'time_step': 0.007270614385604859, 'init_value': 38.340721130371094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:17.43[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967712163925171, 'time_algorithm_update': 0.0052461354732513425, 'loss': 7.589375853300095, 'time_step': 0.007263393878936768, 'init_value': 43.17265701293945}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:17.52[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019563472270965575, 'time_algorithm_update': 0.005208572149276733, 'loss': 8.36772655916214, 'time_step': 0.007213330268859864, 'init_value': 45.26599884033203}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:18.00[0m [[32m[1minfo     [0m] [1mFQE_20250505161633: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968773126602173, 'time_algorithm_update': 0.005237834692001343, 'loss': 8.848071583747863, 'time_step': 0.007256231069564819, 'init_value': 51.478057861328125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.478057861328125
avg return on 5 trajectories of agent4: 936.6326716666666
Episode generator created
[2m2025-05-05 16:18.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:18.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:18.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:18.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:18.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161803[0m
[2m2025-05-05 16:18.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:18.12[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019607560634613036, 'time_algorithm_update': 0.005222212553024292, 'loss': 1.6378451331108808, 'time_step': 0.007231957674026489, 'init_value': 3.503345251083374}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:18.21[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955822229385376, 'time_algorithm_update': 0.005235991716384888, 'loss': 3.7090252155065535, 'time_step': 0.00724092435836792, 'init_value': 8.000140190124512}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:18.30[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019628612995147704, 'time_algorithm_update': 0.005235764741897583, 'loss': 4.7168384971618655, 'time_step': 0.007248268842697143, 'init_value': 13.755660057067871}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:18.38[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019756898880004883, 'time_algorithm_update': 0.005245346784591675, 'loss': 5.0614236505031585, 'time_step': 0.007270548582077026, 'init_value': 20.334579467773438}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:18.47[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001957359552383423, 'time_algorithm_update': 0.005226749897003174, 'loss': 5.195477304339409, 'time_step': 0.0072333159446716306, 'init_value': 24.820743560791016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:18.56[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019738914966583253, 'time_algorithm_update': 0.00523390793800354, 'loss': 5.575653286695481, 'time_step': 0.007256970643997192, 'init_value': 30.6392822265625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:19.04[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968854904174805, 'time_algorithm_update': 0.005240527391433716, 'loss': 6.054011452794075, 'time_step': 0.007258920669555664, 'init_value': 36.67544937133789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:19.13[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960814714431763, 'time_algorithm_update': 0.005217245101928711, 'loss': 6.8980452406406405, 'time_step': 0.007227174520492554, 'init_value': 41.52483367919922}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:19.22[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019938158988952637, 'time_algorithm_update': 0.005288747787475586, 'loss': 7.628975011587143, 'time_step': 0.007333748817443848, 'init_value': 47.205841064453125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:19.31[0m [[32m[1minfo     [0m] [1mFQE_20250505161803: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019708504676818847, 'time_algorithm_update': 0.005232406377792358, 'loss': 8.893201208591462, 'time_step': 0.007252852916717529, 'init_value': 50.96851348876953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.96851348876953
avg return on 5 trajectories of agent5: 951.1589213333333
Episode generator created
[2m2025-05-05 16:19.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:19.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:19.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:19.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:19.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505161934[0m
[2m2025-05-05 16:19.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:19.42[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00190978741645813, 'time_algorithm_update': 0.005104156017303467, 'loss': 1.690180930763483, 'time_step': 0.007061148881912231, 'init_value': 3.6948282718658447}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:19.51[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019303596019744874, 'time_algorithm_update': 0.005142618417739869, 'loss': 3.8057811722755432, 'time_step': 0.007122019290924072, 'init_value': 8.535414695739746}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:19.59[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019325888156890869, 'time_algorithm_update': 0.005129866361618042, 'loss': 4.517979096412659, 'time_step': 0.007111140489578247, 'init_value': 14.65987777709961}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:20.08[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019401240348815919, 'time_algorithm_update': 0.005147432804107666, 'loss': 5.341377534866333, 'time_step': 0.00713652515411377, 'init_value': 20.979082107543945}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:20.17[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001933384895324707, 'time_algorithm_update': 0.005139426469802856, 'loss': 5.73126730966568, 'time_step': 0.007121731519699096, 'init_value': 25.762191772460938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:20.25[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019646403789520266, 'time_algorithm_update': 0.00520568037033081, 'loss': 5.993023755788803, 'time_step': 0.0072192766666412354, 'init_value': 30.964094161987305}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:20.34[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019636921882629395, 'time_algorithm_update': 0.005229087352752686, 'loss': 6.486347223997116, 'time_step': 0.007241891622543335, 'init_value': 36.52436065673828}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:20.43[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973472356796265, 'time_algorithm_update': 0.005229656457901001, 'loss': 7.146589008569717, 'time_step': 0.0072525498867034915, 'init_value': 41.61243438720703}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:20.51[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969475746154785, 'time_algorithm_update': 0.005220950603485108, 'loss': 8.026483603715896, 'time_step': 0.007239505290985108, 'init_value': 46.69906234741211}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:21.00[0m [[32m[1minfo     [0m] [1mFQE_20250505161934: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019811840057373047, 'time_algorithm_update': 0.005239790439605713, 'loss': 9.20274268579483, 'time_step': 0.007270599365234375, 'init_value': 52.059776306152344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.059776306152344
avg return on 5 trajectories of agent6: 954.9692986666665
Episode generator created
[2m2025-05-05 16:21.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:21.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:21.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:21.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:21.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162103[0m
[2m2025-05-05 16:21.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:21.12[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019672253131866454, 'time_algorithm_update': 0.005228914022445678, 'loss': 1.5791807123869657, 'time_step': 0.007245423078536988, 'init_value': 3.374887704849243}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:21.21[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019659252166748047, 'time_algorithm_update': 0.0052377479076385495, 'loss': 3.9242268726825715, 'time_step': 0.007252847194671631, 'init_value': 8.327908515930176}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:21.29[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969248056411743, 'time_algorithm_update': 0.005252046823501587, 'loss': 4.635441719770432, 'time_step': 0.007270581483840942, 'init_value': 14.285809516906738}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:21.38[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019726669788360596, 'time_algorithm_update': 0.005255337953567505, 'loss': 4.982904951572419, 'time_step': 0.007277647495269776, 'init_value': 20.297731399536133}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:21.47[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019698567390441894, 'time_algorithm_update': 0.005238042831420898, 'loss': 5.594587614536286, 'time_step': 0.007256909608840943, 'init_value': 26.467744827270508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:21.56[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019742136001586912, 'time_algorithm_update': 0.0052423965930938725, 'loss': 6.161806778907776, 'time_step': 0.007265896797180176, 'init_value': 33.18348693847656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:22.04[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197100830078125, 'time_algorithm_update': 0.005267425298690796, 'loss': 6.690886030197143, 'time_step': 0.00728830623626709, 'init_value': 38.91625213623047}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:22.13[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019624526500701903, 'time_algorithm_update': 0.005241241693496704, 'loss': 7.754120281457901, 'time_step': 0.007254199743270874, 'init_value': 45.893245697021484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:22.22[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971644639968872, 'time_algorithm_update': 0.005242305994033814, 'loss': 8.703443700313569, 'time_step': 0.007263696670532226, 'init_value': 53.027286529541016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:22.30[0m [[32m[1minfo     [0m] [1mFQE_20250505162103: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967554330825806, 'time_algorithm_update': 0.00524407172203064, 'loss': 9.665254279851913, 'time_step': 0.007261086225509644, 'init_value': 58.117210388183594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.117210388183594
avg return on 5 trajectories of agent7: 926.3999363333332
Episode generator created
[2m2025-05-05 16:22.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:22.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:22.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:22.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:22.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162234[0m
[2m2025-05-05 16:22.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:22.42[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019542829990386963, 'time_algorithm_update': 0.005208413362503052, 'loss': 1.668371204867959, 'time_step': 0.007211105108261108, 'init_value': 3.6068053245544434}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:22.51[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965780258178711, 'time_algorithm_update': 0.0052440276145935055, 'loss': 3.8622758275270463, 'time_step': 0.00725932240486145, 'init_value': 9.104805946350098}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:23.00[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002010838508605957, 'time_algorithm_update': 0.00532813310623169, 'loss': 4.546035788297653, 'time_step': 0.007389977216720581, 'init_value': 14.744362831115723}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:23.09[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00200270676612854, 'time_algorithm_update': 0.005322039842605591, 'loss': 5.25371000957489, 'time_step': 0.007375797748565674, 'init_value': 22.34717559814453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:23.17[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019608540534973144, 'time_algorithm_update': 0.005235560417175293, 'loss': 5.525889188528061, 'time_step': 0.0072452912330627445, 'init_value': 26.6212158203125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:23.26[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019647977352142336, 'time_algorithm_update': 0.005229829788208008, 'loss': 5.855546352624893, 'time_step': 0.00724356484413147, 'init_value': 31.5333251953125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:23.35[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019677846431732176, 'time_algorithm_update': 0.0052286388874053956, 'loss': 5.955540670394898, 'time_step': 0.007246026754379273, 'init_value': 36.40900802612305}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:23.44[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972230911254883, 'time_algorithm_update': 0.0052457194328308105, 'loss': 7.128661390542984, 'time_step': 0.0072675650119781495, 'init_value': 42.86807632446289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:23.52[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974052906036377, 'time_algorithm_update': 0.005240607261657715, 'loss': 7.582118751049042, 'time_step': 0.007264322757720947, 'init_value': 47.658172607421875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:24.01[0m [[32m[1minfo     [0m] [1mFQE_20250505162234: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197579288482666, 'time_algorithm_update': 0.005235821962356568, 'loss': 8.56654123210907, 'time_step': 0.0072613260746002195, 'init_value': 51.79389572143555}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.79389572143555
avg return on 5 trajectories of agent8: 948.8813100000001
Episode generator created
[2m2025-05-05 16:24.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:24.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:24.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:24.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:24.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162404[0m
[2m2025-05-05 16:24.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:24.13[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019613637924194337, 'time_algorithm_update': 0.005216210603713989, 'loss': 1.5811001627594232, 'time_step': 0.007226265430450439, 'init_value': 3.804194688796997}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:24.22[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965637683868408, 'time_algorithm_update': 0.005244696855545044, 'loss': 3.957560307502747, 'time_step': 0.007259834527969361, 'init_value': 8.959938049316406}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:24.30[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019640717506408693, 'time_algorithm_update': 0.0052419366836547856, 'loss': 4.670454666614533, 'time_step': 0.0072547726631164555, 'init_value': 14.89577865600586}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:24.39[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019712746143341064, 'time_algorithm_update': 0.005249779462814331, 'loss': 5.2412411403656005, 'time_step': 0.007270050048828125, 'init_value': 20.52930450439453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:24.48[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019624783992767333, 'time_algorithm_update': 0.005251406669616699, 'loss': 5.472132110238075, 'time_step': 0.0072631282806396484, 'init_value': 26.919864654541016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:24.56[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975815773010254, 'time_algorithm_update': 0.005253791570663452, 'loss': 6.070242024421692, 'time_step': 0.0072789969444274905, 'init_value': 34.14625549316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:25.05[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972874164581299, 'time_algorithm_update': 0.005271961212158203, 'loss': 6.90066530585289, 'time_step': 0.007294275522232056, 'init_value': 38.752262115478516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:25.14[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974486827850342, 'time_algorithm_update': 0.005267311573028564, 'loss': 7.713303031682968, 'time_step': 0.007291274070739746, 'init_value': 43.623104095458984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:25.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019695208072662354, 'time_algorithm_update': 0.005248247623443603, 'loss': 8.619668228626251, 'time_step': 0.007266747713088989, 'init_value': 48.51206588745117}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:25.32[0m [[32m[1minfo     [0m] [1mFQE_20250505162404: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975243806838989, 'time_algorithm_update': 0.005260072708129883, 'loss': 8.849637036800384, 'time_step': 0.007285124540328979, 'init_value': 50.48896408081055}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.48896408081055
avg return on 5 trajectories of agent9: 933.7263223333333
Episode generator created
[2m2025-05-05 16:25.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:25.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:25.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:25.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:25.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162535[0m
[2m2025-05-05 16:25.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:25.43[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964388132095337, 'time_algorithm_update': 0.005210938215255737, 'loss': 1.6496457913666964, 'time_step': 0.007224879741668701, 'init_value': 3.7257137298583984}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:25.52[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019672212600708007, 'time_algorithm_update': 0.005211324691772461, 'loss': 3.848034573793411, 'time_step': 0.007227833986282349, 'init_value': 8.664654731750488}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:26.01[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019651784896850587, 'time_algorithm_update': 0.005229281663894653, 'loss': 4.5252942129373555, 'time_step': 0.00724407410621643, 'init_value': 13.635080337524414}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:26.09[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967532157897949, 'time_algorithm_update': 0.005238461971282959, 'loss': 5.053516347646713, 'time_step': 0.00725536847114563, 'init_value': 19.95218849182129}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:26.18[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019657444953918458, 'time_algorithm_update': 0.005218502759933472, 'loss': 5.44798649764061, 'time_step': 0.007233503341674804, 'init_value': 26.363685607910156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:26.27[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019729979038238523, 'time_algorithm_update': 0.005228338718414306, 'loss': 6.084413550376892, 'time_step': 0.007250863313674927, 'init_value': 32.30742263793945}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:26.36[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019811358451843264, 'time_algorithm_update': 0.005267216682434082, 'loss': 6.828861904144287, 'time_step': 0.007298664569854736, 'init_value': 39.031211853027344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:26.44[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019884426593780517, 'time_algorithm_update': 0.005266337633132934, 'loss': 7.771674768686294, 'time_step': 0.007305208683013916, 'init_value': 44.1690673828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:26.53[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00197182559967041, 'time_algorithm_update': 0.005241220474243164, 'loss': 8.400222818851471, 'time_step': 0.007262558698654175, 'init_value': 49.254608154296875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:27.02[0m [[32m[1minfo     [0m] [1mFQE_20250505162535: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019760074615478517, 'time_algorithm_update': 0.005241775512695312, 'loss': 9.392875890731812, 'time_step': 0.007267401933670044, 'init_value': 54.986637115478516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.986637115478516
avg return on 5 trajectories of agent10: 964.4040776666667
Episode generator created
[2m2025-05-05 16:27.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:27.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:27.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:27.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:27.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162705[0m
[2m2025-05-05 16:27.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:27.14[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961728572845459, 'time_algorithm_update': 0.005214367151260376, 'loss': 1.6358878723680974, 'time_step': 0.0072251598834991455, 'init_value': 3.8695104122161865}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:27.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019684817790985108, 'time_algorithm_update': 0.005241326570510864, 'loss': 3.946990923047066, 'time_step': 0.007259445667266846, 'init_value': 8.744195938110352}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:27.31[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019650897979736326, 'time_algorithm_update': 0.005227776050567627, 'loss': 4.573918734550476, 'time_step': 0.007242262840270996, 'init_value': 13.983861923217773}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:27.40[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019745678901672364, 'time_algorithm_update': 0.00522865891456604, 'loss': 5.047367131710052, 'time_step': 0.00725304388999939, 'init_value': 20.154802322387695}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:27.49[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968501091003418, 'time_algorithm_update': 0.005225701570510864, 'loss': 5.616186888933182, 'time_step': 0.007243727445602417, 'init_value': 27.0833797454834}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:27.57[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972360610961914, 'time_algorithm_update': 0.005224548101425171, 'loss': 5.934651032686234, 'time_step': 0.007246520280838013, 'init_value': 33.67853927612305}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:28.06[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976702928543091, 'time_algorithm_update': 0.005229628562927246, 'loss': 7.121145271539688, 'time_step': 0.007256533622741699, 'init_value': 39.926429748535156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970229148864746, 'time_algorithm_update': 0.0052318115234375, 'loss': 8.456140496492386, 'time_step': 0.00725189208984375, 'init_value': 44.7410888671875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:28.23[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019735679626464845, 'time_algorithm_update': 0.005226651906967163, 'loss': 8.446469159841538, 'time_step': 0.007250024795532227, 'init_value': 49.167869567871094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:28.32[0m [[32m[1minfo     [0m] [1mFQE_20250505162705: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019650955200195314, 'time_algorithm_update': 0.00520872950553894, 'loss': 9.637037582159042, 'time_step': 0.007223318338394165, 'init_value': 54.87030029296875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.87030029296875
avg return on 5 trajectories of agent11: 941.5698176666666
Episode generator created
[2m2025-05-05 16:28.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:28.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:28.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:28.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:28.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505162835[0m
[2m2025-05-05 16:28.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:28.44[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019625892639160156, 'time_algorithm_update': 0.005199231386184692, 'loss': 1.7046940524876117, 'time_step': 0.007210800170898438, 'init_value': 3.7643468379974365}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:28.53[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019560260772705077, 'time_algorithm_update': 0.005216601848602295, 'loss': 3.834189712524414, 'time_step': 0.007221924304962158, 'init_value': 8.134724617004395}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:29.01[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956376314163208, 'time_algorithm_update': 0.0052128684520721435, 'loss': 4.5753265020847325, 'time_step': 0.007218241930007935, 'init_value': 15.503924369812012}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:29.10[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019637258052825927, 'time_algorithm_update': 0.005219380140304566, 'loss': 5.115987452864647, 'time_step': 0.007232726335525513, 'init_value': 22.27967071533203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:29.19[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963757038116455, 'time_algorithm_update': 0.005230691194534302, 'loss': 5.939495010733604, 'time_step': 0.00724384617805481, 'init_value': 29.56690216064453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:29.27[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001926931381225586, 'time_algorithm_update': 0.00512247896194458, 'loss': 6.298042050361634, 'time_step': 0.007097383260726928, 'init_value': 35.62960433959961}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:29.36[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00194043231010437, 'time_algorithm_update': 0.005151546478271484, 'loss': 6.667208364248276, 'time_step': 0.007141694784164428, 'init_value': 39.41727066040039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:29.44[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019346184730529784, 'time_algorithm_update': 0.005137861251831055, 'loss': 7.2692784221172335, 'time_step': 0.007121251106262207, 'init_value': 43.31880569458008}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:29.53[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019412105083465576, 'time_algorithm_update': 0.005139134168624878, 'loss': 8.257808529138565, 'time_step': 0.0071295170783996584, 'init_value': 47.56773376464844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:30.02[0m [[32m[1minfo     [0m] [1mFQE_20250505162835: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001945136308670044, 'time_algorithm_update': 0.005161985158920288, 'loss': 8.577852930307388, 'time_step': 0.007157701015472412, 'init_value': 52.48645782470703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.48645782470703
avg return on 5 trajectories of agent12: 964.2733320000001
Episode generator created
[2m2025-05-05 16:30.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:30.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:30.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:30.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:30.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163005[0m
[2m2025-05-05 16:30.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:30.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019925117492675783, 'time_algorithm_update': 0.005272074699401856, 'loss': 1.6031429418325425, 'time_step': 0.007314954996109009, 'init_value': 3.9408304691314697}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:30.22[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001987392425537109, 'time_algorithm_update': 0.005243853330612182, 'loss': 4.117760094046592, 'time_step': 0.007281112194061279, 'init_value': 9.082401275634766}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:30.31[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958406925201416, 'time_algorithm_update': 0.005205665588378906, 'loss': 4.908376216769218, 'time_step': 0.007213243961334229, 'init_value': 14.970479011535645}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:30.40[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019545300006866455, 'time_algorithm_update': 0.00518791913986206, 'loss': 5.354259909391403, 'time_step': 0.007191627025604248, 'init_value': 21.255260467529297}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:30.48[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960333585739136, 'time_algorithm_update': 0.005201939821243286, 'loss': 5.664218628406525, 'time_step': 0.007211337804794312, 'init_value': 28.132129669189453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:30.57[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969709873199463, 'time_algorithm_update': 0.005215815305709839, 'loss': 6.354097747087478, 'time_step': 0.007235064029693604, 'init_value': 33.20741271972656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:31.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019610540866851806, 'time_algorithm_update': 0.0052091128826141355, 'loss': 7.027586620569229, 'time_step': 0.0072195823192596435, 'init_value': 38.410369873046875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:31.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019690001010894773, 'time_algorithm_update': 0.005222112417221069, 'loss': 7.2584635534286495, 'time_step': 0.0072410361766815185, 'init_value': 42.766357421875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:31.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019714021682739257, 'time_algorithm_update': 0.005220972776412964, 'loss': 8.171790739536286, 'time_step': 0.007241964340209961, 'init_value': 47.146114349365234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:31.32[0m [[32m[1minfo     [0m] [1mFQE_20250505163005: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019670345783233643, 'time_algorithm_update': 0.005209921836853027, 'loss': 9.25822947216034, 'time_step': 0.00722637677192688, 'init_value': 53.63081741333008}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.63081741333008
avg return on 5 trajectories of agent13: 920.9060826666667
Episode generator created
[2m2025-05-05 16:31.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:31.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:31.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:31.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:31.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163135[0m
[2m2025-05-05 16:31.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:31.44[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971413612365723, 'time_algorithm_update': 0.005206535577774048, 'loss': 1.562686705470085, 'time_step': 0.007227344036102295, 'init_value': 3.370208263397217}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:31.52[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019789609909057616, 'time_algorithm_update': 0.005222078800201416, 'loss': 3.627637729883194, 'time_step': 0.007250696420669556, 'init_value': 8.186819076538086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:32.01[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019659562110900877, 'time_algorithm_update': 0.005222891569137573, 'loss': 4.4252218542099, 'time_step': 0.007238008022308349, 'init_value': 13.904970169067383}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:32.10[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019743726253509523, 'time_algorithm_update': 0.005226410627365112, 'loss': 4.898149297475815, 'time_step': 0.007249860048294067, 'init_value': 20.44325828552246}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:32.18[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971879243850708, 'time_algorithm_update': 0.005226069688796997, 'loss': 5.4462010735273365, 'time_step': 0.007247331619262695, 'init_value': 25.630626678466797}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:32.27[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019734177589416503, 'time_algorithm_update': 0.005227380990982055, 'loss': 5.5462586830854415, 'time_step': 0.007250328063964844, 'init_value': 30.775928497314453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:32.36[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019756343364715576, 'time_algorithm_update': 0.00522911524772644, 'loss': 6.066162888288498, 'time_step': 0.0072540478706359865, 'init_value': 36.025997161865234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:32.45[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019715583324432374, 'time_algorithm_update': 0.005234288215637207, 'loss': 7.515034468650818, 'time_step': 0.007255534887313843, 'init_value': 41.49950408935547}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:32.53[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019714345932006837, 'time_algorithm_update': 0.005220724821090698, 'loss': 8.274217421531677, 'time_step': 0.007241623878479004, 'init_value': 48.23752975463867}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:33.02[0m [[32m[1minfo     [0m] [1mFQE_20250505163135: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019684481620788575, 'time_algorithm_update': 0.005227426528930664, 'loss': 9.78439655971527, 'time_step': 0.007246029138565063, 'init_value': 53.9879035949707}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.9879035949707
avg return on 5 trajectories of agent14: 942.2172873333334
Episode generator created
[2m2025-05-05 16:33.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:33.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:33.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:33.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:33.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163305[0m
[2m2025-05-05 16:33.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:33.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019753272533416747, 'time_algorithm_update': 0.005203986406326294, 'loss': 1.667251107648015, 'time_step': 0.007228325128555298, 'init_value': 3.7765259742736816}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:33.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019649014472961426, 'time_algorithm_update': 0.005211388349533081, 'loss': 3.8005515837669375, 'time_step': 0.0072251675128936765, 'init_value': 8.650012016296387}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:33.31[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973539113998413, 'time_algorithm_update': 0.005219516515731812, 'loss': 4.972359213113784, 'time_step': 0.0072422678470611575, 'init_value': 14.630212783813477}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:33.40[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001974242687225342, 'time_algorithm_update': 0.005234409809112548, 'loss': 5.0257153755426405, 'time_step': 0.0072578761577606205, 'init_value': 20.79849624633789}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:33.49[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019614315032958985, 'time_algorithm_update': 0.005207255840301513, 'loss': 5.439723962068558, 'time_step': 0.007217331171035767, 'init_value': 25.83152198791504}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:33.57[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002004629611968994, 'time_algorithm_update': 0.00527109432220459, 'loss': 6.26880747127533, 'time_step': 0.007326226234436035, 'init_value': 31.79355812072754}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:34.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971451997756958, 'time_algorithm_update': 0.005220409631729126, 'loss': 6.295117357730866, 'time_step': 0.007241228580474854, 'init_value': 35.91009521484375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:34.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019601986408233642, 'time_algorithm_update': 0.005202514171600342, 'loss': 7.343393094062805, 'time_step': 0.007211715698242188, 'init_value': 42.85322952270508}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:34.24[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962254047393799, 'time_algorithm_update': 0.005197627067565918, 'loss': 9.139018154382706, 'time_step': 0.00720900297164917, 'init_value': 49.2729606628418}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:34.32[0m [[32m[1minfo     [0m] [1mFQE_20250505163305: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019699630737304687, 'time_algorithm_update': 0.005204376935958863, 'loss': 9.808726844787598, 'time_step': 0.007223415613174439, 'init_value': 54.599178314208984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.599178314208984
avg return on 5 trajectories of agent15: 954.9487173333333
Episode generator created
[2m2025-05-05 16:34.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:34.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:34.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:34.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:34.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163435[0m
[2m2025-05-05 16:34.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:34.44[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019584629535675047, 'time_algorithm_update': 0.005205259561538696, 'loss': 1.7027728879600763, 'time_step': 0.007212094306945801, 'init_value': 3.5283849239349365}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:34.53[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019669973850250243, 'time_algorithm_update': 0.005221390962600708, 'loss': 4.13542627465725, 'time_step': 0.007237856864929199, 'init_value': 9.367178916931152}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:35.01[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967327833175659, 'time_algorithm_update': 0.005218159675598144, 'loss': 4.8180187885761265, 'time_step': 0.007234462261199951, 'init_value': 15.766552925109863}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:35.10[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958737373352051, 'time_algorithm_update': 0.0052042555809020995, 'loss': 5.225545069694519, 'time_step': 0.007211740493774414, 'init_value': 20.827974319458008}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:35.19[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019671528339385985, 'time_algorithm_update': 0.005224251508712768, 'loss': 5.841372301340103, 'time_step': 0.007240654706954956, 'init_value': 26.22995948791504}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:35.27[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971116781234741, 'time_algorithm_update': 0.005223482847213745, 'loss': 6.231728443264961, 'time_step': 0.007244046926498413, 'init_value': 33.42082595825195}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:35.36[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019621145725250244, 'time_algorithm_update': 0.005213990926742553, 'loss': 6.740707549333572, 'time_step': 0.007225030183792115, 'init_value': 39.144264221191406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:35.45[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963560104370117, 'time_algorithm_update': 0.0052212212085723875, 'loss': 7.702656402826309, 'time_step': 0.007233911752700805, 'init_value': 42.9724006652832}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:35.53[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968247652053833, 'time_algorithm_update': 0.005225717544555664, 'loss': 8.110999491453171, 'time_step': 0.007243112802505493, 'init_value': 47.34346389770508}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:36.02[0m [[32m[1minfo     [0m] [1mFQE_20250505163435: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019669103622436523, 'time_algorithm_update': 0.005223543643951416, 'loss': 8.988540515184402, 'time_step': 0.0072396817207336425, 'init_value': 51.06310272216797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.06310272216797
avg return on 5 trajectories of agent16: 969.99469
Episode generator created
[2m2025-05-05 16:36.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:36.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:36.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:36.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:36.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163605[0m
[2m2025-05-05 16:36.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:36.14[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969446659088135, 'time_algorithm_update': 0.005221551418304444, 'loss': 1.621263538569212, 'time_step': 0.007239694833755493, 'init_value': 3.566041946411133}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:36.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971095561981201, 'time_algorithm_update': 0.0052397997379302974, 'loss': 4.01271515238285, 'time_step': 0.007260529041290284, 'init_value': 8.269651412963867}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:36.32[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964906454086304, 'time_algorithm_update': 0.005228816509246826, 'loss': 4.608444844961166, 'time_step': 0.0072428550720214846, 'init_value': 14.457236289978027}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:36.40[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019704852104187012, 'time_algorithm_update': 0.005234158277511597, 'loss': 5.126203006505966, 'time_step': 0.007254297733306885, 'init_value': 22.358484268188477}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:36.49[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972224235534668, 'time_algorithm_update': 0.0052503511905670165, 'loss': 5.567807955026627, 'time_step': 0.007272274494171143, 'init_value': 28.695215225219727}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:36.58[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019779982566833494, 'time_algorithm_update': 0.005249914646148682, 'loss': 5.989775249958038, 'time_step': 0.007276968240737915, 'init_value': 34.84231185913086}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:37.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019632694721221926, 'time_algorithm_update': 0.0052345204353332515, 'loss': 7.019139146089554, 'time_step': 0.007246938705444336, 'init_value': 41.53187561035156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:37.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975020408630371, 'time_algorithm_update': 0.005254075765609741, 'loss': 7.586460166454315, 'time_step': 0.007278544664382935, 'init_value': 45.54209899902344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:37.24[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019863011837005615, 'time_algorithm_update': 0.005270273208618164, 'loss': 8.403528057575226, 'time_step': 0.007306287527084351, 'init_value': 51.32004928588867}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:37.33[0m [[32m[1minfo     [0m] [1mFQE_20250505163605: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019751343727111817, 'time_algorithm_update': 0.005238152265548706, 'loss': 10.242921785593033, 'time_step': 0.00726301646232605, 'init_value': 55.37110137939453}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.37110137939453
avg return on 5 trajectories of agent17: 931.4177436666668
Episode generator created
[2m2025-05-05 16:37.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:37.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:37.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:37.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:37.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163736[0m
[2m2025-05-05 16:37.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:37.44[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019691455364227294, 'time_algorithm_update': 0.005203166246414185, 'loss': 1.5675854904204607, 'time_step': 0.007221149444580078, 'init_value': 3.5178229808807373}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:37.53[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019625916481018067, 'time_algorithm_update': 0.005217944622039795, 'loss': 3.920553153038025, 'time_step': 0.007229570388793945, 'init_value': 7.6183319091796875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:38.02[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976637363433838, 'time_algorithm_update': 0.00523845100402832, 'loss': 4.635954107284546, 'time_step': 0.007264023542404175, 'init_value': 13.291841506958008}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:38.11[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966437578201294, 'time_algorithm_update': 0.005223296403884888, 'loss': 4.8666562795639035, 'time_step': 0.007239111185073852, 'init_value': 19.852298736572266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:38.19[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970393180847168, 'time_algorithm_update': 0.00522052550315857, 'loss': 5.3865551409721375, 'time_step': 0.007240221500396728, 'init_value': 24.861316680908203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:38.28[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961944580078125, 'time_algorithm_update': 0.005219341039657593, 'loss': 5.936683300971985, 'time_step': 0.007230129480361939, 'init_value': 32.47163009643555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:38.37[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019699907302856445, 'time_algorithm_update': 0.005224582433700562, 'loss': 6.903878115653992, 'time_step': 0.007244143486022949, 'init_value': 38.839599609375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:38.45[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019653916358947756, 'time_algorithm_update': 0.00522383713722229, 'loss': 8.067402480125427, 'time_step': 0.007238263368606567, 'init_value': 43.6456298828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:38.54[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019684202671051026, 'time_algorithm_update': 0.005240274429321289, 'loss': 8.376530230283738, 'time_step': 0.007258357286453247, 'init_value': 48.540435791015625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:39.03[0m [[32m[1minfo     [0m] [1mFQE_20250505163736: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019725039005279543, 'time_algorithm_update': 0.0052369430065155025, 'loss': 9.41839552140236, 'time_step': 0.007258883714675903, 'init_value': 54.09418869018555}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.09418869018555
avg return on 5 trajectories of agent18: 907.5591450000001
Episode generator created
[2m2025-05-05 16:39.06[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:39.06[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:39.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:39.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:39.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505163906[0m
[2m2025-05-05 16:39.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:39.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019255552291870116, 'time_algorithm_update': 0.005129793167114258, 'loss': 1.600182638734579, 'time_step': 0.007102170467376709, 'init_value': 3.7105579376220703}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:39.23[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019339735507965087, 'time_algorithm_update': 0.005149404525756836, 'loss': 4.051776157140732, 'time_step': 0.0071319653987884524, 'init_value': 7.739588260650635}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:39.32[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019384660720825194, 'time_algorithm_update': 0.005159092426300049, 'loss': 4.604886287927628, 'time_step': 0.007146288871765136, 'init_value': 13.464970588684082}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:39.41[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019391024112701417, 'time_algorithm_update': 0.005151856660842896, 'loss': 5.103441529035568, 'time_step': 0.007139795303344727, 'init_value': 20.18212127685547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:39.49[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00192444109916687, 'time_algorithm_update': 0.00512565279006958, 'loss': 5.921547565460205, 'time_step': 0.00709900450706482, 'init_value': 28.25077247619629}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:39.58[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001954932689666748, 'time_algorithm_update': 0.005185125350952148, 'loss': 6.792407074451447, 'time_step': 0.0071890013217926025, 'init_value': 34.413963317871094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:40.06[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019723284244537354, 'time_algorithm_update': 0.005249805688858032, 'loss': 7.2354578976631165, 'time_step': 0.007272153854370117, 'init_value': 40.80651092529297}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:40.15[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961980104446411, 'time_algorithm_update': 0.005241241216659546, 'loss': 8.392908726930619, 'time_step': 0.007253311634063721, 'init_value': 44.765377044677734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:40.24[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961611270904541, 'time_algorithm_update': 0.005213282585144043, 'loss': 9.078919713973999, 'time_step': 0.007224203109741211, 'init_value': 49.05538558959961}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:40.32[0m [[32m[1minfo     [0m] [1mFQE_20250505163906: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019685354232788087, 'time_algorithm_update': 0.005219041585922241, 'loss': 9.887532875061035, 'time_step': 0.007237180948257447, 'init_value': 54.59813690185547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.59813690185547
avg return on 5 trajectories of agent19: 979.384809
Episode generator created
[2m2025-05-05 16:40.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:40.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:40.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:40.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:40.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164036[0m
[2m2025-05-05 16:40.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:40.44[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961815118789673, 'time_algorithm_update': 0.005210706949234009, 'loss': 1.6618713165074588, 'time_step': 0.007221662521362305, 'init_value': 3.247889995574951}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:40.53[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019760849475860594, 'time_algorithm_update': 0.005231955051422119, 'loss': 4.055451257109642, 'time_step': 0.0072573525905609134, 'init_value': 7.8713226318359375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:41.02[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019627726078033448, 'time_algorithm_update': 0.0052125704288482665, 'loss': 4.547537484407425, 'time_step': 0.0072246742248535155, 'init_value': 13.800768852233887}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:41.10[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962980508804321, 'time_algorithm_update': 0.00520074725151062, 'loss': 5.187775621891022, 'time_step': 0.00721237301826477, 'init_value': 20.697751998901367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:41.19[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019579849243164063, 'time_algorithm_update': 0.005197631120681763, 'loss': 5.380156940221786, 'time_step': 0.007204047203063965, 'init_value': 26.928136825561523}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:41.28[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969830274581909, 'time_algorithm_update': 0.005217748403549194, 'loss': 6.0538233442306515, 'time_step': 0.007236924171447754, 'init_value': 32.26250457763672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:41.37[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968423128128052, 'time_algorithm_update': 0.005214654445648194, 'loss': 6.2747051725387575, 'time_step': 0.007232249021530151, 'init_value': 38.133453369140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:41.45[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019672243595123293, 'time_algorithm_update': 0.005217341184616089, 'loss': 7.194583591461182, 'time_step': 0.007233872413635254, 'init_value': 44.17933654785156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:41.54[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019690377712249757, 'time_algorithm_update': 0.005214034557342529, 'loss': 8.690097205400466, 'time_step': 0.007232729434967041, 'init_value': 49.54642868041992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:42.03[0m [[32m[1minfo     [0m] [1mFQE_20250505164036: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019721946716308595, 'time_algorithm_update': 0.005223304748535156, 'loss': 9.15312038898468, 'time_step': 0.007245054244995117, 'init_value': 56.027992248535156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.027992248535156
ave advantage rew: 53.75758666992188, std: 2.110233340963031
avg cum rews: 949.2439203333331, std: 20.53531943434607
Pearson correlation coefficient: 0.303125753366065
Spearman correlation coefficient: 0.35639097744360904
Kendall Tau correlation coefficient: 0.23157894736842105
the best agent: 6, best agent cum rewards: 954.9692986666665
1955
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.018389673673224926
avg return on 5 trajectories of agent0: 964.499889
Episode generator created
[2m2025-05-05 16:42.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:42.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:42.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:42.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:42.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164225[0m
[2m2025-05-05 16:42.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:42.33[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961376190185547, 'time_algorithm_update': 0.005208006620407104, 'loss': 1.6430888188630342, 'time_step': 0.007218058824539185, 'init_value': 3.1411361694335938}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:42.42[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001990150213241577, 'time_algorithm_update': 0.005298697233200074, 'loss': 3.909003482580185, 'time_step': 0.007339270114898682, 'init_value': 7.42265510559082}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:42.51[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019586143493652342, 'time_algorithm_update': 0.0052168300151824954, 'loss': 4.506002830982208, 'time_step': 0.007224825382232666, 'init_value': 14.099576950073242}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:43.00[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019663772583007814, 'time_algorithm_update': 0.005214318990707397, 'loss': 5.044561612606048, 'time_step': 0.0072295405864715575, 'init_value': 19.775407791137695}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:43.08[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958850622177124, 'time_algorithm_update': 0.005203107357025147, 'loss': 5.3072312941551205, 'time_step': 0.007211129903793335, 'init_value': 24.815690994262695}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:43.17[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019619781970977783, 'time_algorithm_update': 0.005228673458099365, 'loss': 5.946337879300118, 'time_step': 0.00724008560180664, 'init_value': 31.13158416748047}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:43.26[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196502423286438, 'time_algorithm_update': 0.0052109801769256595, 'loss': 6.582854851007461, 'time_step': 0.007225389242172241, 'init_value': 35.853736877441406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:43.34[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019551632404327395, 'time_algorithm_update': 0.005205518245697022, 'loss': 7.018177658081055, 'time_step': 0.007209974527359009, 'init_value': 41.271583557128906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:43.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019668307304382326, 'time_algorithm_update': 0.0052213058471679685, 'loss': 8.593168953418731, 'time_step': 0.007237452268600464, 'init_value': 48.25338363647461}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:43.52[0m [[32m[1minfo     [0m] [1mFQE_20250505164225: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966733932495117, 'time_algorithm_update': 0.005218385696411133, 'loss': 8.91911959171295, 'time_step': 0.007234659910202027, 'init_value': 53.13770294189453}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.13770294189453
avg return on 5 trajectories of agent1: 973.1501489999999
Episode generator created
[2m2025-05-05 16:43.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:43.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:43.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:43.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:43.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164355[0m
[2m2025-05-05 16:43.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:44.04[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019456920623779296, 'time_algorithm_update': 0.00518437933921814, 'loss': 1.6415791251808405, 'time_step': 0.007178567886352539, 'init_value': 3.728317975997925}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:44.12[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960681915283203, 'time_algorithm_update': 0.005215428590774536, 'loss': 4.161995458841324, 'time_step': 0.007225214719772339, 'init_value': 9.005602836608887}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:44.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019886915683746337, 'time_algorithm_update': 0.005272783517837524, 'loss': 4.933328936100006, 'time_step': 0.007311793804168701, 'init_value': 14.524383544921875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:44.30[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019532203674316405, 'time_algorithm_update': 0.005204429388046264, 'loss': 5.5609948801994324, 'time_step': 0.0072065024375915524, 'init_value': 20.918180465698242}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:44.38[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001955869436264038, 'time_algorithm_update': 0.005216094255447387, 'loss': 5.7126938393116, 'time_step': 0.007221222162246704, 'init_value': 25.844924926757812}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:44.47[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958026647567749, 'time_algorithm_update': 0.005213754653930664, 'loss': 6.29760067653656, 'time_step': 0.007221041917800903, 'init_value': 32.76172637939453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:44.56[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019512362480163575, 'time_algorithm_update': 0.005197877883911133, 'loss': 7.124581362009049, 'time_step': 0.00719762110710144, 'init_value': 38.92595672607422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:45.04[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959373474121094, 'time_algorithm_update': 0.005202688217163086, 'loss': 7.7117627658844, 'time_step': 0.007210924625396729, 'init_value': 43.99556350708008}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:45.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019647600650787352, 'time_algorithm_update': 0.005210856914520264, 'loss': 8.124621669769287, 'time_step': 0.007224898099899292, 'init_value': 49.83809280395508}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:45.22[0m [[32m[1minfo     [0m] [1mFQE_20250505164355: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964045286178589, 'time_algorithm_update': 0.005207583665847778, 'loss': 9.483448565721512, 'time_step': 0.007220824241638183, 'init_value': 55.06349182128906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.06349182128906
avg return on 5 trajectories of agent2: 975.8388533333333
Episode generator created
[2m2025-05-05 16:45.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:45.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:45.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:45.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:45.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164525[0m
[2m2025-05-05 16:45.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:45.34[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019622375965118407, 'time_algorithm_update': 0.005224623918533325, 'loss': 1.7261503857523204, 'time_step': 0.007235815525054931, 'init_value': 4.294524669647217}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:45.42[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019674508571624755, 'time_algorithm_update': 0.005224376916885376, 'loss': 4.13092412018776, 'time_step': 0.007240813493728637, 'init_value': 9.670783042907715}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:45.51[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019625303745269777, 'time_algorithm_update': 0.005230066776275635, 'loss': 4.821541159629822, 'time_step': 0.007241643190383911, 'init_value': 16.002796173095703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:46.00[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973886489868164, 'time_algorithm_update': 0.005244230031967163, 'loss': 5.455063847780227, 'time_step': 0.007267486810684204, 'init_value': 22.798274993896484}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:46.08[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965675354003906, 'time_algorithm_update': 0.005247143268585205, 'loss': 5.9696348943710325, 'time_step': 0.007262144088745117, 'init_value': 28.26512336730957}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:46.17[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019774065017700193, 'time_algorithm_update': 0.005240075588226319, 'loss': 6.394052826881409, 'time_step': 0.007266547203063965, 'init_value': 34.726417541503906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:46.26[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019653005599975584, 'time_algorithm_update': 0.005241364240646362, 'loss': 6.877874138832092, 'time_step': 0.0072558434009552, 'init_value': 39.64088439941406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:46.35[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019692943096160887, 'time_algorithm_update': 0.005237492084503173, 'loss': 7.996180079221725, 'time_step': 0.00725594711303711, 'init_value': 45.87716293334961}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:46.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019666855335235597, 'time_algorithm_update': 0.0052293379306793215, 'loss': 8.992531956672668, 'time_step': 0.007245382070541382, 'init_value': 52.821983337402344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:46.52[0m [[32m[1minfo     [0m] [1mFQE_20250505164525: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969346284866333, 'time_algorithm_update': 0.005233601808547973, 'loss': 10.11580001115799, 'time_step': 0.00725238561630249, 'init_value': 56.425350189208984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.425350189208984
avg return on 5 trajectories of agent3: 983.3191246666665
Episode generator created
[2m2025-05-05 16:46.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:46.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:46.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:46.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:46.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164655[0m
[2m2025-05-05 16:46.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:47.04[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019549551010131835, 'time_algorithm_update': 0.005197698831558227, 'loss': 1.6667991201728583, 'time_step': 0.0072012777328491215, 'init_value': 4.115530490875244}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:47.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019512608051300048, 'time_algorithm_update': 0.005193975448608399, 'loss': 4.124354518175125, 'time_step': 0.007194001436233521, 'init_value': 9.779365539550781}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:47.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962019205093384, 'time_algorithm_update': 0.00521488904953003, 'loss': 4.816704996824265, 'time_step': 0.007226075887680054, 'init_value': 14.823369979858398}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:47.30[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019629287719726564, 'time_algorithm_update': 0.005222391843795776, 'loss': 5.054814739704132, 'time_step': 0.00723442554473877, 'init_value': 21.287790298461914}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:47.39[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019558484554290773, 'time_algorithm_update': 0.0052081670761108395, 'loss': 5.301550611257553, 'time_step': 0.0072130424976348875, 'init_value': 27.010839462280273}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:47.47[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019748916625976563, 'time_algorithm_update': 0.005246953248977661, 'loss': 5.995593818902969, 'time_step': 0.0072717776298522946, 'init_value': 32.77475357055664}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:47.56[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007610559463501, 'time_algorithm_update': 0.0053129644393920894, 'loss': 6.928859752178192, 'time_step': 0.00737167477607727, 'init_value': 38.85277557373047}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:48.05[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019619827270507813, 'time_algorithm_update': 0.005213184356689453, 'loss': 8.151775438308716, 'time_step': 0.0072244873046875, 'init_value': 45.786895751953125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:48.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959902286529541, 'time_algorithm_update': 0.005205243110656738, 'loss': 8.670626802444458, 'time_step': 0.007214571475982666, 'init_value': 50.793113708496094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:48.22[0m [[32m[1minfo     [0m] [1mFQE_20250505164655: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019573261737823484, 'time_algorithm_update': 0.005208795309066773, 'loss': 9.711989122390747, 'time_step': 0.007215530872344971, 'init_value': 55.566341400146484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.566341400146484
avg return on 5 trajectories of agent4: 946.9530166666667
Episode generator created
[2m2025-05-05 16:48.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:48.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:48.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:48.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:48.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164825[0m
[2m2025-05-05 16:48.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:48.34[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956678867340088, 'time_algorithm_update': 0.005193275451660156, 'loss': 1.566680151388049, 'time_step': 0.007198639154434204, 'init_value': 3.2588720321655273}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:48.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965399742126465, 'time_algorithm_update': 0.005215842247009278, 'loss': 3.8460685040950775, 'time_step': 0.0072301807403564455, 'init_value': 8.702025413513184}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:48.51[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969923257827759, 'time_algorithm_update': 0.005222709655761719, 'loss': 4.694982747077942, 'time_step': 0.007241862058639526, 'init_value': 14.76605224609375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:49.00[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001920222282409668, 'time_algorithm_update': 0.005136575222015381, 'loss': 5.193793702840805, 'time_step': 0.007104148149490356, 'init_value': 21.81690216064453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:49.09[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019350597858428956, 'time_algorithm_update': 0.005141440629959106, 'loss': 5.930529858112335, 'time_step': 0.0071254377365112306, 'init_value': 28.726709365844727}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:49.17[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001941889762878418, 'time_algorithm_update': 0.005157670021057129, 'loss': 6.359857133626938, 'time_step': 0.007148094415664673, 'init_value': 34.54481506347656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:49.26[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001945521354675293, 'time_algorithm_update': 0.005143187046051025, 'loss': 6.802067793369293, 'time_step': 0.007137682914733887, 'init_value': 38.82042694091797}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:49.34[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019374761581420897, 'time_algorithm_update': 0.00514147162437439, 'loss': 7.128380743503571, 'time_step': 0.007127701997756958, 'init_value': 43.06392288208008}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:49.43[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019586515426635743, 'time_algorithm_update': 0.00517703914642334, 'loss': 7.665697813987732, 'time_step': 0.007184264421463013, 'init_value': 46.98728942871094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:49.52[0m [[32m[1minfo     [0m] [1mFQE_20250505164825: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196976900100708, 'time_algorithm_update': 0.005220505237579345, 'loss': 8.560143919706345, 'time_step': 0.007239874839782715, 'init_value': 50.98478317260742}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.98478317260742
avg return on 5 trajectories of agent5: 957.1770276666666
Episode generator created
[2m2025-05-05 16:49.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:49.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:49.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:49.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:49.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505164955[0m
[2m2025-05-05 16:49.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:50.03[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196155047416687, 'time_algorithm_update': 0.0052121331691741945, 'loss': 1.7007551260739564, 'time_step': 0.007222119092941284, 'init_value': 3.9879658222198486}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:50.12[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958770513534546, 'time_algorithm_update': 0.0051904599666595455, 'loss': 3.988477563261986, 'time_step': 0.007197933197021484, 'init_value': 8.71847915649414}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:50.21[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019619622230529787, 'time_algorithm_update': 0.005207440137863159, 'loss': 4.864665058374405, 'time_step': 0.00721843957901001, 'init_value': 15.45257568359375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:50.29[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019677743911743163, 'time_algorithm_update': 0.005209392309188843, 'loss': 5.364894984602929, 'time_step': 0.007226362466812134, 'init_value': 21.591066360473633}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:50.38[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019597535133361816, 'time_algorithm_update': 0.005203612089157104, 'loss': 5.789000908136368, 'time_step': 0.007212099075317383, 'init_value': 28.070871353149414}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:50.47[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019666483402252196, 'time_algorithm_update': 0.005224164724349976, 'loss': 6.346928241729736, 'time_step': 0.007240653991699219, 'init_value': 34.214420318603516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:50.56[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960078716278076, 'time_algorithm_update': 0.005206769704818726, 'loss': 6.91530814909935, 'time_step': 0.007215510368347168, 'init_value': 39.27886962890625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:51.04[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019668872356414795, 'time_algorithm_update': 0.005205350160598755, 'loss': 7.326234606266022, 'time_step': 0.0072208731174468995, 'init_value': 44.3311767578125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:51.13[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019765918254852294, 'time_algorithm_update': 0.00521567440032959, 'loss': 8.797927263259888, 'time_step': 0.007241442680358887, 'init_value': 51.1701774597168}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:51.22[0m [[32m[1minfo     [0m] [1mFQE_20250505164955: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019858767986297605, 'time_algorithm_update': 0.005250227451324463, 'loss': 9.741683351278304, 'time_step': 0.007286077499389649, 'init_value': 54.490657806396484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.490657806396484
avg return on 5 trajectories of agent6: 972.6685783333334
Episode generator created
[2m2025-05-05 16:51.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:51.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:51.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:51.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:51.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165125[0m
[2m2025-05-05 16:51.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:51.34[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019511537551879883, 'time_algorithm_update': 0.0052014274597167965, 'loss': 1.6518091881424188, 'time_step': 0.00720117712020874, 'init_value': 3.789518356323242}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:51.42[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958815336227417, 'time_algorithm_update': 0.0052155983448028565, 'loss': 4.042411296606064, 'time_step': 0.007223350286483765, 'init_value': 8.70506763458252}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:51.51[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019645252227783205, 'time_algorithm_update': 0.0052316591739654545, 'loss': 4.9188634135723115, 'time_step': 0.007245195627212524, 'init_value': 14.778240203857422}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:52.00[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019632847309112547, 'time_algorithm_update': 0.0052148463726043705, 'loss': 5.266112530231476, 'time_step': 0.007226660013198853, 'init_value': 22.07154655456543}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:52.08[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019639480113983155, 'time_algorithm_update': 0.005217642307281494, 'loss': 5.944829222679139, 'time_step': 0.0072305748462677, 'init_value': 28.842187881469727}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:52.17[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019576458930969237, 'time_algorithm_update': 0.005226057529449463, 'loss': 6.432297960758209, 'time_step': 0.0072325546741485594, 'init_value': 35.471614837646484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:52.26[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959022760391235, 'time_algorithm_update': 0.005215135574340821, 'loss': 7.6136762268543245, 'time_step': 0.007223363637924194, 'init_value': 42.809112548828125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:52.35[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019672744274139404, 'time_algorithm_update': 0.005226295232772827, 'loss': 8.171792840480805, 'time_step': 0.007243000984191895, 'init_value': 47.746360778808594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:52.43[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001968507766723633, 'time_algorithm_update': 0.005238206386566162, 'loss': 9.336725608587265, 'time_step': 0.007255822658538818, 'init_value': 54.61408233642578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:52.52[0m [[32m[1minfo     [0m] [1mFQE_20250505165125: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019646756649017334, 'time_algorithm_update': 0.005222522974014282, 'loss': 9.885077262163163, 'time_step': 0.007236084461212158, 'init_value': 56.46890640258789}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.46890640258789
avg return on 5 trajectories of agent7: 943.6261896666666
Episode generator created
[2m2025-05-05 16:52.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:52.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:52.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:52.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:52.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165255[0m
[2m2025-05-05 16:52.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:53.04[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019639437198638917, 'time_algorithm_update': 0.0052085604667663574, 'loss': 1.659935141161084, 'time_step': 0.007221264600753784, 'init_value': 3.526111364364624}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:53.12[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966604471206665, 'time_algorithm_update': 0.0052151458263397215, 'loss': 3.8319027678966524, 'time_step': 0.007230489730834961, 'init_value': 8.027233123779297}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:53.21[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963642358779907, 'time_algorithm_update': 0.005213672161102295, 'loss': 4.530787767648697, 'time_step': 0.007226076602935791, 'init_value': 13.570423126220703}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:53.30[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019718251228332518, 'time_algorithm_update': 0.005232589483261108, 'loss': 5.1478141403198245, 'time_step': 0.007253386259078979, 'init_value': 20.44632911682129}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:53.38[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001962353229522705, 'time_algorithm_update': 0.005230845212936402, 'loss': 5.730917883396149, 'time_step': 0.007241737365722656, 'init_value': 27.289579391479492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:53.47[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019668405055999756, 'time_algorithm_update': 0.005233233690261841, 'loss': 6.045997876882553, 'time_step': 0.007249482870101929, 'init_value': 33.735836029052734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:53.56[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019654839038848876, 'time_algorithm_update': 0.005229264497756958, 'loss': 6.674575207948685, 'time_step': 0.007243898630142212, 'init_value': 39.17860412597656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:54.05[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019743967056274413, 'time_algorithm_update': 0.005240718364715576, 'loss': 7.332931225776672, 'time_step': 0.007264333963394165, 'init_value': 42.12902069091797}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:54.13[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019675683975219726, 'time_algorithm_update': 0.005217204093933106, 'loss': 8.672240367889405, 'time_step': 0.007234132289886475, 'init_value': 48.83824920654297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:54.22[0m [[32m[1minfo     [0m] [1mFQE_20250505165255: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019657304286956785, 'time_algorithm_update': 0.005230849742889405, 'loss': 9.596472957611084, 'time_step': 0.007245856523513794, 'init_value': 54.826480865478516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.826480865478516
avg return on 5 trajectories of agent8: 939.5053159999999
Episode generator created
[2m2025-05-05 16:54.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:54.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:54.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:54.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:54.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165425[0m
[2m2025-05-05 16:54.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:54.34[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019586260318756104, 'time_algorithm_update': 0.005224164485931397, 'loss': 1.5329152511507274, 'time_step': 0.007232353925704956, 'init_value': 3.296234130859375}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:54.43[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001956700325012207, 'time_algorithm_update': 0.0052049696445465084, 'loss': 3.6832774121761322, 'time_step': 0.007210850238800049, 'init_value': 7.707754611968994}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:54.51[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019901437759399414, 'time_algorithm_update': 0.005278241157531738, 'loss': 4.5106526672840115, 'time_step': 0.007319069862365722, 'init_value': 12.998866081237793}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:55.00[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967676877975464, 'time_algorithm_update': 0.005217639207839966, 'loss': 4.940852866172791, 'time_step': 0.007234679937362671, 'init_value': 18.99969482421875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:55.09[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196482515335083, 'time_algorithm_update': 0.005214934349060059, 'loss': 5.159045426607132, 'time_step': 0.00722925853729248, 'init_value': 23.172840118408203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:55.17[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969020366668701, 'time_algorithm_update': 0.005235717058181762, 'loss': 5.443002213358879, 'time_step': 0.007254738569259644, 'init_value': 28.987071990966797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:55.26[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967304468154907, 'time_algorithm_update': 0.005234524011611939, 'loss': 6.266804761648178, 'time_step': 0.007251834392547608, 'init_value': 35.03628921508789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:55.35[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196469521522522, 'time_algorithm_update': 0.005215588808059692, 'loss': 7.072865663528442, 'time_step': 0.00722966480255127, 'init_value': 40.205230712890625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:55.44[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971580982208252, 'time_algorithm_update': 0.005231630086898803, 'loss': 8.060902702093124, 'time_step': 0.007253242254257202, 'init_value': 45.864810943603516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:55.52[0m [[32m[1minfo     [0m] [1mFQE_20250505165425: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001970319747924805, 'time_algorithm_update': 0.00523244047164917, 'loss': 8.05093636226654, 'time_step': 0.007252576828002929, 'init_value': 49.541099548339844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 49.541099548339844
avg return on 5 trajectories of agent9: 924.6528910000001
Episode generator created
[2m2025-05-05 16:55.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:55.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:55.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:55.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:55.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165555[0m
[2m2025-05-05 16:55.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:56.04[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019700889587402344, 'time_algorithm_update': 0.005231737613677978, 'loss': 1.7023606651872396, 'time_step': 0.007250986337661743, 'init_value': 3.881535768508911}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:56.13[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019678966999053956, 'time_algorithm_update': 0.005219400644302368, 'loss': 3.9747832262516023, 'time_step': 0.007236487865447998, 'init_value': 8.245244979858398}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:56.22[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019697809219360353, 'time_algorithm_update': 0.005234276294708252, 'loss': 4.757219097256661, 'time_step': 0.007253389358520507, 'init_value': 14.662703514099121}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:56.30[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966318368911743, 'time_algorithm_update': 0.005212796211242676, 'loss': 5.17331009554863, 'time_step': 0.007228130102157592, 'init_value': 20.232070922851562}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:56.39[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019745032787322997, 'time_algorithm_update': 0.005230292320251465, 'loss': 5.275037271380424, 'time_step': 0.007254369974136352, 'init_value': 26.55046844482422}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:56.48[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001973775863647461, 'time_algorithm_update': 0.005235382795333862, 'loss': 5.870103897571564, 'time_step': 0.007258850574493408, 'init_value': 30.964330673217773}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:56.56[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019702329635620116, 'time_algorithm_update': 0.005220149278640747, 'loss': 6.551981534957886, 'time_step': 0.007239814281463623, 'init_value': 37.349544525146484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:57.05[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019684746265411376, 'time_algorithm_update': 0.005227406024932862, 'loss': 7.596804254293442, 'time_step': 0.00724565601348877, 'init_value': 42.399505615234375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:57.14[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001975485324859619, 'time_algorithm_update': 0.005224633693695069, 'loss': 8.28307549571991, 'time_step': 0.007249869585037231, 'init_value': 50.14921188354492}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:57.23[0m [[32m[1minfo     [0m] [1mFQE_20250505165555: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019645998477935793, 'time_algorithm_update': 0.005217052936553955, 'loss': 10.129709218978881, 'time_step': 0.00723127031326294, 'init_value': 54.262474060058594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.262474060058594
avg return on 5 trajectories of agent10: 969.8904673333333
Episode generator created
[2m2025-05-05 16:57.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:57.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:57.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:57.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:57.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165726[0m
[2m2025-05-05 16:57.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:57.34[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971679210662842, 'time_algorithm_update': 0.005219440698623657, 'loss': 1.6412405119985343, 'time_step': 0.007240185976028443, 'init_value': 3.6556732654571533}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:57.43[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019661672115325927, 'time_algorithm_update': 0.0052235786914825435, 'loss': 3.9309142805337904, 'time_step': 0.007239464998245239, 'init_value': 8.255226135253906}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:57.52[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019520430564880372, 'time_algorithm_update': 0.005203022718429566, 'loss': 4.67272461104393, 'time_step': 0.007203745126724243, 'init_value': 13.408864974975586}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:58.01[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019643018245697023, 'time_algorithm_update': 0.005208033323287964, 'loss': 5.0960383554697035, 'time_step': 0.007221340894699097, 'init_value': 20.26969337463379}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:58.09[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001966217279434204, 'time_algorithm_update': 0.005213093042373657, 'loss': 5.436501036643982, 'time_step': 0.0072284314632415775, 'init_value': 27.01030731201172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:58.18[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001978286266326904, 'time_algorithm_update': 0.0052489984035491944, 'loss': 5.921606502532959, 'time_step': 0.0072835440635681155, 'init_value': 32.85192108154297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:58.27[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019857118129730225, 'time_algorithm_update': 0.0052552554607391356, 'loss': 6.710533159255982, 'time_step': 0.007290584087371826, 'init_value': 39.96527862548828}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 16:58.35[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019735643863677977, 'time_algorithm_update': 0.005230728149414062, 'loss': 7.800697231531143, 'time_step': 0.007253605127334595, 'init_value': 44.058204650878906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 16:58.44[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019258878231048584, 'time_algorithm_update': 0.005141182899475098, 'loss': 7.995999735116959, 'time_step': 0.007114915609359741, 'init_value': 48.785179138183594}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 16:58.53[0m [[32m[1minfo     [0m] [1mFQE_20250505165726: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019390013217926026, 'time_algorithm_update': 0.005149448871612549, 'loss': 9.203378437042236, 'time_step': 0.007137425184249878, 'init_value': 51.894744873046875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.894744873046875
avg return on 5 trajectories of agent11: 925.795796
Episode generator created
[2m2025-05-05 16:58.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 16:58.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 16:58.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 16:58.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 16:58.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505165856[0m
[2m2025-05-05 16:58.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 16:59.04[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019285454750061035, 'time_algorithm_update': 0.005128718614578247, 'loss': 1.6031189418882132, 'time_step': 0.007105571746826172, 'init_value': 3.9148802757263184}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 16:59.13[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019285774230957031, 'time_algorithm_update': 0.005120875835418701, 'loss': 3.658526963710785, 'time_step': 0.007097623109817505, 'init_value': 8.366113662719727}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 16:59.21[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001933342695236206, 'time_algorithm_update': 0.005140539407730103, 'loss': 4.468577676177025, 'time_step': 0.007122836828231812, 'init_value': 15.553712844848633}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 16:59.30[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019729704856872557, 'time_algorithm_update': 0.005226991891860962, 'loss': 5.383883763074875, 'time_step': 0.007249013900756836, 'init_value': 22.196876525878906}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 16:59.39[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019773714542388916, 'time_algorithm_update': 0.0052324378490448, 'loss': 5.454933218955993, 'time_step': 0.007259345531463623, 'init_value': 28.02385711669922}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 16:59.48[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001972902774810791, 'time_algorithm_update': 0.005226351737976074, 'loss': 5.871445563316345, 'time_step': 0.007248766422271728, 'init_value': 32.696441650390625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 16:59.56[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001965949773788452, 'time_algorithm_update': 0.005213573694229126, 'loss': 6.344461456775665, 'time_step': 0.007228562593460083, 'init_value': 39.692962646484375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:00.05[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001976205587387085, 'time_algorithm_update': 0.005237875938415527, 'loss': 8.175207972049714, 'time_step': 0.007263443470001221, 'init_value': 48.3348388671875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:00.14[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196816611289978, 'time_algorithm_update': 0.005223615646362305, 'loss': 8.73253568315506, 'time_step': 0.007241355657577515, 'init_value': 52.5224609375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:00.22[0m [[32m[1minfo     [0m] [1mFQE_20250505165856: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00196705961227417, 'time_algorithm_update': 0.005214888095855713, 'loss': 10.17822230219841, 'time_step': 0.007231331110000611, 'init_value': 56.917930603027344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.917930603027344
avg return on 5 trajectories of agent12: 993.9879413333333
Episode generator created
[2m2025-05-05 17:00.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:00.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:00.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:00.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:00.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170026[0m
[2m2025-05-05 17:00.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:00.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019560515880584716, 'time_algorithm_update': 0.005217528820037841, 'loss': 1.5593243768960237, 'time_step': 0.0072230536937713625, 'init_value': 3.6271417140960693}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:00.43[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019634833335876465, 'time_algorithm_update': 0.005221388101577759, 'loss': 3.9434644721746444, 'time_step': 0.007234290838241577, 'init_value': 8.430014610290527}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:00.52[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967620849609375, 'time_algorithm_update': 0.005212603569030761, 'loss': 4.5352543779611585, 'time_step': 0.007229561328887939, 'init_value': 13.172431945800781}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:01.00[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019773879051208495, 'time_algorithm_update': 0.00522302770614624, 'loss': 4.97383128285408, 'time_step': 0.00724998688697815, 'init_value': 19.040451049804688}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:01.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019762816429138184, 'time_algorithm_update': 0.005221591472625732, 'loss': 5.2134341280460355, 'time_step': 0.007247233629226684, 'init_value': 24.29963493347168}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:01.18[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001969456911087036, 'time_algorithm_update': 0.005230217933654785, 'loss': 5.432292849063873, 'time_step': 0.007248920679092407, 'init_value': 29.49165916442871}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:01.26[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971747875213623, 'time_algorithm_update': 0.005227128982543946, 'loss': 5.845495351552963, 'time_step': 0.007248119354248047, 'init_value': 34.203033447265625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:01.35[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019735238552093504, 'time_algorithm_update': 0.005217525720596313, 'loss': 6.81385733628273, 'time_step': 0.007241070747375488, 'init_value': 41.29265213012695}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:01.44[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019922959804534912, 'time_algorithm_update': 0.005263152837753296, 'loss': 8.477135734319686, 'time_step': 0.007305831909179688, 'init_value': 47.82865524291992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:01.53[0m [[32m[1minfo     [0m] [1mFQE_20250505170026: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020026984214782714, 'time_algorithm_update': 0.00528178071975708, 'loss': 9.108343396902084, 'time_step': 0.007335107564926147, 'init_value': 54.28806686401367}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.28806686401367
avg return on 5 trajectories of agent13: 982.6476453333333
Episode generator created
[2m2025-05-05 17:01.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:01.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:01.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:01.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:01.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170156[0m
[2m2025-05-05 17:01.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:02.05[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019678239822387695, 'time_algorithm_update': 0.005233729839324951, 'loss': 1.633935233414173, 'time_step': 0.007251078367233276, 'init_value': 3.4845242500305176}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:02.13[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019538910388946533, 'time_algorithm_update': 0.0051991729736328126, 'loss': 4.008134651064872, 'time_step': 0.007201731204986572, 'init_value': 9.21718978881836}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:02.22[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001964765548706055, 'time_algorithm_update': 0.005213028192520142, 'loss': 4.41662529039383, 'time_step': 0.00722718071937561, 'init_value': 13.957427978515625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:02.31[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019699528217315674, 'time_algorithm_update': 0.005209412097930908, 'loss': 4.982590643644333, 'time_step': 0.007228389501571655, 'init_value': 20.130043029785156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:02.39[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958369493484497, 'time_algorithm_update': 0.005204801559448242, 'loss': 5.696211823821068, 'time_step': 0.0072120015621185305, 'init_value': 26.596586227416992}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:02.48[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967047929763794, 'time_algorithm_update': 0.005220199584960937, 'loss': 5.982411638736725, 'time_step': 0.007236723184585571, 'init_value': 31.219446182250977}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:02.57[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001961383581161499, 'time_algorithm_update': 0.005211758136749268, 'loss': 7.025544343233109, 'time_step': 0.007222246408462524, 'init_value': 38.07280349731445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:03.05[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019631035327911375, 'time_algorithm_update': 0.005199549436569214, 'loss': 7.836050180435181, 'time_step': 0.00721134877204895, 'init_value': 42.793724060058594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:03.14[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001960979700088501, 'time_algorithm_update': 0.005195971250534058, 'loss': 8.675417784929275, 'time_step': 0.007205775022506714, 'init_value': 49.17335891723633}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:03.23[0m [[32m[1minfo     [0m] [1mFQE_20250505170156: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019663221836090086, 'time_algorithm_update': 0.005209160566329956, 'loss': 9.072335091590881, 'time_step': 0.007224774360656739, 'init_value': 54.398555755615234}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.398555755615234
avg return on 5 trajectories of agent14: 952.1316656666667
Episode generator created
[2m2025-05-05 17:03.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:03.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:03.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:03.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:03.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170326[0m
[2m2025-05-05 17:03.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:03.35[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001958324432373047, 'time_algorithm_update': 0.005193257093429565, 'loss': 1.682103150755167, 'time_step': 0.007200461149215698, 'init_value': 3.6480448246002197}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:03.43[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001959506034851074, 'time_algorithm_update': 0.0052173399925231935, 'loss': 4.107919926643372, 'time_step': 0.007226005554199218, 'init_value': 9.594803810119629}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:03.52[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001967161417007446, 'time_algorithm_update': 0.005232783079147339, 'loss': 4.700431049823761, 'time_step': 0.0072495734691619875, 'init_value': 14.895450592041016}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:04.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019651293754577638, 'time_algorithm_update': 0.005231105566024781, 'loss': 5.26023167681694, 'time_step': 0.007245561122894287, 'init_value': 21.399503707885742}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:04.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001971844434738159, 'time_algorithm_update': 0.00522993016242981, 'loss': 5.386311021566391, 'time_step': 0.007251242876052857, 'init_value': 26.622745513916016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:04.18[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019677281379699707, 'time_algorithm_update': 0.0052381610870361325, 'loss': 6.02118837916851, 'time_step': 0.007255441665649414, 'init_value': 31.788599014282227}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:04.27[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001963959455490112, 'time_algorithm_update': 0.005220046043395996, 'loss': 6.477022705793381, 'time_step': 0.007233290672302246, 'init_value': 37.991180419921875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:04.35[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019616637229919434, 'time_algorithm_update': 0.005215740919113159, 'loss': 7.372929758310318, 'time_step': 0.007226855754852295, 'init_value': 43.51025390625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:04.44[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002007209062576294, 'time_algorithm_update': 0.005345519065856934, 'loss': 7.659459055185318, 'time_step': 0.007403013467788697, 'init_value': 46.2900390625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:04.53[0m [[32m[1minfo     [0m] [1mFQE_20250505170326: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051659345626831, 'time_algorithm_update': 0.005469229936599732, 'loss': 9.009205038785934, 'time_step': 0.007573206901550293, 'init_value': 50.93144226074219}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.93144226074219
avg return on 5 trajectories of agent15: 968.1693329999999
Episode generator created
[2m2025-05-05 17:04.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:04.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:04.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:04.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:04.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170457[0m
[2m2025-05-05 17:04.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:05.06[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020527613162994386, 'time_algorithm_update': 0.0054721243381500246, 'loss': 1.5884784546345472, 'time_step': 0.007576777696609497, 'init_value': 3.992945909500122}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:05.15[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065335750579834, 'time_algorithm_update': 0.00549134635925293, 'loss': 4.182836493253708, 'time_step': 0.007609041929244995, 'init_value': 8.363630294799805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:05.24[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059306859970093, 'time_algorithm_update': 0.005466951608657837, 'loss': 4.798498703241348, 'time_step': 0.007578528642654419, 'init_value': 13.680316925048828}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:05.33[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020445613861083986, 'time_algorithm_update': 0.0054312715530395505, 'loss': 5.338213844537735, 'time_step': 0.007526891469955444, 'init_value': 21.169761657714844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:05.42[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020497510433197023, 'time_algorithm_update': 0.0054362313747406, 'loss': 5.919027659893036, 'time_step': 0.007537384033203125, 'init_value': 27.595382690429688}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:05.51[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020427556037902832, 'time_algorithm_update': 0.005444343090057373, 'loss': 6.344004377603531, 'time_step': 0.007538859844207764, 'init_value': 33.13417053222656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:06.00[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039914131164551, 'time_algorithm_update': 0.0054405853748321535, 'loss': 7.351780768632889, 'time_step': 0.007532254934310913, 'init_value': 39.43342590332031}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:06.09[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051891565322876, 'time_algorithm_update': 0.005445783376693726, 'loss': 7.779866928577423, 'time_step': 0.007549211740493774, 'init_value': 45.51250457763672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:06.18[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020499598979949953, 'time_algorithm_update': 0.00543634033203125, 'loss': 8.598723436355591, 'time_step': 0.007537917852401733, 'init_value': 49.558135986328125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:06.27[0m [[32m[1minfo     [0m] [1mFQE_20250505170457: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451509952545167, 'time_algorithm_update': 0.005441825628280639, 'loss': 9.207827296257019, 'time_step': 0.007538326025009155, 'init_value': 54.25942611694336}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.25942611694336
avg return on 5 trajectories of agent16: 985.3078276666666
Episode generator created
[2m2025-05-05 17:06.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:06.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:06.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:06.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:06.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170630[0m
[2m2025-05-05 17:06.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:06.39[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020332658290863038, 'time_algorithm_update': 0.005428086042404175, 'loss': 1.6738503314852715, 'time_step': 0.0075123472213745116, 'init_value': 3.9495723247528076}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:06.48[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038273811340332, 'time_algorithm_update': 0.00543326473236084, 'loss': 3.977785732746124, 'time_step': 0.007522272825241089, 'init_value': 8.564453125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:06.58[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020538179874420165, 'time_algorithm_update': 0.005451388359069824, 'loss': 4.658717213630676, 'time_step': 0.007556894779205322, 'init_value': 13.732837677001953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:07.07[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062579870223999, 'time_algorithm_update': 0.005453121185302734, 'loss': 4.987872656583786, 'time_step': 0.0075673491954803464, 'init_value': 19.2884521484375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:07.16[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049527645111084, 'time_algorithm_update': 0.0054475417137146, 'loss': 5.419956890344619, 'time_step': 0.007548832178115845, 'init_value': 26.636337280273438}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:07.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020586175918579103, 'time_algorithm_update': 0.005462225675582886, 'loss': 6.262301428079605, 'time_step': 0.007572422027587891, 'init_value': 32.52633285522461}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:07.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020475823879241946, 'time_algorithm_update': 0.005447265386581421, 'loss': 6.799562946557999, 'time_step': 0.007546333312988282, 'init_value': 39.24319076538086}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:07.43[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051487684249878, 'time_algorithm_update': 0.005445895433425904, 'loss': 7.58599493598938, 'time_step': 0.0075491783618927, 'init_value': 43.833152770996094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:07.52[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057898759841919, 'time_algorithm_update': 0.005451297998428345, 'loss': 8.546638308525086, 'time_step': 0.0075613527297973635, 'init_value': 49.490211486816406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:08.01[0m [[32m[1minfo     [0m] [1mFQE_20250505170630: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553205013275145, 'time_algorithm_update': 0.0054604773521423336, 'loss': 10.189884674787521, 'time_step': 0.007568045854568482, 'init_value': 53.00045394897461}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.00045394897461
avg return on 5 trajectories of agent17: 927.4604513333334
Episode generator created
[2m2025-05-05 17:08.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:08.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:08.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:08.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:08.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170804[0m
[2m2025-05-05 17:08.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:08.13[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020371727943420412, 'time_algorithm_update': 0.00540888786315918, 'loss': 1.6470224873572588, 'time_step': 0.007496755599975586, 'init_value': 4.281503677368164}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:08.22[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020495474338531492, 'time_algorithm_update': 0.0054377131462097165, 'loss': 3.930438171982765, 'time_step': 0.007538675546646118, 'init_value': 8.632101058959961}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:08.31[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051907539367676, 'time_algorithm_update': 0.005449880838394165, 'loss': 4.707533764958382, 'time_step': 0.007553513526916504, 'init_value': 14.973722457885742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:08.40[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002005028247833252, 'time_algorithm_update': 0.005352705478668213, 'loss': 5.130083555698395, 'time_step': 0.00740724229812622, 'init_value': 20.956283569335938}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:08.49[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020526301860809325, 'time_algorithm_update': 0.005439908742904663, 'loss': 5.629690581083298, 'time_step': 0.0075443112850189205, 'init_value': 27.00568389892578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:08.58[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020176286697387697, 'time_algorithm_update': 0.005354860305786133, 'loss': 5.73720216178894, 'time_step': 0.007423053026199341, 'init_value': 33.524147033691406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:09.07[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026752948760986, 'time_algorithm_update': 0.0053662841320037845, 'loss': 6.441966628074646, 'time_step': 0.0074436008930206295, 'init_value': 38.18272018432617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:09.16[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027775764465332, 'time_algorithm_update': 0.005374960899353028, 'loss': 7.494877879858017, 'time_step': 0.007453614473342895, 'init_value': 42.75811004638672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:09.25[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044088363647461, 'time_algorithm_update': 0.005415814399719238, 'loss': 8.509282091856003, 'time_step': 0.007511319398880005, 'init_value': 50.66482162475586}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:09.34[0m [[32m[1minfo     [0m] [1mFQE_20250505170804: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020659849643707277, 'time_algorithm_update': 0.005456350326538086, 'loss': 9.220748903036117, 'time_step': 0.007574127197265625, 'init_value': 54.280216217041016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.280216217041016
avg return on 5 trajectories of agent18: 954.3548703333332
Episode generator created
[2m2025-05-05 17:09.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:09.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:09.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:09.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:09.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505170937[0m
[2m2025-05-05 17:09.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:09.46[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033766031265259, 'time_algorithm_update': 0.005412763357162476, 'loss': 1.6790568461418152, 'time_step': 0.007497344732284546, 'init_value': 3.053060531616211}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:09.55[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020400192737579344, 'time_algorithm_update': 0.005417593002319336, 'loss': 4.00514754319191, 'time_step': 0.0075085747241973875, 'init_value': 7.626739501953125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:10.04[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060593843460083, 'time_algorithm_update': 0.005449819803237915, 'loss': 4.560580265522003, 'time_step': 0.007561910629272461, 'init_value': 12.468667030334473}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:10.13[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048879623413086, 'time_algorithm_update': 0.005434135675430298, 'loss': 5.0822069523334505, 'time_step': 0.007533937692642212, 'init_value': 19.11232566833496}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:10.23[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046188116073608, 'time_algorithm_update': 0.005440016031265258, 'loss': 5.130418964266777, 'time_step': 0.007537381887435913, 'init_value': 24.154682159423828}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:10.32[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020723793506622315, 'time_algorithm_update': 0.005477326631546021, 'loss': 5.70436773455143, 'time_step': 0.0076020689010620115, 'init_value': 30.564834594726562}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:10.41[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046219348907471, 'time_algorithm_update': 0.005433308839797974, 'loss': 6.327222724199295, 'time_step': 0.007531096458435058, 'init_value': 37.363956451416016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:10.50[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045280933380127, 'time_algorithm_update': 0.005437283992767334, 'loss': 7.3788793513774875, 'time_step': 0.007533912658691406, 'init_value': 42.32977294921875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:10.59[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020510308742523195, 'time_algorithm_update': 0.005439453601837159, 'loss': 7.787415917396546, 'time_step': 0.007541898250579834, 'init_value': 47.35401916503906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:11.08[0m [[32m[1minfo     [0m] [1mFQE_20250505170937: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020490043163299563, 'time_algorithm_update': 0.005442317485809326, 'loss': 9.410957216501236, 'time_step': 0.007542951583862305, 'init_value': 53.280269622802734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.280269622802734
avg return on 5 trajectories of agent19: 960.85316
Episode generator created
[2m2025-05-05 17:11.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:11.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:11.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:11.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:11.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171111[0m
[2m2025-05-05 17:11.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:11.20[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020361056327819825, 'time_algorithm_update': 0.00542613172531128, 'loss': 1.6464346835315227, 'time_step': 0.0075130326747894285, 'init_value': 3.833702564239502}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:11.29[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043497562408447, 'time_algorithm_update': 0.005439668655395508, 'loss': 3.9084571224451063, 'time_step': 0.007534269571304321, 'init_value': 8.045123100280762}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:11.38[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020527167320251467, 'time_algorithm_update': 0.005449930906295777, 'loss': 4.731450143814087, 'time_step': 0.00755431079864502, 'init_value': 14.107792854309082}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:11.47[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020357749462127685, 'time_algorithm_update': 0.005450664043426513, 'loss': 4.9800253911018375, 'time_step': 0.0075374536514282225, 'init_value': 19.950342178344727}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:11.56[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020411112308502195, 'time_algorithm_update': 0.005435727596282959, 'loss': 5.457200052261353, 'time_step': 0.007527663946151734, 'init_value': 26.87439727783203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:12.05[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046766996383667, 'time_algorithm_update': 0.005457547187805176, 'loss': 6.099832403421402, 'time_step': 0.007556173324584961, 'init_value': 32.69432067871094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:12.14[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058168411254883, 'time_algorithm_update': 0.005471385478973388, 'loss': 7.517483705043793, 'time_step': 0.007581721544265747, 'init_value': 39.824729919433594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:12.24[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020752818584442137, 'time_algorithm_update': 0.005496782541275024, 'loss': 7.605260409116745, 'time_step': 0.007624349117279053, 'init_value': 44.81315231323242}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:12.33[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020489025115966795, 'time_algorithm_update': 0.005450425863265991, 'loss': 8.962643600940705, 'time_step': 0.007551328659057617, 'init_value': 50.95139694213867}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:12.42[0m [[32m[1minfo     [0m] [1mFQE_20250505171111: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453834533691404, 'time_algorithm_update': 0.005440352201461792, 'loss': 10.763144735097885, 'time_step': 0.007536993741989136, 'init_value': 55.845924377441406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.845924377441406
ave advantage rew: 53.99321594238281, std: 1.9228311206342283
avg cum rews: 960.0995096666666, std: 20.07518771894215
Pearson correlation coefficient: 0.1535457611115962
Spearman correlation coefficient: 0.1849624060150376
Kendall Tau correlation coefficient: 0.12631578947368421
the best agent: 11, best agent cum rewards: 925.795796
1956
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.01862801501736151
avg return on 5 trajectories of agent0: 971.7830663333334
Episode generator created
[2m2025-05-05 17:13.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:13.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:13.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:13.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:13.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171304[0m
[2m2025-05-05 17:13.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:13.13[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205051326751709, 'time_algorithm_update': 0.0054225332736968996, 'loss': 1.642497418180108, 'time_step': 0.007523466348648072, 'init_value': 3.7816457748413086}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:13.22[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047473430633545, 'time_algorithm_update': 0.00544161605834961, 'loss': 4.166417177677155, 'time_step': 0.007540213108062744, 'init_value': 9.90627670288086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:13.31[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020645062923431395, 'time_algorithm_update': 0.005454535484313965, 'loss': 4.9528772134780885, 'time_step': 0.007570554494857788, 'init_value': 16.802534103393555}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:13.41[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059081315994263, 'time_algorithm_update': 0.005452240228652954, 'loss': 5.460126688957215, 'time_step': 0.007562845230102539, 'init_value': 23.79444694519043}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:13.50[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020697247982025147, 'time_algorithm_update': 0.0054533095359802245, 'loss': 5.947209569454193, 'time_step': 0.007574237823486328, 'init_value': 30.297685623168945}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:13.59[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020597481727600096, 'time_algorithm_update': 0.005452117443084717, 'loss': 6.050847918748856, 'time_step': 0.007563344955444336, 'init_value': 34.726959228515625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:14.08[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020643558502197266, 'time_algorithm_update': 0.00545613431930542, 'loss': 6.854066975355148, 'time_step': 0.007572668313980103, 'init_value': 40.91831588745117}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:14.17[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064424991607666, 'time_algorithm_update': 0.005447680950164795, 'loss': 7.448687523126602, 'time_step': 0.007563966035842896, 'init_value': 44.95792007446289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:14.26[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057878017425537, 'time_algorithm_update': 0.005441975593566894, 'loss': 8.758263425111771, 'time_step': 0.00755132794380188, 'init_value': 51.5164680480957}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:14.35[0m [[32m[1minfo     [0m] [1mFQE_20250505171304: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060201168060303, 'time_algorithm_update': 0.005438069581985474, 'loss': 9.51664892244339, 'time_step': 0.007549960374832154, 'init_value': 55.74329376220703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.74329376220703
avg return on 5 trajectories of agent1: 919.5537209999999
Episode generator created
[2m2025-05-05 17:14.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:14.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:14.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:14.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:14.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171438[0m
[2m2025-05-05 17:14.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:14.47[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039269208908081, 'time_algorithm_update': 0.005413610458374024, 'loss': 1.6872975549846887, 'time_step': 0.007503217697143555, 'init_value': 3.638770580291748}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:14.56[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020643298625946044, 'time_algorithm_update': 0.005455626964569092, 'loss': 4.05865383207798, 'time_step': 0.0075712971687316895, 'init_value': 8.845011711120605}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:15.05[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020533289909362793, 'time_algorithm_update': 0.005450844287872314, 'loss': 4.913630252361298, 'time_step': 0.007555121898651123, 'init_value': 14.38938045501709}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:15.14[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020618259906768797, 'time_algorithm_update': 0.005461240291595459, 'loss': 5.554532730102539, 'time_step': 0.007574488878250122, 'init_value': 21.540802001953125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:15.24[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020610132217407226, 'time_algorithm_update': 0.005459942579269409, 'loss': 6.142149171113968, 'time_step': 0.0075727391242980955, 'init_value': 29.40242576599121}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:15.33[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020588822364807128, 'time_algorithm_update': 0.005458685159683227, 'loss': 6.580952557563782, 'time_step': 0.007569156885147095, 'init_value': 35.30616760253906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:15.42[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002070399045944214, 'time_algorithm_update': 0.005469471216201782, 'loss': 7.350494710445404, 'time_step': 0.007591462612152099, 'init_value': 40.17133331298828}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:15.51[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020858070850372314, 'time_algorithm_update': 0.0055204956531524655, 'loss': 8.136530675172805, 'time_step': 0.0076592621803283694, 'init_value': 45.427574157714844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:16.00[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065038204193115, 'time_algorithm_update': 0.005478667259216309, 'loss': 8.570892518043518, 'time_step': 0.007595741748809814, 'init_value': 49.07816696166992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:16.09[0m [[32m[1minfo     [0m] [1mFQE_20250505171438: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060835361480713, 'time_algorithm_update': 0.005460952281951904, 'loss': 9.256850712060928, 'time_step': 0.007573605537414551, 'init_value': 53.47894287109375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.47894287109375
avg return on 5 trajectories of agent2: 961.3678873333333
Episode generator created
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:16.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:16.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:16.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:16.21[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052725553512573, 'time_algorithm_update': 0.0054351468086242674, 'loss': 1.6025749727487564, 'time_step': 0.007539115905761719, 'init_value': 3.5791454315185547}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:16.31[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020558369159698487, 'time_algorithm_update': 0.00543269419670105, 'loss': 3.833361952781677, 'time_step': 0.007539750337600708, 'init_value': 8.744523048400879}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:16.40[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054695129394531, 'time_algorithm_update': 0.005445398807525635, 'loss': 4.63214391040802, 'time_step': 0.007551631450653076, 'init_value': 14.491411209106445}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:16.49[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065145492553711, 'time_algorithm_update': 0.005448127746582031, 'loss': 4.987294032096862, 'time_step': 0.007565633535385132, 'init_value': 21.108219146728516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:16.58[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058964967727661, 'time_algorithm_update': 0.005435375928878784, 'loss': 5.590028728961944, 'time_step': 0.007545558929443359, 'init_value': 27.65135955810547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:17.07[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002071476459503174, 'time_algorithm_update': 0.005450609683990478, 'loss': 5.707848570346832, 'time_step': 0.00757435417175293, 'init_value': 31.972179412841797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:17.16[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002066809892654419, 'time_algorithm_update': 0.005448627948760987, 'loss': 6.731399210929871, 'time_step': 0.007567677974700928, 'init_value': 37.820709228515625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:17.25[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020538146495819093, 'time_algorithm_update': 0.005428400754928589, 'loss': 7.372517426967621, 'time_step': 0.007533413648605347, 'init_value': 43.08846664428711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:17.34[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020639066696166992, 'time_algorithm_update': 0.005447989940643311, 'loss': 7.75139294219017, 'time_step': 0.0075639901161193845, 'init_value': 47.799781799316406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:17.43[0m [[32m[1minfo     [0m] [1mFQE_20250505171612: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020606629848480226, 'time_algorithm_update': 0.005434541463851928, 'loss': 8.767635317564011, 'time_step': 0.007547102451324463, 'init_value': 50.86848831176758}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.86848831176758
avg return on 5 trajectories of agent3: 983.5997916666666
Episode generator created
[2m2025-05-05 17:17.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:17.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:17.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:17.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:17.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171746[0m
[2m2025-05-05 17:17.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:17.55[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042571306228638, 'time_algorithm_update': 0.005420310497283936, 'loss': 1.6548184496462346, 'time_step': 0.007513844251632691, 'init_value': 3.8869669437408447}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:18.04[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205747127532959, 'time_algorithm_update': 0.005439990043640137, 'loss': 3.9956373579502107, 'time_step': 0.007549098253250122, 'init_value': 9.156327247619629}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:18.13[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020522398948669435, 'time_algorithm_update': 0.005428246021270752, 'loss': 4.669829389214516, 'time_step': 0.0075316960811614994, 'init_value': 15.176714897155762}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:18.22[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020604228973388674, 'time_algorithm_update': 0.005435655593872071, 'loss': 5.346965121507645, 'time_step': 0.0075473225116729735, 'init_value': 20.839120864868164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:18.31[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055481195449829, 'time_algorithm_update': 0.005440441846847534, 'loss': 5.658137221813202, 'time_step': 0.007547491550445556, 'init_value': 27.515779495239258}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:18.41[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061774969100952, 'time_algorithm_update': 0.0054438416957855226, 'loss': 6.323216567516327, 'time_step': 0.007557188034057617, 'init_value': 33.275543212890625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:18.49[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002013141393661499, 'time_algorithm_update': 0.005344521284103393, 'loss': 6.740331129312516, 'time_step': 0.007407252073287964, 'init_value': 37.435935974121094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:18.58[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020201504230499268, 'time_algorithm_update': 0.005355439901351929, 'loss': 6.989634850025177, 'time_step': 0.007425907850265503, 'init_value': 44.28919982910156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:19.07[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002014369249343872, 'time_algorithm_update': 0.005321397066116333, 'loss': 8.67384984779358, 'time_step': 0.0073854756355285645, 'init_value': 49.28639221191406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:19.16[0m [[32m[1minfo     [0m] [1mFQE_20250505171746: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020262455940246583, 'time_algorithm_update': 0.005352197408676147, 'loss': 9.211523531675338, 'time_step': 0.007428760766983032, 'init_value': 53.91626739501953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.91626739501953
avg return on 5 trajectories of agent4: 905.8390313333333
Episode generator created
[2m2025-05-05 17:19.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:19.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:19.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:19.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:19.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505171919[0m
[2m2025-05-05 17:19.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:19.28[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020245790481567385, 'time_algorithm_update': 0.00540116024017334, 'loss': 1.6677725347280503, 'time_step': 0.0074758708477020265, 'init_value': 3.806478977203369}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:19.37[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055361270904541, 'time_algorithm_update': 0.005445162773132325, 'loss': 3.8740599256753923, 'time_step': 0.007551769733428955, 'init_value': 9.362634658813477}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:19.46[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020575103759765626, 'time_algorithm_update': 0.005450134038925171, 'loss': 5.003981140851974, 'time_step': 0.007558654308319092, 'init_value': 14.482985496520996}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:19.55[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055389642715454, 'time_algorithm_update': 0.005441332340240478, 'loss': 5.11919016802311, 'time_step': 0.007547571420669556, 'init_value': 20.000097274780273}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:20.05[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020574486255645753, 'time_algorithm_update': 0.005475680112838745, 'loss': 5.279218426465988, 'time_step': 0.007584521770477295, 'init_value': 24.563261032104492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:20.14[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020559494495391846, 'time_algorithm_update': 0.005443105220794678, 'loss': 5.596292749166489, 'time_step': 0.007549987077713012, 'init_value': 29.054805755615234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:20.23[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059974670410156, 'time_algorithm_update': 0.0054579308032989505, 'loss': 6.473268389463425, 'time_step': 0.007569513320922852, 'init_value': 34.385555267333984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:20.32[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020509159564971926, 'time_algorithm_update': 0.005446433782577515, 'loss': 7.217083071947098, 'time_step': 0.007548091888427734, 'init_value': 41.1202507019043}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:20.41[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067553997039795, 'time_algorithm_update': 0.005459088563919068, 'loss': 8.061612638235092, 'time_step': 0.007577898263931274, 'init_value': 46.72012710571289}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:20.50[0m [[32m[1minfo     [0m] [1mFQE_20250505171919: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206752347946167, 'time_algorithm_update': 0.00545882534980774, 'loss': 9.292838265895844, 'time_step': 0.007578154325485229, 'init_value': 50.104244232177734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.104244232177734
avg return on 5 trajectories of agent5: 977.4153153333333
Episode generator created
[2m2025-05-05 17:20.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:20.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:20.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:20.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:20.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172053[0m
[2m2025-05-05 17:20.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:21.02[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045126676559448, 'time_algorithm_update': 0.005418678283691406, 'loss': 1.559505133792758, 'time_step': 0.007514140605926514, 'init_value': 3.27915620803833}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:21.11[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205519437789917, 'time_algorithm_update': 0.005437484502792358, 'loss': 3.788780402302742, 'time_step': 0.007543635368347168, 'init_value': 8.035569190979004}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:21.20[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020601093769073487, 'time_algorithm_update': 0.0054437689781188965, 'loss': 4.497215593338013, 'time_step': 0.007555038452148438, 'init_value': 14.275933265686035}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:21.29[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020550739765167235, 'time_algorithm_update': 0.00543667197227478, 'loss': 4.806427723884583, 'time_step': 0.007542866468429566, 'init_value': 20.438207626342773}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:21.38[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055295705795288, 'time_algorithm_update': 0.005450404405593872, 'loss': 5.590044531822205, 'time_step': 0.00755721378326416, 'init_value': 27.42782211303711}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:21.47[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020529961585998534, 'time_algorithm_update': 0.005438917875289917, 'loss': 6.3708649415969845, 'time_step': 0.007542966365814209, 'init_value': 34.60780334472656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:21.57[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020482361316680906, 'time_algorithm_update': 0.005430294513702393, 'loss': 6.896503583192826, 'time_step': 0.007529755592346191, 'init_value': 39.250465393066406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:22.06[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002117037534713745, 'time_algorithm_update': 0.005580195426940918, 'loss': 7.543065671443939, 'time_step': 0.0077506968975067135, 'init_value': 44.06102752685547}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:22.15[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002119220972061157, 'time_algorithm_update': 0.0056226511001586914, 'loss': 7.802639047145844, 'time_step': 0.007796105861663819, 'init_value': 45.7213134765625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:22.24[0m [[32m[1minfo     [0m] [1mFQE_20250505172053: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101765155792236, 'time_algorithm_update': 0.005537653684616089, 'loss': 9.147986015081406, 'time_step': 0.007692374229431152, 'init_value': 51.24930953979492}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.24930953979492
avg return on 5 trajectories of agent6: 1001.862114
Episode generator created
[2m2025-05-05 17:22.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:22.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:22.28[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:22.28[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:22.28[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172228[0m
[2m2025-05-05 17:22.28[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:22.37[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085888147354126, 'time_algorithm_update': 0.005529318571090698, 'loss': 1.639130327478051, 'time_step': 0.007667361736297607, 'init_value': 3.842867612838745}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:22.46[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021149301528930664, 'time_algorithm_update': 0.0055823144912719724, 'loss': 3.915784258246422, 'time_step': 0.007750486373901367, 'init_value': 8.64478588104248}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:22.55[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021116976737976076, 'time_algorithm_update': 0.0055739004611969, 'loss': 4.682765003681183, 'time_step': 0.007738571166992187, 'init_value': 15.052328109741211}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:23.05[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020961213111877442, 'time_algorithm_update': 0.005543673515319824, 'loss': 5.503225785255432, 'time_step': 0.0076923325061798095, 'init_value': 23.208208084106445}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:23.14[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002099642992019653, 'time_algorithm_update': 0.00553948187828064, 'loss': 6.100745266437531, 'time_step': 0.007691502809524536, 'init_value': 28.47565460205078}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:23.23[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094975709915161, 'time_algorithm_update': 0.005532763957977295, 'loss': 6.652318188667297, 'time_step': 0.007679986238479614, 'init_value': 35.71968460083008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:23.32[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020986390113830566, 'time_algorithm_update': 0.005543309926986695, 'loss': 7.344766000986099, 'time_step': 0.0076945099830627445, 'init_value': 40.480682373046875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:23.41[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021079297065734865, 'time_algorithm_update': 0.005547226905822754, 'loss': 8.065008362770081, 'time_step': 0.007707473039627075, 'init_value': 46.194515228271484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:23.51[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092439889907837, 'time_algorithm_update': 0.005541052579879761, 'loss': 9.040877909421921, 'time_step': 0.007686006784439087, 'init_value': 50.596473693847656}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:24.00[0m [[32m[1minfo     [0m] [1mFQE_20250505172228: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021017000675201416, 'time_algorithm_update': 0.005540929317474365, 'loss': 9.74570267367363, 'time_step': 0.007695744991302491, 'init_value': 58.956275939941406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.956275939941406
avg return on 5 trajectories of agent7: 1044.2498816666666
Episode generator created
[2m2025-05-05 17:24.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:24.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:24.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:24.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:24.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172403[0m
[2m2025-05-05 17:24.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:24.12[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020759918689727784, 'time_algorithm_update': 0.0055198860168457035, 'loss': 1.6623441043943166, 'time_step': 0.0076484930515289306, 'init_value': 3.8650364875793457}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:24.22[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020927889347076415, 'time_algorithm_update': 0.005532565832138061, 'loss': 3.8490092898607253, 'time_step': 0.00767775297164917, 'init_value': 8.537287712097168}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:24.31[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020963914394378663, 'time_algorithm_update': 0.005552180290222168, 'loss': 4.706625941872597, 'time_step': 0.007702094793319702, 'init_value': 15.58673095703125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:24.40[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092642307281494, 'time_algorithm_update': 0.0055619549751281736, 'loss': 5.4716457529068, 'time_step': 0.007708380460739136, 'init_value': 22.451143264770508}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:24.49[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088754177093506, 'time_algorithm_update': 0.005545701742172241, 'loss': 6.1121901714801785, 'time_step': 0.007687339544296265, 'init_value': 31.11170196533203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:24.58[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097230672836304, 'time_algorithm_update': 0.005557008266448974, 'loss': 6.4082277965545655, 'time_step': 0.0077078242301940915, 'init_value': 37.37858200073242}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:25.08[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097438097000122, 'time_algorithm_update': 0.00556243896484375, 'loss': 7.613070562839508, 'time_step': 0.007713373422622681, 'init_value': 43.39425277709961}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:25.17[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020970053672790525, 'time_algorithm_update': 0.0055563955307006835, 'loss': 8.048656145811082, 'time_step': 0.007706531524658203, 'init_value': 47.6380615234375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:25.26[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002109273910522461, 'time_algorithm_update': 0.005558203935623169, 'loss': 8.721426052331925, 'time_step': 0.007721119403839112, 'init_value': 52.268009185791016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:25.35[0m [[32m[1minfo     [0m] [1mFQE_20250505172403: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100250482559204, 'time_algorithm_update': 0.005557818174362183, 'loss': 10.42112656736374, 'time_step': 0.0077116284370422365, 'init_value': 57.487693786621094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.487693786621094
avg return on 5 trajectories of agent8: 891.2281923333334
Episode generator created
[2m2025-05-05 17:25.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:25.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:25.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:25.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:25.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172539[0m
[2m2025-05-05 17:25.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:25.48[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00207660984992981, 'time_algorithm_update': 0.005522711992263794, 'loss': 1.601447863638401, 'time_step': 0.007651311874389648, 'init_value': 3.6678683757781982}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:25.57[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002104677677154541, 'time_algorithm_update': 0.0055416195392608645, 'loss': 3.8598042945861817, 'time_step': 0.007699110746383667, 'init_value': 8.239011764526367}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:26.06[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021021878719329834, 'time_algorithm_update': 0.0055590028762817385, 'loss': 4.4266269075870515, 'time_step': 0.007714428663253784, 'init_value': 13.916788101196289}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:26.16[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209437370300293, 'time_algorithm_update': 0.00555532169342041, 'loss': 5.034379808306694, 'time_step': 0.0077024245262146, 'init_value': 20.310781478881836}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:26.25[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021219890117645263, 'time_algorithm_update': 0.005624351263046265, 'loss': 5.55332170844078, 'time_step': 0.007800530433654785, 'init_value': 28.192825317382812}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:26.34[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097908020019531, 'time_algorithm_update': 0.005546405076980591, 'loss': 6.100988317012787, 'time_step': 0.007697607517242432, 'init_value': 34.26883316040039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:26.43[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002099454641342163, 'time_algorithm_update': 0.005548385858535766, 'loss': 6.69407290816307, 'time_step': 0.007700643539428711, 'init_value': 40.078304290771484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:26.53[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021076607704162598, 'time_algorithm_update': 0.005556240558624268, 'loss': 7.630978765249252, 'time_step': 0.007716771364212036, 'init_value': 45.50580596923828}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:27.02[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021102225780487063, 'time_algorithm_update': 0.005554835319519043, 'loss': 8.161885409832001, 'time_step': 0.007718563079833984, 'init_value': 49.51607131958008}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:27.11[0m [[32m[1minfo     [0m] [1mFQE_20250505172539: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093125581741333, 'time_algorithm_update': 0.005544845819473267, 'loss': 8.813883852005004, 'time_step': 0.007691181659698486, 'init_value': 54.90188217163086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.90188217163086
avg return on 5 trajectories of agent9: 990.5355596666667
Episode generator created
[2m2025-05-05 17:27.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:27.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:27.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:27.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:27.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172714[0m
[2m2025-05-05 17:27.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:27.23[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020855591297149656, 'time_algorithm_update': 0.005518156051635742, 'loss': 1.5527142771333455, 'time_step': 0.007655822038650513, 'init_value': 3.558067798614502}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:27.33[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096017122268677, 'time_algorithm_update': 0.005530275106430053, 'loss': 3.865873613834381, 'time_step': 0.007678820371627808, 'init_value': 8.73580551147461}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:27.42[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092047452926636, 'time_algorithm_update': 0.00553443431854248, 'loss': 4.499738591909408, 'time_step': 0.007679178953170777, 'init_value': 14.42594051361084}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:27.51[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020952072143554687, 'time_algorithm_update': 0.005539752721786499, 'loss': 4.792653438806534, 'time_step': 0.007687694311141967, 'init_value': 19.48047637939453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:28.00[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020950238704681395, 'time_algorithm_update': 0.005537469387054444, 'loss': 5.351606951236725, 'time_step': 0.00768526291847229, 'init_value': 25.724685668945312}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:28.10[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020912110805511473, 'time_algorithm_update': 0.005528305530548096, 'loss': 5.677312913656235, 'time_step': 0.007671926259994507, 'init_value': 31.183975219726562}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:28.19[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020949721336364748, 'time_algorithm_update': 0.005529634714126587, 'loss': 6.367121605396271, 'time_step': 0.00767729926109314, 'init_value': 37.206851959228516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:28.28[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020915513038635256, 'time_algorithm_update': 0.005546580791473388, 'loss': 7.49975061249733, 'time_step': 0.007691224098205566, 'init_value': 43.232398986816406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:28.37[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091414451599121, 'time_algorithm_update': 0.005526126384735108, 'loss': 8.773559975147247, 'time_step': 0.007669774532318116, 'init_value': 47.96687698364258}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:28.46[0m [[32m[1minfo     [0m] [1mFQE_20250505172714: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020870239734649657, 'time_algorithm_update': 0.005529802322387695, 'loss': 9.292629937648773, 'time_step': 0.007669463157653809, 'init_value': 54.54161071777344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.54161071777344
avg return on 5 trajectories of agent10: 978.6726096666666
Episode generator created
[2m2025-05-05 17:28.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:28.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:28.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:28.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:28.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505172850[0m
[2m2025-05-05 17:28.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:28.59[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020845510959625244, 'time_algorithm_update': 0.0055241453647613525, 'loss': 1.601079908311367, 'time_step': 0.007660825490951538, 'init_value': 3.8461546897888184}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:29.08[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056161642074585, 'time_algorithm_update': 0.005462769985198975, 'loss': 3.8033362674713134, 'time_step': 0.007569824695587158, 'init_value': 8.5315523147583}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:29.17[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020659980773925783, 'time_algorithm_update': 0.005467674732208252, 'loss': 4.721775278568268, 'time_step': 0.007584769964218139, 'init_value': 14.651968002319336}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:29.26[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002070861339569092, 'time_algorithm_update': 0.005472645998001098, 'loss': 5.356069419384003, 'time_step': 0.007594799041748047, 'init_value': 21.55986785888672}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:29.35[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020699639320373537, 'time_algorithm_update': 0.005463084697723389, 'loss': 5.873852577924729, 'time_step': 0.007584258556365967, 'init_value': 29.484468460083008}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:29.44[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020755529403686523, 'time_algorithm_update': 0.005470638990402222, 'loss': 6.052407665967941, 'time_step': 0.007597597599029541, 'init_value': 35.46554946899414}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:29.54[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021135921478271486, 'time_algorithm_update': 0.005575473308563232, 'loss': 6.7761667528152465, 'time_step': 0.00774273943901062, 'init_value': 39.63615798950195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:30.03[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002105504035949707, 'time_algorithm_update': 0.005565183162689209, 'loss': 7.899518463611603, 'time_step': 0.007723398923873901, 'init_value': 46.62410354614258}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:30.12[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021010582447052004, 'time_algorithm_update': 0.005544744968414307, 'loss': 8.741459330320358, 'time_step': 0.0076986258029937745, 'init_value': 52.87980270385742}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:30.21[0m [[32m[1minfo     [0m] [1mFQE_20250505172850: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020946691036224365, 'time_algorithm_update': 0.005532382249832153, 'loss': 9.571082860469819, 'time_step': 0.007679616451263428, 'init_value': 56.77446365356445}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.77446365356445
avg return on 5 trajectories of agent11: 977.0254759999999
Episode generator created
[2m2025-05-05 17:30.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:30.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:30.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:30.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:30.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173024[0m
[2m2025-05-05 17:30.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:30.34[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020805578231811524, 'time_algorithm_update': 0.005524817943572998, 'loss': 1.5726693176478148, 'time_step': 0.00765746545791626, 'init_value': 3.3823344707489014}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:30.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020854220390319825, 'time_algorithm_update': 0.005540825843811035, 'loss': 3.8926942776441575, 'time_step': 0.0076787443161010745, 'init_value': 7.750565528869629}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:30.52[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208583927154541, 'time_algorithm_update': 0.00552811074256897, 'loss': 4.644674783945083, 'time_step': 0.007666503190994263, 'init_value': 13.201837539672852}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:31.01[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090686321258545, 'time_algorithm_update': 0.005546435356140137, 'loss': 4.913029208183288, 'time_step': 0.0076895391941070555, 'init_value': 19.78615379333496}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:31.11[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020988075733184815, 'time_algorithm_update': 0.005554467439651489, 'loss': 5.813887746810913, 'time_step': 0.007705878019332885, 'init_value': 27.785877227783203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:31.20[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089689493179321, 'time_algorithm_update': 0.005544867515563965, 'loss': 6.241388265132904, 'time_step': 0.007687334060668945, 'init_value': 33.63114929199219}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:31.29[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002098236560821533, 'time_algorithm_update': 0.005568334341049194, 'loss': 6.8591331825256345, 'time_step': 0.007719613790512085, 'init_value': 37.99853515625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:31.38[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002104003667831421, 'time_algorithm_update': 0.0055632200241088866, 'loss': 6.7929823315143585, 'time_step': 0.007720124959945679, 'init_value': 43.69313430786133}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:31.47[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021004376411437988, 'time_algorithm_update': 0.00554918909072876, 'loss': 8.06146318745613, 'time_step': 0.007702209711074829, 'init_value': 48.64854049682617}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:31.57[0m [[32m[1minfo     [0m] [1mFQE_20250505173024: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002107741355895996, 'time_algorithm_update': 0.005555625200271606, 'loss': 8.382118427038193, 'time_step': 0.007716894626617432, 'init_value': 53.09945297241211}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.09945297241211
avg return on 5 trajectories of agent12: 944.4299876666668
Episode generator created
[2m2025-05-05 17:32.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:32.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:32.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:32.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:32.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173200[0m
[2m2025-05-05 17:32.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:32.09[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020711472034454347, 'time_algorithm_update': 0.005528367519378662, 'loss': 1.6203845068365335, 'time_step': 0.007651616811752319, 'init_value': 3.6865198612213135}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:32.18[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020785717964172364, 'time_algorithm_update': 0.005527316093444824, 'loss': 4.061782036781311, 'time_step': 0.007658178567886352, 'init_value': 9.376047134399414}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:32.28[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020870282649993895, 'time_algorithm_update': 0.0055358891487121585, 'loss': 4.94146337556839, 'time_step': 0.007675385951995849, 'init_value': 14.4622802734375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:32.37[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020891878604888917, 'time_algorithm_update': 0.005535866022109985, 'loss': 5.773046129465103, 'time_step': 0.007677564859390259, 'init_value': 21.26456642150879}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:32.46[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020886290073394774, 'time_algorithm_update': 0.0055248095989227294, 'loss': 5.718761375665665, 'time_step': 0.007665661334991455, 'init_value': 26.264633178710938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:32.55[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096883296966553, 'time_algorithm_update': 0.005538043260574341, 'loss': 6.080893075704575, 'time_step': 0.007687829971313477, 'init_value': 32.498043060302734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:33.04[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091811180114746, 'time_algorithm_update': 0.005532628536224366, 'loss': 6.366816962480545, 'time_step': 0.007676997900009155, 'init_value': 38.85465621948242}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:33.14[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020893354415893557, 'time_algorithm_update': 0.0055283868312835695, 'loss': 7.5972777967453, 'time_step': 0.007670349597930908, 'init_value': 44.06820297241211}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:33.23[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002112328767776489, 'time_algorithm_update': 0.005595305442810059, 'loss': 8.043177466630935, 'time_step': 0.00776125955581665, 'init_value': 47.566585540771484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:33.32[0m [[32m[1minfo     [0m] [1mFQE_20250505173200: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093313217163086, 'time_algorithm_update': 0.005528576374053955, 'loss': 9.145406242132188, 'time_step': 0.007674520254135132, 'init_value': 52.00407791137695}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.00407791137695
avg return on 5 trajectories of agent13: 908.5865303333334
Episode generator created
[2m2025-05-05 17:33.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:33.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:33.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:33.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:33.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173335[0m
[2m2025-05-05 17:33.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:33.45[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078838109970093, 'time_algorithm_update': 0.005530884504318237, 'loss': 1.6377601467072964, 'time_step': 0.007661622524261474, 'init_value': 3.3409018516540527}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:33.54[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020857508182525633, 'time_algorithm_update': 0.00555050253868103, 'loss': 3.7927571606636046, 'time_step': 0.007688248872756958, 'init_value': 7.375238418579102}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:34.03[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002112452507019043, 'time_algorithm_update': 0.005617679119110108, 'loss': 4.564614514112472, 'time_step': 0.007783280849456787, 'init_value': 13.197578430175781}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:34.12[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092907667160034, 'time_algorithm_update': 0.0055529944896698, 'loss': 5.046175786018372, 'time_step': 0.007698310613632202, 'init_value': 20.63962745666504}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:34.21[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209083366394043, 'time_algorithm_update': 0.005554465770721435, 'loss': 5.611856021404266, 'time_step': 0.007698085308074951, 'init_value': 27.02469825744629}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:34.31[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089344024658203, 'time_algorithm_update': 0.00554893159866333, 'loss': 5.921862959623337, 'time_step': 0.007690708637237548, 'init_value': 32.225433349609375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:34.40[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020918431282043455, 'time_algorithm_update': 0.005551575183868408, 'loss': 6.461219086170196, 'time_step': 0.007695868253707886, 'init_value': 39.505714416503906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:34.49[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020913259983062742, 'time_algorithm_update': 0.005546560525894165, 'loss': 7.576353226423263, 'time_step': 0.007690381288528442, 'init_value': 44.81776428222656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:34.58[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020907573699951174, 'time_algorithm_update': 0.005543954133987426, 'loss': 8.405783577919006, 'time_step': 0.007686981201171875, 'init_value': 49.660423278808594}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:35.08[0m [[32m[1minfo     [0m] [1mFQE_20250505173335: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020985915660858153, 'time_algorithm_update': 0.0055595853328704835, 'loss': 9.364418198108673, 'time_step': 0.007711058139801026, 'init_value': 54.2349967956543}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.2349967956543
avg return on 5 trajectories of agent14: 982.2980586666667
Episode generator created
[2m2025-05-05 17:35.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:35.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:35.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:35.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:35.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173511[0m
[2m2025-05-05 17:35.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:35.20[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020802276134490967, 'time_algorithm_update': 0.005530097007751465, 'loss': 1.6732057816833257, 'time_step': 0.007662400484085083, 'init_value': 4.045878887176514}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:35.29[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020903964042663574, 'time_algorithm_update': 0.005542889595031738, 'loss': 3.8776216495037077, 'time_step': 0.0076858212947845455, 'init_value': 8.965812683105469}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:35.39[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021018176078796387, 'time_algorithm_update': 0.005547436475753784, 'loss': 4.3858986992836, 'time_step': 0.007702259302139282, 'init_value': 14.605220794677734}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:35.48[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020938191413879394, 'time_algorithm_update': 0.0055601618289947505, 'loss': 5.177165859103203, 'time_step': 0.00770662784576416, 'init_value': 22.537744522094727}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:35.57[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089672803878784, 'time_algorithm_update': 0.005568157196044922, 'loss': 5.544127203345298, 'time_step': 0.007711040019989014, 'init_value': 28.744335174560547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:36.06[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101688385009766, 'time_algorithm_update': 0.0055656168460845945, 'loss': 6.435430009126663, 'time_step': 0.007719677209854126, 'init_value': 34.15620803833008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:36.15[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096976041793823, 'time_algorithm_update': 0.005549767017364502, 'loss': 6.779030004024506, 'time_step': 0.007699228763580322, 'init_value': 38.28940963745117}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:36.25[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094459533691406, 'time_algorithm_update': 0.005541474103927612, 'loss': 7.429522181749344, 'time_step': 0.007688735485076904, 'init_value': 42.65369415283203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:36.34[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020951149463653567, 'time_algorithm_update': 0.005552689790725708, 'loss': 7.9742748291492465, 'time_step': 0.007700779438018799, 'init_value': 48.09300994873047}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:36.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173511: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088376760482788, 'time_algorithm_update': 0.00554445195198059, 'loss': 9.649552904605866, 'time_step': 0.007685354232788086, 'init_value': 50.99671173095703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.99671173095703
avg return on 5 trajectories of agent15: 971.5434143333333
Episode generator created
[2m2025-05-05 17:36.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:36.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:36.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:36.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:36.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173646[0m
[2m2025-05-05 17:36.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:36.56[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021018192768096924, 'time_algorithm_update': 0.00557013463973999, 'loss': 1.610445868551731, 'time_step': 0.007725300312042237, 'init_value': 3.724119186401367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:37.05[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096870183944702, 'time_algorithm_update': 0.005525778532028198, 'loss': 3.92359456038475, 'time_step': 0.007675897359848022, 'init_value': 8.471914291381836}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:37.14[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020989906787872315, 'time_algorithm_update': 0.00553484034538269, 'loss': 4.676540599822998, 'time_step': 0.007686957597732544, 'init_value': 14.594861030578613}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:37.23[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020991802215576173, 'time_algorithm_update': 0.00553198766708374, 'loss': 5.254180590391159, 'time_step': 0.007684432029724121, 'init_value': 20.993709564208984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:37.33[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00210172176361084, 'time_algorithm_update': 0.005535841703414917, 'loss': 5.277497999668121, 'time_step': 0.007690975904464722, 'init_value': 26.868396759033203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:37.42[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102616786956787, 'time_algorithm_update': 0.005542173862457276, 'loss': 5.997650163173676, 'time_step': 0.0076983065605163575, 'init_value': 32.95997619628906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:37.51[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020980026721954346, 'time_algorithm_update': 0.00552572250366211, 'loss': 6.812575735330582, 'time_step': 0.0076770176887512205, 'init_value': 38.876197814941406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:38.00[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021058251857757567, 'time_algorithm_update': 0.005541522979736328, 'loss': 7.314852324247361, 'time_step': 0.0077009711265563965, 'init_value': 44.87096405029297}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:38.09[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021085169315338136, 'time_algorithm_update': 0.00553352952003479, 'loss': 8.636918795347214, 'time_step': 0.007695512294769287, 'init_value': 49.260231018066406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:38.19[0m [[32m[1minfo     [0m] [1mFQE_20250505173646: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020970971584320067, 'time_algorithm_update': 0.005536949396133423, 'loss': 9.048079232692718, 'time_step': 0.007687501192092896, 'init_value': 54.71003341674805}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.71003341674805
avg return on 5 trajectories of agent16: 872.821658
Episode generator created
[2m2025-05-05 17:38.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:38.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:38.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:38.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:38.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:38.31[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079091548919678, 'time_algorithm_update': 0.0055272579193115234, 'loss': 1.6009158681035043, 'time_step': 0.007658304691314698, 'init_value': 3.6766717433929443}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:38.40[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020913176536560057, 'time_algorithm_update': 0.0055457897186279295, 'loss': 3.8248598235845566, 'time_step': 0.007689568996429443, 'init_value': 8.675972938537598}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:38.49[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020811986923217774, 'time_algorithm_update': 0.005541401863098145, 'loss': 4.773016743421555, 'time_step': 0.007674692153930664, 'init_value': 14.448132514953613}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:38.59[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020944721698760984, 'time_algorithm_update': 0.005561722755432129, 'loss': 5.30031358218193, 'time_step': 0.0077087488174438475, 'init_value': 19.868017196655273}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:39.08[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090672254562378, 'time_algorithm_update': 0.005548296213150025, 'loss': 5.9334333462715145, 'time_step': 0.007691895008087158, 'init_value': 28.56366729736328}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:39.17[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096160173416138, 'time_algorithm_update': 0.005555934190750122, 'loss': 6.214208174824715, 'time_step': 0.007705100059509277, 'init_value': 34.445682525634766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:39.27[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021197667121887207, 'time_algorithm_update': 0.005615083932876587, 'loss': 6.775925644397736, 'time_step': 0.0077886743545532225, 'init_value': 38.19639205932617}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:39.36[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062699556350708, 'time_algorithm_update': 0.005483162641525268, 'loss': 7.610615224838257, 'time_step': 0.007597388029098511, 'init_value': 42.79975891113281}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:39.45[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020720651149749754, 'time_algorithm_update': 0.005490296602249146, 'loss': 8.27883758378029, 'time_step': 0.007614502429962158, 'init_value': 47.065093994140625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505173822: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020678112506866456, 'time_algorithm_update': 0.005471321105957031, 'loss': 8.588094607114792, 'time_step': 0.007590558767318726, 'init_value': 52.05347442626953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.05347442626953
avg return on 5 trajectories of agent17: 908.0848973333333
Episode generator created
[2m2025-05-05 17:39.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:39.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:39.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:39.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:39.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505173957[0m
[2m2025-05-05 17:39.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:40.06[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020601561069488526, 'time_algorithm_update': 0.005464312314987183, 'loss': 1.5668651321828366, 'time_step': 0.0075756504535675045, 'init_value': 3.671541452407837}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:40.15[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002070045471191406, 'time_algorithm_update': 0.005472601175308228, 'loss': 3.8515390450954436, 'time_step': 0.007593995332717896, 'init_value': 8.44123363494873}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:40.25[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020991556644439696, 'time_algorithm_update': 0.005563446283340454, 'loss': 4.61177586722374, 'time_step': 0.007715677976608277, 'init_value': 14.602587699890137}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:40.34[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020878634452819824, 'time_algorithm_update': 0.005544443607330322, 'loss': 5.19059536933899, 'time_step': 0.007684657096862793, 'init_value': 21.739240646362305}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:40.43[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088961362838745, 'time_algorithm_update': 0.00554469633102417, 'loss': 5.3387625470161435, 'time_step': 0.007686203002929688, 'init_value': 28.621822357177734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:40.52[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087999105453491, 'time_algorithm_update': 0.005537266492843628, 'loss': 5.992221647024155, 'time_step': 0.007677695035934448, 'init_value': 33.62882995605469}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:41.02[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095515727996826, 'time_algorithm_update': 0.005535375118255615, 'loss': 7.066570717096329, 'time_step': 0.007683101654052734, 'init_value': 40.605743408203125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:41.11[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020984737873077394, 'time_algorithm_update': 0.005552320003509521, 'loss': 7.7864927532672885, 'time_step': 0.007703974485397339, 'init_value': 46.36739730834961}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:41.20[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002082557678222656, 'time_algorithm_update': 0.005531317234039307, 'loss': 8.937959326267242, 'time_step': 0.007666598796844482, 'init_value': 51.53705596923828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:41.29[0m [[32m[1minfo     [0m] [1mFQE_20250505173957: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092620611190796, 'time_algorithm_update': 0.005545245409011841, 'loss': 9.313116478919984, 'time_step': 0.007690697908401489, 'init_value': 55.07901382446289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.07901382446289
avg return on 5 trajectories of agent18: 936.7458173333334
Episode generator created
[2m2025-05-05 17:41.32[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:41.32[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:41.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:41.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:41.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174132[0m
[2m2025-05-05 17:41.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:41.42[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093224287033081, 'time_algorithm_update': 0.005535936832427978, 'loss': 1.6671466662436725, 'time_step': 0.007681532382965088, 'init_value': 3.2246758937835693}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:41.51[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091372728347778, 'time_algorithm_update': 0.005541049957275391, 'loss': 3.7084153187274933, 'time_step': 0.007685065507888794, 'init_value': 7.400654315948486}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:42.00[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020903000831604002, 'time_algorithm_update': 0.005540298223495483, 'loss': 4.5721064510345455, 'time_step': 0.00768961763381958, 'init_value': 12.816341400146484}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:42.09[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088780641555786, 'time_algorithm_update': 0.005538271188735962, 'loss': 5.1422194324731825, 'time_step': 0.007679650783538819, 'init_value': 19.407968521118164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:42.18[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020812869071960447, 'time_algorithm_update': 0.005529551029205322, 'loss': 5.513846952080726, 'time_step': 0.007663524866104126, 'init_value': 26.299694061279297}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:42.28[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020946803092956544, 'time_algorithm_update': 0.0055308926105499265, 'loss': 6.132284779429436, 'time_step': 0.007678685665130615, 'init_value': 33.080989837646484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:42.37[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020943493843078613, 'time_algorithm_update': 0.005543368101119995, 'loss': 6.942254779577255, 'time_step': 0.007690749645233154, 'init_value': 38.805267333984375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:42.46[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089519739151001, 'time_algorithm_update': 0.005544313430786133, 'loss': 7.917552440881729, 'time_step': 0.00768747091293335, 'init_value': 43.487693786621094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:42.55[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020944802761077882, 'time_algorithm_update': 0.0055462136268615726, 'loss': 8.519685878515244, 'time_step': 0.007693620920181274, 'init_value': 50.086761474609375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:43.05[0m [[32m[1minfo     [0m] [1mFQE_20250505174132: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021010003089904786, 'time_algorithm_update': 0.00554620885848999, 'loss': 9.710333765983581, 'time_step': 0.00770028018951416, 'init_value': 55.91874694824219}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.91874694824219
avg return on 5 trajectories of agent19: 989.651741
Episode generator created
[2m2025-05-05 17:43.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:43.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:43.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:43.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:43.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174308[0m
[2m2025-05-05 17:43.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:43.17[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083775520324707, 'time_algorithm_update': 0.005526236772537232, 'loss': 1.6245812771767378, 'time_step': 0.0076617028713226315, 'init_value': 3.5174756050109863}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:43.26[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020958514213562014, 'time_algorithm_update': 0.005546560525894165, 'loss': 3.928322934269905, 'time_step': 0.007694856643676758, 'init_value': 7.78009557723999}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:43.35[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090865135192871, 'time_algorithm_update': 0.005546463251113892, 'loss': 4.565695872068405, 'time_step': 0.007689531087875366, 'init_value': 13.58869457244873}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:43.45[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102550268173218, 'time_algorithm_update': 0.005598273754119873, 'loss': 4.941087007522583, 'time_step': 0.0077540576457977295, 'init_value': 19.962501525878906}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:43.54[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086801290512085, 'time_algorithm_update': 0.005544230222702027, 'loss': 5.723811949372291, 'time_step': 0.007683438777923584, 'init_value': 27.646259307861328}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:44.03[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021042630672454834, 'time_algorithm_update': 0.005567113637924195, 'loss': 6.102912317037583, 'time_step': 0.007724492311477661, 'init_value': 33.5687255859375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:44.12[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208521032333374, 'time_algorithm_update': 0.00554386568069458, 'loss': 6.687819199085236, 'time_step': 0.007682009935379029, 'init_value': 37.61344528198242}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:44.22[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020922365188598634, 'time_algorithm_update': 0.005548802137374878, 'loss': 7.124250966310501, 'time_step': 0.007693496942520142, 'init_value': 42.606712341308594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:44.31[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094844102859497, 'time_algorithm_update': 0.005544284105300903, 'loss': 7.832087944507599, 'time_step': 0.007692040920257569, 'init_value': 46.552581787109375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:44.40[0m [[32m[1minfo     [0m] [1mFQE_20250505174308: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020825126171112062, 'time_algorithm_update': 0.005534915685653686, 'loss': 8.695033282518386, 'time_step': 0.007670234680175781, 'init_value': 52.157325744628906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.157325744628906
ave advantage rew: 53.913815307617185, std: 2.320083390764889
avg cum rews: 955.8647375500001, std: 42.196386959525206
Pearson correlation coefficient: 0.336199349222605
Spearman correlation coefficient: 0.27669172932330827
Kendall Tau correlation coefficient: 0.18947368421052632
the best agent: 6, best agent cum rewards: 1001.862114
1957
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.017991998518317807
avg return on 5 trajectories of agent0: 906.5457153333333
Episode generator created
[2m2025-05-05 17:45.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:45.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:45.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:45.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:45.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174503[0m
[2m2025-05-05 17:45.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:45.12[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020741753578186035, 'time_algorithm_update': 0.005533409357070923, 'loss': 1.6443342387527227, 'time_step': 0.007659876585006714, 'init_value': 3.533748149871826}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:45.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020754942893981936, 'time_algorithm_update': 0.005541818380355835, 'loss': 3.8913302952051163, 'time_step': 0.00766953182220459, 'init_value': 8.290308952331543}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:45.31[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940091609954834, 'time_algorithm_update': 0.005563756704330444, 'loss': 4.575907624721527, 'time_step': 0.007711267948150634, 'init_value': 13.630193710327148}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:45.40[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002076212406158447, 'time_algorithm_update': 0.005550902605056762, 'loss': 5.2826472002267835, 'time_step': 0.007680058002471924, 'init_value': 20.345474243164062}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:45.49[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020909168720245363, 'time_algorithm_update': 0.005561751127243042, 'loss': 5.739365873336792, 'time_step': 0.007705819606781006, 'init_value': 26.27690887451172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:45.58[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020931293964385985, 'time_algorithm_update': 0.0055557191371917725, 'loss': 6.124688633918762, 'time_step': 0.00770225715637207, 'init_value': 32.62291717529297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:46.07[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020882632732391357, 'time_algorithm_update': 0.005555374383926392, 'loss': 6.554965520143509, 'time_step': 0.0076968657970428464, 'init_value': 37.61170959472656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:46.17[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097165584564209, 'time_algorithm_update': 0.005567041873931885, 'loss': 7.236937499761582, 'time_step': 0.007717769384384155, 'init_value': 42.7431526184082}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:46.26[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020905327796936035, 'time_algorithm_update': 0.0055702214241027835, 'loss': 8.093276045322419, 'time_step': 0.007714115619659424, 'init_value': 48.05887222290039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:46.35[0m [[32m[1minfo     [0m] [1mFQE_20250505174503: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090876579284668, 'time_algorithm_update': 0.005562685251235962, 'loss': 9.869685706615448, 'time_step': 0.007706885099411011, 'init_value': 54.73957061767578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.73957061767578
avg return on 5 trajectories of agent1: 920.2326966666668
Episode generator created
[2m2025-05-05 17:46.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:46.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:46.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:46.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:46.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174638[0m
[2m2025-05-05 17:46.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:46.48[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020759594440460205, 'time_algorithm_update': 0.005513564348220825, 'loss': 1.5648552789539099, 'time_step': 0.00764168643951416, 'init_value': 3.270686626434326}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:46.57[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083982229232788, 'time_algorithm_update': 0.005532401561737061, 'loss': 3.9000608546733857, 'time_step': 0.007669166564941406, 'init_value': 7.809878826141357}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:47.06[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020856785774230955, 'time_algorithm_update': 0.005522008419036865, 'loss': 4.4926305693387985, 'time_step': 0.007660255432128906, 'init_value': 13.47670841217041}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:47.15[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002115703344345093, 'time_algorithm_update': 0.005599317312240601, 'loss': 4.994487495183945, 'time_step': 0.00776911449432373, 'init_value': 19.75474739074707}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:47.25[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020994417667388916, 'time_algorithm_update': 0.005536679744720459, 'loss': 5.566162884235382, 'time_step': 0.007689249515533447, 'init_value': 27.07290267944336}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:47.34[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094036340713501, 'time_algorithm_update': 0.005538799524307251, 'loss': 5.710563400030136, 'time_step': 0.007685870170593262, 'init_value': 32.159088134765625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:47.43[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096608638763428, 'time_algorithm_update': 0.005550367832183838, 'loss': 6.745317130327225, 'time_step': 0.007702317476272583, 'init_value': 38.97584533691406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:47.52[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209354829788208, 'time_algorithm_update': 0.005545971632003785, 'loss': 7.744223180055618, 'time_step': 0.007693050146102906, 'init_value': 45.370887756347656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:48.01[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020975224971771242, 'time_algorithm_update': 0.005556102991104126, 'loss': 8.690225721359253, 'time_step': 0.007707516431808472, 'init_value': 51.42986297607422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:48.11[0m [[32m[1minfo     [0m] [1mFQE_20250505174638: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020968286991119383, 'time_algorithm_update': 0.005554560422897339, 'loss': 10.13472026538849, 'time_step': 0.007704733610153198, 'init_value': 56.85744857788086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.85744857788086
avg return on 5 trajectories of agent2: 960.2064633333333
Episode generator created
[2m2025-05-05 17:48.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:48.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:48.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:48.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:48.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174814[0m
[2m2025-05-05 17:48.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:48.23[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020837557315826418, 'time_algorithm_update': 0.005532694339752197, 'loss': 1.6997071002572774, 'time_step': 0.007668771266937256, 'init_value': 4.277663230895996}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:48.32[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020810387134552, 'time_algorithm_update': 0.005529238224029541, 'loss': 3.935201647400856, 'time_step': 0.007662961483001709, 'init_value': 9.59975814819336}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:48.42[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020961854457855226, 'time_algorithm_update': 0.005558295011520386, 'loss': 4.713414401292801, 'time_step': 0.0077076256275177, 'init_value': 16.083858489990234}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:48.51[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020830535888671873, 'time_algorithm_update': 0.005546191930770874, 'loss': 4.9834598890542985, 'time_step': 0.00768222975730896, 'init_value': 22.4785099029541}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:49.00[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020816540718078614, 'time_algorithm_update': 0.005532286167144775, 'loss': 5.854994618415833, 'time_step': 0.0076667826175689695, 'init_value': 28.46877098083496}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:49.09[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020881249904632568, 'time_algorithm_update': 0.005544742345809936, 'loss': 6.218701762437821, 'time_step': 0.007685809373855591, 'init_value': 33.48302459716797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:49.19[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091978073120117, 'time_algorithm_update': 0.005541799068450928, 'loss': 6.832155015468597, 'time_step': 0.007687134504318237, 'init_value': 38.55012130737305}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:49.28[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020846498012542726, 'time_algorithm_update': 0.0055412139892578125, 'loss': 7.746908523082733, 'time_step': 0.007678814172744751, 'init_value': 43.935367584228516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:49.37[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088451147079468, 'time_algorithm_update': 0.005544018507003784, 'loss': 8.43977918767929, 'time_step': 0.007686067581176758, 'init_value': 50.802982330322266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:49.46[0m [[32m[1minfo     [0m] [1mFQE_20250505174814: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020792996883392334, 'time_algorithm_update': 0.0055240395069122315, 'loss': 9.070888827323914, 'time_step': 0.00765643048286438, 'init_value': 53.81517028808594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.81517028808594
avg return on 5 trajectories of agent3: 936.485493
Episode generator created
[2m2025-05-05 17:49.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:49.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:49.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:49.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:49.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505174949[0m
[2m2025-05-05 17:49.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:49.58[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057389259338379, 'time_algorithm_update': 0.005451719045639038, 'loss': 1.633538550287485, 'time_step': 0.007559658765792847, 'init_value': 3.387113094329834}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:50.08[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073667049407959, 'time_algorithm_update': 0.005482191562652588, 'loss': 3.882178808927536, 'time_step': 0.007607835531234741, 'init_value': 8.694671630859375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:50.17[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002069620132446289, 'time_algorithm_update': 0.005480140209197998, 'loss': 4.694232757210732, 'time_step': 0.007601361513137817, 'init_value': 15.177970886230469}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:50.26[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020708634853363037, 'time_algorithm_update': 0.005466213941574097, 'loss': 5.519160085201263, 'time_step': 0.007588160753250122, 'init_value': 22.966291427612305}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:50.35[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002072169780731201, 'time_algorithm_update': 0.005467175006866455, 'loss': 5.98166675567627, 'time_step': 0.007591817617416382, 'init_value': 28.986989974975586}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:50.44[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002124373435974121, 'time_algorithm_update': 0.005600744009017945, 'loss': 6.480124259233475, 'time_step': 0.0077789690494537355, 'init_value': 34.859676361083984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:50.54[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021002488136291505, 'time_algorithm_update': 0.005544648647308349, 'loss': 7.079441396474838, 'time_step': 0.0076978871822357174, 'init_value': 40.24673843383789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:51.03[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967061519622803, 'time_algorithm_update': 0.005557750463485718, 'loss': 8.764050934314728, 'time_step': 0.007707603216171264, 'init_value': 46.3515625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:51.12[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020876147747039796, 'time_algorithm_update': 0.005530810594558716, 'loss': 9.29621580696106, 'time_step': 0.007671175241470337, 'init_value': 51.30905532836914}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:51.21[0m [[32m[1minfo     [0m] [1mFQE_20250505174949: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020934860706329347, 'time_algorithm_update': 0.005547222137451172, 'loss': 10.786694960594177, 'time_step': 0.007693578720092773, 'init_value': 60.243404388427734}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 60.243404388427734
avg return on 5 trajectories of agent4: 954.5912513333333
Episode generator created
[2m2025-05-05 17:51.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:51.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:51.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:51.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:51.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175124[0m
[2m2025-05-05 17:51.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:51.34[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020814306735992432, 'time_algorithm_update': 0.005528761863708496, 'loss': 1.6821231340169907, 'time_step': 0.007661992073059082, 'init_value': 3.697185754776001}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:51.43[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020898354053497316, 'time_algorithm_update': 0.005550312519073486, 'loss': 3.9031809945106506, 'time_step': 0.0076924369335174565, 'init_value': 8.523247718811035}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:51.52[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020904994010925294, 'time_algorithm_update': 0.0055532739162445065, 'loss': 4.796957286834717, 'time_step': 0.007696429967880249, 'init_value': 13.733835220336914}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:52.01[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020944042205810545, 'time_algorithm_update': 0.005564432144165039, 'loss': 5.573628552675247, 'time_step': 0.007711692571640015, 'init_value': 19.795705795288086}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:52.11[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087741136550903, 'time_algorithm_update': 0.005550271272659302, 'loss': 5.737837480545044, 'time_step': 0.007690307140350342, 'init_value': 26.613908767700195}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:52.20[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021001222133636473, 'time_algorithm_update': 0.005562973737716675, 'loss': 6.258695258975029, 'time_step': 0.007715617418289185, 'init_value': 32.9991569519043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:52.29[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020939433574676514, 'time_algorithm_update': 0.005567827463150024, 'loss': 6.500496086359024, 'time_step': 0.007714744329452515, 'init_value': 37.969146728515625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:52.38[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020838401317596436, 'time_algorithm_update': 0.005545009613037109, 'loss': 7.572053163766861, 'time_step': 0.007680838346481323, 'init_value': 42.49644470214844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:52.48[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092794418334961, 'time_algorithm_update': 0.005561813116073609, 'loss': 8.628762824058533, 'time_step': 0.00770751953125, 'init_value': 48.03432083129883}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:52.57[0m [[32m[1minfo     [0m] [1mFQE_20250505175124: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020898311138153078, 'time_algorithm_update': 0.005562753200531006, 'loss': 9.421830417871476, 'time_step': 0.007705362319946289, 'init_value': 54.66782760620117}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.66782760620117
avg return on 5 trajectories of agent5: 942.3001633333333
Episode generator created
[2m2025-05-05 17:53.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:53.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:53.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:53.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:53.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175300[0m
[2m2025-05-05 17:53.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:53.09[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020787427425384523, 'time_algorithm_update': 0.00552333402633667, 'loss': 1.6341562186926604, 'time_step': 0.007654084444046021, 'init_value': 3.770110845565796}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:53.18[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020872881412506102, 'time_algorithm_update': 0.005545968770980835, 'loss': 3.8625795015096664, 'time_step': 0.007686280488967896, 'init_value': 8.45563793182373}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:53.28[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209414005279541, 'time_algorithm_update': 0.005548620700836181, 'loss': 4.840625295996666, 'time_step': 0.007695787906646728, 'init_value': 15.082208633422852}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:53.37[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020867905616760254, 'time_algorithm_update': 0.005539067268371582, 'loss': 5.2117325887680055, 'time_step': 0.007678964853286743, 'init_value': 21.993453979492188}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:53.46[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100058078765869, 'time_algorithm_update': 0.005551333665847778, 'loss': 5.821528558969498, 'time_step': 0.007704432725906372, 'init_value': 27.7104434967041}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:53.55[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091370582580566, 'time_algorithm_update': 0.00553946852684021, 'loss': 5.744687081217766, 'time_step': 0.007684030532836914, 'init_value': 32.153053283691406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:54.04[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091752529144287, 'time_algorithm_update': 0.005534917831420899, 'loss': 6.598377952098846, 'time_step': 0.007679400444030762, 'init_value': 39.07125473022461}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:54.14[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021103265285491945, 'time_algorithm_update': 0.005601988554000854, 'loss': 7.6648709349632265, 'time_step': 0.007765872240066528, 'init_value': 46.39112854003906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:54.23[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002109732151031494, 'time_algorithm_update': 0.005591601371765137, 'loss': 8.950219698667526, 'time_step': 0.007755037069320679, 'init_value': 50.495052337646484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:54.32[0m [[32m[1minfo     [0m] [1mFQE_20250505175300: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094661712646484, 'time_algorithm_update': 0.005531692743301391, 'loss': 10.014622301340102, 'time_step': 0.007679221153259278, 'init_value': 55.9116096496582}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.9116096496582
avg return on 5 trajectories of agent6: 917.151903
Episode generator created
[2m2025-05-05 17:54.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:54.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:54.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:54.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:54.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175436[0m
[2m2025-05-05 17:54.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:54.45[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020851991176605226, 'time_algorithm_update': 0.005549061059951782, 'loss': 1.616306608095765, 'time_step': 0.007686834812164306, 'init_value': 3.575254440307617}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:54.54[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091150760650635, 'time_algorithm_update': 0.00554542875289917, 'loss': 4.172159850716591, 'time_step': 0.007689147472381592, 'init_value': 9.847831726074219}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:55.03[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020855672359466554, 'time_algorithm_update': 0.005531758546829224, 'loss': 4.985024366140365, 'time_step': 0.007669628143310547, 'init_value': 15.700867652893066}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:55.13[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093912363052368, 'time_algorithm_update': 0.005546991109848022, 'loss': 5.337444216251373, 'time_step': 0.007694104671478272, 'init_value': 21.014930725097656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:55.22[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094797134399414, 'time_algorithm_update': 0.0055478098392486574, 'loss': 5.611629259824753, 'time_step': 0.007695858478546143, 'init_value': 25.648046493530273}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:55.31[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020892837047576905, 'time_algorithm_update': 0.005537843227386475, 'loss': 5.901877111434937, 'time_step': 0.007680025577545166, 'init_value': 31.37105369567871}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:55.40[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097887992858887, 'time_algorithm_update': 0.005548271179199218, 'loss': 6.522187093257904, 'time_step': 0.00769962215423584, 'init_value': 37.628440856933594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:55.49[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020955219268798827, 'time_algorithm_update': 0.005543991804122925, 'loss': 7.239641338586807, 'time_step': 0.0076926169395446775, 'init_value': 43.31420135498047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:55.59[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094732046127319, 'time_algorithm_update': 0.005552727222442627, 'loss': 8.50512069106102, 'time_step': 0.007700472354888916, 'init_value': 49.222164154052734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:56.08[0m [[32m[1minfo     [0m] [1mFQE_20250505175436: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020954153537750242, 'time_algorithm_update': 0.005554494142532349, 'loss': 9.469743509054185, 'time_step': 0.007703030347824096, 'init_value': 55.38813400268555}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.38813400268555
avg return on 5 trajectories of agent7: 968.0893763333333
Episode generator created
[2m2025-05-05 17:56.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:56.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:56.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:56.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:56.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175611[0m
[2m2025-05-05 17:56.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:56.20[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002076024532318115, 'time_algorithm_update': 0.005531821250915527, 'loss': 1.561323087155819, 'time_step': 0.0076607284545898435, 'init_value': 3.5795440673828125}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:56.30[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020866832733154295, 'time_algorithm_update': 0.005521631479263306, 'loss': 3.698135044693947, 'time_step': 0.007661107540130615, 'init_value': 7.6132426261901855}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:56.39[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092637062072754, 'time_algorithm_update': 0.005526418924331665, 'loss': 4.394487404108047, 'time_step': 0.007672159671783447, 'init_value': 14.008188247680664}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:56.48[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002105579137802124, 'time_algorithm_update': 0.005540795564651489, 'loss': 4.9042192922830585, 'time_step': 0.007699888706207275, 'init_value': 20.770532608032227}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:56.57[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096989393234253, 'time_algorithm_update': 0.0055400655269622805, 'loss': 5.488311205387116, 'time_step': 0.007690196514129639, 'init_value': 28.158578872680664}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:57.06[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021033360958099367, 'time_algorithm_update': 0.005557526588439941, 'loss': 6.203584432840347, 'time_step': 0.0077141613960266114, 'init_value': 34.04328918457031}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:57.16[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021056678295135497, 'time_algorithm_update': 0.005553894519805909, 'loss': 6.584418393850327, 'time_step': 0.007713067054748535, 'init_value': 39.63736343383789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:57.25[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002098694324493408, 'time_algorithm_update': 0.005543035268783569, 'loss': 7.515841546058655, 'time_step': 0.0076944539546966555, 'init_value': 43.891334533691406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:57.34[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102625131607056, 'time_algorithm_update': 0.005532759428024292, 'loss': 8.510049947738647, 'time_step': 0.007688811779022217, 'init_value': 50.174190521240234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:57.43[0m [[32m[1minfo     [0m] [1mFQE_20250505175611: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002108177900314331, 'time_algorithm_update': 0.005561215162277222, 'loss': 10.030874678850173, 'time_step': 0.007723507881164551, 'init_value': 56.459407806396484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.459407806396484
avg return on 5 trajectories of agent8: 938.9290573333334
Episode generator created
[2m2025-05-05 17:57.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:57.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:57.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:57.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:57.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175747[0m
[2m2025-05-05 17:57.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:57.56[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002077484846115112, 'time_algorithm_update': 0.0055209040641784664, 'loss': 1.6967025960832833, 'time_step': 0.007650251388549805, 'init_value': 3.979132652282715}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:58.05[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020919132232666018, 'time_algorithm_update': 0.0055413758754730225, 'loss': 3.961598289489746, 'time_step': 0.007685697793960571, 'init_value': 8.252617835998535}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:58.14[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091633081436157, 'time_algorithm_update': 0.005542678594589233, 'loss': 4.70067941391468, 'time_step': 0.007686937808990478, 'init_value': 13.466118812561035}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:58.23[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002098618984222412, 'time_algorithm_update': 0.005543660879135132, 'loss': 5.047288564920425, 'time_step': 0.007695208549499512, 'init_value': 19.535043716430664}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 17:58.33[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021009302139282228, 'time_algorithm_update': 0.00553834080696106, 'loss': 5.183907473087311, 'time_step': 0.007692180633544922, 'init_value': 26.11249351501465}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 17:58.42[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020961472988128664, 'time_algorithm_update': 0.0055391998291015624, 'loss': 6.27269838476181, 'time_step': 0.007688022375106811, 'init_value': 35.14973449707031}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 17:58.51[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101632833480835, 'time_algorithm_update': 0.005548471927642822, 'loss': 7.327449732303619, 'time_step': 0.007703134775161743, 'init_value': 42.751609802246094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 17:59.00[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095928430557251, 'time_algorithm_update': 0.005542102575302124, 'loss': 9.01644325375557, 'time_step': 0.00769083046913147, 'init_value': 51.36866760253906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 17:59.10[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209844970703125, 'time_algorithm_update': 0.0055425455570220945, 'loss': 10.309165131807328, 'time_step': 0.0076944146156311035, 'init_value': 55.29358673095703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 17:59.19[0m [[32m[1minfo     [0m] [1mFQE_20250505175747: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021038088798522947, 'time_algorithm_update': 0.0055607836246490475, 'loss': 11.787702196121217, 'time_step': 0.007718436002731323, 'init_value': 60.69269561767578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 60.69269561767578
avg return on 5 trajectories of agent9: 891.0483916666667
Episode generator created
[2m2025-05-05 17:59.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 17:59.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 17:59.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 17:59.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 17:59.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505175922[0m
[2m2025-05-05 17:59.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 17:59.31[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020720887184143065, 'time_algorithm_update': 0.005516679286956787, 'loss': 1.6253917165994645, 'time_step': 0.007640816450119018, 'init_value': 3.6274538040161133}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 17:59.40[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085737705230713, 'time_algorithm_update': 0.0055340960025787355, 'loss': 3.8531924823522568, 'time_step': 0.0076721301078796385, 'init_value': 8.047284126281738}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 17:59.50[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092584133148193, 'time_algorithm_update': 0.0055334272384643555, 'loss': 4.5843038818836215, 'time_step': 0.007678221464157104, 'init_value': 13.930562019348145}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 17:59.59[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020784320831298826, 'time_algorithm_update': 0.005520714044570923, 'loss': 5.40392258310318, 'time_step': 0.00765123200416565, 'init_value': 22.464656829833984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:00.08[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020975496768951417, 'time_algorithm_update': 0.005561807870864868, 'loss': 6.223100961923599, 'time_step': 0.007712332010269165, 'init_value': 29.082258224487305}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:00.17[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090723276138306, 'time_algorithm_update': 0.005548268795013428, 'loss': 6.655210033655167, 'time_step': 0.007691517829895019, 'init_value': 35.056915283203125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:00.26[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057410955429077, 'time_algorithm_update': 0.0054706201553344725, 'loss': 6.93040685582161, 'time_step': 0.007579219818115234, 'init_value': 39.69861602783203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:00.36[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002072894811630249, 'time_algorithm_update': 0.005479888677597046, 'loss': 7.3700043139457705, 'time_step': 0.0076043660640716555, 'init_value': 44.110992431640625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:00.45[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067544460296631, 'time_algorithm_update': 0.00546856689453125, 'loss': 8.344965475797654, 'time_step': 0.007587599515914917, 'init_value': 48.63831329345703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:00.54[0m [[32m[1minfo     [0m] [1mFQE_20250505175922: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067401647567749, 'time_algorithm_update': 0.005478291988372803, 'loss': 9.027715656280517, 'time_step': 0.007597695350646973, 'init_value': 52.453895568847656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.453895568847656
avg return on 5 trajectories of agent10: 936.1318556666666
Episode generator created
[2m2025-05-05 18:00.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:00.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:00.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:00.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:00.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180057[0m
[2m2025-05-05 18:00.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:01.06[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020505001544952393, 'time_algorithm_update': 0.005440086603164673, 'loss': 1.64839658819139, 'time_step': 0.007541393756866455, 'init_value': 3.5303847789764404}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:01.15[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020946221351623535, 'time_algorithm_update': 0.005542144775390625, 'loss': 4.231623744487762, 'time_step': 0.0076897268295288085, 'init_value': 8.767599105834961}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:01.24[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002080958366394043, 'time_algorithm_update': 0.005521348476409912, 'loss': 4.655208143949508, 'time_step': 0.007654844522476196, 'init_value': 13.466270446777344}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:01.34[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089467287063599, 'time_algorithm_update': 0.005547272443771362, 'loss': 5.184542187094689, 'time_step': 0.007689839839935303, 'init_value': 19.90243148803711}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:01.43[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020780723094940183, 'time_algorithm_update': 0.005532850980758667, 'loss': 5.560173867702484, 'time_step': 0.007664103984832763, 'init_value': 27.191532135009766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:01.52[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020945539474487304, 'time_algorithm_update': 0.005532176494598389, 'loss': 6.274822711229325, 'time_step': 0.007679589033126831, 'init_value': 32.953346252441406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:02.01[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094783544540405, 'time_algorithm_update': 0.0055420975685119625, 'loss': 7.121861459970474, 'time_step': 0.007690004348754883, 'init_value': 39.256072998046875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:02.11[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084850788116455, 'time_algorithm_update': 0.005531070947647094, 'loss': 8.275119455814362, 'time_step': 0.007668889284133911, 'init_value': 47.60879898071289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:02.20[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085944890975952, 'time_algorithm_update': 0.005537095546722412, 'loss': 8.815028059005737, 'time_step': 0.007675905704498291, 'init_value': 50.16861343383789}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:02.29[0m [[32m[1minfo     [0m] [1mFQE_20250505180057: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020853397846221926, 'time_algorithm_update': 0.005527140617370606, 'loss': 9.467113805055618, 'time_step': 0.007665632724761963, 'init_value': 55.42560577392578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.42560577392578
avg return on 5 trajectories of agent11: 994.1896069999999
Episode generator created
[2m2025-05-05 18:02.32[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:02.32[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:02.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:02.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:02.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180232[0m
[2m2025-05-05 18:02.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:02.41[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002068385601043701, 'time_algorithm_update': 0.00551661491394043, 'loss': 1.6717736009657382, 'time_step': 0.007636884450912476, 'init_value': 3.142448902130127}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:02.51[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020826151371002195, 'time_algorithm_update': 0.0055258855819702146, 'loss': 3.8673331928253174, 'time_step': 0.007660756349563599, 'init_value': 7.94390869140625}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:03.00[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020877397060394287, 'time_algorithm_update': 0.005538914918899536, 'loss': 4.595299431324005, 'time_step': 0.007679288387298584, 'init_value': 15.204767227172852}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:03.09[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084989547729492, 'time_algorithm_update': 0.005540562152862549, 'loss': 5.2407260775566105, 'time_step': 0.00767813777923584, 'init_value': 21.138071060180664}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:03.18[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002109575510025024, 'time_algorithm_update': 0.005595454454421997, 'loss': 5.358027596235275, 'time_step': 0.007758538961410522, 'init_value': 26.178403854370117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:03.27[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091606855392456, 'time_algorithm_update': 0.005541894674301147, 'loss': 6.335033684015274, 'time_step': 0.0076866884231567385, 'init_value': 31.562664031982422}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:03.37[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020937123298645018, 'time_algorithm_update': 0.0055401451587677, 'loss': 6.430787802219391, 'time_step': 0.0076866307258605954, 'init_value': 36.85274124145508}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:03.46[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100381374359131, 'time_algorithm_update': 0.0055567224025726315, 'loss': 6.88037832903862, 'time_step': 0.007710052251815796, 'init_value': 42.684688568115234}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:03.55[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092549562454224, 'time_algorithm_update': 0.00554351019859314, 'loss': 7.864165237665176, 'time_step': 0.007689070463180542, 'init_value': 46.101871490478516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:04.04[0m [[32m[1minfo     [0m] [1mFQE_20250505180232: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020939345359802246, 'time_algorithm_update': 0.005545706748962403, 'loss': 8.587466722488402, 'time_step': 0.007693332433700561, 'init_value': 51.28324890136719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.28324890136719
avg return on 5 trajectories of agent12: 938.8540816666667
Episode generator created
[2m2025-05-05 18:04.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:04.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:04.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:04.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:04.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180408[0m
[2m2025-05-05 18:04.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:04.17[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020754082202911377, 'time_algorithm_update': 0.005512056350708008, 'loss': 1.6356037233769893, 'time_step': 0.007639414548873901, 'init_value': 3.5669867992401123}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:04.26[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089491605758667, 'time_algorithm_update': 0.005525611877441407, 'loss': 4.513188338160515, 'time_step': 0.007667579889297485, 'init_value': 9.549819946289062}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:04.35[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020939490795135497, 'time_algorithm_update': 0.00554973554611206, 'loss': 5.2492864217758175, 'time_step': 0.007696687936782837, 'init_value': 15.338820457458496}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:04.45[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021060483455657957, 'time_algorithm_update': 0.005572394847869873, 'loss': 5.603310209512711, 'time_step': 0.007731655359268189, 'init_value': 20.830875396728516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:04.54[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095908880233765, 'time_algorithm_update': 0.0055344560146331784, 'loss': 5.951782255887985, 'time_step': 0.007683028697967529, 'init_value': 28.02474594116211}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:05.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020972023010253906, 'time_algorithm_update': 0.00553493070602417, 'loss': 6.763186359882355, 'time_step': 0.007684802770614624, 'init_value': 33.474159240722656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:05.12[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940380096435545, 'time_algorithm_update': 0.0055362508296966555, 'loss': 7.097356300354004, 'time_step': 0.00768313455581665, 'init_value': 38.8209114074707}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097867012023926, 'time_algorithm_update': 0.005548254013061523, 'loss': 8.007880831480026, 'time_step': 0.007704338073730469, 'init_value': 44.10701370239258}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:05.31[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020876870155334473, 'time_algorithm_update': 0.005536314010620117, 'loss': 8.653272716999053, 'time_step': 0.007676519632339477, 'init_value': 48.61486053466797}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:05.40[0m [[32m[1minfo     [0m] [1mFQE_20250505180408: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097412109375, 'time_algorithm_update': 0.005536914587020874, 'loss': 8.93241299366951, 'time_step': 0.0076874964237213135, 'init_value': 51.52320098876953}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.52320098876953
avg return on 5 trajectories of agent13: 929.8077286666667
Episode generator created
[2m2025-05-05 18:05.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:05.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:05.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:05.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:05.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180543[0m
[2m2025-05-05 18:05.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:05.52[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020728187561035154, 'time_algorithm_update': 0.005521058320999145, 'loss': 1.6266882311105728, 'time_step': 0.007646252632141113, 'init_value': 3.7387256622314453}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:06.02[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081749677658081, 'time_algorithm_update': 0.005539639711380005, 'loss': 3.954402769804001, 'time_step': 0.0076743500232696535, 'init_value': 8.35147476196289}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:06.11[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020785129070281985, 'time_algorithm_update': 0.005529006242752075, 'loss': 4.855644940137863, 'time_step': 0.007660458326339722, 'init_value': 13.88668441772461}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:06.20[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085306406021118, 'time_algorithm_update': 0.005541327953338623, 'loss': 5.08073004579544, 'time_step': 0.007679908514022827, 'init_value': 20.66922378540039}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:06.29[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020719759464263915, 'time_algorithm_update': 0.005516835927963257, 'loss': 6.030593681573868, 'time_step': 0.007641377449035644, 'init_value': 28.350282669067383}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:06.38[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020889623165130616, 'time_algorithm_update': 0.005535342216491699, 'loss': 6.3004340648651125, 'time_step': 0.007677913665771485, 'init_value': 33.29937744140625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:06.48[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087642192840576, 'time_algorithm_update': 0.005538254022598266, 'loss': 6.664259278774262, 'time_step': 0.007679310083389282, 'init_value': 37.878841400146484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:06.57[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020825982093811033, 'time_algorithm_update': 0.005526854276657105, 'loss': 7.545666621685028, 'time_step': 0.0076623990535736085, 'init_value': 42.770145416259766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:07.06[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208786416053772, 'time_algorithm_update': 0.0055296080112457275, 'loss': 8.428039230585098, 'time_step': 0.007670583486557006, 'init_value': 48.23278045654297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:07.15[0m [[32m[1minfo     [0m] [1mFQE_20250505180543: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020816473960876465, 'time_algorithm_update': 0.00552094578742981, 'loss': 9.24151190185547, 'time_step': 0.007655738353729248, 'init_value': 54.287269592285156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.287269592285156
avg return on 5 trajectories of agent14: 927.422924
Episode generator created
[2m2025-05-05 18:07.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:07.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:07.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:07.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:07.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180718[0m
[2m2025-05-05 18:07.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:07.27[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020732738971710207, 'time_algorithm_update': 0.005512764453887939, 'loss': 1.5732733100354672, 'time_step': 0.0076381247043609615, 'init_value': 3.402958631515503}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:07.37[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090972185134888, 'time_algorithm_update': 0.005548990249633789, 'loss': 3.8781854251623153, 'time_step': 0.007692771196365356, 'init_value': 8.673490524291992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:07.46[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081874370574951, 'time_algorithm_update': 0.005560547113418579, 'loss': 4.586960844278336, 'time_step': 0.007695191860198974, 'init_value': 13.439963340759277}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:07.55[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020922043323516847, 'time_algorithm_update': 0.00554438591003418, 'loss': 5.020217032194138, 'time_step': 0.007689478874206543, 'init_value': 20.087854385375977}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:08.05[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021013996601104735, 'time_algorithm_update': 0.005588584423065186, 'loss': 5.895044081926346, 'time_step': 0.007743772268295288, 'init_value': 27.82424545288086}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:08.14[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089620351791382, 'time_algorithm_update': 0.005549201726913452, 'loss': 6.0004809012413025, 'time_step': 0.007691577196121215, 'init_value': 32.71621322631836}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:08.23[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020869438648223877, 'time_algorithm_update': 0.005551412105560303, 'loss': 6.640953275680542, 'time_step': 0.007690962076187134, 'init_value': 36.929351806640625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:08.32[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020929036140441893, 'time_algorithm_update': 0.0055549037456512455, 'loss': 7.295343401193619, 'time_step': 0.007700770616531372, 'init_value': 42.49158477783203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:08.41[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209687876701355, 'time_algorithm_update': 0.005583630561828613, 'loss': 8.066313343763351, 'time_step': 0.007733888864517212, 'init_value': 46.931148529052734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505180718: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021000375747680664, 'time_algorithm_update': 0.005580951690673828, 'loss': 9.077883065462112, 'time_step': 0.007734856843948364, 'init_value': 50.734397888183594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.734397888183594
avg return on 5 trajectories of agent15: 892.0677863333334
Episode generator created
[2m2025-05-05 18:08.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:08.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:08.54[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:08.54[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:08.54[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505180854[0m
[2m2025-05-05 18:08.54[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:09.03[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020866320133209226, 'time_algorithm_update': 0.00554242205619812, 'loss': 1.658952230706811, 'time_step': 0.007681507825851441, 'init_value': 3.4217453002929688}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:09.12[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020914154052734373, 'time_algorithm_update': 0.00554982876777649, 'loss': 3.8890439990758896, 'time_step': 0.00769410228729248, 'init_value': 7.234984874725342}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:09.22[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020869369506835937, 'time_algorithm_update': 0.005544649839401245, 'loss': 4.295986952662468, 'time_step': 0.007684659957885742, 'init_value': 12.825501441955566}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:09.31[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092076539993286, 'time_algorithm_update': 0.0055587530136108395, 'loss': 5.001803283214569, 'time_step': 0.0077042214870452885, 'init_value': 18.148401260375977}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:09.40[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020915756225585937, 'time_algorithm_update': 0.005563394784927368, 'loss': 5.395158068776131, 'time_step': 0.007708453178405762, 'init_value': 24.887910842895508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:09.49[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020910332202911377, 'time_algorithm_update': 0.005551933765411377, 'loss': 5.819239461898804, 'time_step': 0.007695985078811645, 'init_value': 30.659915924072266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:09.59[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209326958656311, 'time_algorithm_update': 0.005556012392044067, 'loss': 6.472726101636886, 'time_step': 0.007702685356140136, 'init_value': 36.048912048339844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:10.08[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021002674102783203, 'time_algorithm_update': 0.005569483280181885, 'loss': 7.05910502910614, 'time_step': 0.007723254203796387, 'init_value': 42.068389892578125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:10.17[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084439277648926, 'time_algorithm_update': 0.005546314239501953, 'loss': 7.686334851503372, 'time_step': 0.007684195041656494, 'init_value': 44.63801956176758}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:10.26[0m [[32m[1minfo     [0m] [1mFQE_20250505180854: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101036548614502, 'time_algorithm_update': 0.005553964853286743, 'loss': 8.642020647287369, 'time_step': 0.007708474397659302, 'init_value': 52.35600662231445}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.35600662231445
avg return on 5 trajectories of agent16: 904.5391983333334
Episode generator created
[2m2025-05-05 18:10.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:10.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:10.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:10.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:10.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181030[0m
[2m2025-05-05 18:10.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:10.39[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002076414346694946, 'time_algorithm_update': 0.0055404937267303465, 'loss': 1.7531357331871986, 'time_step': 0.007669029474258423, 'init_value': 4.080821514129639}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:10.48[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020623676776885987, 'time_algorithm_update': 0.005478221416473389, 'loss': 4.051731809854507, 'time_step': 0.007591586112976074, 'init_value': 9.106915473937988}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:10.57[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020656085014343264, 'time_algorithm_update': 0.005468880653381348, 'loss': 4.740439735651016, 'time_step': 0.007585703134536743, 'init_value': 14.688512802124023}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:11.06[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020734364986419677, 'time_algorithm_update': 0.005474403381347657, 'loss': 5.118032427310943, 'time_step': 0.007599255561828613, 'init_value': 20.266271591186523}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:11.15[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020745372772216796, 'time_algorithm_update': 0.0054712860584259036, 'loss': 5.7976419322490695, 'time_step': 0.007597366333007813, 'init_value': 28.248350143432617}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:11.24[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020690445899963377, 'time_algorithm_update': 0.00547547197341919, 'loss': 6.222956047534943, 'time_step': 0.007596294164657593, 'init_value': 34.23419189453125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:11.34[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020879268646240234, 'time_algorithm_update': 0.005539316654205323, 'loss': 6.924414772748947, 'time_step': 0.007679748296737671, 'init_value': 39.45708465576172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:11.43[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020911014080047608, 'time_algorithm_update': 0.0055453450679779056, 'loss': 7.413530691385269, 'time_step': 0.007689555168151855, 'init_value': 44.896175384521484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:11.52[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021033239364624022, 'time_algorithm_update': 0.005554002523422241, 'loss': 8.870854377031327, 'time_step': 0.007710764884948731, 'init_value': 48.97481155395508}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:12.01[0m [[32m[1minfo     [0m] [1mFQE_20250505181030: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020824332237243653, 'time_algorithm_update': 0.0055439770221710205, 'loss': 9.475931564807892, 'time_step': 0.007679601907730102, 'init_value': 54.432498931884766}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.432498931884766
avg return on 5 trajectories of agent17: 977.5857826666667
Episode generator created
[2m2025-05-05 18:12.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:12.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:12.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:12.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:12.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181205[0m
[2m2025-05-05 18:12.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:12.14[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020794203281402587, 'time_algorithm_update': 0.005524687051773071, 'loss': 1.6597131083011627, 'time_step': 0.007656456708908081, 'init_value': 4.291104316711426}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:12.23[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020932538509368897, 'time_algorithm_update': 0.005535896301269531, 'loss': 3.9562942259311678, 'time_step': 0.007681621074676514, 'init_value': 10.338617324829102}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:12.32[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020847692489624025, 'time_algorithm_update': 0.005530286550521851, 'loss': 5.049779555916786, 'time_step': 0.007667841911315918, 'init_value': 16.395401000976562}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:12.41[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100051641464233, 'time_algorithm_update': 0.005543403863906861, 'loss': 5.401979796648026, 'time_step': 0.007696541786193847, 'init_value': 23.500606536865234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:12.51[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020898900032043457, 'time_algorithm_update': 0.005555705785751343, 'loss': 6.1647883648872375, 'time_step': 0.0076987755298614504, 'init_value': 30.103429794311523}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:13.00[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020909128189086916, 'time_algorithm_update': 0.005538377285003662, 'loss': 6.707280427932739, 'time_step': 0.00768189001083374, 'init_value': 35.605552673339844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:13.09[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091535806655884, 'time_algorithm_update': 0.005528973817825317, 'loss': 7.70663050031662, 'time_step': 0.007673012971878052, 'init_value': 41.4127311706543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:13.18[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020966901779174807, 'time_algorithm_update': 0.005545339584350586, 'loss': 7.702532656431198, 'time_step': 0.00769501519203186, 'init_value': 46.32497024536133}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:13.28[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020936195850372315, 'time_algorithm_update': 0.005529880046844482, 'loss': 8.736601028203964, 'time_step': 0.007676255226135254, 'init_value': 50.11284637451172}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:13.37[0m [[32m[1minfo     [0m] [1mFQE_20250505181205: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940022468566894, 'time_algorithm_update': 0.005541142225265503, 'loss': 9.426743514060973, 'time_step': 0.00768795394897461, 'init_value': 51.63652420043945}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.63652420043945
avg return on 5 trajectories of agent18: 928.0965163333334
Episode generator created
[2m2025-05-05 18:13.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:13.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:13.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:13.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:13.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181340[0m
[2m2025-05-05 18:13.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:13.49[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020841188430786133, 'time_algorithm_update': 0.005535930871963501, 'loss': 1.7052842491567135, 'time_step': 0.00767252516746521, 'init_value': 4.381768703460693}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:13.58[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086678743362427, 'time_algorithm_update': 0.005540818214416504, 'loss': 4.071130486011505, 'time_step': 0.007679964780807495, 'init_value': 9.237893104553223}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:14.08[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102189779281616, 'time_algorithm_update': 0.005571092844009399, 'loss': 4.787599041461944, 'time_step': 0.007726529598236084, 'init_value': 15.922865867614746}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:14.17[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020973825454711913, 'time_algorithm_update': 0.005556583881378174, 'loss': 5.6023916612863545, 'time_step': 0.007707083702087402, 'init_value': 22.000608444213867}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:14.26[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020849785804748534, 'time_algorithm_update': 0.005550372123718262, 'loss': 5.975022735118866, 'time_step': 0.0076883029937744145, 'init_value': 28.516572952270508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:14.35[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020849776268005373, 'time_algorithm_update': 0.005528507947921753, 'loss': 6.542842231750488, 'time_step': 0.007666298151016235, 'init_value': 35.54308319091797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:14.44[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020938427448272704, 'time_algorithm_update': 0.0055441555976867675, 'loss': 7.411713985204696, 'time_step': 0.007690799474716186, 'init_value': 39.18488693237305}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:14.54[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091963768005371, 'time_algorithm_update': 0.005540472030639648, 'loss': 7.583831326723098, 'time_step': 0.007685659885406494, 'init_value': 44.72489929199219}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:15.03[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967350006103514, 'time_algorithm_update': 0.0055523371696472165, 'loss': 8.797196079254151, 'time_step': 0.007702142715454102, 'init_value': 50.13788604736328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:15.12[0m [[32m[1minfo     [0m] [1mFQE_20250505181340: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002120574235916138, 'time_algorithm_update': 0.005623982906341553, 'loss': 9.958767816781998, 'time_step': 0.007799426078796387, 'init_value': 54.51918029785156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.51918029785156
avg return on 5 trajectories of agent19: 963.0759403333333
Episode generator created
[2m2025-05-05 18:15.15[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:15.15[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:15.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:15.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:15.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181516[0m
[2m2025-05-05 18:15.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:15.25[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020694622993469238, 'time_algorithm_update': 0.0055225293636322025, 'loss': 1.5473020898997785, 'time_step': 0.007643621444702148, 'init_value': 3.1384971141815186}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:15.34[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020852532386779784, 'time_algorithm_update': 0.00553408432006836, 'loss': 3.798944296002388, 'time_step': 0.00767155408859253, 'init_value': 8.561318397521973}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:15.43[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096120595932007, 'time_algorithm_update': 0.005542845726013184, 'loss': 4.460254716992378, 'time_step': 0.0076917574405670165, 'init_value': 14.332619667053223}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:15.52[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020837483406066894, 'time_algorithm_update': 0.00554888105392456, 'loss': 5.013954552173614, 'time_step': 0.00768551778793335, 'init_value': 20.62411880493164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:16.02[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209283185005188, 'time_algorithm_update': 0.005556439638137818, 'loss': 5.456161752223968, 'time_step': 0.007702617645263672, 'init_value': 27.750587463378906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:16.11[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087777853012085, 'time_algorithm_update': 0.00554806923866272, 'loss': 6.077177008867264, 'time_step': 0.007688921928405762, 'init_value': 33.808189392089844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:16.20[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093604564666748, 'time_algorithm_update': 0.005546007871627808, 'loss': 6.911832943916321, 'time_step': 0.00769238567352295, 'init_value': 38.81607437133789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:16.29[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086532115936279, 'time_algorithm_update': 0.005536393642425537, 'loss': 7.5557353363037105, 'time_step': 0.007675665378570557, 'init_value': 43.59176254272461}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:16.38[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020932588577270506, 'time_algorithm_update': 0.005556950807571411, 'loss': 8.885260483503341, 'time_step': 0.0077034194469451905, 'init_value': 49.878761291503906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:16.48[0m [[32m[1minfo     [0m] [1mFQE_20250505181516: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020901031494140626, 'time_algorithm_update': 0.005537680387496948, 'loss': 9.780192703723907, 'time_step': 0.007680667877197266, 'init_value': 55.4379997253418}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.4379997253418
ave advantage rew: 54.64325485229492, std: 2.6059225266218227
avg cum rews: 936.3675966166668, std: 26.87941135659133
Pearson correlation coefficient: -0.035880300644232456
Spearman correlation coefficient: 0.061654135338345864
Kendall Tau correlation coefficient: 0.0736842105263158
the best agent: 8, best agent cum rewards: 938.9290573333334
1958
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.019447561309954318
avg return on 5 trajectories of agent0: 951.5139273333333
Episode generator created
[2m2025-05-05 18:17.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:17.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:17.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:17.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:17.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181710[0m
[2m2025-05-05 18:17.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:17.20[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020840163230895995, 'time_algorithm_update': 0.00553220009803772, 'loss': 1.6268756482750177, 'time_step': 0.007668804407119751, 'init_value': 3.127305507659912}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:17.29[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020894341468811035, 'time_algorithm_update': 0.005543442964553833, 'loss': 3.8502398302555085, 'time_step': 0.007686243057250976, 'init_value': 8.258869171142578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:17.38[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020916645526885985, 'time_algorithm_update': 0.0055539276599884035, 'loss': 4.528692535638809, 'time_step': 0.007698214054107666, 'init_value': 13.861821174621582}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:17.47[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088460445404053, 'time_algorithm_update': 0.005555346488952637, 'loss': 5.326580644130707, 'time_step': 0.007696301937103272, 'init_value': 20.963953018188477}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:17.57[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021027603149414062, 'time_algorithm_update': 0.005564199686050415, 'loss': 5.433482110738754, 'time_step': 0.007719779014587402, 'init_value': 25.426057815551758}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:18.06[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093480348587036, 'time_algorithm_update': 0.005579270362854004, 'loss': 6.047124979734421, 'time_step': 0.007726025819778442, 'init_value': 32.08988571166992}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:18.15[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020910744667053224, 'time_algorithm_update': 0.005556694269180298, 'loss': 6.799426786184311, 'time_step': 0.007700135231018066, 'init_value': 37.87990951538086}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:18.24[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092854261398315, 'time_algorithm_update': 0.005559176921844483, 'loss': 7.389579775333405, 'time_step': 0.0077045059204101565, 'init_value': 43.27348709106445}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:18.34[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091028928756714, 'time_algorithm_update': 0.00555620002746582, 'loss': 7.89586897277832, 'time_step': 0.0076995775699615476, 'init_value': 49.3270149230957}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:18.43[0m [[32m[1minfo     [0m] [1mFQE_20250505181710: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00210184383392334, 'time_algorithm_update': 0.005571748971939087, 'loss': 9.660704140901565, 'time_step': 0.007726849794387818, 'init_value': 54.24557876586914}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.24557876586914
avg return on 5 trajectories of agent1: 947.7453536666667
Episode generator created
[2m2025-05-05 18:18.46[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:18.46[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:18.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:18.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:18.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505181846[0m
[2m2025-05-05 18:18.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:18.55[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020785775184631347, 'time_algorithm_update': 0.005546793937683105, 'loss': 1.615884634077549, 'time_step': 0.007677967071533203, 'init_value': 3.776942253112793}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:19.04[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085458517074585, 'time_algorithm_update': 0.005549111366271973, 'loss': 4.019163916110992, 'time_step': 0.007686965703964234, 'init_value': 8.196839332580566}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:19.14[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002074979066848755, 'time_algorithm_update': 0.005546874046325684, 'loss': 4.6636765941381455, 'time_step': 0.00767492151260376, 'init_value': 14.058530807495117}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:19.23[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020849087238311768, 'time_algorithm_update': 0.005551810026168823, 'loss': 5.2500384457111355, 'time_step': 0.007689392328262329, 'init_value': 20.39029312133789}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:19.32[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020836045742034914, 'time_algorithm_update': 0.005547794342041015, 'loss': 5.5535659019947055, 'time_step': 0.007684673309326172, 'init_value': 25.577022552490234}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:19.41[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020817415714263917, 'time_algorithm_update': 0.005550154209136963, 'loss': 5.9165157678127285, 'time_step': 0.007684932947158813, 'init_value': 32.00956344604492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:19.51[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020851409435272217, 'time_algorithm_update': 0.005554489135742188, 'loss': 6.263016795158387, 'time_step': 0.007692731142044067, 'init_value': 34.738616943359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:20.00[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089238405227661, 'time_algorithm_update': 0.005553614139556884, 'loss': 7.032610933303833, 'time_step': 0.007695708990097046, 'init_value': 41.52969741821289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:20.09[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083146572113037, 'time_algorithm_update': 0.005544599294662476, 'loss': 7.63356045627594, 'time_step': 0.007680701732635498, 'init_value': 46.671791076660156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:20.18[0m [[32m[1minfo     [0m] [1mFQE_20250505181846: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020846781730651854, 'time_algorithm_update': 0.00555013632774353, 'loss': 8.489315480947495, 'time_step': 0.007687680959701538, 'init_value': 50.46273422241211}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.46273422241211
avg return on 5 trajectories of agent2: 925.5371173333333
Episode generator created
[2m2025-05-05 18:20.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:20.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:20.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:20.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:20.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182021[0m
[2m2025-05-05 18:20.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:20.31[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065460443496704, 'time_algorithm_update': 0.005505237579345703, 'loss': 1.6594056599140168, 'time_step': 0.007622892379760742, 'init_value': 3.401914596557617}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:20.40[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020705630779266357, 'time_algorithm_update': 0.0055146608352661134, 'loss': 3.724307446241379, 'time_step': 0.007637617826461792, 'init_value': 7.1831583976745605}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:20.49[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020770702362060546, 'time_algorithm_update': 0.005529569864273071, 'loss': 4.6374231569767, 'time_step': 0.007659343004226685, 'init_value': 12.828669548034668}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:20.58[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085771083831787, 'time_algorithm_update': 0.005534392833709717, 'loss': 5.1414937341213225, 'time_step': 0.007672674655914306, 'init_value': 20.24265480041504}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:21.07[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020502488613128663, 'time_algorithm_update': 0.005492095232009888, 'loss': 5.443220217466354, 'time_step': 0.007594589710235596, 'init_value': 27.469894409179688}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:21.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062443971633911, 'time_algorithm_update': 0.00546407151222229, 'loss': 6.248281479597091, 'time_step': 0.007578631162643432, 'init_value': 33.18021011352539}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:21.26[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020626540184020994, 'time_algorithm_update': 0.005472713232040406, 'loss': 7.076063578367234, 'time_step': 0.0075872821807861325, 'init_value': 39.488739013671875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:21.35[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020601515769958496, 'time_algorithm_update': 0.0054673607349395754, 'loss': 8.152264172315597, 'time_step': 0.007579134464263916, 'init_value': 46.168495178222656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:21.44[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064558267593384, 'time_algorithm_update': 0.0054669158458709715, 'loss': 8.844957196235656, 'time_step': 0.007583943367004395, 'init_value': 52.6081657409668}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:21.53[0m [[32m[1minfo     [0m] [1mFQE_20250505182021: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206266450881958, 'time_algorithm_update': 0.005468508005142212, 'loss': 10.507625515937805, 'time_step': 0.007583437204360962, 'init_value': 58.21691131591797}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.21691131591797
avg return on 5 trajectories of agent3: 885.7923363333333
Episode generator created
[2m2025-05-05 18:21.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:21.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:21.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:21.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:21.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182156[0m
[2m2025-05-05 18:21.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:22.05[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020764496326446534, 'time_algorithm_update': 0.005530851602554321, 'loss': 1.6410080642849207, 'time_step': 0.007659837961196899, 'init_value': 4.159595012664795}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:22.15[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021085238456726076, 'time_algorithm_update': 0.00560990309715271, 'loss': 3.922286607503891, 'time_step': 0.0077720961570739745, 'init_value': 8.946418762207031}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:22.24[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020869593620300294, 'time_algorithm_update': 0.005527763128280639, 'loss': 4.711001656532288, 'time_step': 0.007667636394500733, 'init_value': 14.871450424194336}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:22.33[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208704137802124, 'time_algorithm_update': 0.005534454107284546, 'loss': 5.322146848678589, 'time_step': 0.0076740548610687255, 'init_value': 21.259872436523438}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:22.42[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020944247245788575, 'time_algorithm_update': 0.005545460224151612, 'loss': 5.640343404531479, 'time_step': 0.007692758560180664, 'init_value': 27.164852142333984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:22.52[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020919909477233887, 'time_algorithm_update': 0.005536752223968506, 'loss': 5.69530441403389, 'time_step': 0.007681727170944214, 'init_value': 32.412715911865234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:23.01[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020872173309326174, 'time_algorithm_update': 0.005538554906845093, 'loss': 6.772398143768311, 'time_step': 0.007678781032562256, 'init_value': 37.471614837646484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:23.10[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021002352237701415, 'time_algorithm_update': 0.005547108173370362, 'loss': 7.905989541053772, 'time_step': 0.007700670957565308, 'init_value': 45.969295501708984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:23.19[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020855300426483154, 'time_algorithm_update': 0.0055314130783081054, 'loss': 8.697014681577683, 'time_step': 0.007669650316238404, 'init_value': 50.19807434082031}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:23.28[0m [[32m[1minfo     [0m] [1mFQE_20250505182156: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020959112644195555, 'time_algorithm_update': 0.005560558557510376, 'loss': 9.504489341020584, 'time_step': 0.007710804224014282, 'init_value': 53.55165481567383}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.55165481567383
avg return on 5 trajectories of agent4: 911.1342116666666
Episode generator created
[2m2025-05-05 18:23.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:23.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:23.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:23.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:23.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182332[0m
[2m2025-05-05 18:23.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:23.41[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067417860031128, 'time_algorithm_update': 0.00553487491607666, 'loss': 1.6575537018030881, 'time_step': 0.0076543126106262205, 'init_value': 3.3123652935028076}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:23.50[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020812082290649413, 'time_algorithm_update': 0.0055403120517730714, 'loss': 3.7805954946279527, 'time_step': 0.007673931360244751, 'init_value': 8.3024320602417}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:23.59[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086522102355957, 'time_algorithm_update': 0.0055492322444915775, 'loss': 4.7303093003034595, 'time_step': 0.007688251972198487, 'init_value': 14.71930980682373}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:24.08[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095850706100464, 'time_algorithm_update': 0.005572762966156006, 'loss': 5.566854145526886, 'time_step': 0.007721788644790649, 'init_value': 21.392202377319336}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:24.18[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078361511230469, 'time_algorithm_update': 0.005544613122940064, 'loss': 5.720962161540985, 'time_step': 0.007675513505935669, 'init_value': 27.380699157714844}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:24.27[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091624975204468, 'time_algorithm_update': 0.0055614616870880125, 'loss': 6.489381813764572, 'time_step': 0.007706317663192749, 'init_value': 33.354347229003906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:24.36[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083221435546875, 'time_algorithm_update': 0.005555124998092652, 'loss': 7.020771559715271, 'time_step': 0.007691552400588989, 'init_value': 38.84584045410156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:24.45[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091944932937622, 'time_algorithm_update': 0.005550005674362183, 'loss': 7.466482570886612, 'time_step': 0.007694628953933716, 'init_value': 44.64872360229492}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:24.55[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092118501663208, 'time_algorithm_update': 0.00556365966796875, 'loss': 8.741250711202621, 'time_step': 0.007708795070648193, 'init_value': 50.24635696411133}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:25.04[0m [[32m[1minfo     [0m] [1mFQE_20250505182332: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020921473503112795, 'time_algorithm_update': 0.005564226388931275, 'loss': 9.477423122882843, 'time_step': 0.0077098970413208, 'init_value': 55.33870315551758}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.33870315551758
avg return on 5 trajectories of agent5: 920.2653999999999
Episode generator created
[2m2025-05-05 18:25.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:25.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:25.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:25.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:25.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:25.16[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020796358585357666, 'time_algorithm_update': 0.005518785238265991, 'loss': 1.5698021826446056, 'time_step': 0.007651041746139526, 'init_value': 3.589536666870117}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:25.25[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020977749824523926, 'time_algorithm_update': 0.0055362477302551266, 'loss': 3.695702201247215, 'time_step': 0.007687169075012207, 'init_value': 8.051677703857422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:25.35[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091918706893921, 'time_algorithm_update': 0.005543280839920044, 'loss': 4.345454970479012, 'time_step': 0.007688326358795166, 'init_value': 13.802176475524902}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:25.44[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021107959747314452, 'time_algorithm_update': 0.005586226463317871, 'loss': 5.288493901729583, 'time_step': 0.007751072883605957, 'init_value': 19.25885772705078}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:25.53[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020949962139129637, 'time_algorithm_update': 0.005548994302749634, 'loss': 5.445187738895417, 'time_step': 0.007697394609451294, 'init_value': 25.417932510375977}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:26.02[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021016223430633547, 'time_algorithm_update': 0.005560356616973877, 'loss': 6.152755161523819, 'time_step': 0.007715415954589844, 'init_value': 31.68665313720703}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:26.12[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095818519592285, 'time_algorithm_update': 0.005535113334655762, 'loss': 6.872274789810181, 'time_step': 0.007683942317962647, 'init_value': 38.25886535644531}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:26.21[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090364933013916, 'time_algorithm_update': 0.005540227890014649, 'loss': 8.04872898888588, 'time_step': 0.007683108806610108, 'init_value': 45.3271598815918}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:26.30[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020911145210266114, 'time_algorithm_update': 0.005547999382019043, 'loss': 9.705895787239074, 'time_step': 0.007692681789398193, 'init_value': 52.60163879394531}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:26.39[0m [[32m[1minfo     [0m] [1mFQE_20250505182507: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089550971984863, 'time_algorithm_update': 0.005540299415588379, 'loss': 10.832519880771637, 'time_step': 0.007682407140731811, 'init_value': 57.3390998840332}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.3390998840332
avg return on 5 trajectories of agent6: 955.328177
Episode generator created
[2m2025-05-05 18:26.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:26.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:26.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:26.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:26.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182642[0m
[2m2025-05-05 18:26.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:26.52[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020746028423309325, 'time_algorithm_update': 0.005540251731872559, 'loss': 1.630423936292529, 'time_step': 0.007667141675949097, 'init_value': 3.6411893367767334}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:27.01[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020905308723449707, 'time_algorithm_update': 0.005540879726409912, 'loss': 4.072658067464828, 'time_step': 0.0076840980052948, 'init_value': 8.460160255432129}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:27.10[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020884361267089844, 'time_algorithm_update': 0.005547838926315308, 'loss': 5.056495783805847, 'time_step': 0.0076887719631195065, 'init_value': 14.757482528686523}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:27.19[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089262008666992, 'time_algorithm_update': 0.005551857471466064, 'loss': 5.347808666706086, 'time_step': 0.007694314479827881, 'init_value': 21.197338104248047}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:27.29[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020928893089294433, 'time_algorithm_update': 0.005547742366790772, 'loss': 5.915660481214523, 'time_step': 0.007693639278411865, 'init_value': 27.64171028137207}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:27.38[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020880031585693358, 'time_algorithm_update': 0.005551304817199707, 'loss': 6.015350595474243, 'time_step': 0.007692389011383057, 'init_value': 33.37077713012695}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:27.47[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086960792541504, 'time_algorithm_update': 0.005545469760894775, 'loss': 6.316759228944778, 'time_step': 0.00768527102470398, 'init_value': 38.183223724365234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:27.56[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020930540561676027, 'time_algorithm_update': 0.00555803108215332, 'loss': 7.642760442733764, 'time_step': 0.007704667091369629, 'init_value': 44.08174514770508}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:28.06[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209175705909729, 'time_algorithm_update': 0.005565474510192871, 'loss': 8.648217584133148, 'time_step': 0.0077101545333862305, 'init_value': 48.694400787353516}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505182642: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092839002609253, 'time_algorithm_update': 0.005559828758239746, 'loss': 9.748013538122176, 'time_step': 0.007706180810928344, 'init_value': 54.62217330932617}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.62217330932617
avg return on 5 trajectories of agent7: 932.6563433333334
Episode generator created
[2m2025-05-05 18:28.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:28.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:28.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:28.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:28.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182818[0m
[2m2025-05-05 18:28.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:28.27[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002080498218536377, 'time_algorithm_update': 0.005543091058731079, 'loss': 1.552625538110733, 'time_step': 0.007675968647003174, 'init_value': 3.7985057830810547}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:28.37[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208370041847229, 'time_algorithm_update': 0.005533867835998535, 'loss': 3.97441958463192, 'time_step': 0.007670014142990112, 'init_value': 8.79570484161377}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:28.46[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209049654006958, 'time_algorithm_update': 0.005531614303588867, 'loss': 4.802440199613571, 'time_step': 0.007674901247024536, 'init_value': 14.830333709716797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:28.55[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020872483253479004, 'time_algorithm_update': 0.005544441938400269, 'loss': 5.190571791648865, 'time_step': 0.007685178756713867, 'init_value': 21.00786590576172}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:29.04[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086829662322998, 'time_algorithm_update': 0.005533941984176636, 'loss': 5.544752156019211, 'time_step': 0.007673660278320313, 'init_value': 26.03325653076172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:29.13[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021001641750335695, 'time_algorithm_update': 0.005579120635986328, 'loss': 5.595036882042884, 'time_step': 0.007733219861984253, 'init_value': 31.357254028320312}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:29.23[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020893402099609374, 'time_algorithm_update': 0.005551212072372437, 'loss': 6.093214432954788, 'time_step': 0.007694124221801758, 'init_value': 36.2980842590332}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:29.32[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020759077072143553, 'time_algorithm_update': 0.005533953189849853, 'loss': 7.168769527435303, 'time_step': 0.007662684917449951, 'init_value': 41.608924865722656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:29.41[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209621000289917, 'time_algorithm_update': 0.005544986724853516, 'loss': 8.382168637514114, 'time_step': 0.00769467282295227, 'init_value': 48.48951721191406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:29.50[0m [[32m[1minfo     [0m] [1mFQE_20250505182818: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020889809131622314, 'time_algorithm_update': 0.005539305210113525, 'loss': 9.033127851247787, 'time_step': 0.00768138337135315, 'init_value': 52.21827697753906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.21827697753906
avg return on 5 trajectories of agent8: 958.1637013333334
Episode generator created
[2m2025-05-05 18:29.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:29.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:29.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:29.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:29.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505182953[0m
[2m2025-05-05 18:29.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:30.03[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020783329010009765, 'time_algorithm_update': 0.005532457113265991, 'loss': 1.646210746780038, 'time_step': 0.007662712335586548, 'init_value': 4.007859706878662}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:30.12[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020866734981536865, 'time_algorithm_update': 0.0055648512840271, 'loss': 3.994774113535881, 'time_step': 0.007704408407211304, 'init_value': 8.796404838562012}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:30.21[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097830057144165, 'time_algorithm_update': 0.0055667319297790525, 'loss': 4.67909853386879, 'time_step': 0.007717270374298096, 'init_value': 14.040574073791504}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:30.31[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020871403217315675, 'time_algorithm_update': 0.0055585367679595946, 'loss': 5.181291981935501, 'time_step': 0.0076981401443481446, 'init_value': 20.337329864501953}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:30.40[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092780351638794, 'time_algorithm_update': 0.005558532953262329, 'loss': 5.8086979546546935, 'time_step': 0.007704396724700927, 'init_value': 26.726547241210938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:30.49[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085747718811035, 'time_algorithm_update': 0.005562552928924561, 'loss': 6.117026810884476, 'time_step': 0.007701286792755127, 'init_value': 31.485727310180664}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:30.58[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208510422706604, 'time_algorithm_update': 0.005568176031112671, 'loss': 6.936313469886779, 'time_step': 0.007706129789352417, 'init_value': 38.36600112915039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:31.07[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087975263595581, 'time_algorithm_update': 0.005558853626251221, 'loss': 7.522150757312775, 'time_step': 0.007699687480926514, 'init_value': 45.12913513183594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:31.17[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020865898132324217, 'time_algorithm_update': 0.005562406778335571, 'loss': 8.016080379724503, 'time_step': 0.007702043771743774, 'init_value': 49.720699310302734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505182953: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002080892086029053, 'time_algorithm_update': 0.005546806335449218, 'loss': 9.09046311378479, 'time_step': 0.00768037486076355, 'init_value': 53.608619689941406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.608619689941406
avg return on 5 trajectories of agent9: 966.0069156666667
Episode generator created
[2m2025-05-05 18:31.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:31.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:31.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:31.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:31.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183129[0m
[2m2025-05-05 18:31.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:31.38[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020502142906188964, 'time_algorithm_update': 0.005462412834167481, 'loss': 1.6375555685013532, 'time_step': 0.007563116788864135, 'init_value': 3.789963960647583}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:31.47[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061072826385498, 'time_algorithm_update': 0.00547100830078125, 'loss': 3.7608353176116944, 'time_step': 0.007583582878112793, 'init_value': 8.765575408935547}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:31.56[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020616710186004638, 'time_algorithm_update': 0.005473739862442016, 'loss': 4.663462552547455, 'time_step': 0.007586425065994263, 'init_value': 15.04270076751709}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:32.06[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590615272521972, 'time_algorithm_update': 0.005465908288955689, 'loss': 4.9684438762664795, 'time_step': 0.007575966358184814, 'init_value': 20.709625244140625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:32.15[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079773426055908, 'time_algorithm_update': 0.005519797325134277, 'loss': 5.3382034575939175, 'time_step': 0.00765238094329834, 'init_value': 25.832963943481445}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:32.24[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020923407077789308, 'time_algorithm_update': 0.00556724739074707, 'loss': 5.989467014074325, 'time_step': 0.007712934732437134, 'init_value': 31.38703727722168}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:32.33[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021260838508605955, 'time_algorithm_update': 0.005641918659210205, 'loss': 6.303743101358414, 'time_step': 0.007822483062744141, 'init_value': 36.57472610473633}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:32.42[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020964505672454834, 'time_algorithm_update': 0.005559632062911987, 'loss': 7.655933905601501, 'time_step': 0.007709305763244629, 'init_value': 43.963783264160156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:32.52[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020993175506591796, 'time_algorithm_update': 0.005556713819503784, 'loss': 9.084114233970642, 'time_step': 0.0077092452049255375, 'init_value': 46.8874626159668}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:33.01[0m [[32m[1minfo     [0m] [1mFQE_20250505183129: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00210056734085083, 'time_algorithm_update': 0.005557693004608154, 'loss': 8.369110326766968, 'time_step': 0.007711323738098144, 'init_value': 52.64892578125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.64892578125
avg return on 5 trajectories of agent10: 965.0755089999999
Episode generator created
[2m2025-05-05 18:33.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:33.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:33.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:33.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:33.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183304[0m
[2m2025-05-05 18:33.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:33.13[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020805366039276124, 'time_algorithm_update': 0.005524961471557617, 'loss': 1.6936907323747874, 'time_step': 0.007657874584197998, 'init_value': 3.717881917953491}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:33.23[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088927745819092, 'time_algorithm_update': 0.005545190811157227, 'loss': 3.9493545854091643, 'time_step': 0.007686902284622193, 'init_value': 8.198626518249512}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:33.32[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020879225730895995, 'time_algorithm_update': 0.005542129755020142, 'loss': 4.859037716388702, 'time_step': 0.00768291425704956, 'init_value': 15.331550598144531}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:33.41[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020934274196624755, 'time_algorithm_update': 0.005549216270446777, 'loss': 5.5577085204124455, 'time_step': 0.00769551134109497, 'init_value': 21.81679344177246}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:33.50[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091676473617554, 'time_algorithm_update': 0.005551143169403076, 'loss': 5.923816153287888, 'time_step': 0.007695666551589966, 'init_value': 28.397783279418945}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:34.00[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101040840148926, 'time_algorithm_update': 0.005569620847702027, 'loss': 6.643138946294784, 'time_step': 0.00772417950630188, 'init_value': 34.77135467529297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:34.09[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021014811992645264, 'time_algorithm_update': 0.0055653293132781985, 'loss': 7.045897627592087, 'time_step': 0.007719831705093384, 'init_value': 41.229103088378906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:34.18[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020968103408813476, 'time_algorithm_update': 0.005552731275558472, 'loss': 8.303811993837357, 'time_step': 0.0077026991844177245, 'init_value': 46.02857971191406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:34.27[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020980703830718993, 'time_algorithm_update': 0.0055639023780822755, 'loss': 8.983775013685227, 'time_step': 0.0077155082225799565, 'init_value': 52.62201690673828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:34.37[0m [[32m[1minfo     [0m] [1mFQE_20250505183304: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021020705699920654, 'time_algorithm_update': 0.00555795168876648, 'loss': 10.007034259796143, 'time_step': 0.007713712215423584, 'init_value': 55.74916076660156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.74916076660156
avg return on 5 trajectories of agent11: 931.762209
Episode generator created
[2m2025-05-05 18:34.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:34.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:34.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:34.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:34.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183440[0m
[2m2025-05-05 18:34.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:34.49[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086015462875366, 'time_algorithm_update': 0.005543917655944824, 'loss': 1.6385475316345692, 'time_step': 0.007681828737258911, 'init_value': 3.9624764919281006}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:34.58[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094909429550171, 'time_algorithm_update': 0.005564542055130005, 'loss': 3.9292282835245134, 'time_step': 0.00771153473854065, 'init_value': 8.923691749572754}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:35.07[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021034603118896484, 'time_algorithm_update': 0.0055688488483428954, 'loss': 4.920696137428283, 'time_step': 0.007725046396255493, 'init_value': 14.323775291442871}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:35.17[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002108442544937134, 'time_algorithm_update': 0.0055660390853881836, 'loss': 5.546856426477432, 'time_step': 0.007726935863494873, 'init_value': 21.37539291381836}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:35.26[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021044533252716066, 'time_algorithm_update': 0.005583349943161011, 'loss': 5.737800060272217, 'time_step': 0.007740671157836914, 'init_value': 28.144750595092773}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:35.35[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002099492311477661, 'time_algorithm_update': 0.005570244550704956, 'loss': 6.184696407318115, 'time_step': 0.00772257661819458, 'init_value': 33.40085983276367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:35.45[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021008026599884035, 'time_algorithm_update': 0.0055553650856018065, 'loss': 7.07705987739563, 'time_step': 0.0077089605331420894, 'init_value': 40.10889434814453}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:35.54[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002107503652572632, 'time_algorithm_update': 0.005580225706100464, 'loss': 7.731179364204407, 'time_step': 0.007740854978561401, 'init_value': 44.75283432006836}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:36.03[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002126896381378174, 'time_algorithm_update': 0.005625511407852173, 'loss': 9.256455702066422, 'time_step': 0.007806333780288696, 'init_value': 52.726993560791016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:36.13[0m [[32m[1minfo     [0m] [1mFQE_20250505183440: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002119807004928589, 'time_algorithm_update': 0.005610334873199463, 'loss': 10.084270786762238, 'time_step': 0.0077839956283569335, 'init_value': 55.91535186767578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.91535186767578
avg return on 5 trajectories of agent12: 977.8889876666666
Episode generator created
[2m2025-05-05 18:36.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:36.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:36.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:36.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:36.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183616[0m
[2m2025-05-05 18:36.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:36.25[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020852134227752686, 'time_algorithm_update': 0.0055162723064422605, 'loss': 1.5866521813869476, 'time_step': 0.007653676509857178, 'init_value': 3.951512575149536}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:36.34[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096207857131958, 'time_algorithm_update': 0.005543285608291626, 'loss': 4.108445171356201, 'time_step': 0.0076923248767852784, 'init_value': 9.317228317260742}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:36.43[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020995049476623534, 'time_algorithm_update': 0.005534509897232056, 'loss': 4.657962636113167, 'time_step': 0.00768648624420166, 'init_value': 13.602349281311035}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:36.53[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020964217185974123, 'time_algorithm_update': 0.0055467550754547115, 'loss': 4.9422206811904905, 'time_step': 0.007696342706680298, 'init_value': 19.407283782958984}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:37.02[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021053032875061033, 'time_algorithm_update': 0.005553908348083496, 'loss': 5.367526382446289, 'time_step': 0.007712732553482055, 'init_value': 25.62683868408203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:37.11[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096050262451172, 'time_algorithm_update': 0.005547557353973389, 'loss': 5.7868017141819, 'time_step': 0.007696848630905151, 'init_value': 31.48332977294922}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:37.20[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209499454498291, 'time_algorithm_update': 0.005543487310409546, 'loss': 6.667642243146896, 'time_step': 0.007691105604171753, 'init_value': 37.77703094482422}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:37.30[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021046764850616456, 'time_algorithm_update': 0.0055517578125, 'loss': 7.227564941883087, 'time_step': 0.007709470987319947, 'init_value': 43.068660736083984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:37.39[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020953836441040038, 'time_algorithm_update': 0.0055336041450500485, 'loss': 8.432106440782547, 'time_step': 0.007682337999343872, 'init_value': 50.23959732055664}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:37.48[0m [[32m[1minfo     [0m] [1mFQE_20250505183616: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020979154109954834, 'time_algorithm_update': 0.005548252582550049, 'loss': 9.778420293807983, 'time_step': 0.007700106143951416, 'init_value': 54.997161865234375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.997161865234375
avg return on 5 trajectories of agent13: 970.9998689999999
Episode generator created
[2m2025-05-05 18:37.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:37.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:37.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:37.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:37.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183751[0m
[2m2025-05-05 18:37.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:38.01[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021045804023742676, 'time_algorithm_update': 0.00559793472290039, 'loss': 1.637875200778246, 'time_step': 0.007756654739379883, 'init_value': 3.8502719402313232}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:38.10[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020836169719696046, 'time_algorithm_update': 0.005536383628845215, 'loss': 3.8879771567583084, 'time_step': 0.007672857046127319, 'init_value': 8.41351318359375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:38.19[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020974512100219726, 'time_algorithm_update': 0.005541908264160156, 'loss': 4.666474521517753, 'time_step': 0.0076919982433319095, 'init_value': 14.181175231933594}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:38.28[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020795891284942627, 'time_algorithm_update': 0.005542336225509643, 'loss': 4.900577037453651, 'time_step': 0.007674986839294433, 'init_value': 20.15513801574707}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:38.37[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090653896331787, 'time_algorithm_update': 0.0055281114578247074, 'loss': 5.658282096862793, 'time_step': 0.0076712994575500485, 'init_value': 27.849498748779297}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:38.47[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089639902114868, 'time_algorithm_update': 0.005530351638793945, 'loss': 6.153645367145538, 'time_step': 0.007672610759735107, 'init_value': 32.61901092529297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:38.56[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020972156524658205, 'time_algorithm_update': 0.005529337882995605, 'loss': 6.815139537096024, 'time_step': 0.007679625511169434, 'init_value': 38.45580291748047}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:39.05[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020832738876342773, 'time_algorithm_update': 0.005521266460418701, 'loss': 7.695509521961212, 'time_step': 0.007657454252243042, 'init_value': 45.22920608520508}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:39.14[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020958991050720214, 'time_algorithm_update': 0.005535606384277344, 'loss': 8.679811692237854, 'time_step': 0.007684487819671631, 'init_value': 51.204254150390625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:39.24[0m [[32m[1minfo     [0m] [1mFQE_20250505183751: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097019672393799, 'time_algorithm_update': 0.005535005092620849, 'loss': 10.199582459449768, 'time_step': 0.007684920310974121, 'init_value': 55.028568267822266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.028568267822266
avg return on 5 trajectories of agent14: 978.630588
Episode generator created
[2m2025-05-05 18:39.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:39.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:39.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:39.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:39.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505183927[0m
[2m2025-05-05 18:39.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:39.36[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020744364261627195, 'time_algorithm_update': 0.0055249912738800045, 'loss': 1.7002199159562588, 'time_step': 0.007651838064193725, 'init_value': 3.303389549255371}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:39.45[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021050078868865966, 'time_algorithm_update': 0.00556090521812439, 'loss': 3.911835036277771, 'time_step': 0.007718990802764893, 'init_value': 7.982956886291504}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084725856781006, 'time_algorithm_update': 0.0055413713455200195, 'loss': 4.521614677548408, 'time_step': 0.007679212808609009, 'init_value': 13.2623291015625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:40.04[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088790655136108, 'time_algorithm_update': 0.005546410083770752, 'loss': 5.021351813554764, 'time_step': 0.007688553333282471, 'init_value': 20.492534637451172}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:40.13[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020966525077819823, 'time_algorithm_update': 0.005552753925323486, 'loss': 5.805911145687103, 'time_step': 0.007702543020248413, 'init_value': 27.299718856811523}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:40.22[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020923733711242674, 'time_algorithm_update': 0.005549643039703369, 'loss': 6.29434417295456, 'time_step': 0.007695533514022827, 'init_value': 34.05858612060547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:40.31[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020984485149383547, 'time_algorithm_update': 0.005551303863525391, 'loss': 7.015315747976303, 'time_step': 0.0077028067111968995, 'init_value': 39.82273483276367}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:40.40[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093128204345703, 'time_algorithm_update': 0.005558695316314697, 'loss': 7.8017449941635135, 'time_step': 0.007705284595489502, 'init_value': 42.27031707763672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:40.50[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101294279098511, 'time_algorithm_update': 0.005559802293777466, 'loss': 7.882709800958634, 'time_step': 0.00771458888053894, 'init_value': 46.43952560424805}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:40.59[0m [[32m[1minfo     [0m] [1mFQE_20250505183927: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090092182159424, 'time_algorithm_update': 0.005544270277023315, 'loss': 9.225119375228882, 'time_step': 0.007687642335891724, 'init_value': 51.9542121887207}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.9542121887207
avg return on 5 trajectories of agent15: 1000.7645823333334
Episode generator created
[2m2025-05-05 18:41.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:41.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:41.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:41.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:41.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184102[0m
[2m2025-05-05 18:41.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:41.11[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020784883499145508, 'time_algorithm_update': 0.005523170232772827, 'loss': 1.5942515968680382, 'time_step': 0.007654402732849121, 'init_value': 3.3280210494995117}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:41.20[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208707857131958, 'time_algorithm_update': 0.005525281429290771, 'loss': 3.8849537925720217, 'time_step': 0.007665086030960083, 'init_value': 7.5784807205200195}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:41.30[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020873894691467287, 'time_algorithm_update': 0.005536703586578369, 'loss': 4.786867148637771, 'time_step': 0.007676942348480225, 'init_value': 13.799388885498047}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:41.39[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020839648246765135, 'time_algorithm_update': 0.005546574115753174, 'loss': 5.038988655567169, 'time_step': 0.0076833865642547605, 'init_value': 19.732891082763672}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:41.48[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088272571563721, 'time_algorithm_update': 0.005543248176574707, 'loss': 5.453364527463913, 'time_step': 0.007684840679168701, 'init_value': 25.981678009033203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:41.57[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020587685108184816, 'time_algorithm_update': 0.005465682983398438, 'loss': 6.035358477830886, 'time_step': 0.007575822830200195, 'init_value': 32.483489990234375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:42.06[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020726847648620604, 'time_algorithm_update': 0.005483932256698608, 'loss': 6.944507304430008, 'time_step': 0.0076089692115783696, 'init_value': 37.872108459472656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:42.16[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002071526050567627, 'time_algorithm_update': 0.005468857526779175, 'loss': 7.311169578075409, 'time_step': 0.007592105388641358, 'init_value': 44.65052795410156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:42.25[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020647122859954836, 'time_algorithm_update': 0.005464379549026489, 'loss': 9.095203852415084, 'time_step': 0.007580990314483642, 'init_value': 50.217655181884766}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:42.34[0m [[32m[1minfo     [0m] [1mFQE_20250505184102: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002068070888519287, 'time_algorithm_update': 0.0054716265201568606, 'loss': 9.113088384628297, 'time_step': 0.007591960430145264, 'init_value': 56.08930969238281}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.08930969238281
avg return on 5 trajectories of agent16: 978.3794616666668
Episode generator created
[2m2025-05-05 18:42.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:42.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:42.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:42.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:42.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184237[0m
[2m2025-05-05 18:42.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:42.46[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020816683769226073, 'time_algorithm_update': 0.005519164562225342, 'loss': 1.6642676651328803, 'time_step': 0.007653325319290161, 'init_value': 3.589350461959839}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:42.55[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083628416061401, 'time_algorithm_update': 0.0055235085487365726, 'loss': 4.206473278880119, 'time_step': 0.007659384965896607, 'init_value': 8.361501693725586}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:43.05[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088728427886963, 'time_algorithm_update': 0.005540757656097412, 'loss': 5.031334797859192, 'time_step': 0.007681993484497071, 'init_value': 15.740259170532227}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:43.14[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021027700901031492, 'time_algorithm_update': 0.005575563192367554, 'loss': 5.589293632507324, 'time_step': 0.007732048749923706, 'init_value': 24.46522331237793}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:43.23[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021147804260253904, 'time_algorithm_update': 0.00560450291633606, 'loss': 5.979937392115593, 'time_step': 0.00777336049079895, 'init_value': 29.46392822265625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:43.32[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209649395942688, 'time_algorithm_update': 0.005540647268295288, 'loss': 6.57700413942337, 'time_step': 0.0076901822090148925, 'init_value': 37.0517692565918}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:43.42[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020832765102386476, 'time_algorithm_update': 0.005534739971160889, 'loss': 6.958297268390655, 'time_step': 0.00767076301574707, 'init_value': 42.122398376464844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:43.51[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087446928024292, 'time_algorithm_update': 0.005527149438858032, 'loss': 8.387673305273056, 'time_step': 0.007667596101760864, 'init_value': 47.76697540283203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:44.00[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020930843353271483, 'time_algorithm_update': 0.005531819581985474, 'loss': 9.747197185516358, 'time_step': 0.007677752733230591, 'init_value': 52.36001205444336}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:44.09[0m [[32m[1minfo     [0m] [1mFQE_20250505184237: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020814578533172607, 'time_algorithm_update': 0.005525506496429443, 'loss': 10.672299350976944, 'time_step': 0.007659981966018677, 'init_value': 55.12874221801758}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.12874221801758
avg return on 5 trajectories of agent17: 973.8690266666666
Episode generator created
[2m2025-05-05 18:44.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:44.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:44.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:44.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:44.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184413[0m
[2m2025-05-05 18:44.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:44.22[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020832483768463135, 'time_algorithm_update': 0.005536317825317383, 'loss': 1.6290856158435345, 'time_step': 0.0076722965240478514, 'init_value': 3.4408764839172363}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:44.31[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020918569564819336, 'time_algorithm_update': 0.005576892375946045, 'loss': 3.925049079537392, 'time_step': 0.007721846342086792, 'init_value': 8.240140914916992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:44.40[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084193468093872, 'time_algorithm_update': 0.005556782484054565, 'loss': 4.54263417339325, 'time_step': 0.007693750858306885, 'init_value': 13.34776782989502}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:44.49[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020860586166381837, 'time_algorithm_update': 0.005568016529083252, 'loss': 5.19158962726593, 'time_step': 0.0077066168785095215, 'init_value': 20.346923828125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:44.59[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096273422241211, 'time_algorithm_update': 0.005569510698318482, 'loss': 5.572245438337326, 'time_step': 0.007718390941619873, 'init_value': 27.271297454833984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:45.08[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208302116394043, 'time_algorithm_update': 0.005561262607574463, 'loss': 6.396751136779785, 'time_step': 0.007697134494781494, 'init_value': 32.64971160888672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:45.17[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020933520793914796, 'time_algorithm_update': 0.005567927837371826, 'loss': 7.271552251577377, 'time_step': 0.007714571714401245, 'init_value': 40.441104888916016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:45.26[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089211940765381, 'time_algorithm_update': 0.005558920621871948, 'loss': 7.7421741955280305, 'time_step': 0.007701479196548462, 'init_value': 44.746002197265625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:45.36[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088572025299072, 'time_algorithm_update': 0.005551749229431152, 'loss': 8.303846800804138, 'time_step': 0.00769320797920227, 'init_value': 49.14999008178711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:45.45[0m [[32m[1minfo     [0m] [1mFQE_20250505184413: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093211650848389, 'time_algorithm_update': 0.005561211347579956, 'loss': 9.219868577957154, 'time_step': 0.007707482099533081, 'init_value': 54.45658493041992}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.45658493041992
avg return on 5 trajectories of agent18: 965.637685
Episode generator created
[2m2025-05-05 18:45.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:45.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:45.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:45.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:45.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184548[0m
[2m2025-05-05 18:45.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:45.57[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085580825805664, 'time_algorithm_update': 0.0055332190990448, 'loss': 1.6234432842880488, 'time_step': 0.007671715021133423, 'init_value': 3.545358896255493}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:46.07[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020859384536743163, 'time_algorithm_update': 0.005546185255050659, 'loss': 4.137584325909614, 'time_step': 0.007684602022171021, 'init_value': 8.260345458984375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:46.16[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020889270305633543, 'time_algorithm_update': 0.0055354835987091065, 'loss': 4.7008957430124285, 'time_step': 0.007676723957061767, 'init_value': 13.442728042602539}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:46.25[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020850033760070803, 'time_algorithm_update': 0.005539250612258911, 'loss': 5.672784936189651, 'time_step': 0.007676795721054077, 'init_value': 21.1118221282959}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:46.34[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096231460571289, 'time_algorithm_update': 0.005536419868469238, 'loss': 6.122216170668602, 'time_step': 0.007685030221939087, 'init_value': 27.56157875061035}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:46.43[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020866010189056396, 'time_algorithm_update': 0.005543514728546143, 'loss': 6.359475285053253, 'time_step': 0.007683193683624268, 'init_value': 33.53447723388672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:46.53[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00210032057762146, 'time_algorithm_update': 0.005572702169418335, 'loss': 7.463986269474029, 'time_step': 0.0077261018753051755, 'init_value': 38.53958511352539}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:47.02[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096829891204834, 'time_algorithm_update': 0.005572323322296143, 'loss': 7.574622075557709, 'time_step': 0.007722832202911377, 'init_value': 43.96433639526367}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:47.11[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020876572132110596, 'time_algorithm_update': 0.005534934759140015, 'loss': 8.727994170665742, 'time_step': 0.007675685167312622, 'init_value': 48.92698287963867}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:47.20[0m [[32m[1minfo     [0m] [1mFQE_20250505184548: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209462571144104, 'time_algorithm_update': 0.005543251037597657, 'loss': 9.942636405706406, 'time_step': 0.007691141128540039, 'init_value': 55.128456115722656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.128456115722656
avg return on 5 trajectories of agent19: 945.3668596666666
Episode generator created
[2m2025-05-05 18:47.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:47.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:47.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:47.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:47.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184724[0m
[2m2025-05-05 18:47.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:47.33[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020834991931915283, 'time_algorithm_update': 0.005511212825775147, 'loss': 1.6479194560497998, 'time_step': 0.0076467800140380855, 'init_value': 4.089260578155518}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:47.42[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020926539897918703, 'time_algorithm_update': 0.005530905485153198, 'loss': 3.9198640884160993, 'time_step': 0.007675716638565064, 'init_value': 9.233802795410156}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:47.51[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093742847442627, 'time_algorithm_update': 0.005538663864135742, 'loss': 4.62057455599308, 'time_step': 0.007684882402420044, 'init_value': 14.956562042236328}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:48.00[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095041036605835, 'time_algorithm_update': 0.005539437055587768, 'loss': 5.191982626914978, 'time_step': 0.0076868927478790285, 'init_value': 21.565265655517578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:48.10[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020876660346984864, 'time_algorithm_update': 0.005532445430755616, 'loss': 5.461740053415299, 'time_step': 0.007672433614730835, 'init_value': 26.191041946411133}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:48.19[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020937678813934325, 'time_algorithm_update': 0.005547362804412842, 'loss': 5.786394796133042, 'time_step': 0.007693717479705811, 'init_value': 31.234647750854492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:48.28[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208825945854187, 'time_algorithm_update': 0.005530595541000366, 'loss': 6.329746167182923, 'time_step': 0.007670967817306518, 'init_value': 38.50558853149414}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:48.37[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020848944187164308, 'time_algorithm_update': 0.0055311453342437745, 'loss': 7.391713429450989, 'time_step': 0.007668300151824951, 'init_value': 43.84261703491211}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:48.46[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094733476638794, 'time_algorithm_update': 0.005526317358016968, 'loss': 8.09472916007042, 'time_step': 0.0076729805469512935, 'init_value': 48.673980712890625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:48.56[0m [[32m[1minfo     [0m] [1mFQE_20250505184724: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020869994163513184, 'time_algorithm_update': 0.005518014907836914, 'loss': 8.841930129766464, 'time_step': 0.007656984329223633, 'init_value': 53.622596740722656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.622596740722656
ave advantage rew: 54.51614112854004, std: 1.7880026384455008
avg cum rews: 952.1259130833336, std: 26.927083165870553
Pearson correlation coefficient: -0.08227736151160935
Spearman correlation coefficient: -0.08571428571428572
Kendall Tau correlation coefficient: -0.021052631578947368
the best agent: 2, best agent cum rewards: 925.5371173333333
1959
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.018431735649274104
avg return on 5 trajectories of agent0: 928.5898126666667
Episode generator created
[2m2025-05-05 18:49.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:49.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:49.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:49.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:49.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505184918[0m
[2m2025-05-05 18:49.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:49.27[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073632478713989, 'time_algorithm_update': 0.00552037525177002, 'loss': 1.6159404511898756, 'time_step': 0.007645958662033081, 'init_value': 3.4937713146209717}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:49.37[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085169315338135, 'time_algorithm_update': 0.005537295341491699, 'loss': 4.015121236562729, 'time_step': 0.007674733638763428, 'init_value': 8.37696361541748}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:49.46[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020845122337341307, 'time_algorithm_update': 0.005554164171218872, 'loss': 4.621559109210968, 'time_step': 0.007691629886627197, 'init_value': 14.38892936706543}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:49.55[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020806381702423095, 'time_algorithm_update': 0.005536323070526123, 'loss': 5.145123137712479, 'time_step': 0.007669152736663819, 'init_value': 19.636417388916016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:50.04[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020854253768920897, 'time_algorithm_update': 0.005558061838150025, 'loss': 5.3425523414611815, 'time_step': 0.007696041584014893, 'init_value': 25.565568923950195}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:50.14[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020916948318481445, 'time_algorithm_update': 0.005545990705490112, 'loss': 6.066816610097885, 'time_step': 0.007690162181854248, 'init_value': 32.823097229003906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:50.23[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020861172676086425, 'time_algorithm_update': 0.005544425964355469, 'loss': 6.516809195518493, 'time_step': 0.007682847023010254, 'init_value': 39.07560729980469}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:50.32[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002122192144393921, 'time_algorithm_update': 0.005632688283920288, 'loss': 7.029035417079926, 'time_step': 0.00780940055847168, 'init_value': 43.03983688354492}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:50.41[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101292610168457, 'time_algorithm_update': 0.0055778310298919675, 'loss': 8.1639511988163, 'time_step': 0.00773227334022522, 'init_value': 49.526851654052734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:50.51[0m [[32m[1minfo     [0m] [1mFQE_20250505184918: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208266282081604, 'time_algorithm_update': 0.005548623561859131, 'loss': 8.958216690063477, 'time_step': 0.00768369460105896, 'init_value': 54.496986389160156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.496986389160156
avg return on 5 trajectories of agent1: 909.40904
Episode generator created
[2m2025-05-05 18:50.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:50.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:50.54[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:50.54[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:50.54[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185054[0m
[2m2025-05-05 18:50.54[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:51.03[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020853309631347658, 'time_algorithm_update': 0.0055314509868621825, 'loss': 1.6489263166636228, 'time_step': 0.0076689329147338866, 'init_value': 3.590681791305542}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:51.12[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086466312408447, 'time_algorithm_update': 0.005528877496719361, 'loss': 3.9312724447250367, 'time_step': 0.0076677298545837404, 'init_value': 8.218480110168457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:51.22[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085923671722412, 'time_algorithm_update': 0.005531665563583374, 'loss': 4.6457488814592365, 'time_step': 0.007669876337051392, 'init_value': 13.537463188171387}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:51.31[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089763879776001, 'time_algorithm_update': 0.005533803224563599, 'loss': 5.010470145702362, 'time_step': 0.00767608642578125, 'init_value': 19.49462890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:51.40[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020952439308166504, 'time_algorithm_update': 0.005536291122436523, 'loss': 5.47086235833168, 'time_step': 0.007684557676315307, 'init_value': 25.513427734375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:51.49[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020926735401153563, 'time_algorithm_update': 0.005525874376296997, 'loss': 5.936808218955994, 'time_step': 0.007671538114547729, 'init_value': 30.513141632080078}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:51.58[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020902535915374755, 'time_algorithm_update': 0.005526579141616821, 'loss': 6.348011663675308, 'time_step': 0.007669646501541138, 'init_value': 37.00868606567383}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:52.08[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020986454486846924, 'time_algorithm_update': 0.005548991203308105, 'loss': 7.376979614019394, 'time_step': 0.007700356960296631, 'init_value': 42.64022445678711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:52.17[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081756591796875, 'time_algorithm_update': 0.005513521909713745, 'loss': 8.475879086971283, 'time_step': 0.007647582769393921, 'init_value': 48.547203063964844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:52.26[0m [[32m[1minfo     [0m] [1mFQE_20250505185054: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020649242401123047, 'time_algorithm_update': 0.005451886177062988, 'loss': 9.307684613227844, 'time_step': 0.007568370342254638, 'init_value': 54.298526763916016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.298526763916016
avg return on 5 trajectories of agent2: 956.228962
Episode generator created
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:52.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:52.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185229[0m
[2m2025-05-05 18:52.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:52.38[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020575008392333984, 'time_algorithm_update': 0.005450922966003418, 'loss': 1.7064232754260302, 'time_step': 0.007559056997299194, 'init_value': 3.8815248012542725}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:52.47[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020782089233398436, 'time_algorithm_update': 0.0054777743816375735, 'loss': 3.847756709098816, 'time_step': 0.00760753870010376, 'init_value': 8.831408500671387}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:52.56[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062213897705078, 'time_algorithm_update': 0.005470021963119507, 'loss': 4.652484976530075, 'time_step': 0.007584016323089599, 'init_value': 15.498120307922363}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:53.06[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020764100551605223, 'time_algorithm_update': 0.005504691123962403, 'loss': 5.3787189948558805, 'time_step': 0.007632845401763916, 'init_value': 21.014930725097656}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:53.15[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940680503845214, 'time_algorithm_update': 0.00554745864868164, 'loss': 5.6846444392204285, 'time_step': 0.007694154977798462, 'init_value': 26.44009780883789}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:53.24[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084421157836914, 'time_algorithm_update': 0.005541239976882935, 'loss': 6.16348669052124, 'time_step': 0.007678624153137207, 'init_value': 31.647045135498047}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:53.33[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020817198753356934, 'time_algorithm_update': 0.0055479896068573, 'loss': 6.607143803954124, 'time_step': 0.007682634115219116, 'init_value': 39.55353546142578}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:53.42[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020895235538482665, 'time_algorithm_update': 0.0055513756275177, 'loss': 8.157799375772477, 'time_step': 0.007693693876266479, 'init_value': 47.185142517089844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:53.52[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020871288776397705, 'time_algorithm_update': 0.005543906450271607, 'loss': 9.636734345197677, 'time_step': 0.007683688163757324, 'init_value': 54.154876708984375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:54.01[0m [[32m[1minfo     [0m] [1mFQE_20250505185229: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097273111343384, 'time_algorithm_update': 0.005565355777740479, 'loss': 11.22456721305847, 'time_step': 0.007715901851654053, 'init_value': 59.487369537353516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 59.487369537353516
avg return on 5 trajectories of agent3: 919.4324006666667
Episode generator created
[2m2025-05-05 18:54.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:54.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:54.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:54.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:54.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185404[0m
[2m2025-05-05 18:54.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:54.13[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002075035810470581, 'time_algorithm_update': 0.005533048152923584, 'loss': 1.6775175496786834, 'time_step': 0.007659838914871216, 'init_value': 3.609937906265259}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:54.23[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101500749588013, 'time_algorithm_update': 0.005570069074630737, 'loss': 3.8979194971323015, 'time_step': 0.007724005937576294, 'init_value': 7.922728061676025}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:54.32[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085787296295166, 'time_algorithm_update': 0.005545915603637696, 'loss': 4.779638325929642, 'time_step': 0.007683576583862305, 'init_value': 14.307624816894531}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:54.41[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091839551925659, 'time_algorithm_update': 0.0055535690784454346, 'loss': 5.326001593351364, 'time_step': 0.007697654962539673, 'init_value': 20.999929428100586}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:54.50[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020959618091583253, 'time_algorithm_update': 0.0055607171058654785, 'loss': 5.932060822963715, 'time_step': 0.007709146499633789, 'init_value': 26.923738479614258}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:55.00[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020927901268005373, 'time_algorithm_update': 0.005571474075317382, 'loss': 6.358800937652588, 'time_step': 0.007716930150985718, 'init_value': 31.674314498901367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:55.09[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091398477554321, 'time_algorithm_update': 0.005565892696380615, 'loss': 6.462221648693085, 'time_step': 0.007710071802139282, 'init_value': 37.023067474365234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:55.18[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967085361480713, 'time_algorithm_update': 0.0055691819190979005, 'loss': 7.266825326681137, 'time_step': 0.007718564748764038, 'init_value': 42.81415557861328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:55.27[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020906546115875245, 'time_algorithm_update': 0.00556418251991272, 'loss': 8.419914620161057, 'time_step': 0.007707592010498047, 'init_value': 47.749420166015625}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:55.37[0m [[32m[1minfo     [0m] [1mFQE_20250505185404: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209598445892334, 'time_algorithm_update': 0.005571711778640747, 'loss': 9.512462182760238, 'time_step': 0.00772030520439148, 'init_value': 51.04954528808594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.04954528808594
avg return on 5 trajectories of agent4: 926.4056316666666
Episode generator created
[2m2025-05-05 18:55.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:55.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:55.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:55.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:55.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185540[0m
[2m2025-05-05 18:55.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:55.49[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020840508937835693, 'time_algorithm_update': 0.005548207521438598, 'loss': 1.5592848044931888, 'time_step': 0.007684709548950196, 'init_value': 3.723480224609375}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:55.58[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020865468978881834, 'time_algorithm_update': 0.0055357983112335205, 'loss': 4.012874125480652, 'time_step': 0.007674387454986572, 'init_value': 8.454998016357422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:56.07[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096846342086792, 'time_algorithm_update': 0.005570405006408692, 'loss': 4.764786692261696, 'time_step': 0.007719639301300049, 'init_value': 14.451107025146484}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:56.17[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020949718952178956, 'time_algorithm_update': 0.005563530206680298, 'loss': 5.00089471745491, 'time_step': 0.00771103024482727, 'init_value': 20.62685203552246}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:56.26[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020968515872955324, 'time_algorithm_update': 0.005564986228942871, 'loss': 5.486673743009567, 'time_step': 0.007714252710342407, 'init_value': 27.288450241088867}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:56.35[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093083381652832, 'time_algorithm_update': 0.005578617572784424, 'loss': 5.929506987571716, 'time_step': 0.007724522352218628, 'init_value': 33.53688049316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:56.44[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020916838645935057, 'time_algorithm_update': 0.005563664436340332, 'loss': 6.711821600198745, 'time_step': 0.007707904100418091, 'init_value': 39.53609848022461}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:56.54[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084936857223511, 'time_algorithm_update': 0.0055489356517791745, 'loss': 7.605138329029083, 'time_step': 0.007686384916305542, 'init_value': 45.26127243041992}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:57.03[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096546411514282, 'time_algorithm_update': 0.005554242610931397, 'loss': 8.453693694114685, 'time_step': 0.007703374862670898, 'init_value': 50.146507263183594}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:57.12[0m [[32m[1minfo     [0m] [1mFQE_20250505185540: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020894465446472167, 'time_algorithm_update': 0.0055562655925750735, 'loss': 9.569375891208649, 'time_step': 0.007698601245880127, 'init_value': 54.819007873535156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.819007873535156
avg return on 5 trajectories of agent5: 942.142339
Episode generator created
[2m2025-05-05 18:57.15[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:57.15[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:57.15[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:57.15[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:57.15[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185715[0m
[2m2025-05-05 18:57.15[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:57.25[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020847210884094238, 'time_algorithm_update': 0.005523162603378296, 'loss': 1.6197353137135506, 'time_step': 0.007660597324371338, 'init_value': 3.7024412155151367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:57.34[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021123347282409667, 'time_algorithm_update': 0.005591893672943115, 'loss': 3.836430727124214, 'time_step': 0.007757532119750977, 'init_value': 8.728494644165039}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:57.43[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020935652256011965, 'time_algorithm_update': 0.005525700092315674, 'loss': 4.801310122132302, 'time_step': 0.007671744108200073, 'init_value': 15.623735427856445}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:57.52[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021019771099090576, 'time_algorithm_update': 0.0055388822555541995, 'loss': 5.263580639839172, 'time_step': 0.007693071842193603, 'init_value': 21.528749465942383}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:58.01[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096672296524048, 'time_algorithm_update': 0.00553783392906189, 'loss': 5.717714276552201, 'time_step': 0.007687059402465821, 'init_value': 28.275569915771484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:58.11[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209765887260437, 'time_algorithm_update': 0.005538533449172974, 'loss': 6.489201965093613, 'time_step': 0.007688616037368774, 'init_value': 34.13302230834961}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:58.20[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096420049667358, 'time_algorithm_update': 0.005524937152862549, 'loss': 6.750383090257644, 'time_step': 0.007673768281936645, 'init_value': 39.93244552612305}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 18:58.29[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094138145446777, 'time_algorithm_update': 0.005525094270706177, 'loss': 7.955758611440658, 'time_step': 0.007671608686447144, 'init_value': 45.1890754699707}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 18:58.38[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021049778461456298, 'time_algorithm_update': 0.005535104990005493, 'loss': 8.694307067632675, 'time_step': 0.007693028926849365, 'init_value': 49.618900299072266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 18:58.48[0m [[32m[1minfo     [0m] [1mFQE_20250505185715: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094926118850708, 'time_algorithm_update': 0.005543123722076416, 'loss': 9.79028523182869, 'time_step': 0.007691002130508423, 'init_value': 54.180179595947266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.180179595947266
avg return on 5 trajectories of agent6: 952.1489216666668
Episode generator created
[2m2025-05-05 18:58.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 18:58.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 18:58.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 18:58.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 18:58.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505185851[0m
[2m2025-05-05 18:58.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 18:59.00[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020840485095977783, 'time_algorithm_update': 0.005528746604919433, 'loss': 1.649333985209465, 'time_step': 0.007664836168289184, 'init_value': 3.9538986682891846}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 18:59.09[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089637994766235, 'time_algorithm_update': 0.005539980411529541, 'loss': 4.27295372235775, 'time_step': 0.007682268619537354, 'init_value': 9.81590747833252}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 18:59.18[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091127634048462, 'time_algorithm_update': 0.0055472743511199955, 'loss': 5.084153139352798, 'time_step': 0.007691345691680908, 'init_value': 16.003679275512695}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 18:59.28[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020885567665100096, 'time_algorithm_update': 0.0055436108112335205, 'loss': 5.213570315122604, 'time_step': 0.007685428380966187, 'init_value': 22.187070846557617}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 18:59.37[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097118854522705, 'time_algorithm_update': 0.005565138578414917, 'loss': 5.7488264424800875, 'time_step': 0.007715601205825806, 'init_value': 28.533748626708984}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 18:59.46[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020915274620056153, 'time_algorithm_update': 0.005546151876449585, 'loss': 6.461461067199707, 'time_step': 0.0076907813549041745, 'init_value': 35.136409759521484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 18:59.55[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020875773429870604, 'time_algorithm_update': 0.0055530455112457276, 'loss': 6.706452288866043, 'time_step': 0.0076935007572174075, 'init_value': 39.24501419067383}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:00.05[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002099236488342285, 'time_algorithm_update': 0.005569417238235474, 'loss': 7.448045440196991, 'time_step': 0.007722099781036377, 'init_value': 45.34204864501953}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:00.14[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940232276916502, 'time_algorithm_update': 0.00555954384803772, 'loss': 8.069277510643005, 'time_step': 0.007706834077835083, 'init_value': 50.515743255615234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:00.23[0m [[32m[1minfo     [0m] [1mFQE_20250505185851: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020909771919250487, 'time_algorithm_update': 0.005556832075119019, 'loss': 9.361224199295044, 'time_step': 0.007700750112533569, 'init_value': 55.97222137451172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.97222137451172
avg return on 5 trajectories of agent7: 928.0896873333335
Episode generator created
[2m2025-05-05 19:00.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:00.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:00.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:00.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:00.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190026[0m
[2m2025-05-05 19:00.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:00.35[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020776586532592774, 'time_algorithm_update': 0.005540113687515258, 'loss': 1.6318758814930916, 'time_step': 0.007669808387756348, 'init_value': 3.2590060234069824}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:00.45[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085775136947632, 'time_algorithm_update': 0.005543932437896728, 'loss': 3.8676096305847167, 'time_step': 0.007682254076004028, 'init_value': 8.741739273071289}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:00.54[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093139171600342, 'time_algorithm_update': 0.005536296844482422, 'loss': 4.614340992093086, 'time_step': 0.007681881189346314, 'init_value': 14.688948631286621}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:01.03[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021085193157196046, 'time_algorithm_update': 0.005595968961715698, 'loss': 5.333903116464615, 'time_step': 0.007758244514465332, 'init_value': 21.03064727783203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:01.12[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091110706329346, 'time_algorithm_update': 0.0055471031665802, 'loss': 5.717514929294587, 'time_step': 0.007690995931625366, 'init_value': 26.875333786010742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:01.22[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088578701019287, 'time_algorithm_update': 0.005534267187118531, 'loss': 6.001741263628006, 'time_step': 0.00767547869682312, 'init_value': 33.441253662109375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:01.31[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095900058746338, 'time_algorithm_update': 0.005543261766433716, 'loss': 6.902998760938645, 'time_step': 0.0076919691562652584, 'init_value': 38.9579963684082}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:01.40[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002098344802856445, 'time_algorithm_update': 0.005547217845916748, 'loss': 7.76002743601799, 'time_step': 0.007698835134506226, 'init_value': 44.2536506652832}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:01.49[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002113124132156372, 'time_algorithm_update': 0.005616791725158691, 'loss': 8.412463527202606, 'time_step': 0.007784129858016968, 'init_value': 47.708065032958984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:01.59[0m [[32m[1minfo     [0m] [1mFQE_20250505190026: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020852625370025636, 'time_algorithm_update': 0.005549334526062012, 'loss': 9.472271949529647, 'time_step': 0.007687443733215332, 'init_value': 53.72264862060547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.72264862060547
avg return on 5 trajectories of agent8: 886.0612583333333
Episode generator created
[2m2025-05-05 19:02.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:02.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:02.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:02.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:02.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190202[0m
[2m2025-05-05 19:02.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:02.11[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081228256225586, 'time_algorithm_update': 0.005540492057800293, 'loss': 1.6713152903169393, 'time_step': 0.007673714637756348, 'init_value': 3.7105712890625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:02.20[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089276313781738, 'time_algorithm_update': 0.005550765037536621, 'loss': 3.8569936300516128, 'time_step': 0.007692303895950318, 'init_value': 8.1651611328125}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:02.30[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020924608707427977, 'time_algorithm_update': 0.00555081844329834, 'loss': 4.627564375400543, 'time_step': 0.007696126461029053, 'init_value': 13.628657341003418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:02.39[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020841760635375976, 'time_algorithm_update': 0.005550717353820801, 'loss': 5.11389969754219, 'time_step': 0.007688071727752686, 'init_value': 19.530784606933594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:02.48[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205839467048645, 'time_algorithm_update': 0.005460472106933594, 'loss': 5.808404620409012, 'time_step': 0.007570652723312378, 'init_value': 26.376489639282227}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:02.57[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020618860721588134, 'time_algorithm_update': 0.005474230766296387, 'loss': 5.999643833398819, 'time_step': 0.0075881221294403075, 'init_value': 32.552730560302734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:03.06[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020717012882232664, 'time_algorithm_update': 0.005482085943222046, 'loss': 6.68763565659523, 'time_step': 0.007605894804000855, 'init_value': 38.255191802978516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:03.15[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065415620803833, 'time_algorithm_update': 0.005475366592407226, 'loss': 8.326327880144119, 'time_step': 0.007592671394348145, 'init_value': 45.215362548828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:03.24[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067801475524902, 'time_algorithm_update': 0.005471675872802734, 'loss': 9.455259159326554, 'time_step': 0.007591533660888672, 'init_value': 51.329586029052734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:03.34[0m [[32m[1minfo     [0m] [1mFQE_20250505190202: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020801753997802736, 'time_algorithm_update': 0.005534456253051758, 'loss': 10.125293842077255, 'time_step': 0.007667630434036255, 'init_value': 56.38266372680664}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.38266372680664
avg return on 5 trajectories of agent9: 969.8883906666666
Episode generator created
[2m2025-05-05 19:03.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:03.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:03.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:03.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:03.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190337[0m
[2m2025-05-05 19:03.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:03.46[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002074634552001953, 'time_algorithm_update': 0.0055255451202392575, 'loss': 1.6468099425584077, 'time_step': 0.0076526875495910645, 'init_value': 3.7018446922302246}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:03.55[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020897388458251953, 'time_algorithm_update': 0.005550246000289917, 'loss': 4.101026590704918, 'time_step': 0.007692511320114136, 'init_value': 9.131011009216309}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:04.05[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088797330856323, 'time_algorithm_update': 0.00556410551071167, 'loss': 4.779663969874382, 'time_step': 0.007705930233001709, 'init_value': 15.816717147827148}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:04.14[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087472915649414, 'time_algorithm_update': 0.005547224998474121, 'loss': 5.66388648056984, 'time_step': 0.007687716484069824, 'init_value': 22.208740234375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:04.23[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002082951068878174, 'time_algorithm_update': 0.00555220627784729, 'loss': 6.056018453836441, 'time_step': 0.007688313245773315, 'init_value': 27.862958908081055}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:04.32[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021053011417388914, 'time_algorithm_update': 0.005591454267501831, 'loss': 6.043163378953934, 'time_step': 0.007750294923782349, 'init_value': 33.00581741333008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:04.41[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089822053909302, 'time_algorithm_update': 0.005545969486236572, 'loss': 6.933889386415482, 'time_step': 0.007688487291336059, 'init_value': 37.31916427612305}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:04.51[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020807440280914305, 'time_algorithm_update': 0.00556367015838623, 'loss': 7.150557068586349, 'time_step': 0.007697266817092895, 'init_value': 40.785484313964844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:05.00[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020799269676208495, 'time_algorithm_update': 0.0055369181632995606, 'loss': 7.82064897942543, 'time_step': 0.007669447660446167, 'init_value': 46.44217300415039}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:05.09[0m [[32m[1minfo     [0m] [1mFQE_20250505190337: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087632179260254, 'time_algorithm_update': 0.005551713466644287, 'loss': 9.208573525905608, 'time_step': 0.007692561388015747, 'init_value': 51.67922592163086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.67922592163086
avg return on 5 trajectories of agent10: 935.5669743333333
Episode generator created
[2m2025-05-05 19:05.12[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:05.12[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:05.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:05.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:05.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190512[0m
[2m2025-05-05 19:05.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020827772617340087, 'time_algorithm_update': 0.0055175178050994875, 'loss': 1.6294705637395381, 'time_step': 0.007652502059936523, 'init_value': 3.583711624145508}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:05.31[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079582929611206, 'time_algorithm_update': 0.005526316165924072, 'loss': 4.09586785018444, 'time_step': 0.007658464908599854, 'init_value': 8.293054580688477}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:05.40[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020955779552459717, 'time_algorithm_update': 0.0055481200218200685, 'loss': 4.762495075941086, 'time_step': 0.0076967010498046875, 'init_value': 14.578189849853516}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:05.49[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020813384056091308, 'time_algorithm_update': 0.005539835929870606, 'loss': 5.314929560422898, 'time_step': 0.007674264907836914, 'init_value': 21.63638687133789}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:05.58[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208614182472229, 'time_algorithm_update': 0.005538170337677002, 'loss': 5.636036984682083, 'time_step': 0.00767710280418396, 'init_value': 27.498214721679688}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:06.08[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094409704208374, 'time_algorithm_update': 0.005559269905090332, 'loss': 6.125905940055847, 'time_step': 0.007706633806228638, 'init_value': 32.78711700439453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:06.17[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020848143100738524, 'time_algorithm_update': 0.005535576581954956, 'loss': 7.0189035322666165, 'time_step': 0.007672979354858399, 'init_value': 38.79661560058594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:06.26[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020828988552093505, 'time_algorithm_update': 0.0055364353656768795, 'loss': 7.614053651809693, 'time_step': 0.0076718685626983646, 'init_value': 45.010597229003906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:06.35[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020896797180175782, 'time_algorithm_update': 0.005541297912597656, 'loss': 8.875438430786133, 'time_step': 0.0076840312480926515, 'init_value': 49.675071716308594}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:06.44[0m [[32m[1minfo     [0m] [1mFQE_20250505190512: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084344148635864, 'time_algorithm_update': 0.005541190862655639, 'loss': 10.283439613819123, 'time_step': 0.007678484439849854, 'init_value': 56.0910530090332}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.0910530090332
avg return on 5 trajectories of agent11: 902.643463
Episode generator created
[2m2025-05-05 19:06.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:06.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:06.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:06.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:06.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190648[0m
[2m2025-05-05 19:06.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:06.57[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020822601318359374, 'time_algorithm_update': 0.00551963996887207, 'loss': 1.6504501701295375, 'time_step': 0.007654615879058838, 'init_value': 3.9937336444854736}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:07.06[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00211330246925354, 'time_algorithm_update': 0.005613797903060913, 'loss': 4.123273354053497, 'time_step': 0.007781075000762939, 'init_value': 8.64903736114502}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:07.15[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020879130363464357, 'time_algorithm_update': 0.005528104782104492, 'loss': 4.822323726177215, 'time_step': 0.007668585062026978, 'init_value': 14.906176567077637}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:07.25[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208231258392334, 'time_algorithm_update': 0.005517199039459229, 'loss': 5.194689897656441, 'time_step': 0.007652002811431885, 'init_value': 20.649993896484375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:07.34[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095433235168457, 'time_algorithm_update': 0.0055301814079284665, 'loss': 5.540288257837296, 'time_step': 0.007678645372390747, 'init_value': 27.0963077545166}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:07.43[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089977741241455, 'time_algorithm_update': 0.005528434753417969, 'loss': 6.212288083076477, 'time_step': 0.007671169996261597, 'init_value': 32.225440979003906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:07.52[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020859231948852537, 'time_algorithm_update': 0.0055367712974548336, 'loss': 7.228931097269058, 'time_step': 0.007676161766052246, 'init_value': 39.21232604980469}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:08.02[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021167278289794924, 'time_algorithm_update': 0.005605190277099609, 'loss': 7.7581225824356075, 'time_step': 0.007776246547698974, 'init_value': 45.081695556640625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:08.11[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090315580368042, 'time_algorithm_update': 0.005547019243240356, 'loss': 9.242192524433136, 'time_step': 0.007690290212631226, 'init_value': 52.13680648803711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:08.20[0m [[32m[1minfo     [0m] [1mFQE_20250505190648: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020878732204437254, 'time_algorithm_update': 0.00553708553314209, 'loss': 9.918002635478974, 'time_step': 0.007678094387054443, 'init_value': 57.214900970458984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.214900970458984
avg return on 5 trajectories of agent12: 893.6457326666667
Episode generator created
[2m2025-05-05 19:08.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:08.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:08.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:08.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:08.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190823[0m
[2m2025-05-05 19:08.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:08.32[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002082768440246582, 'time_algorithm_update': 0.0055147426128387455, 'loss': 1.6538152335882186, 'time_step': 0.007650018453598023, 'init_value': 3.749476909637451}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:08.42[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002082019567489624, 'time_algorithm_update': 0.005526208877563476, 'loss': 3.9867777585983277, 'time_step': 0.007661064624786377, 'init_value': 8.955778121948242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089367389678955, 'time_algorithm_update': 0.005526703596115112, 'loss': 4.8507498428821565, 'time_step': 0.007668494462966919, 'init_value': 15.144853591918945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:09.00[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097053289413452, 'time_algorithm_update': 0.005542198896408081, 'loss': 5.071752171039582, 'time_step': 0.007692131996154785, 'init_value': 21.0279483795166}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:09.09[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967702865600586, 'time_algorithm_update': 0.005542394161224365, 'loss': 5.422470136165619, 'time_step': 0.0076920464038848875, 'init_value': 28.380250930786133}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:09.19[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020801293849945068, 'time_algorithm_update': 0.005533239364624023, 'loss': 6.12070614528656, 'time_step': 0.007665854215621948, 'init_value': 32.62152099609375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:09.28[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089055299758911, 'time_algorithm_update': 0.005534221887588501, 'loss': 7.008820996284485, 'time_step': 0.007676719188690185, 'init_value': 39.392887115478516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:09.37[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020915043354034425, 'time_algorithm_update': 0.0055348525047302245, 'loss': 7.391101961135864, 'time_step': 0.007679495573043823, 'init_value': 44.86289596557617}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:09.46[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089902400970459, 'time_algorithm_update': 0.005523998022079468, 'loss': 8.76653955221176, 'time_step': 0.007666916608810425, 'init_value': 50.30756759643555}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:09.55[0m [[32m[1minfo     [0m] [1mFQE_20250505190823: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101627826690674, 'time_algorithm_update': 0.005530750751495362, 'loss': 9.349453198671341, 'time_step': 0.007685482978820801, 'init_value': 55.588218688964844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.588218688964844
avg return on 5 trajectories of agent13: 972.3968166666667
Episode generator created
[2m2025-05-05 19:09.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:09.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:09.59[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:09.59[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:09.59[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505190959[0m
[2m2025-05-05 19:09.59[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:10.08[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020814406871795654, 'time_algorithm_update': 0.005532310724258423, 'loss': 1.6490453882962466, 'time_step': 0.007666550159454346, 'init_value': 3.814924478530884}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:10.17[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020926923751831057, 'time_algorithm_update': 0.005535787343978882, 'loss': 3.8604590566158294, 'time_step': 0.007681271076202392, 'init_value': 9.297783851623535}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:10.26[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091799259185791, 'time_algorithm_update': 0.005549330949783325, 'loss': 4.681681246995926, 'time_step': 0.007693631649017334, 'init_value': 15.747467041015625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:10.35[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102735757827759, 'time_algorithm_update': 0.005557811975479126, 'loss': 5.221964522123336, 'time_step': 0.007713301420211792, 'init_value': 22.462841033935547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:10.45[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020820081233978273, 'time_algorithm_update': 0.005537813425064087, 'loss': 6.111205332756042, 'time_step': 0.0076724131107330324, 'init_value': 29.368120193481445}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:10.54[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020952115058898925, 'time_algorithm_update': 0.005556153059005737, 'loss': 6.794658572435379, 'time_step': 0.007703953742980957, 'init_value': 36.83424377441406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:11.03[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020853104591369628, 'time_algorithm_update': 0.0055424258708953855, 'loss': 7.641486861228943, 'time_step': 0.007680507898330688, 'init_value': 42.68327713012695}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:11.12[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020990867614746095, 'time_algorithm_update': 0.005547768592834472, 'loss': 8.190197326660156, 'time_step': 0.0076997849941253665, 'init_value': 48.761329650878906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:11.22[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100248336791992, 'time_algorithm_update': 0.005548789501190186, 'loss': 9.537620291471482, 'time_step': 0.007701917171478272, 'init_value': 55.90007019042969}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:11.31[0m [[32m[1minfo     [0m] [1mFQE_20250505190959: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002108886480331421, 'time_algorithm_update': 0.005594307422637939, 'loss': 10.67600832271576, 'time_step': 0.007756585359573364, 'init_value': 58.1727180480957}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.1727180480957
avg return on 5 trajectories of agent14: 984.601326
Episode generator created
[2m2025-05-05 19:11.34[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:11.34[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:11.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:11.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:11.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191134[0m
[2m2025-05-05 19:11.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:11.43[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086742639541626, 'time_algorithm_update': 0.00554003119468689, 'loss': 1.6820046039968728, 'time_step': 0.007679590463638306, 'init_value': 3.533137083053589}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:11.53[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089197874069214, 'time_algorithm_update': 0.005555232524871826, 'loss': 4.084492466688156, 'time_step': 0.007697085857391358, 'init_value': 7.86533260345459}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:12.02[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020999617576599123, 'time_algorithm_update': 0.00554936671257019, 'loss': 4.751187195420266, 'time_step': 0.007701686382293701, 'init_value': 13.686748504638672}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:12.11[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021067671775817872, 'time_algorithm_update': 0.005565598011016846, 'loss': 5.235581871032715, 'time_step': 0.007725659847259521, 'init_value': 21.32990264892578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:12.20[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020942366123199462, 'time_algorithm_update': 0.005566003084182739, 'loss': 5.82566020989418, 'time_step': 0.007713079214096069, 'init_value': 27.423891067504883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:12.29[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020894711017608644, 'time_algorithm_update': 0.00556182861328125, 'loss': 5.938683510303497, 'time_step': 0.007704315662384033, 'init_value': 33.87312698364258}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:12.39[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021085190773010255, 'time_algorithm_update': 0.00557080078125, 'loss': 6.958919894695282, 'time_step': 0.007732120990753174, 'init_value': 39.266334533691406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:12.48[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101473569869995, 'time_algorithm_update': 0.005563955545425415, 'loss': 7.331088603973389, 'time_step': 0.007718430995941162, 'init_value': 42.50300979614258}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:12.57[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089935302734375, 'time_algorithm_update': 0.0055637919902801515, 'loss': 9.212354584693909, 'time_step': 0.007706224203109741, 'init_value': 50.712493896484375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:13.06[0m [[32m[1minfo     [0m] [1mFQE_20250505191134: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020916666984558104, 'time_algorithm_update': 0.005569173097610474, 'loss': 10.309497975111007, 'time_step': 0.007713712215423584, 'init_value': 57.48662185668945}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.48662185668945
avg return on 5 trajectories of agent15: 994.5017969999999
Episode generator created
[2m2025-05-05 19:13.09[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:13.09[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:13.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:13.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:13.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191310[0m
[2m2025-05-05 19:13.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:13.19[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055093765258789, 'time_algorithm_update': 0.005443800687789917, 'loss': 1.7135102189332247, 'time_step': 0.007550306320190429, 'init_value': 3.668107509613037}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:13.28[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020686748027801513, 'time_algorithm_update': 0.005461730003356933, 'loss': 4.271123349189758, 'time_step': 0.007582150220870972, 'init_value': 9.286351203918457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:13.37[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002069520950317383, 'time_algorithm_update': 0.0054616363048553464, 'loss': 4.69670339512825, 'time_step': 0.007582770109176636, 'init_value': 15.249295234680176}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:13.46[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020625605583190917, 'time_algorithm_update': 0.005459902763366699, 'loss': 5.124124895095825, 'time_step': 0.0075740208625793455, 'init_value': 21.765064239501953}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:13.55[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002070518732070923, 'time_algorithm_update': 0.005475790977478028, 'loss': 5.776769291996956, 'time_step': 0.007598364114761352, 'init_value': 26.707992553710938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:14.04[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020914828777313234, 'time_algorithm_update': 0.005533916711807251, 'loss': 6.48226518034935, 'time_step': 0.007678766250610352, 'init_value': 33.833927154541016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:14.13[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020933628082275392, 'time_algorithm_update': 0.0055261669158935545, 'loss': 7.0168676264286045, 'time_step': 0.007672232866287231, 'init_value': 39.165443420410156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:14.23[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100816249847412, 'time_algorithm_update': 0.005539306402206421, 'loss': 7.65856805729866, 'time_step': 0.007692902088165283, 'init_value': 44.589988708496094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:14.32[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094430446624756, 'time_algorithm_update': 0.005532799959182739, 'loss': 8.477330262184143, 'time_step': 0.007680297136306763, 'init_value': 51.58109664916992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:14.41[0m [[32m[1minfo     [0m] [1mFQE_20250505191310: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092768430709839, 'time_algorithm_update': 0.005541317462921143, 'loss': 10.379553616523742, 'time_step': 0.007687624454498291, 'init_value': 55.99839782714844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.99839782714844
avg return on 5 trajectories of agent16: 895.2411493333334
Episode generator created
[2m2025-05-05 19:14.44[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:14.44[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:14.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:14.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:14.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191444[0m
[2m2025-05-05 19:14.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:14.53[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020817189216613768, 'time_algorithm_update': 0.0055243678092956544, 'loss': 1.583245398312807, 'time_step': 0.007657979965209961, 'init_value': 3.4600789546966553}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:15.03[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021109201908111573, 'time_algorithm_update': 0.005591608047485351, 'loss': 4.0524307719469075, 'time_step': 0.007755873680114746, 'init_value': 8.374580383300781}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:15.12[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021070005893707275, 'time_algorithm_update': 0.005579511642456055, 'loss': 4.681840122699738, 'time_step': 0.007739214420318603, 'init_value': 15.011281967163086}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:15.21[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091673135757446, 'time_algorithm_update': 0.005552922487258911, 'loss': 5.256179833054542, 'time_step': 0.007696966648101807, 'init_value': 21.101163864135742}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:15.31[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020903496742248535, 'time_algorithm_update': 0.005553431749343872, 'loss': 5.68109860253334, 'time_step': 0.00769680643081665, 'init_value': 27.07944107055664}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:15.40[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100160837173462, 'time_algorithm_update': 0.005557024478912353, 'loss': 6.50514796924591, 'time_step': 0.007709669351577759, 'init_value': 32.790061950683594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:15.49[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095599889755249, 'time_algorithm_update': 0.005557748079299926, 'loss': 6.602235506534576, 'time_step': 0.007706056594848633, 'init_value': 38.21977233886719}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:15.58[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021046783924102783, 'time_algorithm_update': 0.005565911054611206, 'loss': 7.603341963768005, 'time_step': 0.0077233903408050536, 'init_value': 45.66236877441406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:16.08[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002106170654296875, 'time_algorithm_update': 0.005586085796356201, 'loss': 8.565625098228455, 'time_step': 0.0077455356121063235, 'init_value': 48.60904312133789}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:16.17[0m [[32m[1minfo     [0m] [1mFQE_20250505191444: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020978729724884034, 'time_algorithm_update': 0.0055650448799133305, 'loss': 9.337357520341873, 'time_step': 0.007715428829193115, 'init_value': 53.727508544921875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.727508544921875
avg return on 5 trajectories of agent17: 947.7421353333333
Episode generator created
[2m2025-05-05 19:16.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:16.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:16.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:16.20[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:16.20[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191620[0m
[2m2025-05-05 19:16.20[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:16.29[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020758287906646727, 'time_algorithm_update': 0.00553150749206543, 'loss': 1.686266175121069, 'time_step': 0.007659671783447265, 'init_value': 4.045248031616211}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:16.38[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020971031188964846, 'time_algorithm_update': 0.005543816328048706, 'loss': 4.082963559150696, 'time_step': 0.007693514347076416, 'init_value': 9.180774688720703}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:16.48[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020824120044708253, 'time_algorithm_update': 0.005535501480102539, 'loss': 4.989663880467415, 'time_step': 0.007670125961303711, 'init_value': 15.813047409057617}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:16.57[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020937471389770508, 'time_algorithm_update': 0.005558574199676513, 'loss': 5.410653186321259, 'time_step': 0.007705327033996582, 'init_value': 21.619552612304688}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:17.06[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093138933181763, 'time_algorithm_update': 0.0055529184341430666, 'loss': 5.492059808969498, 'time_step': 0.007698953151702881, 'init_value': 25.59662437438965}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:17.15[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209224271774292, 'time_algorithm_update': 0.005553924083709717, 'loss': 5.912352137088775, 'time_step': 0.007699314594268799, 'init_value': 31.304384231567383}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:17.25[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020984067916870117, 'time_algorithm_update': 0.00554818081855774, 'loss': 6.6249661424160005, 'time_step': 0.007699583292007446, 'init_value': 34.89265823364258}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:17.34[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020954442024230958, 'time_algorithm_update': 0.005556090116500855, 'loss': 7.380928727149963, 'time_step': 0.0077041866779327395, 'init_value': 41.54566192626953}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:17.43[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020863234996795653, 'time_algorithm_update': 0.005572127342224121, 'loss': 8.426109919548034, 'time_step': 0.0077117917537689205, 'init_value': 47.75692367553711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:17.52[0m [[32m[1minfo     [0m] [1mFQE_20250505191620: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083056926727295, 'time_algorithm_update': 0.005540421724319458, 'loss': 8.770829656839371, 'time_step': 0.007675989389419556, 'init_value': 50.610443115234375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.610443115234375
avg return on 5 trajectories of agent18: 976.6685796666667
Episode generator created
[2m2025-05-05 19:17.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:17.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:17.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:17.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:17.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191756[0m
[2m2025-05-05 19:17.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:18.05[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020836012363433837, 'time_algorithm_update': 0.005520256996154785, 'loss': 1.572438683077693, 'time_step': 0.007656255960464478, 'init_value': 3.358548164367676}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:18.14[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020953469276428225, 'time_algorithm_update': 0.005524284362792968, 'loss': 3.891476298213005, 'time_step': 0.007672344207763672, 'init_value': 8.09677791595459}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:18.23[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020908007621765136, 'time_algorithm_update': 0.005538610219955445, 'loss': 5.059017275810242, 'time_step': 0.007682188749313355, 'init_value': 14.25853157043457}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:18.32[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00210625433921814, 'time_algorithm_update': 0.005562544345855713, 'loss': 5.307510448217392, 'time_step': 0.0077220981121063235, 'init_value': 20.73292350769043}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:18.42[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020981624126434326, 'time_algorithm_update': 0.0055375885963439946, 'loss': 5.449467034816742, 'time_step': 0.007688686609268188, 'init_value': 26.266727447509766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:18.51[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092092990875244, 'time_algorithm_update': 0.005534395217895508, 'loss': 5.881461804389954, 'time_step': 0.007679182529449463, 'init_value': 30.56863784790039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:19.00[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020929532051086426, 'time_algorithm_update': 0.005533389091491699, 'loss': 6.548798135519028, 'time_step': 0.007678892135620117, 'init_value': 37.082881927490234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:19.09[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020959677696228028, 'time_algorithm_update': 0.0055439693927764894, 'loss': 7.324466998577118, 'time_step': 0.00769274091720581, 'init_value': 43.009395599365234}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:19.18[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020856831073760985, 'time_algorithm_update': 0.005537856101989746, 'loss': 8.279651650190353, 'time_step': 0.007676081657409668, 'init_value': 47.59683609008789}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:19.28[0m [[32m[1minfo     [0m] [1mFQE_20250505191756: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020986666679382324, 'time_algorithm_update': 0.005537865161895752, 'loss': 9.200719132661819, 'time_step': 0.007689393520355224, 'init_value': 53.301483154296875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.301483154296875
avg return on 5 trajectories of agent19: 953.3725713333333
Episode generator created
[2m2025-05-05 19:19.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:19.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:19.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:19.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:19.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505191931[0m
[2m2025-05-05 19:19.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:19.40[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086211919784546, 'time_algorithm_update': 0.005532739877700805, 'loss': 1.665048563182354, 'time_step': 0.007671263456344605, 'init_value': 3.6864898204803467}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:19.49[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089276313781738, 'time_algorithm_update': 0.005538804054260254, 'loss': 4.072514060139656, 'time_step': 0.0076803631782531735, 'init_value': 9.708641052246094}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:19.59[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102933406829834, 'time_algorithm_update': 0.0055412654876708985, 'loss': 4.840489659309387, 'time_step': 0.007696544170379639, 'init_value': 15.60807991027832}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:20.08[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094728708267212, 'time_algorithm_update': 0.00554657244682312, 'loss': 5.105329876422882, 'time_step': 0.0076940336227417, 'init_value': 23.092527389526367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:20.17[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020864043235778807, 'time_algorithm_update': 0.005528956890106201, 'loss': 5.613229395627975, 'time_step': 0.00766756534576416, 'init_value': 27.488296508789062}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:20.26[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020977418422698972, 'time_algorithm_update': 0.005535413742065429, 'loss': 5.683440024614334, 'time_step': 0.007685713291168213, 'init_value': 33.01563262939453}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:20.35[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020936434268951417, 'time_algorithm_update': 0.005538682222366333, 'loss': 7.091609648704528, 'time_step': 0.0076850426197052, 'init_value': 40.718955993652344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:20.45[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084503173828125, 'time_algorithm_update': 0.005536942958831787, 'loss': 7.405855466127395, 'time_step': 0.0076736207008361815, 'init_value': 46.3165168762207}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:20.54[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090928316116333, 'time_algorithm_update': 0.005539387226104736, 'loss': 8.72735894703865, 'time_step': 0.0076830008029937745, 'init_value': 50.22624588012695}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:21.03[0m [[32m[1minfo     [0m] [1mFQE_20250505191931: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020902252197265627, 'time_algorithm_update': 0.005542909622192383, 'loss': 9.004684607744217, 'time_step': 0.0076856563091278075, 'init_value': 54.24009704589844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.24009704589844
ave advantage rew: 54.92599086761474, std: 2.243182881836253
avg cum rews: 938.7388494666668, std: 30.953199300431447
Pearson correlation coefficient: 0.09872390365004242
Spearman correlation coefficient: 0.10526315789473684
Kendall Tau correlation coefficient: 0.042105263157894736
the best agent: 2, best agent cum rewards: 956.228962
1960
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.01750669953606141
avg return on 5 trajectories of agent0: 925.2359033333333
Episode generator created
[2m2025-05-05 19:21.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:21.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:21.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:21.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:21.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192126[0m
[2m2025-05-05 19:21.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:21.35[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020778095722198487, 'time_algorithm_update': 0.005507630109786987, 'loss': 1.6438381021469832, 'time_step': 0.007637303352355957, 'init_value': 3.4084579944610596}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:21.44[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087952375411987, 'time_algorithm_update': 0.00552943754196167, 'loss': 3.9897692749500275, 'time_step': 0.007669578552246094, 'init_value': 8.769116401672363}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:21.53[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020966894626617432, 'time_algorithm_update': 0.00554106068611145, 'loss': 4.728187709331513, 'time_step': 0.007690674543380737, 'init_value': 14.32344913482666}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:22.03[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021238934993743895, 'time_algorithm_update': 0.0056331045627594, 'loss': 5.428342080593109, 'time_step': 0.00781120491027832, 'init_value': 21.998130798339844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:22.12[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021024937629699706, 'time_algorithm_update': 0.005556208372116089, 'loss': 5.9336628043651585, 'time_step': 0.007711810350418091, 'init_value': 27.69911003112793}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:22.21[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002103919744491577, 'time_algorithm_update': 0.005558758020401001, 'loss': 6.1026756343841555, 'time_step': 0.007715876817703247, 'init_value': 32.96597671508789}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:22.30[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096493721008301, 'time_algorithm_update': 0.005554683685302734, 'loss': 7.169019715070725, 'time_step': 0.007703856468200683, 'init_value': 39.565181732177734}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:22.40[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020939435958862306, 'time_algorithm_update': 0.005552041053771973, 'loss': 8.213152822256088, 'time_step': 0.007698674917221069, 'init_value': 44.75507354736328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:22.49[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085946083068848, 'time_algorithm_update': 0.005546884536743164, 'loss': 8.537251388549805, 'time_step': 0.007686014413833618, 'init_value': 48.97723388671875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:22.58[0m [[32m[1minfo     [0m] [1mFQE_20250505192126: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002099200963973999, 'time_algorithm_update': 0.005544533014297485, 'loss': 9.611920879125595, 'time_step': 0.00769643759727478, 'init_value': 53.530338287353516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.530338287353516
avg return on 5 trajectories of agent1: 943.8254386666666
Episode generator created
[2m2025-05-05 19:23.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:23.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:23.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:23.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:23.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192301[0m
[2m2025-05-05 19:23.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:23.10[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020732648372650147, 'time_algorithm_update': 0.005522487878799438, 'loss': 1.6493688413649799, 'time_step': 0.007647711753845215, 'init_value': 3.785486936569214}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:23.20[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020873441696166992, 'time_algorithm_update': 0.005535135746002198, 'loss': 4.060337340116501, 'time_step': 0.007674859285354614, 'init_value': 9.806952476501465}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:23.29[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020929338932037353, 'time_algorithm_update': 0.005545421123504639, 'loss': 4.8335571668148045, 'time_step': 0.007690953493118286, 'init_value': 15.938583374023438}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:23.38[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020592012405395506, 'time_algorithm_update': 0.005466461658477783, 'loss': 5.349716847181321, 'time_step': 0.007577065944671631, 'init_value': 22.2404842376709}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:23.47[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020665125846862794, 'time_algorithm_update': 0.005471912622451783, 'loss': 5.64347798037529, 'time_step': 0.0075897214412689205, 'init_value': 27.612136840820312}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:23.56[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020704872608184816, 'time_algorithm_update': 0.005467979192733764, 'loss': 6.195411514043808, 'time_step': 0.007589935302734375, 'init_value': 34.15260696411133}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:24.05[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020667200088500975, 'time_algorithm_update': 0.005473590850830078, 'loss': 6.77322033238411, 'time_step': 0.007592420339584351, 'init_value': 38.91008377075195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:24.14[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020766472816467286, 'time_algorithm_update': 0.005473838090896606, 'loss': 7.879076137304306, 'time_step': 0.007602385759353638, 'init_value': 46.183345794677734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:24.24[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020917723178863526, 'time_algorithm_update': 0.0055421671867370605, 'loss': 9.001865521192551, 'time_step': 0.007686741828918457, 'init_value': 51.402828216552734}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:24.33[0m [[32m[1minfo     [0m] [1mFQE_20250505192301: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020874841213226318, 'time_algorithm_update': 0.005536655902862549, 'loss': 9.736190200805664, 'time_step': 0.007676331043243409, 'init_value': 56.06252670288086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.06252670288086
avg return on 5 trajectories of agent2: 930.1078986666666
Episode generator created
[2m2025-05-05 19:24.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:24.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:24.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:24.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:24.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192436[0m
[2m2025-05-05 19:24.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:24.45[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020672907829284667, 'time_algorithm_update': 0.005512613296508789, 'loss': 1.7114737263023854, 'time_step': 0.007631281614303589, 'init_value': 3.7252864837646484}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:24.54[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089519739151001, 'time_algorithm_update': 0.005531277656555176, 'loss': 3.8948126821517945, 'time_step': 0.00767288875579834, 'init_value': 8.17175579071045}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:25.04[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020882763862609863, 'time_algorithm_update': 0.005520912647247314, 'loss': 4.7063273110389705, 'time_step': 0.007661083698272705, 'init_value': 14.2012357711792}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:25.13[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020882530212402344, 'time_algorithm_update': 0.005534164667129517, 'loss': 5.037560544013977, 'time_step': 0.007674317836761474, 'init_value': 20.997013092041016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:25.22[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084991216659546, 'time_algorithm_update': 0.0055293264389038085, 'loss': 5.929812099933624, 'time_step': 0.007666290283203125, 'init_value': 27.862051010131836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:25.31[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021063125133514403, 'time_algorithm_update': 0.0055801281929016115, 'loss': 6.0734812180995945, 'time_step': 0.007739532470703125, 'init_value': 33.38456726074219}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:25.41[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021111009120941162, 'time_algorithm_update': 0.005574928283691406, 'loss': 6.856829122066498, 'time_step': 0.007738827228546142, 'init_value': 40.92171859741211}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:25.50[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088886499404907, 'time_algorithm_update': 0.005532421588897705, 'loss': 7.768089218616486, 'time_step': 0.0076731789112091065, 'init_value': 46.29527282714844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:25.59[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208870005607605, 'time_algorithm_update': 0.005535261631011963, 'loss': 8.648933166027069, 'time_step': 0.007676673889160156, 'init_value': 51.386478424072266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:26.08[0m [[32m[1minfo     [0m] [1mFQE_20250505192436: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088798999786377, 'time_algorithm_update': 0.005535753965377807, 'loss': 9.72270738863945, 'time_step': 0.007676925182342529, 'init_value': 55.36271667480469}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.36271667480469
avg return on 5 trajectories of agent3: 947.8373086666666
Episode generator created
[2m2025-05-05 19:26.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:26.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:26.12[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:26.12[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:26.12[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192612[0m
[2m2025-05-05 19:26.12[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:26.21[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020717034339904784, 'time_algorithm_update': 0.0055276150703430175, 'loss': 1.626297723531723, 'time_step': 0.007651414394378662, 'init_value': 3.8174047470092773}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:26.30[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086850643157959, 'time_algorithm_update': 0.005542099714279175, 'loss': 4.02027299284935, 'time_step': 0.007681199550628662, 'init_value': 8.89648151397705}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:26.39[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020862605571746826, 'time_algorithm_update': 0.005557433366775512, 'loss': 4.853962058782577, 'time_step': 0.007696495771408081, 'init_value': 15.242411613464355}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:26.49[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020884933471679687, 'time_algorithm_update': 0.005554320096969605, 'loss': 5.395263622999192, 'time_step': 0.007695217609405517, 'init_value': 21.25986099243164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:26.58[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020911414623260498, 'time_algorithm_update': 0.0055602178573608396, 'loss': 5.576220320463181, 'time_step': 0.00770383882522583, 'init_value': 28.744108200073242}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:27.07[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090187311172485, 'time_algorithm_update': 0.005560460329055786, 'loss': 6.287363918304443, 'time_step': 0.0077033755779266355, 'init_value': 34.77481460571289}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:27.16[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020927016735076904, 'time_algorithm_update': 0.005552445411682129, 'loss': 7.280395282030105, 'time_step': 0.00769844388961792, 'init_value': 41.87677001953125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:27.25[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020897364616394042, 'time_algorithm_update': 0.0055611252784729, 'loss': 7.958444131851197, 'time_step': 0.007703669548034668, 'init_value': 47.129920959472656}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:27.35[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020895581245422364, 'time_algorithm_update': 0.005558202505111695, 'loss': 9.022909952163696, 'time_step': 0.007700842380523681, 'init_value': 50.90593719482422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:27.44[0m [[32m[1minfo     [0m] [1mFQE_20250505192612: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020823631286621094, 'time_algorithm_update': 0.005554487943649292, 'loss': 10.485975873470306, 'time_step': 0.007689609527587891, 'init_value': 56.861000061035156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.861000061035156
avg return on 5 trajectories of agent4: 962.5121676666666
Episode generator created
[2m2025-05-05 19:27.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:27.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:27.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:27.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:27.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192747[0m
[2m2025-05-05 19:27.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:27.56[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020744633674621583, 'time_algorithm_update': 0.005526173353195191, 'loss': 1.6664251552671194, 'time_step': 0.00765256667137146, 'init_value': 4.2476911544799805}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:28.05[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020792508125305176, 'time_algorithm_update': 0.005541623830795288, 'loss': 4.043768832325935, 'time_step': 0.0076732196807861325, 'init_value': 9.64049243927002}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:28.15[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020774028301239014, 'time_algorithm_update': 0.005535963773727417, 'loss': 4.578378058075905, 'time_step': 0.00766620135307312, 'init_value': 15.305521965026855}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:28.24[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086264371871948, 'time_algorithm_update': 0.005530549764633179, 'loss': 5.304020793914795, 'time_step': 0.007669376611709595, 'init_value': 21.374900817871094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:28.33[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020855872631072997, 'time_algorithm_update': 0.005530474424362183, 'loss': 5.636895401716233, 'time_step': 0.007668601751327515, 'init_value': 29.406068801879883}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:28.42[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020862393379211426, 'time_algorithm_update': 0.005532782077789306, 'loss': 6.165184283018112, 'time_step': 0.00767175006866455, 'init_value': 36.01022720336914}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:28.52[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020877511501312257, 'time_algorithm_update': 0.005539694309234619, 'loss': 7.327394708633423, 'time_step': 0.007680511236190796, 'init_value': 40.87480926513672}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:29.01[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020914859771728514, 'time_algorithm_update': 0.005545702457427979, 'loss': 7.943695000171662, 'time_step': 0.007690153121948242, 'init_value': 45.90163040161133}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:29.10[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020985851287841795, 'time_algorithm_update': 0.005570373058319092, 'loss': 8.59660036969185, 'time_step': 0.007722130060195923, 'init_value': 51.46908187866211}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:29.19[0m [[32m[1minfo     [0m] [1mFQE_20250505192747: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020904691219329834, 'time_algorithm_update': 0.005543743848800659, 'loss': 9.504979439496994, 'time_step': 0.0076871497631072995, 'init_value': 54.93508529663086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.93508529663086
avg return on 5 trajectories of agent5: 939.5794689999999
Episode generator created
[2m2025-05-05 19:29.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:29.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:29.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:29.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:29.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505192922[0m
[2m2025-05-05 19:29.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:29.32[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020860223770141602, 'time_algorithm_update': 0.005527897834777832, 'loss': 1.643715252712369, 'time_step': 0.007666491031646729, 'init_value': 3.9498629570007324}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:29.41[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020948643684387206, 'time_algorithm_update': 0.005543371915817261, 'loss': 3.9709401078224182, 'time_step': 0.00769103741645813, 'init_value': 8.167322158813477}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:29.50[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020932440757751463, 'time_algorithm_update': 0.005537858009338379, 'loss': 4.984091379404068, 'time_step': 0.0076837499141693116, 'init_value': 14.37895393371582}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:29.59[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093172788619995, 'time_algorithm_update': 0.005545216083526611, 'loss': 5.407308299541473, 'time_step': 0.007691239833831787, 'init_value': 20.514850616455078}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:30.09[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096226930618286, 'time_algorithm_update': 0.005545520305633545, 'loss': 5.776603843212127, 'time_step': 0.007694498538970947, 'init_value': 27.466825485229492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:30.18[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021008105278015137, 'time_algorithm_update': 0.005553135395050049, 'loss': 6.243588993787766, 'time_step': 0.007707010507583618, 'init_value': 32.515869140625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:30.27[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020951189994812013, 'time_algorithm_update': 0.005554713010787964, 'loss': 6.707487906455993, 'time_step': 0.007703189611434937, 'init_value': 39.3481559753418}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:30.36[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020937244892120363, 'time_algorithm_update': 0.005544931650161743, 'loss': 7.543823479175567, 'time_step': 0.007691607236862182, 'init_value': 44.02774429321289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:30.46[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967233180999756, 'time_algorithm_update': 0.005554253101348877, 'loss': 7.942572362661362, 'time_step': 0.007704062938690186, 'init_value': 48.159523010253906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:30.55[0m [[32m[1minfo     [0m] [1mFQE_20250505192922: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209537935256958, 'time_algorithm_update': 0.00555523681640625, 'loss': 9.120099643707276, 'time_step': 0.007703939199447632, 'init_value': 52.909393310546875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.909393310546875
avg return on 5 trajectories of agent6: 886.2959733333333
Episode generator created
[2m2025-05-05 19:30.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:30.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:30.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:30.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:30.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193058[0m
[2m2025-05-05 19:30.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:31.07[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102324724197388, 'time_algorithm_update': 0.005597517251968383, 'loss': 1.6677530981302262, 'time_step': 0.007753507852554321, 'init_value': 3.7698795795440674}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:31.17[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020834243297576903, 'time_algorithm_update': 0.00553835654258728, 'loss': 3.9516257494688034, 'time_step': 0.007680751800537109, 'init_value': 8.930120468139648}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020836949348449706, 'time_algorithm_update': 0.005534755945205689, 'loss': 4.637436074256897, 'time_step': 0.007670864343643189, 'init_value': 14.453085899353027}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:31.35[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084545373916626, 'time_algorithm_update': 0.005534371137619018, 'loss': 5.198220921754837, 'time_step': 0.0076710946559906, 'init_value': 20.423736572265625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:31.44[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020879967212677, 'time_algorithm_update': 0.0055344576835632325, 'loss': 5.481558169126511, 'time_step': 0.007675142288208008, 'init_value': 27.4689998626709}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:31.53[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081584692001343, 'time_algorithm_update': 0.005527851819992066, 'loss': 5.9467909097671505, 'time_step': 0.007661922216415405, 'init_value': 34.70505905151367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:32.02[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090367317199707, 'time_algorithm_update': 0.005535731077194214, 'loss': 6.792872938036918, 'time_step': 0.007678879976272583, 'init_value': 40.37906265258789}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:32.12[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089853525161743, 'time_algorithm_update': 0.00553921389579773, 'loss': 7.4427420635223385, 'time_step': 0.0076818022727966305, 'init_value': 45.90595245361328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:32.21[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087862730026245, 'time_algorithm_update': 0.005530697107315063, 'loss': 9.1269893014431, 'time_step': 0.007670954704284668, 'init_value': 51.64628219604492}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:32.30[0m [[32m[1minfo     [0m] [1mFQE_20250505193058: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101199388504028, 'time_algorithm_update': 0.005558360815048218, 'loss': 9.892250744581222, 'time_step': 0.007712825059890747, 'init_value': 56.681358337402344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.681358337402344
avg return on 5 trajectories of agent7: 894.9836946666668
Episode generator created
[2m2025-05-05 19:32.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:32.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:32.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:32.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:32.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193233[0m
[2m2025-05-05 19:32.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:32.43[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020758390426635744, 'time_algorithm_update': 0.005535263538360596, 'loss': 1.615071699783206, 'time_step': 0.007664109468460083, 'init_value': 3.655487060546875}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:32.52[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002085440397262573, 'time_algorithm_update': 0.005533247709274292, 'loss': 3.98133440554142, 'time_step': 0.007671034574508667, 'init_value': 8.286635398864746}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:33.01[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020835082530975342, 'time_algorithm_update': 0.005533453464508057, 'loss': 4.533758986353874, 'time_step': 0.007669716835021973, 'init_value': 13.57449722290039}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:33.10[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020861911773681643, 'time_algorithm_update': 0.005533042430877685, 'loss': 5.1083060624599455, 'time_step': 0.007671859979629517, 'init_value': 19.30225944519043}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:33.20[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020841612815856933, 'time_algorithm_update': 0.0055266859531402585, 'loss': 5.540626588821411, 'time_step': 0.007663177013397217, 'init_value': 25.814817428588867}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:33.29[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078947305679321, 'time_algorithm_update': 0.005537538290023803, 'loss': 6.189818780660629, 'time_step': 0.007669275522232056, 'init_value': 31.79033088684082}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:33.38[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020842597484588624, 'time_algorithm_update': 0.005534542083740234, 'loss': 6.828337096452713, 'time_step': 0.007671511650085449, 'init_value': 38.125213623046875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:33.47[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020895929336547854, 'time_algorithm_update': 0.005542308330535889, 'loss': 7.966227529287338, 'time_step': 0.0076846275329589845, 'init_value': 42.94100570678711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:33.56[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020535831451416017, 'time_algorithm_update': 0.005463521003723145, 'loss': 8.358762440919875, 'time_step': 0.007568525791168213, 'init_value': 48.00880432128906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:34.05[0m [[32m[1minfo     [0m] [1mFQE_20250505193233: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020592906475067137, 'time_algorithm_update': 0.00546558666229248, 'loss': 9.48181637763977, 'time_step': 0.007576778411865235, 'init_value': 55.32326126098633}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.32326126098633
avg return on 5 trajectories of agent8: 951.8292743333333
Episode generator created
[2m2025-05-05 19:34.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:34.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:34.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:34.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:34.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193408[0m
[2m2025-05-05 19:34.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:34.18[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020634348392486574, 'time_algorithm_update': 0.005451238632202148, 'loss': 1.643449732556939, 'time_step': 0.007566080093383789, 'init_value': 3.454211711883545}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:34.27[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064561605453491, 'time_algorithm_update': 0.005459834814071655, 'loss': 3.873132494091988, 'time_step': 0.007575725317001343, 'init_value': 8.036307334899902}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:34.36[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064850807189941, 'time_algorithm_update': 0.005454357862472534, 'loss': 4.539597357749939, 'time_step': 0.007570297718048096, 'init_value': 14.599955558776855}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:34.45[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020853657722473143, 'time_algorithm_update': 0.005518776178359985, 'loss': 5.0059000654220585, 'time_step': 0.007656251192092896, 'init_value': 21.20416259765625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:34.54[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209145450592041, 'time_algorithm_update': 0.005537111759185791, 'loss': 5.37480150103569, 'time_step': 0.007680677890777588, 'init_value': 26.8878173828125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:35.04[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091101884841919, 'time_algorithm_update': 0.005540470123291016, 'loss': 5.83918572974205, 'time_step': 0.007684325218200684, 'init_value': 33.613460540771484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:35.13[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020893895626068115, 'time_algorithm_update': 0.005533784627914429, 'loss': 6.4957675864696505, 'time_step': 0.007675534248352051, 'init_value': 38.25373077392578}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:35.22[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209031081199646, 'time_algorithm_update': 0.005544342279434204, 'loss': 7.081445464134216, 'time_step': 0.007686719894409179, 'init_value': 45.5030517578125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:35.31[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095016956329346, 'time_algorithm_update': 0.0055442955493927, 'loss': 8.705669752597808, 'time_step': 0.007691653966903686, 'init_value': 51.76272201538086}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:35.40[0m [[32m[1minfo     [0m] [1mFQE_20250505193408: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020937085151672362, 'time_algorithm_update': 0.00553348708152771, 'loss': 9.78484852862358, 'time_step': 0.007679787158966065, 'init_value': 57.49917984008789}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.49917984008789
avg return on 5 trajectories of agent9: 909.5147876666666
Episode generator created
[2m2025-05-05 19:35.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:35.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:35.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:35.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:35.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193544[0m
[2m2025-05-05 19:35.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:35.53[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020870180130004882, 'time_algorithm_update': 0.0055159502029418946, 'loss': 1.5489639853686095, 'time_step': 0.007655383825302124, 'init_value': 3.4705286026000977}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:36.02[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002112622022628784, 'time_algorithm_update': 0.005593962430953979, 'loss': 3.930782963633537, 'time_step': 0.007759672403335571, 'init_value': 8.740489959716797}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:36.11[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095691204071045, 'time_algorithm_update': 0.005537551164627075, 'loss': 4.7032989687919615, 'time_step': 0.007685577630996704, 'init_value': 14.09931755065918}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:36.21[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002107997179031372, 'time_algorithm_update': 0.005579529523849487, 'loss': 4.985792028546333, 'time_step': 0.007740367412567139, 'init_value': 19.986722946166992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:36.30[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209405255317688, 'time_algorithm_update': 0.0055461833477020266, 'loss': 5.682993572950363, 'time_step': 0.007693041801452636, 'init_value': 27.923839569091797}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:36.39[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020891976356506347, 'time_algorithm_update': 0.005526911973953247, 'loss': 6.122404776573181, 'time_step': 0.00766899561882019, 'init_value': 33.519859313964844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:36.48[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093362092971802, 'time_algorithm_update': 0.00554084849357605, 'loss': 6.888531407117844, 'time_step': 0.007686835765838623, 'init_value': 40.797855377197266}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:36.58[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020941867828369143, 'time_algorithm_update': 0.005538867712020874, 'loss': 7.168247481584549, 'time_step': 0.007685423135757446, 'init_value': 44.135719299316406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:37.07[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020884382724761963, 'time_algorithm_update': 0.005526670694351196, 'loss': 8.308141473293304, 'time_step': 0.007667275190353394, 'init_value': 49.92170333862305}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:37.16[0m [[32m[1minfo     [0m] [1mFQE_20250505193544: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020927841663360594, 'time_algorithm_update': 0.005542005062103271, 'loss': 9.419576375961304, 'time_step': 0.007687420129776001, 'init_value': 54.236610412597656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.236610412597656
avg return on 5 trajectories of agent10: 982.6983073333334
Episode generator created
[2m2025-05-05 19:37.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:37.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:37.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:37.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:37.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193719[0m
[2m2025-05-05 19:37.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:37.28[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002075385332107544, 'time_algorithm_update': 0.0055332636833190915, 'loss': 1.6394231551140548, 'time_step': 0.00766114354133606, 'init_value': 2.8739373683929443}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:37.38[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020825262069702147, 'time_algorithm_update': 0.005541246652603149, 'loss': 3.8915762003660204, 'time_step': 0.0076760764122009275, 'init_value': 8.179443359375}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:37.47[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020850486755371093, 'time_algorithm_update': 0.005549399614334106, 'loss': 4.794801697731018, 'time_step': 0.007686769008636475, 'init_value': 14.410903930664062}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:37.56[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020874879360198973, 'time_algorithm_update': 0.005557522058486939, 'loss': 5.476378373622894, 'time_step': 0.007697264432907105, 'init_value': 20.54931640625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:38.05[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020916638374328615, 'time_algorithm_update': 0.005548935890197754, 'loss': 5.678233803033828, 'time_step': 0.007692980527877808, 'init_value': 26.613819122314453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:38.15[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020944335460662843, 'time_algorithm_update': 0.005552628993988037, 'loss': 6.03690928709507, 'time_step': 0.007699619531631469, 'init_value': 31.257726669311523}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:38.24[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020880167484283447, 'time_algorithm_update': 0.005551155090332031, 'loss': 6.660360094070435, 'time_step': 0.00769133996963501, 'init_value': 35.62529373168945}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:38.33[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002091785669326782, 'time_algorithm_update': 0.0055524008274078366, 'loss': 7.221407918453217, 'time_step': 0.0076969900131225585, 'init_value': 41.52851867675781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:38.42[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092989206314087, 'time_algorithm_update': 0.0055609230995178225, 'loss': 7.781867730140686, 'time_step': 0.007706534624099731, 'init_value': 46.64772415161133}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:38.51[0m [[32m[1minfo     [0m] [1mFQE_20250505193719: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020941805839538572, 'time_algorithm_update': 0.005558752536773682, 'loss': 8.720779988050461, 'time_step': 0.007705827951431274, 'init_value': 51.19145965576172}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.19145965576172
avg return on 5 trajectories of agent11: 922.8259703333333
Episode generator created
[2m2025-05-05 19:38.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:38.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:38.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:38.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:38.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505193855[0m
[2m2025-05-05 19:38.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:39.04[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020780792236328124, 'time_algorithm_update': 0.0054971764087677006, 'loss': 1.5587645726203918, 'time_step': 0.007627636909484863, 'init_value': 3.2935068607330322}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:39.13[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020868895053863528, 'time_algorithm_update': 0.0055193533897399906, 'loss': 3.79215724337101, 'time_step': 0.007658839702606201, 'init_value': 8.413692474365234}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:39.22[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090928316116333, 'time_algorithm_update': 0.005520125389099121, 'loss': 4.726790098547935, 'time_step': 0.007663573741912842, 'init_value': 14.36334228515625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:39.32[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021017632484436033, 'time_algorithm_update': 0.005567899703979492, 'loss': 5.052468045711517, 'time_step': 0.007723098754882813, 'init_value': 20.405929565429688}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:39.41[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002094881534576416, 'time_algorithm_update': 0.005535687446594238, 'loss': 5.47922868680954, 'time_step': 0.007683229684829712, 'init_value': 26.86454200744629}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:39.50[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020933907032012937, 'time_algorithm_update': 0.005541612863540649, 'loss': 6.072516061544419, 'time_step': 0.00768769097328186, 'init_value': 33.0029296875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:39.59[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020926215648651124, 'time_algorithm_update': 0.005532837390899658, 'loss': 7.068572364091873, 'time_step': 0.007678093910217285, 'init_value': 40.71537780761719}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:40.08[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020996191501617433, 'time_algorithm_update': 0.005553174257278443, 'loss': 7.978033605575561, 'time_step': 0.007705634593963623, 'init_value': 46.91975021362305}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:40.18[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209075665473938, 'time_algorithm_update': 0.005545063018798828, 'loss': 9.086617740631104, 'time_step': 0.007688313245773315, 'init_value': 49.54774856567383}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:40.27[0m [[32m[1minfo     [0m] [1mFQE_20250505193855: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090140342712402, 'time_algorithm_update': 0.00553059983253479, 'loss': 9.765230527639389, 'time_step': 0.007673188447952271, 'init_value': 56.505859375}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.505859375
avg return on 5 trajectories of agent12: 880.4683570000001
Episode generator created
[2m2025-05-05 19:40.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:40.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:40.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:40.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:40.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194030[0m
[2m2025-05-05 19:40.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:40.39[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00207906699180603, 'time_algorithm_update': 0.005531070232391358, 'loss': 1.6147373483181, 'time_step': 0.007662672758102417, 'init_value': 3.636378288269043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:40.49[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020899345874786377, 'time_algorithm_update': 0.005547754049301148, 'loss': 3.8208760976791383, 'time_step': 0.007690205335617066, 'init_value': 8.250018119812012}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:40.58[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020857083797454832, 'time_algorithm_update': 0.005554109573364258, 'loss': 4.557747547745705, 'time_step': 0.007692523717880249, 'init_value': 14.702263832092285}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:41.07[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087244987487793, 'time_algorithm_update': 0.005551695823669434, 'loss': 5.3728289037942885, 'time_step': 0.007691102981567383, 'init_value': 22.608375549316406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:41.16[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089564561843872, 'time_algorithm_update': 0.005555921316146851, 'loss': 5.795003114938736, 'time_step': 0.007697839975357055, 'init_value': 28.71405601501465}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:41.26[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020859875679016112, 'time_algorithm_update': 0.005546023845672607, 'loss': 5.973588614344597, 'time_step': 0.007684325933456421, 'init_value': 32.98337173461914}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:41.35[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002098928689956665, 'time_algorithm_update': 0.0055580101013183595, 'loss': 6.66215362739563, 'time_step': 0.007709697723388672, 'init_value': 40.013648986816406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:41.44[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002097611427307129, 'time_algorithm_update': 0.005560404539108276, 'loss': 8.365544928789138, 'time_step': 0.0077109293937683105, 'init_value': 46.47669982910156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:41.53[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020843000411987305, 'time_algorithm_update': 0.0055414457321167, 'loss': 9.311199433803559, 'time_step': 0.007678425788879394, 'init_value': 51.890113830566406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:42.02[0m [[32m[1minfo     [0m] [1mFQE_20250505194030: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092134952545166, 'time_algorithm_update': 0.005564154148101807, 'loss': 9.891914402723312, 'time_step': 0.007709028244018555, 'init_value': 55.6393928527832}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.6393928527832
avg return on 5 trajectories of agent13: 924.727288
Episode generator created
[2m2025-05-05 19:42.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:42.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:42.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:42.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:42.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:42.15[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208951997756958, 'time_algorithm_update': 0.005536051273345948, 'loss': 1.6798008728921414, 'time_step': 0.007678401231765747, 'init_value': 3.755864381790161}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:42.24[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020839951038360595, 'time_algorithm_update': 0.005546945333480835, 'loss': 3.895217598795891, 'time_step': 0.007683687448501587, 'init_value': 8.64937973022461}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:42.33[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081308364868164, 'time_algorithm_update': 0.0055568435192108155, 'loss': 4.735057906866073, 'time_step': 0.0076909992694854734, 'init_value': 15.600464820861816}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:42.43[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020849032402038576, 'time_algorithm_update': 0.005550187110900879, 'loss': 5.467898255825043, 'time_step': 0.0076879897117614745, 'init_value': 22.682870864868164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:42.52[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020825178623199462, 'time_algorithm_update': 0.005545261144638061, 'loss': 5.578906651258468, 'time_step': 0.007680320024490357, 'init_value': 28.619590759277344}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:43.01[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021042590141296387, 'time_algorithm_update': 0.005585368871688843, 'loss': 6.110778273701667, 'time_step': 0.007743023157119751, 'init_value': 31.812257766723633}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:43.10[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020926268100738524, 'time_algorithm_update': 0.0055515685081481934, 'loss': 6.290712323427201, 'time_step': 0.007696747303009033, 'init_value': 37.340755462646484}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:43.20[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020978424549102782, 'time_algorithm_update': 0.005556741714477539, 'loss': 7.28505787730217, 'time_step': 0.007707543849945068, 'init_value': 41.286354064941406}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:43.29[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020881855487823488, 'time_algorithm_update': 0.005562258005142212, 'loss': 7.893412436008453, 'time_step': 0.007703362703323364, 'init_value': 46.77033615112305}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:43.38[0m [[32m[1minfo     [0m] [1mFQE_20250505194206: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086883544921875, 'time_algorithm_update': 0.005542121171951294, 'loss': 8.876236795663834, 'time_step': 0.007681133031845093, 'init_value': 51.989070892333984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.989070892333984
avg return on 5 trajectories of agent14: 1003.2448136666667
Episode generator created
[2m2025-05-05 19:43.41[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:43.41[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:43.41[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:43.41[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:43.41[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194341[0m
[2m2025-05-05 19:43.41[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:43.51[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078707218170166, 'time_algorithm_update': 0.0055335090160369875, 'loss': 1.6731463650763034, 'time_step': 0.007665974140167236, 'init_value': 4.320824146270752}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:44.00[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089484453201294, 'time_algorithm_update': 0.0055555579662323, 'loss': 3.9264263235330583, 'time_step': 0.0076979358196258545, 'init_value': 9.567350387573242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:44.09[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002087317943572998, 'time_algorithm_update': 0.00555010461807251, 'loss': 4.754247963309288, 'time_step': 0.007690032005310058, 'init_value': 14.6318941116333}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:44.18[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020645554065704345, 'time_algorithm_update': 0.005513686656951905, 'loss': 5.164434908390045, 'time_step': 0.00763022518157959, 'init_value': 19.53107261657715}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:44.27[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060081720352173, 'time_algorithm_update': 0.00547377872467041, 'loss': 5.369602324485779, 'time_step': 0.007585039377212524, 'init_value': 25.21133041381836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:44.36[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020611474514007568, 'time_algorithm_update': 0.005475978136062622, 'loss': 5.4043806515932085, 'time_step': 0.0075888361930847165, 'init_value': 31.072233200073242}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:44.45[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568478107452393, 'time_algorithm_update': 0.005483193874359131, 'loss': 6.212695073843002, 'time_step': 0.007591447353363037, 'init_value': 37.22905349731445}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:44.55[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020572826862335207, 'time_algorithm_update': 0.005474649429321289, 'loss': 7.479476818799973, 'time_step': 0.007583508014678955, 'init_value': 43.49541091918945}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:45.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451223850250244, 'time_algorithm_update': 0.005460695743560791, 'loss': 8.448171895742416, 'time_step': 0.007557013034820557, 'init_value': 50.753562927246094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:45.13[0m [[32m[1minfo     [0m] [1mFQE_20250505194341: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020783073902130127, 'time_algorithm_update': 0.00554293179512024, 'loss': 10.203972176790238, 'time_step': 0.007673928022384644, 'init_value': 56.75759506225586}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.75759506225586
avg return on 5 trajectories of agent15: 944.6822596666667
Episode generator created
[2m2025-05-05 19:45.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:45.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:45.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:45.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:45.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194516[0m
[2m2025-05-05 19:45.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:45.25[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020769195556640625, 'time_algorithm_update': 0.005518850803375244, 'loss': 1.6093465640097857, 'time_step': 0.00764852523803711, 'init_value': 4.107858657836914}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:45.35[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020802552700042725, 'time_algorithm_update': 0.005535761594772339, 'loss': 3.7155752696990967, 'time_step': 0.007668612003326416, 'init_value': 8.643425941467285}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:45.44[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020843400955200195, 'time_algorithm_update': 0.005542388677597046, 'loss': 4.61839051258564, 'time_step': 0.0076791408061981205, 'init_value': 14.36575698852539}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:45.53[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020851781368255613, 'time_algorithm_update': 0.005546952962875366, 'loss': 5.147957297682762, 'time_step': 0.007684833765029907, 'init_value': 21.421722412109375}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:46.02[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208136248588562, 'time_algorithm_update': 0.005539594411849975, 'loss': 5.952637736320495, 'time_step': 0.007673769950866699, 'init_value': 28.006967544555664}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:46.11[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079136848449707, 'time_algorithm_update': 0.005531376361846924, 'loss': 6.532820084333419, 'time_step': 0.007663060665130615, 'init_value': 34.708438873291016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:46.20[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084559679031372, 'time_algorithm_update': 0.005550068616867065, 'loss': 7.295489964008332, 'time_step': 0.00768795657157898, 'init_value': 41.55830764770508}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:46.30[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020901329517364503, 'time_algorithm_update': 0.00557729721069336, 'loss': 8.621522680282593, 'time_step': 0.007720578193664551, 'init_value': 48.532596588134766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:46.39[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079918384552002, 'time_algorithm_update': 0.005550014734268189, 'loss': 9.33372167491913, 'time_step': 0.007682896137237548, 'init_value': 51.05277633666992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:46.48[0m [[32m[1minfo     [0m] [1mFQE_20250505194516: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020924863815307616, 'time_algorithm_update': 0.005550100088119507, 'loss': 10.382383971452713, 'time_step': 0.0076956779956817625, 'init_value': 55.317344665527344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.317344665527344
avg return on 5 trajectories of agent16: 895.929837
Episode generator created
[2m2025-05-05 19:46.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:46.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:46.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:46.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:46.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194651[0m
[2m2025-05-05 19:46.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:47.01[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078183650970459, 'time_algorithm_update': 0.005538521289825439, 'loss': 1.6609600159078837, 'time_step': 0.00766974139213562, 'init_value': 3.8664190769195557}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:47.10[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020800330638885496, 'time_algorithm_update': 0.005545544147491455, 'loss': 3.9660373945236205, 'time_step': 0.007678169488906861, 'init_value': 9.029824256896973}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020885369777679445, 'time_algorithm_update': 0.005564410924911499, 'loss': 4.6789673600196835, 'time_step': 0.007706235647201538, 'init_value': 14.102993965148926}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:47.28[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020860729217529296, 'time_algorithm_update': 0.005556929111480713, 'loss': 5.0835695872306825, 'time_step': 0.007696245670318604, 'init_value': 19.891687393188477}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:47.38[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096590042114258, 'time_algorithm_update': 0.0055526535511016845, 'loss': 5.6246379075050355, 'time_step': 0.007701948165893555, 'init_value': 26.787569046020508}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:47.47[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209415864944458, 'time_algorithm_update': 0.005572764158248901, 'loss': 6.3714426882267, 'time_step': 0.007720215797424317, 'init_value': 32.9951286315918}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:47.56[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020951671600341797, 'time_algorithm_update': 0.005560968160629272, 'loss': 6.700193513393402, 'time_step': 0.007709399223327636, 'init_value': 39.13506317138672}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:48.05[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092703580856323, 'time_algorithm_update': 0.005564685106277466, 'loss': 7.506903760194779, 'time_step': 0.007710641622543335, 'init_value': 43.11601638793945}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:48.15[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020940852165222167, 'time_algorithm_update': 0.005558483600616455, 'loss': 8.685907647371293, 'time_step': 0.007705523014068604, 'init_value': 49.24292755126953}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:48.24[0m [[32m[1minfo     [0m] [1mFQE_20250505194651: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020986242294311524, 'time_algorithm_update': 0.005557817697525024, 'loss': 10.013157082080841, 'time_step': 0.007709139823913574, 'init_value': 53.71912384033203}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.71912384033203
avg return on 5 trajectories of agent17: 944.1682393333334
Episode generator created
[2m2025-05-05 19:48.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:48.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:48.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:48.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:48.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505194827[0m
[2m2025-05-05 19:48.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:48.36[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020760433673858644, 'time_algorithm_update': 0.005521733283996582, 'loss': 1.6696811757087708, 'time_step': 0.007649907112121582, 'init_value': 3.6307218074798584}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:48.45[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020840857028961183, 'time_algorithm_update': 0.005539895534515381, 'loss': 3.9260310678482058, 'time_step': 0.007676797151565552, 'init_value': 8.330714225769043}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:48.55[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002088955879211426, 'time_algorithm_update': 0.005544346332550049, 'loss': 4.5822513748407365, 'time_step': 0.007686184167861938, 'init_value': 14.25421142578125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:49.04[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020887439250946043, 'time_algorithm_update': 0.005540630340576172, 'loss': 5.115270360469818, 'time_step': 0.007682460308074951, 'init_value': 20.825931549072266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:49.13[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020933730602264405, 'time_algorithm_update': 0.00555099892616272, 'loss': 5.852577749490738, 'time_step': 0.007697279214859009, 'init_value': 27.904151916503906}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:49.22[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020910239219665526, 'time_algorithm_update': 0.005554900169372558, 'loss': 6.501374499320984, 'time_step': 0.007698456764221192, 'init_value': 34.25710678100586}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:49.32[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020881760120391845, 'time_algorithm_update': 0.005537992238998413, 'loss': 6.980727216243744, 'time_step': 0.0076785430908203126, 'init_value': 40.5610466003418}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:49.41[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090165138244629, 'time_algorithm_update': 0.00554513692855835, 'loss': 7.838062773704529, 'time_step': 0.0076879563331604004, 'init_value': 46.70526123046875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:49.50[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095151424407959, 'time_algorithm_update': 0.005542901039123535, 'loss': 9.5707136323452, 'time_step': 0.007690760612487793, 'init_value': 52.593475341796875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:49.59[0m [[32m[1minfo     [0m] [1mFQE_20250505194827: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090292453765869, 'time_algorithm_update': 0.005552008390426636, 'loss': 9.522969126224519, 'time_step': 0.00769535493850708, 'init_value': 58.41471862792969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.41471862792969
avg return on 5 trajectories of agent18: 902.8040769999999
Episode generator created
[2m2025-05-05 19:50.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:50.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:50.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:50.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:50.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195003[0m
[2m2025-05-05 19:50.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:50.12[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020837626457214354, 'time_algorithm_update': 0.005523839235305786, 'loss': 1.628598142772913, 'time_step': 0.007660149574279785, 'init_value': 3.0615763664245605}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:50.21[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020892410278320313, 'time_algorithm_update': 0.005553275108337402, 'loss': 3.8067622969150543, 'time_step': 0.007695383310317993, 'init_value': 8.046027183532715}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:50.30[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020882520675659178, 'time_algorithm_update': 0.005554092407226562, 'loss': 4.540612947821617, 'time_step': 0.007694733381271362, 'init_value': 14.131425857543945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:50.40[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002086583375930786, 'time_algorithm_update': 0.005563547134399414, 'loss': 5.142966077566147, 'time_step': 0.007702620983123779, 'init_value': 20.35031509399414}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:50.49[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002084939241409302, 'time_algorithm_update': 0.005572716474533081, 'loss': 5.853056141614914, 'time_step': 0.007710601329803467, 'init_value': 28.312578201293945}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:50.58[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020782344341278075, 'time_algorithm_update': 0.00554613447189331, 'loss': 6.246929970502854, 'time_step': 0.007676993370056152, 'init_value': 33.67378616333008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:51.07[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020881283283233644, 'time_algorithm_update': 0.005560007333755493, 'loss': 6.766949321746826, 'time_step': 0.0077011573314666746, 'init_value': 38.54110336303711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:51.16[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083681583404541, 'time_algorithm_update': 0.005561738014221191, 'loss': 7.6893971650600434, 'time_step': 0.007697932243347168, 'init_value': 44.90605163574219}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:51.26[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083550214767456, 'time_algorithm_update': 0.005543810129165649, 'loss': 8.329450168371201, 'time_step': 0.007679731369018555, 'init_value': 49.84421920776367}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:51.35[0m [[32m[1minfo     [0m] [1mFQE_20250505195003: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020880870819091797, 'time_algorithm_update': 0.005572861909866333, 'loss': 9.100934267520904, 'time_step': 0.0077142021656036374, 'init_value': 54.625694274902344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.625694274902344
avg return on 5 trajectories of agent19: 922.556662
Episode generator created
[2m2025-05-05 19:51.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:51.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:51.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:51.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:51.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195138[0m
[2m2025-05-05 19:51.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:51.47[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020799386501312257, 'time_algorithm_update': 0.005524928331375122, 'loss': 1.615290736451745, 'time_step': 0.007657257080078125, 'init_value': 3.667004346847534}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:51.56[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083454370498657, 'time_algorithm_update': 0.0055269553661346435, 'loss': 4.059114665150642, 'time_step': 0.007662605762481689, 'init_value': 8.426690101623535}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:52.06[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020901508331298826, 'time_algorithm_update': 0.005546114921569824, 'loss': 4.4520937385559085, 'time_step': 0.007689024448394775, 'init_value': 13.914848327636719}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:52.15[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090238332748413, 'time_algorithm_update': 0.005538544416427612, 'loss': 5.155137741565705, 'time_step': 0.007681367635726929, 'init_value': 21.93006134033203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:52.24[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002082900524139404, 'time_algorithm_update': 0.005523477077484131, 'loss': 5.255478023767472, 'time_step': 0.007659176826477051, 'init_value': 27.800048828125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:52.33[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020901141166687013, 'time_algorithm_update': 0.005539832592010498, 'loss': 6.224306471705437, 'time_step': 0.007682478904724121, 'init_value': 33.065101623535156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:52.43[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020899319648742675, 'time_algorithm_update': 0.005547338008880616, 'loss': 6.405493015527726, 'time_step': 0.007689815044403076, 'init_value': 37.72831726074219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:52.52[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100613355636597, 'time_algorithm_update': 0.005544640779495239, 'loss': 7.49456662940979, 'time_step': 0.007697964191436767, 'init_value': 44.31669235229492}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:53.01[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020943441390991213, 'time_algorithm_update': 0.005559481382369995, 'loss': 8.415106850624085, 'time_step': 0.007707048416137696, 'init_value': 47.41752624511719}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:53.10[0m [[32m[1minfo     [0m] [1mFQE_20250505195138: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093142032623291, 'time_algorithm_update': 0.00554537034034729, 'loss': 9.000400691270828, 'time_step': 0.007691046476364136, 'init_value': 53.001163482666016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.001163482666016
ave advantage rew: 55.028144645690915, std: 1.8422302357008122
avg cum rews: 930.7913863666666, std: 30.61643202105692
Pearson correlation coefficient: 0.036262279869036816
Spearman correlation coefficient: 0.16090225563909774
Kendall Tau correlation coefficient: 0.06315789473684211
the best agent: 17, best agent cum rewards: 944.1682393333334
1961
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.016751729767664737
avg return on 5 trajectories of agent0: 989.3904016666667
Episode generator created
[2m2025-05-05 19:53.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:53.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:53.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:53.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:53.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195333[0m
[2m2025-05-05 19:53.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:53.42[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020901095867156983, 'time_algorithm_update': 0.005517608642578125, 'loss': 1.5872425392866134, 'time_step': 0.007659833192825318, 'init_value': 3.5739011764526367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:53.51[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020851221084594728, 'time_algorithm_update': 0.0055386369228363035, 'loss': 3.759339929461479, 'time_step': 0.007676125764846802, 'init_value': 8.1265869140625}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:54.01[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096360921859741, 'time_algorithm_update': 0.005552961111068726, 'loss': 4.7335152719020845, 'time_step': 0.007702018737792969, 'init_value': 13.578758239746094}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:54.10[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021030209064483644, 'time_algorithm_update': 0.005555604696273804, 'loss': 5.0979369692802425, 'time_step': 0.007711246013641358, 'init_value': 20.360021591186523}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:54.19[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002103647708892822, 'time_algorithm_update': 0.005558820486068726, 'loss': 5.963585566282273, 'time_step': 0.007715357542037964, 'init_value': 26.23029327392578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:54.28[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020931973457336424, 'time_algorithm_update': 0.005558529615402222, 'loss': 6.287804725646972, 'time_step': 0.007705069780349731, 'init_value': 32.94542694091797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:54.38[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020993924140930175, 'time_algorithm_update': 0.005558892250061035, 'loss': 7.225587410926819, 'time_step': 0.007711455583572387, 'init_value': 38.92942428588867}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:54.47[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020702602863311766, 'time_algorithm_update': 0.005497153282165527, 'loss': 7.965503307580948, 'time_step': 0.007619084358215332, 'init_value': 46.09003448486328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:54.56[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020669724941253663, 'time_algorithm_update': 0.005474338293075562, 'loss': 8.691748852968216, 'time_step': 0.0075932683944702145, 'init_value': 51.453182220458984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:55.05[0m [[32m[1minfo     [0m] [1mFQE_20250505195333: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002079028606414795, 'time_algorithm_update': 0.005478899955749511, 'loss': 9.946937422275543, 'time_step': 0.007609734058380127, 'init_value': 56.81137466430664}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.81137466430664
avg return on 5 trajectories of agent1: 967.7345436666668
Episode generator created
[2m2025-05-05 19:55.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:55.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:55.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:55.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:55.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195508[0m
[2m2025-05-05 19:55.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:55.17[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050276279449463, 'time_algorithm_update': 0.005436563491821289, 'loss': 1.7114189368337394, 'time_step': 0.007538058519363403, 'init_value': 3.628220558166504}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:55.26[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062602758407593, 'time_algorithm_update': 0.0054499564170837405, 'loss': 3.9538542886972428, 'time_step': 0.007564548015594482, 'init_value': 8.374347686767578}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:55.35[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020788121223449707, 'time_algorithm_update': 0.005509746313095093, 'loss': 5.033867069482803, 'time_step': 0.007640614986419678, 'init_value': 15.500204086303711}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:55.45[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020904803276062013, 'time_algorithm_update': 0.005536197185516357, 'loss': 5.354450147628784, 'time_step': 0.007679652452468872, 'init_value': 22.51797866821289}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:55.54[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020967388153076173, 'time_algorithm_update': 0.005535764694213867, 'loss': 5.991924332141876, 'time_step': 0.007685173511505127, 'init_value': 28.875892639160156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:56.03[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002100454330444336, 'time_algorithm_update': 0.005558366537094116, 'loss': 6.34576712346077, 'time_step': 0.007712088346481323, 'init_value': 34.74064254760742}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:56.12[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002089292049407959, 'time_algorithm_update': 0.005529672861099243, 'loss': 7.6491762113571165, 'time_step': 0.00767204213142395, 'init_value': 39.69013214111328}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:56.21[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002092360496520996, 'time_algorithm_update': 0.005531502962112427, 'loss': 7.475537854909897, 'time_step': 0.00767666482925415, 'init_value': 44.67739486694336}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:56.31[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083497762680054, 'time_algorithm_update': 0.005527374982833863, 'loss': 8.448853071689605, 'time_step': 0.00766318678855896, 'init_value': 49.995445251464844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:56.40[0m [[32m[1minfo     [0m] [1mFQE_20250505195508: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090126991271973, 'time_algorithm_update': 0.005526900053024292, 'loss': 9.731189479351043, 'time_step': 0.007670095682144165, 'init_value': 56.616764068603516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.616764068603516
avg return on 5 trajectories of agent2: 957.8373796666666
Episode generator created
[2m2025-05-05 19:56.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:56.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:56.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:56.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:56.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195643[0m
[2m2025-05-05 19:56.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:56.53[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002096470594406128, 'time_algorithm_update': 0.005601515293121338, 'loss': 1.6014963239580393, 'time_step': 0.007751874923706055, 'init_value': 3.284942150115967}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:57.02[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020848481655120848, 'time_algorithm_update': 0.005521537303924561, 'loss': 3.777901029706001, 'time_step': 0.007658926963806152, 'init_value': 8.162053108215332}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:57.11[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021021099090576174, 'time_algorithm_update': 0.005539263010025024, 'loss': 4.65008891415596, 'time_step': 0.0076947414875030515, 'init_value': 14.110474586486816}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:57.20[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002102792501449585, 'time_algorithm_update': 0.0055518682003021244, 'loss': 5.044058058381081, 'time_step': 0.007707533359527588, 'init_value': 20.22374725341797}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:57.29[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020977885723114016, 'time_algorithm_update': 0.00554798436164856, 'loss': 5.331871904611588, 'time_step': 0.00769903564453125, 'init_value': 28.333375930786133}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:57.39[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020969743728637695, 'time_algorithm_update': 0.005561839342117309, 'loss': 6.808606861114502, 'time_step': 0.007712244033813476, 'init_value': 35.6261100769043}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:57.48[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002101489305496216, 'time_algorithm_update': 0.005550479888916016, 'loss': 7.65098623251915, 'time_step': 0.007704857587814331, 'init_value': 40.45817565917969}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:57.57[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020951490402221678, 'time_algorithm_update': 0.005540100812911987, 'loss': 8.34491200351715, 'time_step': 0.007688299417495727, 'init_value': 46.547698974609375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:58.06[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002103954553604126, 'time_algorithm_update': 0.005553035736083984, 'loss': 9.077951252698899, 'time_step': 0.0077103800773620605, 'init_value': 52.53140640258789}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:58.16[0m [[32m[1minfo     [0m] [1mFQE_20250505195643: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002095355749130249, 'time_algorithm_update': 0.005540376663208008, 'loss': 10.544167874097823, 'time_step': 0.007688708782196045, 'init_value': 57.81865692138672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.81865692138672
avg return on 5 trajectories of agent3: 963.4422673333333
Episode generator created
[2m2025-05-05 19:58.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:58.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:58.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:58.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:58.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195819[0m
[2m2025-05-05 19:58.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 19:58.28[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020749380588531495, 'time_algorithm_update': 0.005498682022094727, 'loss': 1.6246415684074162, 'time_step': 0.007625810384750366, 'init_value': 3.7009403705596924}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 19:58.37[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020858962535858154, 'time_algorithm_update': 0.005521220684051514, 'loss': 3.9610595021247863, 'time_step': 0.0076598114967346195, 'init_value': 8.755046844482422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 19:58.46[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020843942165374757, 'time_algorithm_update': 0.0055236990451812745, 'loss': 4.632237307548523, 'time_step': 0.007660958290100097, 'init_value': 15.03730297088623}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 19:58.56[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00208945369720459, 'time_algorithm_update': 0.0055232555866241454, 'loss': 5.117028577566147, 'time_step': 0.007665728807449341, 'init_value': 20.348360061645508}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 19:59.05[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020985186100006105, 'time_algorithm_update': 0.005536970376968384, 'loss': 5.434319195508957, 'time_step': 0.00768906044960022, 'init_value': 24.785688400268555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 19:59.14[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020902206897735597, 'time_algorithm_update': 0.00552435302734375, 'loss': 5.510513946652412, 'time_step': 0.007667949438095093, 'init_value': 28.821073532104492}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 19:59.23[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020891215801239014, 'time_algorithm_update': 0.005529573440551758, 'loss': 5.961784743070602, 'time_step': 0.007671897888183594, 'init_value': 35.81958770751953}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 19:59.32[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020879673957824706, 'time_algorithm_update': 0.00551541256904602, 'loss': 7.274004311084747, 'time_step': 0.007656283855438232, 'init_value': 42.3809814453125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 19:59.42[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020912280082702635, 'time_algorithm_update': 0.005523170709609985, 'loss': 7.99466791844368, 'time_step': 0.007667680263519287, 'init_value': 47.46852111816406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 19:59.51[0m [[32m[1minfo     [0m] [1mFQE_20250505195819: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020924177169799807, 'time_algorithm_update': 0.0055301587581634525, 'loss': 9.235987901449203, 'time_step': 0.007675933361053467, 'init_value': 52.67643737792969}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.67643737792969
avg return on 5 trajectories of agent4: 964.939738
Episode generator created
[2m2025-05-05 19:59.54[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 19:59.54[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 19:59.54[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 19:59.54[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 19:59.54[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505195954[0m
[2m2025-05-05 19:59.54[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:00.03[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002083775043487549, 'time_algorithm_update': 0.005533139228820801, 'loss': 1.5854232511222361, 'time_step': 0.007669979095458984, 'init_value': 3.411188840866089}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:00.12[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020942723751068114, 'time_algorithm_update': 0.00553576397895813, 'loss': 4.050326092839241, 'time_step': 0.007683093309402466, 'init_value': 9.175064086914062}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:00.22[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0021186296939849853, 'time_algorithm_update': 0.00559679913520813, 'loss': 4.778993747591972, 'time_step': 0.007769582509994507, 'init_value': 14.97516918182373}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:00.31[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00209222149848938, 'time_algorithm_update': 0.005538462400436401, 'loss': 5.396595585346222, 'time_step': 0.007683659076690674, 'init_value': 20.111181259155273}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:00.40[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020797224044799803, 'time_algorithm_update': 0.005491460561752319, 'loss': 5.333412541627884, 'time_step': 0.007624212265014648, 'init_value': 26.613065719604492}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:00.49[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020554473400115967, 'time_algorithm_update': 0.005437355279922485, 'loss': 5.969400929450988, 'time_step': 0.007544852256774902, 'init_value': 31.55080223083496}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:00.58[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058157205581665, 'time_algorithm_update': 0.005426943063735962, 'loss': 6.3789017131328585, 'time_step': 0.007536843061447144, 'init_value': 36.39891052246094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:01.07[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062737464904785, 'time_algorithm_update': 0.005438376903533935, 'loss': 7.428412081956863, 'time_step': 0.007553245306015015, 'init_value': 41.971317291259766}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:01.16[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590877532958986, 'time_algorithm_update': 0.005425628662109375, 'loss': 7.814205287694931, 'time_step': 0.007536405324935913, 'init_value': 46.65108871459961}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:01.25[0m [[32m[1minfo     [0m] [1mFQE_20250505195954: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020565052032470704, 'time_algorithm_update': 0.005431720733642578, 'loss': 9.030102040290833, 'time_step': 0.007540451765060425, 'init_value': 51.662052154541016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.662052154541016
avg return on 5 trajectories of agent5: 978.9427733333333
Episode generator created
[2m2025-05-05 20:01.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:01.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:01.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:01.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:01.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200129[0m
[2m2025-05-05 20:01.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:01.38[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020377957820892335, 'time_algorithm_update': 0.005396879911422729, 'loss': 1.6634281266629696, 'time_step': 0.007485707521438598, 'init_value': 3.907815933227539}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:01.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035998821258545, 'time_algorithm_update': 0.005410051822662353, 'loss': 4.051813686966896, 'time_step': 0.007497098445892334, 'init_value': 9.004179000854492}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:01.56[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020462260246276857, 'time_algorithm_update': 0.005435264587402343, 'loss': 4.963799230098724, 'time_step': 0.007533049106597901, 'init_value': 15.303494453430176}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:02.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020513916015625, 'time_algorithm_update': 0.005446650743484497, 'loss': 5.486947981595993, 'time_step': 0.007549663543701172, 'init_value': 21.28852081298828}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:02.14[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020450735092163086, 'time_algorithm_update': 0.005421711683273316, 'loss': 5.496733419179916, 'time_step': 0.007517671585083008, 'init_value': 26.509838104248047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:02.23[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020460548400878906, 'time_algorithm_update': 0.00542310619354248, 'loss': 6.039206963539123, 'time_step': 0.007520551204681396, 'init_value': 31.97488784790039}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:02.32[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046955347061157, 'time_algorithm_update': 0.005421945333480835, 'loss': 5.993334186315536, 'time_step': 0.0075203564167022705, 'init_value': 37.15752029418945}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:02.41[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020469844341278074, 'time_algorithm_update': 0.005413382768630981, 'loss': 6.982892426967621, 'time_step': 0.007511678457260132, 'init_value': 42.81513977050781}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:02.50[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020504095554351805, 'time_algorithm_update': 0.005424064636230469, 'loss': 8.463588923692702, 'time_step': 0.007526072025299072, 'init_value': 48.61033248901367}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:02.59[0m [[32m[1minfo     [0m] [1mFQE_20250505200129: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050748348236084, 'time_algorithm_update': 0.005414743900299072, 'loss': 9.005773468017578, 'time_step': 0.0075170378684997555, 'init_value': 53.417137145996094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.417137145996094
avg return on 5 trajectories of agent6: 977.7229706666667
Episode generator created
[2m2025-05-05 20:03.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:03.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:03.02[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:03.02[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:03.02[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200302[0m
[2m2025-05-05 20:03.02[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:03.11[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020408244132995605, 'time_algorithm_update': 0.005395356178283691, 'loss': 1.6239651621133089, 'time_step': 0.007487028121948242, 'init_value': 3.732832193374634}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:03.20[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055729627609253, 'time_algorithm_update': 0.005429338932037353, 'loss': 3.9300485092401503, 'time_step': 0.0075361537933349605, 'init_value': 8.436308860778809}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:03.29[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020585055351257323, 'time_algorithm_update': 0.005434263944625855, 'loss': 4.842508014917374, 'time_step': 0.007543847799301147, 'init_value': 14.728375434875488}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:03.38[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204949951171875, 'time_algorithm_update': 0.00545098090171814, 'loss': 5.111851852416992, 'time_step': 0.007552066087722778, 'init_value': 20.160619735717773}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:03.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073286771774292, 'time_algorithm_update': 0.005485062837600708, 'loss': 5.610391477108002, 'time_step': 0.007610377073287964, 'init_value': 26.815414428710938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:03.56[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020602777004241945, 'time_algorithm_update': 0.005450481176376342, 'loss': 5.805117072582245, 'time_step': 0.0075622136592864994, 'init_value': 32.21046447753906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:04.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065732479095459, 'time_algorithm_update': 0.005459912538528442, 'loss': 6.540981568813324, 'time_step': 0.007577615261077881, 'init_value': 38.41468048095703}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:04.15[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020600483417510984, 'time_algorithm_update': 0.005445108890533447, 'loss': 7.520476854085922, 'time_step': 0.007556488037109375, 'init_value': 43.37810516357422}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:04.24[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053693771362305, 'time_algorithm_update': 0.005453055620193482, 'loss': 8.375013766288758, 'time_step': 0.007558289051055908, 'init_value': 46.26105880737305}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:04.33[0m [[32m[1minfo     [0m] [1mFQE_20250505200302: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054727554321289, 'time_algorithm_update': 0.005447926521301269, 'loss': 8.447444061994553, 'time_step': 0.007554342746734619, 'init_value': 50.562156677246094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 50.562156677246094
avg return on 5 trajectories of agent7: 959.4439940000001
Episode generator created
[2m2025-05-05 20:04.36[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:04.36[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:04.36[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:04.36[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:04.36[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200436[0m
[2m2025-05-05 20:04.36[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:04.45[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020379452705383302, 'time_algorithm_update': 0.0054302499294281, 'loss': 1.6247336471825837, 'time_step': 0.007519354820251465, 'init_value': 3.711205244064331}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:04.54[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020469958782196045, 'time_algorithm_update': 0.005452216863632202, 'loss': 3.9532899284362792, 'time_step': 0.007550933599472046, 'init_value': 7.973507404327393}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:05.03[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002034172534942627, 'time_algorithm_update': 0.0054078340530395504, 'loss': 4.7141441609859465, 'time_step': 0.007492488861083985, 'init_value': 13.842522621154785}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:05.12[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020196268558502197, 'time_algorithm_update': 0.00537138295173645, 'loss': 4.990092427372932, 'time_step': 0.007441462516784668, 'init_value': 19.728801727294922}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:05.21[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020507028102874757, 'time_algorithm_update': 0.005432308673858643, 'loss': 5.549720924377441, 'time_step': 0.007534738540649414, 'init_value': 25.86680793762207}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:05.30[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020199522972106933, 'time_algorithm_update': 0.005355958938598633, 'loss': 6.030366519927979, 'time_step': 0.0074260284900665285, 'init_value': 32.59208679199219}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:05.39[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021470069885254, 'time_algorithm_update': 0.005357879161834717, 'loss': 7.06278347158432, 'time_step': 0.007429847478866577, 'init_value': 39.04811096191406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:05.48[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002018723726272583, 'time_algorithm_update': 0.005365157842636108, 'loss': 7.317556319952011, 'time_step': 0.0074342176914215085, 'init_value': 44.97657012939453}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:05.57[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020583534240722658, 'time_algorithm_update': 0.005455022811889649, 'loss': 8.509023500680923, 'time_step': 0.007565507411956787, 'init_value': 52.508304595947266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:06.06[0m [[32m[1minfo     [0m] [1mFQE_20250505200436: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056102991104126, 'time_algorithm_update': 0.00545105242729187, 'loss': 9.877758840799332, 'time_step': 0.00755899453163147, 'init_value': 56.39192581176758}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.39192581176758
avg return on 5 trajectories of agent8: 955.0894033333334
Episode generator created
[2m2025-05-05 20:06.09[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:06.09[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:06.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:06.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:06.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200609[0m
[2m2025-05-05 20:06.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:06.18[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020394277572631835, 'time_algorithm_update': 0.005413623571395874, 'loss': 1.5529333867281676, 'time_step': 0.007504659652709961, 'init_value': 3.598484992980957}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:06.27[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020617902278900146, 'time_algorithm_update': 0.0054335625171661375, 'loss': 3.913975710749626, 'time_step': 0.0075472922325134275, 'init_value': 8.618401527404785}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:06.36[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020540268421173095, 'time_algorithm_update': 0.005442697048187256, 'loss': 4.583359991908074, 'time_step': 0.007549052476882935, 'init_value': 13.756794929504395}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:06.45[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020471653938293455, 'time_algorithm_update': 0.005428592920303345, 'loss': 5.094126728773117, 'time_step': 0.007527629613876343, 'init_value': 20.03238868713379}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:06.54[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020485243797302246, 'time_algorithm_update': 0.005423771619796753, 'loss': 5.691599000215531, 'time_step': 0.0075240848064422605, 'init_value': 26.073087692260742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:07.03[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057872295379639, 'time_algorithm_update': 0.005431658267974854, 'loss': 5.945343240737915, 'time_step': 0.00754180359840393, 'init_value': 32.140525817871094}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:07.13[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073824167251587, 'time_algorithm_update': 0.0054668900966644285, 'loss': 6.549201307058334, 'time_step': 0.007593206167221069, 'init_value': 37.49213409423828}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:07.22[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020534098148345947, 'time_algorithm_update': 0.005434629917144776, 'loss': 7.335626749992371, 'time_step': 0.007540255308151245, 'init_value': 43.27540588378906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:07.31[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057348966598511, 'time_algorithm_update': 0.00543175721168518, 'loss': 8.326836564779281, 'time_step': 0.007541272163391113, 'init_value': 50.06659698486328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:07.40[0m [[32m[1minfo     [0m] [1mFQE_20250505200609: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020511929988861082, 'time_algorithm_update': 0.005423818349838257, 'loss': 9.33955554318428, 'time_step': 0.0075264787673950196, 'init_value': 53.6203498840332}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.6203498840332
avg return on 5 trajectories of agent9: 865.9907410000001
Episode generator created
[2m2025-05-05 20:07.43[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:07.43[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:07.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:07.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:07.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200743[0m
[2m2025-05-05 20:07.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:07.52[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020515453815460206, 'time_algorithm_update': 0.005426923990249634, 'loss': 1.6614456821978092, 'time_step': 0.0075305125713348384, 'init_value': 3.978879690170288}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:08.01[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020513451099395752, 'time_algorithm_update': 0.005443778991699219, 'loss': 4.002832351922989, 'time_step': 0.007547176122665406, 'init_value': 9.457392692565918}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:08.10[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047847270965576, 'time_algorithm_update': 0.005437719106674194, 'loss': 5.01841418504715, 'time_step': 0.007537122488021851, 'init_value': 14.660245895385742}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:08.19[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020387179851531984, 'time_algorithm_update': 0.005411717891693115, 'loss': 5.1996171934604645, 'time_step': 0.0075017549991607665, 'init_value': 21.41813850402832}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:08.28[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020559966564178468, 'time_algorithm_update': 0.005437883377075195, 'loss': 5.644905087471009, 'time_step': 0.007545867204666138, 'init_value': 27.316028594970703}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:08.37[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049355506896973, 'time_algorithm_update': 0.00543004059791565, 'loss': 6.145398153066635, 'time_step': 0.0075313253402709964, 'init_value': 33.627559661865234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:08.46[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020522074699401856, 'time_algorithm_update': 0.0054368188381195065, 'loss': 7.170622028589249, 'time_step': 0.00754073452949524, 'init_value': 40.485862731933594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:08.55[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020510804653167724, 'time_algorithm_update': 0.005446320056915283, 'loss': 7.862124713420868, 'time_step': 0.0075490243434906, 'init_value': 46.94320297241211}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:09.05[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045581817626953, 'time_algorithm_update': 0.005433598518371582, 'loss': 8.534252496480942, 'time_step': 0.007530933141708374, 'init_value': 50.60065841674805}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:09.14[0m [[32m[1minfo     [0m] [1mFQE_20250505200743: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020518081188201902, 'time_algorithm_update': 0.005440907716751099, 'loss': 9.412052536010743, 'time_step': 0.007544813394546509, 'init_value': 55.386531829833984}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.386531829833984
avg return on 5 trajectories of agent10: 961.2498023333333
Episode generator created
[2m2025-05-05 20:09.17[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:09.17[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:09.17[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:09.17[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:09.17[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505200917[0m
[2m2025-05-05 20:09.17[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:09.26[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048100709915161, 'time_algorithm_update': 0.005420421838760376, 'loss': 1.6230697946697474, 'time_step': 0.00752000904083252, 'init_value': 3.7339589595794678}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:09.35[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020443980693817137, 'time_algorithm_update': 0.005422374963760376, 'loss': 3.87926731300354, 'time_step': 0.007518110275268555, 'init_value': 8.172783851623535}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:09.44[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020389764308929442, 'time_algorithm_update': 0.005412625789642334, 'loss': 4.705549567937851, 'time_step': 0.007502647161483765, 'init_value': 14.455119132995605}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:09.53[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020474886894226076, 'time_algorithm_update': 0.005428066968917847, 'loss': 5.041819756627083, 'time_step': 0.007526825904846191, 'init_value': 20.631399154663086}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:10.02[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020402932167053224, 'time_algorithm_update': 0.005417453765869141, 'loss': 5.482460141897201, 'time_step': 0.007509187936782837, 'init_value': 27.792417526245117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:10.11[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020559661388397216, 'time_algorithm_update': 0.005431121826171875, 'loss': 5.985307131290436, 'time_step': 0.007538886070251465, 'init_value': 32.731624603271484}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:10.20[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020497066974639894, 'time_algorithm_update': 0.005437746047973633, 'loss': 6.9827598458528515, 'time_step': 0.007539273500442505, 'init_value': 38.88957214355469}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:10.29[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043863534927368, 'time_algorithm_update': 0.005430446863174438, 'loss': 7.3410242547988895, 'time_step': 0.007525607347488404, 'init_value': 42.105621337890625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:10.38[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045344114303589, 'time_algorithm_update': 0.0054341721534729, 'loss': 8.365603857517243, 'time_step': 0.007531461000442505, 'init_value': 47.79656982421875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:10.47[0m [[32m[1minfo     [0m] [1mFQE_20250505200917: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040732145309448, 'time_algorithm_update': 0.005426512956619263, 'loss': 10.13137813615799, 'time_step': 0.007518652200698852, 'init_value': 55.99565124511719}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.99565124511719
avg return on 5 trajectories of agent11: 942.712685
Episode generator created
[2m2025-05-05 20:10.50[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:10.50[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:10.51[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:10.51[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:10.51[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201051[0m
[2m2025-05-05 20:10.51[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:11.00[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020449798107147216, 'time_algorithm_update': 0.005415353536605835, 'loss': 1.6402066456377506, 'time_step': 0.007511528015136719, 'init_value': 4.087620258331299}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:11.09[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057586908340454, 'time_algorithm_update': 0.005429412841796875, 'loss': 4.155177704691887, 'time_step': 0.007538812875747681, 'init_value': 9.461410522460938}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:11.18[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206062912940979, 'time_algorithm_update': 0.005436326503753662, 'loss': 4.621562826156616, 'time_step': 0.007548197984695435, 'init_value': 14.825506210327148}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:11.27[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568690299987793, 'time_algorithm_update': 0.005433883905410767, 'loss': 5.3234160418510434, 'time_step': 0.007541865348815918, 'init_value': 22.106538772583008}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:11.36[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020645959377288818, 'time_algorithm_update': 0.005433575868606567, 'loss': 5.3961639306545255, 'time_step': 0.007549729108810425, 'init_value': 27.427776336669922}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:11.45[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053784132003784, 'time_algorithm_update': 0.005429248332977295, 'loss': 6.0561845259666445, 'time_step': 0.007534564733505249, 'init_value': 33.43696975708008}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:11.54[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050875663757324, 'time_algorithm_update': 0.0054352574348449706, 'loss': 6.704667647600174, 'time_step': 0.007537986993789673, 'init_value': 40.01522445678711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:12.03[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206498122215271, 'time_algorithm_update': 0.005440829277038574, 'loss': 7.6493635721206665, 'time_step': 0.007557691097259522, 'init_value': 46.48983383178711}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:12.12[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020631701946258545, 'time_algorithm_update': 0.005434438943862915, 'loss': 8.55724960422516, 'time_step': 0.007549526453018188, 'init_value': 50.746360778808594}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:12.21[0m [[32m[1minfo     [0m] [1mFQE_20250505201051: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051037788391113, 'time_algorithm_update': 0.005424120903015137, 'loss': 9.245660475969315, 'time_step': 0.0075266709327697755, 'init_value': 54.93584442138672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.93584442138672
avg return on 5 trajectories of agent12: 963.9920003333333
Episode generator created
[2m2025-05-05 20:12.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:12.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:12.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:12.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:12.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201224[0m
[2m2025-05-05 20:12.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:12.33[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050284147262573, 'time_algorithm_update': 0.005429609060287476, 'loss': 1.6451969100534916, 'time_step': 0.007531513214111328, 'init_value': 3.2704694271087646}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:12.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062138080596924, 'time_algorithm_update': 0.005439523220062256, 'loss': 3.79885238969326, 'time_step': 0.0075537157058715824, 'init_value': 7.867538928985596}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:12.51[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020566222667694092, 'time_algorithm_update': 0.005435482978820801, 'loss': 4.481347521185875, 'time_step': 0.007543726682662964, 'init_value': 13.171642303466797}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:13.00[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020558483600616453, 'time_algorithm_update': 0.005445669889450073, 'loss': 4.9539171738624574, 'time_step': 0.0075534114837646485, 'init_value': 19.533424377441406}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:13.10[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067548036575317, 'time_algorithm_update': 0.005444245338439941, 'loss': 5.456549699187279, 'time_step': 0.007563850164413452, 'init_value': 25.739933013916016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:13.19[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020604939460754394, 'time_algorithm_update': 0.00543489408493042, 'loss': 5.9352069683074955, 'time_step': 0.007546981334686279, 'init_value': 32.11088180541992}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:13.28[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020563712120056153, 'time_algorithm_update': 0.005454443216323853, 'loss': 6.368275748252868, 'time_step': 0.007562403440475464, 'init_value': 38.14726257324219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:13.37[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055837392807007, 'time_algorithm_update': 0.005434580326080322, 'loss': 7.9711266243457795, 'time_step': 0.007542173862457275, 'init_value': 45.098167419433594}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:13.46[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051738739013672, 'time_algorithm_update': 0.005432678461074829, 'loss': 8.357753023386001, 'time_step': 0.007536238193511963, 'init_value': 51.63542556762695}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:13.55[0m [[32m[1minfo     [0m] [1mFQE_20250505201224: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020625426769256593, 'time_algorithm_update': 0.005443823575973511, 'loss': 9.713143942594527, 'time_step': 0.007558102130889892, 'init_value': 57.50910186767578}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.50910186767578
avg return on 5 trajectories of agent13: 952.0934786666667
Episode generator created
[2m2025-05-05 20:13.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:13.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:13.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:13.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:13.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201358[0m
[2m2025-05-05 20:13.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:14.07[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002063406467437744, 'time_algorithm_update': 0.00548713493347168, 'loss': 1.6451703752428293, 'time_step': 0.007603337526321411, 'init_value': 4.185513973236084}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:14.16[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493690967559814, 'time_algorithm_update': 0.0054223606586456296, 'loss': 3.97930218064785, 'time_step': 0.0075231587886810305, 'init_value': 8.851099967956543}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:14.25[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055034637451172, 'time_algorithm_update': 0.005439912796020508, 'loss': 4.35671294438839, 'time_step': 0.007546967983245849, 'init_value': 13.6043701171875}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:14.34[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020577173233032224, 'time_algorithm_update': 0.0054407396316528325, 'loss': 4.63925995016098, 'time_step': 0.007549949169158935, 'init_value': 19.365999221801758}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:14.43[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020580222606658934, 'time_algorithm_update': 0.005434442043304444, 'loss': 5.152845897197723, 'time_step': 0.0075437076091766355, 'init_value': 26.52428436279297}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:14.52[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064054012298584, 'time_algorithm_update': 0.005445995569229126, 'loss': 5.749866593122483, 'time_step': 0.0075620441436767575, 'init_value': 32.62096405029297}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:15.02[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058131456375122, 'time_algorithm_update': 0.0054404296875, 'loss': 6.860069243192672, 'time_step': 0.007550386428833008, 'init_value': 38.54685974121094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:15.10[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002021816253662109, 'time_algorithm_update': 0.005370940446853638, 'loss': 7.148077282905579, 'time_step': 0.007442877769470215, 'init_value': 44.30147171020508}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:15.20[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023678779602051, 'time_algorithm_update': 0.005351688623428345, 'loss': 8.656311920642853, 'time_step': 0.0074256548881530765, 'init_value': 48.956058502197266}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:15.28[0m [[32m[1minfo     [0m] [1mFQE_20250505201358: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020215814113616944, 'time_algorithm_update': 0.005350296974182129, 'loss': 9.766195363521575, 'time_step': 0.007422522068023681, 'init_value': 53.89452362060547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.89452362060547
avg return on 5 trajectories of agent14: 1003.6335813333334
Episode generator created
[2m2025-05-05 20:15.31[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:15.31[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:15.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:15.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:15.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201532[0m
[2m2025-05-05 20:15.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:15.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020164794921875, 'time_algorithm_update': 0.005343161821365357, 'loss': 1.6371731370538474, 'time_step': 0.0074104080200195314, 'init_value': 3.3510491847991943}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:15.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020085821151733397, 'time_algorithm_update': 0.005346662998199463, 'loss': 4.250410090088844, 'time_step': 0.007405612230300903, 'init_value': 8.52714729309082}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:15.59[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058093309402466, 'time_algorithm_update': 0.005428168535232544, 'loss': 4.740511240959168, 'time_step': 0.007537864208221436, 'init_value': 14.322501182556152}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:16.08[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020648963451385498, 'time_algorithm_update': 0.005438225507736206, 'loss': 5.309474147558213, 'time_step': 0.00755484938621521, 'init_value': 20.555606842041016}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:16.17[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059382915496826, 'time_algorithm_update': 0.0054317543506622315, 'loss': 5.82852064216137, 'time_step': 0.007542749166488647, 'init_value': 26.89693832397461}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:16.26[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020622718334198, 'time_algorithm_update': 0.005438034296035767, 'loss': 6.2180033884048465, 'time_step': 0.007552215814590454, 'init_value': 32.30674743652344}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:16.35[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020596280097961426, 'time_algorithm_update': 0.0054311823844909665, 'loss': 6.7359375436306, 'time_step': 0.007542356014251709, 'init_value': 39.798362731933594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:16.44[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065462350845337, 'time_algorithm_update': 0.005428772687911987, 'loss': 7.646717512369156, 'time_step': 0.00754638671875, 'init_value': 44.964778900146484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:16.53[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020589823722839354, 'time_algorithm_update': 0.0054150230884552, 'loss': 8.586578043699264, 'time_step': 0.007525627136230469, 'init_value': 49.09534454345703}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:17.02[0m [[32m[1minfo     [0m] [1mFQE_20250505201532: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020597984790802003, 'time_algorithm_update': 0.0054306044578552246, 'loss': 9.000340734004974, 'time_step': 0.00754223895072937, 'init_value': 53.359344482421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.359344482421875
avg return on 5 trajectories of agent15: 942.2657990000001
Episode generator created
[2m2025-05-05 20:17.05[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:17.05[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:17.05[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:17.05[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:17.05[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201705[0m
[2m2025-05-05 20:17.05[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:17.14[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020439510345458983, 'time_algorithm_update': 0.005423458576202392, 'loss': 1.6239002288877964, 'time_step': 0.007518860101699829, 'init_value': 3.7935826778411865}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:17.23[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020552916526794434, 'time_algorithm_update': 0.005425796508789062, 'loss': 3.7494949830770494, 'time_step': 0.007532370805740356, 'init_value': 7.762106895446777}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:17.32[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061413049697876, 'time_algorithm_update': 0.005444432973861694, 'loss': 4.325695850849152, 'time_step': 0.00755752968788147, 'init_value': 13.241986274719238}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:17.41[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020583217144012453, 'time_algorithm_update': 0.005446953535079956, 'loss': 4.820055640816689, 'time_step': 0.007556978225708008, 'init_value': 18.69851303100586}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:17.50[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048475742340088, 'time_algorithm_update': 0.005429732084274292, 'loss': 5.150314259290695, 'time_step': 0.007529563426971435, 'init_value': 24.48188591003418}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:18.00[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020589847564697265, 'time_algorithm_update': 0.005439792156219482, 'loss': 5.944720092773437, 'time_step': 0.007550663232803344, 'init_value': 29.491743087768555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:18.09[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020594987869262697, 'time_algorithm_update': 0.005429170608520508, 'loss': 6.623572959423065, 'time_step': 0.007540327787399292, 'init_value': 35.62541580200195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:18.18[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205077862739563, 'time_algorithm_update': 0.005416037082672119, 'loss': 7.434495879411697, 'time_step': 0.007517784833908081, 'init_value': 41.8626708984375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:18.27[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020694684982299804, 'time_algorithm_update': 0.005436334848403931, 'loss': 8.524332392454147, 'time_step': 0.007557468891143799, 'init_value': 47.45443344116211}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:18.36[0m [[32m[1minfo     [0m] [1mFQE_20250505201705: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020566225051879884, 'time_algorithm_update': 0.005441924095153808, 'loss': 8.79770834851265, 'time_step': 0.007550641775131226, 'init_value': 53.20427322387695}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.20427322387695
avg return on 5 trajectories of agent16: 961.472218
Episode generator created
[2m2025-05-05 20:18.39[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:18.39[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:18.39[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:18.39[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:18.39[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505201839[0m
[2m2025-05-05 20:18.39[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:18.48[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020419483184814452, 'time_algorithm_update': 0.005415992498397827, 'loss': 1.6653781051933765, 'time_step': 0.007509453535079956, 'init_value': 3.8798882961273193}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:18.57[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020478899478912353, 'time_algorithm_update': 0.005436199903488159, 'loss': 3.7717732585668564, 'time_step': 0.007535228967666626, 'init_value': 8.791120529174805}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:19.06[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020503342151641847, 'time_algorithm_update': 0.005445929050445557, 'loss': 4.8566269023418425, 'time_step': 0.007547798871994018, 'init_value': 16.15572738647461}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:19.15[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020643904209136964, 'time_algorithm_update': 0.005463644027709961, 'loss': 5.151885651826858, 'time_step': 0.007579489946365357, 'init_value': 21.60662841796875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:19.24[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206622314453125, 'time_algorithm_update': 0.00546031641960144, 'loss': 5.313463162899017, 'time_step': 0.007578216314315796, 'init_value': 27.570148468017578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:19.33[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020526483058929445, 'time_algorithm_update': 0.005463757753372192, 'loss': 5.649886300683021, 'time_step': 0.00756831431388855, 'init_value': 33.11052703857422}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:19.42[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046882629394531, 'time_algorithm_update': 0.005438534021377564, 'loss': 6.459180217504501, 'time_step': 0.007536659002304077, 'init_value': 38.668033599853516}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:19.51[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020566792488098144, 'time_algorithm_update': 0.0054616093635559086, 'loss': 7.881704820871353, 'time_step': 0.0075699687004089355, 'init_value': 46.37336730957031}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:20.01[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002066535472869873, 'time_algorithm_update': 0.005462045669555664, 'loss': 8.500058569669724, 'time_step': 0.0075801007747650145, 'init_value': 50.68408203125}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:20.10[0m [[32m[1minfo     [0m] [1mFQE_20250505201839: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020470294952392577, 'time_algorithm_update': 0.005446619033813477, 'loss': 9.127456226825714, 'time_step': 0.00754508113861084, 'init_value': 54.46155548095703}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.46155548095703
avg return on 5 trajectories of agent17: 898.1303023333334
Episode generator created
[2m2025-05-05 20:20.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:20.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:20.13[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:20.13[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:20.13[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202013[0m
[2m2025-05-05 20:20.13[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:20.22[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044830799102783, 'time_algorithm_update': 0.005415317296981812, 'loss': 1.6224016885757446, 'time_step': 0.0075115647315979, 'init_value': 3.2745606899261475}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:20.31[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020444443225860597, 'time_algorithm_update': 0.005423992872238159, 'loss': 3.771845808506012, 'time_step': 0.0075196406841278075, 'init_value': 8.190388679504395}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:20.40[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020567660331726073, 'time_algorithm_update': 0.005441896438598633, 'loss': 4.472965516328812, 'time_step': 0.007549880266189575, 'init_value': 14.375682830810547}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:20.49[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020554654598236083, 'time_algorithm_update': 0.005442218542098999, 'loss': 5.0239738509655, 'time_step': 0.007549054861068725, 'init_value': 22.776517868041992}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:20.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020531628131866455, 'time_algorithm_update': 0.005458630800247192, 'loss': 5.4350543804168705, 'time_step': 0.0075638341903686524, 'init_value': 29.785053253173828}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:21.07[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020589120388031005, 'time_algorithm_update': 0.005445667028427124, 'loss': 6.411810212135315, 'time_step': 0.007556246757507324, 'init_value': 36.70072937011719}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:21.16[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020581393241882323, 'time_algorithm_update': 0.00545705795288086, 'loss': 6.951350953340531, 'time_step': 0.007567232131958008, 'init_value': 41.28541564941406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:21.25[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067640542984009, 'time_algorithm_update': 0.0054576613903045655, 'loss': 8.345265854120255, 'time_step': 0.007577294826507568, 'init_value': 47.83219528198242}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:21.34[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057833433151245, 'time_algorithm_update': 0.005449681520462036, 'loss': 9.150110512018204, 'time_step': 0.00755942153930664, 'init_value': 53.95915603637695}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:21.44[0m [[32m[1minfo     [0m] [1mFQE_20250505202013: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020565104484558104, 'time_algorithm_update': 0.005453521013259887, 'loss': 10.403625180721283, 'time_step': 0.007561618089675903, 'init_value': 59.636749267578125}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 59.636749267578125
avg return on 5 trajectories of agent18: 937.9432496666667
Episode generator created
[2m2025-05-05 20:21.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:21.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:21.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:21.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:21.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202147[0m
[2m2025-05-05 20:21.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:21.56[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020457022190093995, 'time_algorithm_update': 0.005414153814315796, 'loss': 1.5874519069939852, 'time_step': 0.007511039972305298, 'init_value': 3.462433099746704}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:22.05[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065153121948242, 'time_algorithm_update': 0.005452746868133545, 'loss': 3.714816864132881, 'time_step': 0.007569694995880127, 'init_value': 7.975689888000488}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:22.14[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020549089908599855, 'time_algorithm_update': 0.005447831392288208, 'loss': 4.444348594427109, 'time_step': 0.007554076194763184, 'init_value': 13.87959098815918}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:22.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047623634338379, 'time_algorithm_update': 0.0054428913593292235, 'loss': 5.049345089197159, 'time_step': 0.007541948080062867, 'init_value': 20.440494537353516}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:22.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205761981010437, 'time_algorithm_update': 0.005458700180053711, 'loss': 5.9917047607898715, 'time_step': 0.007568282842636108, 'init_value': 27.820735931396484}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:22.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060232162475586, 'time_algorithm_update': 0.005457849740982056, 'loss': 6.086680531263352, 'time_step': 0.007570147275924683, 'init_value': 33.48268508911133}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:22.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020570557117462157, 'time_algorithm_update': 0.005452665090560913, 'loss': 6.7843853688240054, 'time_step': 0.007561445474624634, 'init_value': 38.942138671875}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:22.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206106162071228, 'time_algorithm_update': 0.005460227012634277, 'loss': 7.889443055391312, 'time_step': 0.0075731201171875, 'init_value': 45.997230529785156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:23.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020583903789520262, 'time_algorithm_update': 0.005464788913726807, 'loss': 8.850761420011521, 'time_step': 0.007575103044509888, 'init_value': 47.03571701049805}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:23.18[0m [[32m[1minfo     [0m] [1mFQE_20250505202147: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020538179874420165, 'time_algorithm_update': 0.005446034908294678, 'loss': 8.948173537015915, 'time_step': 0.007551499128341675, 'init_value': 51.22736740112305}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.22736740112305
avg return on 5 trajectories of agent19: 943.6262889999999
Episode generator created
[2m2025-05-05 20:23.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:23.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:23.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:23.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:23.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202321[0m
[2m2025-05-05 20:23.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:23.30[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020461692810058592, 'time_algorithm_update': 0.0054261527061462405, 'loss': 1.6723047173321246, 'time_step': 0.00752399468421936, 'init_value': 4.1702189445495605}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:23.39[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020621047019958494, 'time_algorithm_update': 0.0054328696727752685, 'loss': 4.027780262947083, 'time_step': 0.0075469231605529786, 'init_value': 9.978967666625977}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:23.48[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020537033081054687, 'time_algorithm_update': 0.005423834800720215, 'loss': 4.5081244161129, 'time_step': 0.007528946876525879, 'init_value': 16.954437255859375}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:23.57[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055342435836792, 'time_algorithm_update': 0.00545009183883667, 'loss': 4.911675710439682, 'time_step': 0.007557279586791992, 'init_value': 23.166553497314453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:24.06[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051039218902588, 'time_algorithm_update': 0.005419467926025391, 'loss': 5.497376913309098, 'time_step': 0.007521732807159424, 'init_value': 28.767332077026367}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:24.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050140619277954, 'time_algorithm_update': 0.005424362182617187, 'loss': 6.339288321495056, 'time_step': 0.007526037693023682, 'init_value': 33.60945510864258}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:24.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020596513748168946, 'time_algorithm_update': 0.005434950590133667, 'loss': 6.442284489989281, 'time_step': 0.007546594858169556, 'init_value': 39.74715042114258}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:24.33[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002069770336151123, 'time_algorithm_update': 0.005471070051193237, 'loss': 7.340938305139542, 'time_step': 0.007593893051147461, 'init_value': 45.37383270263672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:24.42[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054927349090576, 'time_algorithm_update': 0.0054230520725250244, 'loss': 8.711011809587479, 'time_step': 0.007529507398605347, 'init_value': 48.912960052490234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:24.51[0m [[32m[1minfo     [0m] [1mFQE_20250505202321: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055220365524292, 'time_algorithm_update': 0.005438585758209228, 'loss': 8.799959482192993, 'time_step': 0.007545614719390869, 'init_value': 52.630313873291016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.630313873291016
ave advantage rew: 54.590905570983885, std: 2.3376349170685207
avg cum rews: 954.3826809166667, std: 29.19797600444546
Pearson correlation coefficient: -0.24471687678407888
Spearman correlation coefficient: -0.07067669172932331
Kendall Tau correlation coefficient: -0.052631578947368425
the best agent: 17, best agent cum rewards: 898.1303023333334
1962
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.017909415629235384
avg return on 5 trajectories of agent0: 883.3876226666666
Episode generator created
[2m2025-05-05 20:25.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:25.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:25.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:25.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:25.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202514[0m
[2m2025-05-05 20:25.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:25.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023801565170288, 'time_algorithm_update': 0.005349739074707031, 'loss': 1.651658980846405, 'time_step': 0.0074240841865539555, 'init_value': 3.7492942810058594}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:25.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020118281841278074, 'time_algorithm_update': 0.005343247175216675, 'loss': 4.030499393224717, 'time_step': 0.007405289649963379, 'init_value': 8.397797584533691}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:25.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002022897243499756, 'time_algorithm_update': 0.005354719161987305, 'loss': 4.549275094985962, 'time_step': 0.007428240060806274, 'init_value': 13.776549339294434}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:25.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002025042772293091, 'time_algorithm_update': 0.005351202487945557, 'loss': 4.952763990163803, 'time_step': 0.007426925659179687, 'init_value': 19.494089126586914}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:25.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047559022903442, 'time_algorithm_update': 0.0054055085182189945, 'loss': 5.455016275882721, 'time_step': 0.007504451036453247, 'init_value': 25.332515716552734}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:26.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020529317855834963, 'time_algorithm_update': 0.005435837984085083, 'loss': 6.0688997540473935, 'time_step': 0.007540378093719482, 'init_value': 31.895450592041016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:26.17[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057319641113281, 'time_algorithm_update': 0.005435762643814087, 'loss': 6.28973312330246, 'time_step': 0.007545254468917847, 'init_value': 36.94642639160156}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:26.26[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020508930683135985, 'time_algorithm_update': 0.005425591468811036, 'loss': 7.4868512029647825, 'time_step': 0.0075279617309570316, 'init_value': 43.935611724853516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:26.35[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020544302463531496, 'time_algorithm_update': 0.00544262433052063, 'loss': 8.516927508354186, 'time_step': 0.007549435138702393, 'init_value': 50.00877380371094}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:26.44[0m [[32m[1minfo     [0m] [1mFQE_20250505202514: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020630462169647216, 'time_algorithm_update': 0.005444236278533935, 'loss': 9.666797879934311, 'time_step': 0.007559707164764404, 'init_value': 54.55946350097656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.55946350097656
avg return on 5 trajectories of agent1: 864.906057
Episode generator created
[2m2025-05-05 20:26.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:26.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:26.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:26.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:26.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202647[0m
[2m2025-05-05 20:26.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:26.56[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020393686294555664, 'time_algorithm_update': 0.005427902460098267, 'loss': 1.6102659891694784, 'time_step': 0.007518369913101197, 'init_value': 3.774022102355957}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:27.06[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052210092544556, 'time_algorithm_update': 0.005446211814880371, 'loss': 3.800989712357521, 'time_step': 0.007550303936004639, 'init_value': 8.385788917541504}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:27.15[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056330919265747, 'time_algorithm_update': 0.005449106693267822, 'loss': 4.64276869225502, 'time_step': 0.007557234048843384, 'init_value': 14.061798095703125}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:27.24[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042907476425171, 'time_algorithm_update': 0.0054380295276641845, 'loss': 4.980836668729782, 'time_step': 0.007532466173171997, 'init_value': 20.041013717651367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:27.33[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590038299560546, 'time_algorithm_update': 0.0054515118598937986, 'loss': 5.535935928344727, 'time_step': 0.007562306642532349, 'init_value': 26.48004150390625}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:27.42[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057912826538086, 'time_algorithm_update': 0.0054572923183441166, 'loss': 6.25210684967041, 'time_step': 0.007567380428314209, 'init_value': 32.148197174072266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:27.51[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064516305923462, 'time_algorithm_update': 0.005500014781951904, 'loss': 6.519050837755203, 'time_step': 0.007617230176925659, 'init_value': 38.32664489746094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:28.00[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020539298057556154, 'time_algorithm_update': 0.005462208032608032, 'loss': 7.7679742810726164, 'time_step': 0.007568074703216553, 'init_value': 44.2280158996582}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:28.09[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020545136928558348, 'time_algorithm_update': 0.00545456051826477, 'loss': 8.002828029870987, 'time_step': 0.007561211824417114, 'init_value': 47.8487434387207}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:28.18[0m [[32m[1minfo     [0m] [1mFQE_20250505202647: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052217960357666, 'time_algorithm_update': 0.00543296480178833, 'loss': 8.68921225476265, 'time_step': 0.00753678297996521, 'init_value': 53.903385162353516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.903385162353516
avg return on 5 trajectories of agent2: 963.0384036666666
Episode generator created
[2m2025-05-05 20:28.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:28.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:28.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:28.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:28.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202821[0m
[2m2025-05-05 20:28.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:28.30[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020484426021575926, 'time_algorithm_update': 0.005439815759658814, 'loss': 1.6314378303289414, 'time_step': 0.007546280384063721, 'init_value': 3.424546241760254}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:28.40[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020544729232788088, 'time_algorithm_update': 0.005459112644195557, 'loss': 3.8865285844802857, 'time_step': 0.0075658452510833744, 'init_value': 8.298028945922852}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:28.49[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052030086517334, 'time_algorithm_update': 0.005451016664505005, 'loss': 4.141201388001442, 'time_step': 0.00755545449256897, 'init_value': 12.639641761779785}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:28.58[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057389259338379, 'time_algorithm_update': 0.00546474027633667, 'loss': 4.791667424440384, 'time_step': 0.007574501514434814, 'init_value': 19.327407836914062}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:29.07[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020511209964752196, 'time_algorithm_update': 0.005462462186813354, 'loss': 5.584631562232971, 'time_step': 0.007565979480743408, 'init_value': 26.655363082885742}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:29.16[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020805702209472656, 'time_algorithm_update': 0.0055389320850372315, 'loss': 5.8654908168315885, 'time_step': 0.007673258304595947, 'init_value': 32.24151611328125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:29.25[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058094501495361, 'time_algorithm_update': 0.005470229387283325, 'loss': 6.393751924753189, 'time_step': 0.007580379009246826, 'init_value': 38.1918830871582}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:29.34[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054067611694336, 'time_algorithm_update': 0.005472609758377075, 'loss': 7.354492313623428, 'time_step': 0.007578909635543823, 'init_value': 43.61692428588867}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:29.43[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046374559402466, 'time_algorithm_update': 0.005458479166030884, 'loss': 8.146918976306916, 'time_step': 0.00755734372138977, 'init_value': 48.548213958740234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:29.52[0m [[32m[1minfo     [0m] [1mFQE_20250505202821: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553512573242188, 'time_algorithm_update': 0.005457501649856567, 'loss': 9.394510611534118, 'time_step': 0.007564993143081665, 'init_value': 54.08872604370117}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.08872604370117
avg return on 5 trajectories of agent3: 936.2865713333334
Episode generator created
[2m2025-05-05 20:29.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:29.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:29.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:29.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:29.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505202955[0m
[2m2025-05-05 20:29.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:30.04[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057835817337036, 'time_algorithm_update': 0.0054371488094329835, 'loss': 1.593625347137451, 'time_step': 0.007547023773193359, 'init_value': 3.8801965713500977}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:30.14[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060582876205444, 'time_algorithm_update': 0.005446181297302246, 'loss': 3.638910889863968, 'time_step': 0.007558811902999878, 'init_value': 8.483742713928223}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:30.23[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020582916736602785, 'time_algorithm_update': 0.005453779935836792, 'loss': 4.40438128554821, 'time_step': 0.007563864946365357, 'init_value': 14.170186996459961}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:30.32[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206705117225647, 'time_algorithm_update': 0.005459429025650025, 'loss': 5.34627540230751, 'time_step': 0.007580920696258545, 'init_value': 20.394859313964844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:30.41[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020624110698699953, 'time_algorithm_update': 0.005456065893173218, 'loss': 5.746228829622269, 'time_step': 0.007570640802383423, 'init_value': 26.608266830444336}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:30.50[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064629793167114, 'time_algorithm_update': 0.005458024978637696, 'loss': 6.188411053419113, 'time_step': 0.007574634075164795, 'init_value': 32.22220230102539}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:30.59[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020647687911987305, 'time_algorithm_update': 0.0054628076553344725, 'loss': 7.199214422941208, 'time_step': 0.007579472064971924, 'init_value': 41.06962585449219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:31.08[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020575659275054933, 'time_algorithm_update': 0.005447934150695801, 'loss': 7.730322606563568, 'time_step': 0.007557003021240234, 'init_value': 45.492671966552734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:31.17[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002077035903930664, 'time_algorithm_update': 0.005455540180206299, 'loss': 8.361228647708893, 'time_step': 0.007584436655044556, 'init_value': 51.75589370727539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:31.26[0m [[32m[1minfo     [0m] [1mFQE_20250505202955: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002090498685836792, 'time_algorithm_update': 0.0055081164836883545, 'loss': 9.342457796812058, 'time_step': 0.007651864528656006, 'init_value': 55.07477569580078}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.07477569580078
avg return on 5 trajectories of agent4: 946.7281670000001
Episode generator created
[2m2025-05-05 20:31.29[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:31.29[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:31.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:31.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:31.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203130[0m
[2m2025-05-05 20:31.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:31.39[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043731689453125, 'time_algorithm_update': 0.005417582511901856, 'loss': 1.6520570341199636, 'time_step': 0.007512810707092285, 'init_value': 3.6942241191864014}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:31.48[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020449512004852297, 'time_algorithm_update': 0.005436152935028076, 'loss': 4.007369611263275, 'time_step': 0.007532382726669311, 'init_value': 8.553441047668457}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:31.57[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568726062774657, 'time_algorithm_update': 0.00544659161567688, 'loss': 4.711580966711044, 'time_step': 0.00755522084236145, 'init_value': 13.801219940185547}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:32.06[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020461761951446533, 'time_algorithm_update': 0.005460107326507568, 'loss': 4.973753910064698, 'time_step': 0.007557977676391601, 'init_value': 20.071596145629883}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:32.15[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205967116355896, 'time_algorithm_update': 0.005481177091598511, 'loss': 5.482233249425888, 'time_step': 0.00759257960319519, 'init_value': 25.80885124206543}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:32.24[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020565521717071534, 'time_algorithm_update': 0.00546472692489624, 'loss': 6.191450807332992, 'time_step': 0.007573518276214599, 'init_value': 32.13111877441406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:32.33[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020501596927642823, 'time_algorithm_update': 0.005458831310272217, 'loss': 6.722779896497727, 'time_step': 0.007561039686203003, 'init_value': 38.77901077270508}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:32.42[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053673505783081, 'time_algorithm_update': 0.005454023361206054, 'loss': 7.499191391468048, 'time_step': 0.007559376955032349, 'init_value': 44.551544189453125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:32.51[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049466848373413, 'time_algorithm_update': 0.005460186004638672, 'loss': 8.650520483970642, 'time_step': 0.007561373233795166, 'init_value': 47.501277923583984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:33.00[0m [[32m[1minfo     [0m] [1mFQE_20250505203130: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020542542934417723, 'time_algorithm_update': 0.005454949378967285, 'loss': 8.471218523979188, 'time_step': 0.00756125545501709, 'init_value': 51.69960403442383}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.69960403442383
avg return on 5 trajectories of agent5: 947.7106466666665
Episode generator created
[2m2025-05-05 20:33.03[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:33.03[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:33.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:33.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:33.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203304[0m
[2m2025-05-05 20:33.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:33.13[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020428049564361573, 'time_algorithm_update': 0.005414335489273071, 'loss': 1.6344593084305525, 'time_step': 0.007508986949920654, 'init_value': 4.089539527893066}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:33.22[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020416953563690186, 'time_algorithm_update': 0.00541326117515564, 'loss': 4.03252147769928, 'time_step': 0.00750657057762146, 'init_value': 8.718992233276367}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:33.31[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042827844619751, 'time_algorithm_update': 0.005413198947906494, 'loss': 4.584408647179604, 'time_step': 0.007507789373397827, 'init_value': 15.427331924438477}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:33.40[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020438222885131837, 'time_algorithm_update': 0.005429494142532349, 'loss': 4.963341549396515, 'time_step': 0.007525000810623169, 'init_value': 20.78546905517578}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:33.49[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020491104125976564, 'time_algorithm_update': 0.005441596984863281, 'loss': 5.525081457614899, 'time_step': 0.007542953729629516, 'init_value': 27.324399948120117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:33.58[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020409550666809083, 'time_algorithm_update': 0.005423623323440552, 'loss': 6.273193387746811, 'time_step': 0.007516295194625855, 'init_value': 33.346622467041016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:34.07[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061365604400635, 'time_algorithm_update': 0.00546658205986023, 'loss': 6.926906260967255, 'time_step': 0.007580937385559082, 'init_value': 40.42564392089844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:34.16[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020655038356781007, 'time_algorithm_update': 0.005457350492477417, 'loss': 8.49162956905365, 'time_step': 0.007575550317764282, 'init_value': 46.847740173339844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:34.25[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044683218002319, 'time_algorithm_update': 0.005430509805679321, 'loss': 8.781889290571213, 'time_step': 0.007527316808700561, 'init_value': 53.49253845214844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:34.34[0m [[32m[1minfo     [0m] [1mFQE_20250505203304: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020501384735107423, 'time_algorithm_update': 0.0054277324676513675, 'loss': 10.21764102935791, 'time_step': 0.007530162334442139, 'init_value': 58.719303131103516}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.719303131103516
avg return on 5 trajectories of agent6: 965.5559126666667
Episode generator created
[2m2025-05-05 20:34.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:34.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:34.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:34.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:34.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203437[0m
[2m2025-05-05 20:34.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:34.46[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046388149261475, 'time_algorithm_update': 0.0054269773960113525, 'loss': 1.6560157840847969, 'time_step': 0.007524685144424438, 'init_value': 3.517003297805786}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:34.55[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020579166412353516, 'time_algorithm_update': 0.005463178873062134, 'loss': 3.8313224704265596, 'time_step': 0.007573178291320801, 'init_value': 8.85641098022461}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:35.04[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055490255355835, 'time_algorithm_update': 0.00544828987121582, 'loss': 4.509093489408493, 'time_step': 0.007555458545684814, 'init_value': 13.795770645141602}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:35.14[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053537130355835, 'time_algorithm_update': 0.005463088512420654, 'loss': 4.760041084289551, 'time_step': 0.007568361282348633, 'init_value': 20.383146286010742}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:35.22[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020107154846191405, 'time_algorithm_update': 0.00534556794166565, 'loss': 5.359960660815239, 'time_step': 0.007405969619750976, 'init_value': 27.399221420288086}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:35.31[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020229763984680174, 'time_algorithm_update': 0.005374704837799072, 'loss': 5.945806646585464, 'time_step': 0.007448094606399536, 'init_value': 33.615962982177734}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:35.40[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020161042213439942, 'time_algorithm_update': 0.005351807117462158, 'loss': 6.509436613559723, 'time_step': 0.007418164253234863, 'init_value': 38.783653259277344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:35.49[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027735233306885, 'time_algorithm_update': 0.005372318744659424, 'loss': 7.145641832351685, 'time_step': 0.007450349330902099, 'init_value': 43.537986755371094}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:35.58[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202730131149292, 'time_algorithm_update': 0.005386303663253784, 'loss': 8.814941798210144, 'time_step': 0.00746479606628418, 'init_value': 49.37715530395508}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:36.07[0m [[32m[1minfo     [0m] [1mFQE_20250505203437: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052926778793335, 'time_algorithm_update': 0.005441824913024903, 'loss': 9.012912978172302, 'time_step': 0.007546237468719482, 'init_value': 53.5140266418457}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.5140266418457
avg return on 5 trajectories of agent7: 993.7182643333334
Episode generator created
[2m2025-05-05 20:36.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:36.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:36.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:36.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:36.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203611[0m
[2m2025-05-05 20:36.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:36.20[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020482184886932374, 'time_algorithm_update': 0.005418277502059936, 'loss': 1.6934922680109739, 'time_step': 0.0075179142951965336, 'init_value': 3.8985376358032227}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:36.29[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050297975540161, 'time_algorithm_update': 0.005426655769348145, 'loss': 3.8873313730955124, 'time_step': 0.007528300285339355, 'init_value': 8.077787399291992}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:36.38[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050355911254883, 'time_algorithm_update': 0.005427386522293091, 'loss': 4.442365406274796, 'time_step': 0.007529481172561646, 'init_value': 14.523857116699219}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:36.47[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568649768829346, 'time_algorithm_update': 0.005432968854904175, 'loss': 5.149058317303657, 'time_step': 0.0075410656929016115, 'init_value': 19.968257904052734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:36.56[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020441930294036867, 'time_algorithm_update': 0.0054300928115844724, 'loss': 5.162986991405487, 'time_step': 0.007526134490966797, 'init_value': 26.4805908203125}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:37.05[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020370323657989504, 'time_algorithm_update': 0.0054082190990448, 'loss': 5.602307514667511, 'time_step': 0.007496119260787964, 'init_value': 31.398237228393555}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:37.14[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020539500713348388, 'time_algorithm_update': 0.005432583808898926, 'loss': 6.009961851358414, 'time_step': 0.007538244724273681, 'init_value': 35.19998550415039}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:37.23[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053035020828247, 'time_algorithm_update': 0.005430096626281738, 'loss': 7.171715182781219, 'time_step': 0.007534467220306397, 'init_value': 42.02666473388672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:37.32[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020465714931488035, 'time_algorithm_update': 0.0054312777519226075, 'loss': 8.186025663852691, 'time_step': 0.007529282093048096, 'init_value': 47.625213623046875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:37.41[0m [[32m[1minfo     [0m] [1mFQE_20250505203611: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020507254600524902, 'time_algorithm_update': 0.005435145854949951, 'loss': 9.218871596336365, 'time_step': 0.007537494897842407, 'init_value': 51.300697326660156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.300697326660156
avg return on 5 trajectories of agent8: 965.34316
Episode generator created
[2m2025-05-05 20:37.44[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:37.44[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:37.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:37.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:37.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203744[0m
[2m2025-05-05 20:37.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:37.53[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020321648120880127, 'time_algorithm_update': 0.0054237558841705325, 'loss': 1.5713991338163615, 'time_step': 0.007507508754730225, 'init_value': 3.5131020545959473}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:38.02[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058199644088745, 'time_algorithm_update': 0.005444857835769653, 'loss': 3.758557537794113, 'time_step': 0.007555233001708984, 'init_value': 7.9926676750183105}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:38.11[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045011043548584, 'time_algorithm_update': 0.005433588027954101, 'loss': 4.484528784394264, 'time_step': 0.007530198574066162, 'init_value': 12.309026718139648}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:38.20[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020464844703674315, 'time_algorithm_update': 0.005443089485168457, 'loss': 4.574887364625931, 'time_step': 0.0075422594547271725, 'init_value': 18.20652198791504}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:38.30[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064655065536499, 'time_algorithm_update': 0.005482280015945434, 'loss': 5.1430064296722415, 'time_step': 0.007600009918212891, 'init_value': 25.1543025970459}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:38.39[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051786184310913, 'time_algorithm_update': 0.005432054281234742, 'loss': 5.871563268184662, 'time_step': 0.007535881519317627, 'init_value': 31.740259170532227}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:38.48[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020473480224609377, 'time_algorithm_update': 0.005431485414505005, 'loss': 6.427600037574768, 'time_step': 0.007530724287033081, 'init_value': 38.2809944152832}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:38.57[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044892072677612, 'time_algorithm_update': 0.005420290470123291, 'loss': 7.422519195079803, 'time_step': 0.0075170199871063235, 'init_value': 43.94572067260742}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:39.06[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054830551147461, 'time_algorithm_update': 0.005432410717010498, 'loss': 8.687543710708619, 'time_step': 0.007539348840713501, 'init_value': 48.0875129699707}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:39.15[0m [[32m[1minfo     [0m] [1mFQE_20250505203744: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020444705486297606, 'time_algorithm_update': 0.0054337546825408934, 'loss': 10.09562744498253, 'time_step': 0.007530294179916382, 'init_value': 55.72938919067383}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.72938919067383
avg return on 5 trajectories of agent9: 951.477004
Episode generator created
[2m2025-05-05 20:39.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:39.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:39.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:39.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:39.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505203918[0m
[2m2025-05-05 20:39.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:39.27[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045556306838989, 'time_algorithm_update': 0.005433560609817505, 'loss': 1.63403451025486, 'time_step': 0.007530923366546631, 'init_value': 3.6105663776397705}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:39.36[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062403917312622, 'time_algorithm_update': 0.005452058553695679, 'loss': 3.9397456245422364, 'time_step': 0.007566938400268555, 'init_value': 9.019103050231934}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:39.45[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020491516590118407, 'time_algorithm_update': 0.0054521276950836185, 'loss': 4.686989184141159, 'time_step': 0.007553151369094849, 'init_value': 14.27064323425293}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:39.54[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042717456817627, 'time_algorithm_update': 0.005428186655044556, 'loss': 4.840596503734589, 'time_step': 0.00752228832244873, 'init_value': 19.881153106689453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:40.03[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020596628189086916, 'time_algorithm_update': 0.005454852104187012, 'loss': 5.536300868034362, 'time_step': 0.007566650867462158, 'init_value': 25.352041244506836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:40.12[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020540437698364257, 'time_algorithm_update': 0.005442259550094605, 'loss': 5.408104452967644, 'time_step': 0.007548211574554443, 'init_value': 31.287565231323242}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:40.22[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020529818534851074, 'time_algorithm_update': 0.005436845302581787, 'loss': 6.801479249477387, 'time_step': 0.007541490077972412, 'init_value': 38.144737243652344}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:40.31[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052577495574951, 'time_algorithm_update': 0.005449653863906861, 'loss': 7.4428100421428685, 'time_step': 0.0075541589260101315, 'init_value': 41.96810531616211}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:40.40[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056361675262451, 'time_algorithm_update': 0.005444506883621216, 'loss': 8.427933243513108, 'time_step': 0.007553644180297851, 'init_value': 46.33397674560547}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:40.49[0m [[32m[1minfo     [0m] [1mFQE_20250505203918: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020378491878509522, 'time_algorithm_update': 0.005431988477706909, 'loss': 8.652446502923965, 'time_step': 0.007521637201309204, 'init_value': 51.68425750732422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.68425750732422
avg return on 5 trajectories of agent10: 940.9489443333333
Episode generator created
[2m2025-05-05 20:40.52[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:40.52[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:40.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:40.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:40.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204052[0m
[2m2025-05-05 20:40.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:41.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020505080223083495, 'time_algorithm_update': 0.005434997320175171, 'loss': 1.5994410331398248, 'time_step': 0.007537091255187988, 'init_value': 4.204446315765381}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:41.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553362369537353, 'time_algorithm_update': 0.005450828552246094, 'loss': 4.2854812128543855, 'time_step': 0.0075577166080474855, 'init_value': 9.234901428222656}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:41.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020510306358337404, 'time_algorithm_update': 0.00546080756187439, 'loss': 4.854723174214363, 'time_step': 0.007563586473464966, 'init_value': 15.665115356445312}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:41.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052609443664551, 'time_algorithm_update': 0.0054629120826721195, 'loss': 5.352913004875183, 'time_step': 0.00756743049621582, 'init_value': 22.415056228637695}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:41.37[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020447888374328614, 'time_algorithm_update': 0.005456923484802246, 'loss': 5.67842328286171, 'time_step': 0.007553111553192138, 'init_value': 27.283958435058594}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:41.46[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568954944610598, 'time_algorithm_update': 0.005466077327728271, 'loss': 5.927028703212738, 'time_step': 0.007576303482055664, 'init_value': 33.14076614379883}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:41.56[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061028003692627, 'time_algorithm_update': 0.0054984230995178225, 'loss': 6.833657491445542, 'time_step': 0.007612123012542725, 'init_value': 40.46532440185547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:42.05[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205710506439209, 'time_algorithm_update': 0.005476760149002075, 'loss': 7.8808759276866915, 'time_step': 0.007586168050765991, 'init_value': 47.03948974609375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:42.14[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045813083648682, 'time_algorithm_update': 0.0054661200046539305, 'loss': 8.164846108675004, 'time_step': 0.007563794374465942, 'init_value': 49.52825927734375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:42.23[0m [[32m[1minfo     [0m] [1mFQE_20250505204052: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020512514114379883, 'time_algorithm_update': 0.0054713599681854245, 'loss': 9.15492740392685, 'time_step': 0.007574479579925537, 'init_value': 52.46535873413086}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.46535873413086
avg return on 5 trajectories of agent11: 974.6995726666668
Episode generator created
[2m2025-05-05 20:42.26[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:42.26[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:42.26[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:42.26[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:42.26[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204226[0m
[2m2025-05-05 20:42.26[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:42.35[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048356294631958, 'time_algorithm_update': 0.005431597709655762, 'loss': 1.7216803086400032, 'time_step': 0.007531758308410645, 'init_value': 3.6219820976257324}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:42.44[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055380344390869, 'time_algorithm_update': 0.00546437406539917, 'loss': 3.87226503944397, 'time_step': 0.007571685075759888, 'init_value': 8.398510932922363}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:42.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050536870956421, 'time_algorithm_update': 0.005446299314498902, 'loss': 4.6858783811330795, 'time_step': 0.007548399209976196, 'init_value': 13.748038291931152}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:43.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041381120681763, 'time_algorithm_update': 0.005441240072250366, 'loss': 5.3491229617595675, 'time_step': 0.007534482955932617, 'init_value': 20.29957389831543}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:43.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053264856338501, 'time_algorithm_update': 0.005453065633773803, 'loss': 5.763751576185227, 'time_step': 0.0075581374168396, 'init_value': 26.320228576660156}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:43.21[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020526585578918457, 'time_algorithm_update': 0.0054561481475830075, 'loss': 5.884669624328613, 'time_step': 0.007560963630676269, 'init_value': 32.58949279785156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:43.30[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020437684059143066, 'time_algorithm_update': 0.005460990428924561, 'loss': 6.947501767396927, 'time_step': 0.007556764364242553, 'init_value': 39.429237365722656}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:43.39[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048531770706177, 'time_algorithm_update': 0.005452531576156616, 'loss': 7.898389070987702, 'time_step': 0.007552581548690796, 'init_value': 45.1385498046875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:43.48[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020509254932403564, 'time_algorithm_update': 0.005452743291854858, 'loss': 9.24012695813179, 'time_step': 0.007555800199508667, 'init_value': 50.64911651611328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:43.57[0m [[32m[1minfo     [0m] [1mFQE_20250505204226: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020492587089538574, 'time_algorithm_update': 0.0054505813121795655, 'loss': 9.840318702697754, 'time_step': 0.007551795721054077, 'init_value': 55.0203742980957}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.0203742980957
avg return on 5 trajectories of agent12: 899.9076133333333
Episode generator created
[2m2025-05-05 20:44.00[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:44.00[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:44.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:44.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:44.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204400[0m
[2m2025-05-05 20:44.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:44.09[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036777973175049, 'time_algorithm_update': 0.005415558338165283, 'loss': 1.6294201726913453, 'time_step': 0.007503837585449219, 'init_value': 3.81237530708313}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:44.18[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042479753494263, 'time_algorithm_update': 0.005431907415390015, 'loss': 3.770508682727814, 'time_step': 0.0075263924598693846, 'init_value': 8.392361640930176}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:44.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020334818363189695, 'time_algorithm_update': 0.0054314849376678465, 'loss': 4.791052691459655, 'time_step': 0.007516088008880616, 'init_value': 13.811939239501953}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:44.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042140483856201, 'time_algorithm_update': 0.005444347143173218, 'loss': 5.395889658689499, 'time_step': 0.007537946462631225, 'init_value': 20.765653610229492}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:44.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020519182682037355, 'time_algorithm_update': 0.005451423168182373, 'loss': 5.874856676340103, 'time_step': 0.0075550274848937985, 'init_value': 27.68333625793457}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:44.54[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020410513877868654, 'time_algorithm_update': 0.00543541145324707, 'loss': 6.309720114946366, 'time_step': 0.007528249502182007, 'init_value': 33.52195358276367}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:45.03[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020440428256988524, 'time_algorithm_update': 0.005439837455749511, 'loss': 6.945695392608642, 'time_step': 0.0075355939865112305, 'init_value': 37.76938247680664}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:45.12[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203373384475708, 'time_algorithm_update': 0.005436324357986451, 'loss': 7.4036303582191465, 'time_step': 0.007521435737609863, 'init_value': 43.08042526245117}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:45.21[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020251471996307374, 'time_algorithm_update': 0.005407000780105591, 'loss': 8.163213831663132, 'time_step': 0.007483583927154541, 'init_value': 49.33039093017578}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:45.30[0m [[32m[1minfo     [0m] [1mFQE_20250505204400: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020551681518555, 'time_algorithm_update': 0.005364867210388183, 'loss': 8.70272956442833, 'time_step': 0.0074361956119537356, 'init_value': 53.140777587890625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.140777587890625
avg return on 5 trajectories of agent13: 942.645086
Episode generator created
[2m2025-05-05 20:45.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:45.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:45.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:45.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:45.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204534[0m
[2m2025-05-05 20:45.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:45.42[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020121405124664308, 'time_algorithm_update': 0.005331727981567383, 'loss': 1.627349232301116, 'time_step': 0.007393895864486694, 'init_value': 3.714784622192383}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:45.51[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017920255661011, 'time_algorithm_update': 0.005367798566818237, 'loss': 3.992325663924217, 'time_step': 0.007436344623565674, 'init_value': 8.774126052856445}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:46.00[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002017552852630615, 'time_algorithm_update': 0.005355716466903687, 'loss': 4.974666202068329, 'time_step': 0.0074245016574859615, 'init_value': 15.656126976013184}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:46.09[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020288197994232176, 'time_algorithm_update': 0.0053970742225646975, 'loss': 5.557892110347748, 'time_step': 0.007476866245269775, 'init_value': 23.591054916381836}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:46.18[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057708263397217, 'time_algorithm_update': 0.005445526361465454, 'loss': 6.281799808979034, 'time_step': 0.007555397272109986, 'init_value': 31.721908569335938}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:46.27[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045565366744995, 'time_algorithm_update': 0.0054424054622650144, 'loss': 6.90846709227562, 'time_step': 0.007539770841598511, 'init_value': 38.17821502685547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:46.36[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055985927581787, 'time_algorithm_update': 0.0054361252784729, 'loss': 7.65251676607132, 'time_step': 0.007544182538986206, 'init_value': 44.0709342956543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:46.45[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047290325164795, 'time_algorithm_update': 0.005434471845626831, 'loss': 8.54107309627533, 'time_step': 0.007533376455307007, 'init_value': 49.232666015625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:46.55[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020530807971954348, 'time_algorithm_update': 0.005435975551605224, 'loss': 9.142228499174118, 'time_step': 0.007540657997131348, 'init_value': 53.61337661743164}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:47.04[0m [[32m[1minfo     [0m] [1mFQE_20250505204534: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020356097221374513, 'time_algorithm_update': 0.005409004926681518, 'loss': 10.154125351667405, 'time_step': 0.0074957311153411865, 'init_value': 57.11229705810547}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.11229705810547
avg return on 5 trajectories of agent14: 966.821714
Episode generator created
[2m2025-05-05 20:47.07[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:47.07[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:47.07[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:47.07[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:47.07[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204707[0m
[2m2025-05-05 20:47.07[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:47.16[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040905714035034, 'time_algorithm_update': 0.005421764135360717, 'loss': 1.613869532033801, 'time_step': 0.0075143656730651855, 'init_value': 3.885580539703369}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:47.25[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204934287071228, 'time_algorithm_update': 0.005425007104873657, 'loss': 3.9872809116840364, 'time_step': 0.007526153564453125, 'init_value': 9.129319190979004}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:47.34[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040431261062622, 'time_algorithm_update': 0.005411648511886596, 'loss': 4.828029045820236, 'time_step': 0.007504032850265503, 'init_value': 14.045576095581055}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:47.43[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204928731918335, 'time_algorithm_update': 0.005426374435424805, 'loss': 5.052661780118942, 'time_step': 0.007527637243270874, 'init_value': 20.085935592651367}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:47.52[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020599184036254885, 'time_algorithm_update': 0.0054354312419891354, 'loss': 5.627011839389801, 'time_step': 0.0075478196144104, 'init_value': 27.953359603881836}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:48.01[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052023649215698, 'time_algorithm_update': 0.005434418439865112, 'loss': 6.428030560016632, 'time_step': 0.007538432359695434, 'init_value': 33.19112777709961}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:48.10[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020597097873687746, 'time_algorithm_update': 0.005431056261062622, 'loss': 7.146949296236039, 'time_step': 0.007542994022369385, 'init_value': 39.32854461669922}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:48.19[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553319454193115, 'time_algorithm_update': 0.005430394887924194, 'loss': 7.628301273107529, 'time_step': 0.007538268089294434, 'init_value': 45.10593795776367}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:48.28[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053884744644165, 'time_algorithm_update': 0.005419140577316284, 'loss': 9.02445266532898, 'time_step': 0.007524855375289917, 'init_value': 49.50856018066406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:48.37[0m [[32m[1minfo     [0m] [1mFQE_20250505204707: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020569732189178467, 'time_algorithm_update': 0.005426832437515259, 'loss': 9.430963879823684, 'time_step': 0.007536276340484619, 'init_value': 55.24004364013672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.24004364013672
avg return on 5 trajectories of agent15: 919.228173
Episode generator created
[2m2025-05-05 20:48.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:48.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:48.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:48.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:48.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505204840[0m
[2m2025-05-05 20:48.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:48.50[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020494384765625, 'time_algorithm_update': 0.005422759056091309, 'loss': 1.6029720919281245, 'time_step': 0.007524447441101074, 'init_value': 2.9767675399780273}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:48.59[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020457110404968263, 'time_algorithm_update': 0.005427999496459961, 'loss': 3.846180542349815, 'time_step': 0.007525318384170533, 'init_value': 7.909507751464844}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:49.08[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020855696201324465, 'time_algorithm_update': 0.00551138162612915, 'loss': 4.566929320096969, 'time_step': 0.007650958776473999, 'init_value': 13.572834014892578}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:49.17[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002077305316925049, 'time_algorithm_update': 0.005482585906982422, 'loss': 5.099775849342346, 'time_step': 0.007613073348999024, 'init_value': 20.285125732421875}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:49.26[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054767608642578, 'time_algorithm_update': 0.005433442831039428, 'loss': 5.65670349574089, 'time_step': 0.007540521621704102, 'init_value': 27.21212387084961}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:49.35[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020528984069824218, 'time_algorithm_update': 0.005446270227432251, 'loss': 6.127063367128372, 'time_step': 0.0075516548156738285, 'init_value': 33.321895599365234}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:49.44[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020523810386657714, 'time_algorithm_update': 0.00543374490737915, 'loss': 6.91140038228035, 'time_step': 0.007538459062576294, 'init_value': 39.825836181640625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:49.53[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046696662902832, 'time_algorithm_update': 0.005430234670639038, 'loss': 7.990579484939575, 'time_step': 0.007528963088989257, 'init_value': 43.46174240112305}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:50.02[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057320833206177, 'time_algorithm_update': 0.005433021306991577, 'loss': 8.805889047145843, 'time_step': 0.0075423955917358395, 'init_value': 51.48902893066406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:50.11[0m [[32m[1minfo     [0m] [1mFQE_20250505204840: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205026650428772, 'time_algorithm_update': 0.005438560724258423, 'loss': 9.594293762207032, 'time_step': 0.007541989088058472, 'init_value': 56.056007385253906}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.056007385253906
avg return on 5 trajectories of agent16: 973.7459916666667
Episode generator created
[2m2025-05-05 20:50.14[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:50.14[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:50.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:50.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:50.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205014[0m
[2m2025-05-05 20:50.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:50.23[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032505989074707, 'time_algorithm_update': 0.00542276406288147, 'loss': 1.66316862732172, 'time_step': 0.007506725311279297, 'init_value': 3.391472339630127}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:50.33[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044332981109619, 'time_algorithm_update': 0.00544740629196167, 'loss': 3.81211504983902, 'time_step': 0.00754381275177002, 'init_value': 7.910888671875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:50.42[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047523498535156, 'time_algorithm_update': 0.0054569456577301025, 'loss': 4.72715167093277, 'time_step': 0.0075563910007476805, 'init_value': 14.02279281616211}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:50.51[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051633358001709, 'time_algorithm_update': 0.005454199552536011, 'loss': 5.540749585628509, 'time_step': 0.007557668447494507, 'init_value': 20.647579193115234}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:51.00[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020508198738098146, 'time_algorithm_update': 0.005456705570220947, 'loss': 5.75388050031662, 'time_step': 0.007559769868850708, 'init_value': 28.740337371826172}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:51.09[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055891513824463, 'time_algorithm_update': 0.005467995643615723, 'loss': 6.294348870277405, 'time_step': 0.007576168537139893, 'init_value': 35.453453063964844}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:51.18[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050031900405884, 'time_algorithm_update': 0.0054530975818634034, 'loss': 6.998916469573975, 'time_step': 0.007555385828018188, 'init_value': 40.2481689453125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:51.27[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020480711460113526, 'time_algorithm_update': 0.00544978404045105, 'loss': 7.748958317995071, 'time_step': 0.0075495967864990235, 'init_value': 45.31882858276367}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:51.36[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590364933013917, 'time_algorithm_update': 0.005463268756866455, 'loss': 9.00130786728859, 'time_step': 0.007574528455734253, 'init_value': 50.46444320678711}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:51.45[0m [[32m[1minfo     [0m] [1mFQE_20250505205014: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046178102493286, 'time_algorithm_update': 0.005441455364227295, 'loss': 10.269159978628158, 'time_step': 0.007539363622665406, 'init_value': 57.14621353149414}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.14621353149414
avg return on 5 trajectories of agent17: 939.4527899999999
Episode generator created
[2m2025-05-05 20:51.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:51.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:51.48[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:51.48[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:51.48[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205148[0m
[2m2025-05-05 20:51.48[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:51.57[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040329456329346, 'time_algorithm_update': 0.005409930229187012, 'loss': 1.7895022127628326, 'time_step': 0.007501260757446289, 'init_value': 3.897667169570923}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:52.06[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020409228801727295, 'time_algorithm_update': 0.005421579599380493, 'loss': 4.139352495074272, 'time_step': 0.00751425313949585, 'init_value': 8.8512544631958}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:52.15[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203888463973999, 'time_algorithm_update': 0.005413829088211059, 'loss': 4.960118536949158, 'time_step': 0.007503559589385986, 'init_value': 14.903063774108887}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:52.24[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204949951171875, 'time_algorithm_update': 0.00542717456817627, 'loss': 5.443397771120072, 'time_step': 0.007527893781661988, 'init_value': 22.284690856933594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:52.34[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050588607788086, 'time_algorithm_update': 0.005442767381668091, 'loss': 5.963971614360809, 'time_step': 0.00754500937461853, 'init_value': 28.37164878845215}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:52.43[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065629243850708, 'time_algorithm_update': 0.005476997375488281, 'loss': 5.865929355382919, 'time_step': 0.007595702648162842, 'init_value': 33.57606506347656}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:52.52[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020472884178161623, 'time_algorithm_update': 0.005429322242736816, 'loss': 6.9547365353107455, 'time_step': 0.007527838230133057, 'init_value': 38.713226318359375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:53.01[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049527645111084, 'time_algorithm_update': 0.005439472913742065, 'loss': 7.744618936538696, 'time_step': 0.007540802955627441, 'init_value': 46.706947326660156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:53.10[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049499273300171, 'time_algorithm_update': 0.0054325790405273435, 'loss': 9.418520464658737, 'time_step': 0.007533839702606201, 'init_value': 51.93642044067383}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:53.19[0m [[32m[1minfo     [0m] [1mFQE_20250505205148: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059528112411499, 'time_algorithm_update': 0.005436677217483521, 'loss': 10.612564569711685, 'time_step': 0.007548165798187256, 'init_value': 55.74655532836914}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.74655532836914
avg return on 5 trajectories of agent18: 930.6141096666666
Episode generator created
[2m2025-05-05 20:53.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:53.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:53.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:53.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:53.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205322[0m
[2m2025-05-05 20:53.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:53.31[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020429863929748537, 'time_algorithm_update': 0.005416609764099121, 'loss': 1.6531583024710417, 'time_step': 0.007510925769805908, 'init_value': 3.4456474781036377}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:53.40[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204435396194458, 'time_algorithm_update': 0.005424768686294556, 'loss': 4.056229395031929, 'time_step': 0.007520173788070679, 'init_value': 9.001256942749023}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:53.49[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002063207387924194, 'time_algorithm_update': 0.005444708108901977, 'loss': 4.846717772603035, 'time_step': 0.007559820175170899, 'init_value': 15.4102201461792}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:53.58[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055168390274048, 'time_algorithm_update': 0.00543261981010437, 'loss': 5.488618581533432, 'time_step': 0.0075392346382141115, 'init_value': 22.38862419128418}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:54.07[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020506629943847655, 'time_algorithm_update': 0.00544486117362976, 'loss': 5.465276182413101, 'time_step': 0.0075473179817199705, 'init_value': 27.041086196899414}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:54.17[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046899318695068, 'time_algorithm_update': 0.005422380685806275, 'loss': 5.902535073518753, 'time_step': 0.007520979166030884, 'init_value': 33.034423828125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:54.26[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051948547363281, 'time_algorithm_update': 0.005431727409362793, 'loss': 6.71073842382431, 'time_step': 0.007535268306732177, 'init_value': 38.39703369140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:54.35[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020560970306396486, 'time_algorithm_update': 0.005433836698532105, 'loss': 7.085541052818298, 'time_step': 0.007541763782501221, 'init_value': 43.59487533569336}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:54.44[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020596585273742678, 'time_algorithm_update': 0.005442765474319458, 'loss': 8.050431289434433, 'time_step': 0.007553935289382935, 'init_value': 48.37421417236328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:54.53[0m [[32m[1minfo     [0m] [1mFQE_20250505205322: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020503647327423094, 'time_algorithm_update': 0.0054468362331390385, 'loss': 9.148588302850722, 'time_step': 0.00754911994934082, 'init_value': 52.11687469482422}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.11687469482422
avg return on 5 trajectories of agent19: 932.1546086666667
Episode generator created
[2m2025-05-05 20:54.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:54.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:54.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:54.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:54.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205456[0m
[2m2025-05-05 20:54.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:55.05[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203402304649353, 'time_algorithm_update': 0.0054045491218566895, 'loss': 1.6724383147656918, 'time_step': 0.007489082098007202, 'init_value': 3.7531328201293945}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:55.14[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002035097122192383, 'time_algorithm_update': 0.005419388294219971, 'loss': 4.200546148657799, 'time_step': 0.007505493879318237, 'init_value': 9.682841300964355}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:55.23[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020477302074432373, 'time_algorithm_update': 0.005421922445297241, 'loss': 4.740019796252251, 'time_step': 0.007521131992340088, 'init_value': 15.844281196594238}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:55.32[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001997755765914917, 'time_algorithm_update': 0.005333300352096558, 'loss': 5.346013227939606, 'time_step': 0.0073807816505432125, 'init_value': 22.497426986694336}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:55.41[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019994945526123045, 'time_algorithm_update': 0.005321534872055053, 'loss': 5.637007352352143, 'time_step': 0.007370775699615479, 'init_value': 28.232433319091797}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:55.50[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020124177932739256, 'time_algorithm_update': 0.005343575239181519, 'loss': 6.285064235925675, 'time_step': 0.007406329870223999, 'init_value': 35.282718658447266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:55.59[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020157058238983155, 'time_algorithm_update': 0.005337733268737793, 'loss': 7.390425975084304, 'time_step': 0.007403428077697754, 'init_value': 41.41532897949219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:56.08[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202303147315979, 'time_algorithm_update': 0.005348901748657226, 'loss': 8.13951061463356, 'time_step': 0.007422565698623657, 'init_value': 47.35882568359375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:56.17[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020457558631896975, 'time_algorithm_update': 0.005429037570953369, 'loss': 8.278142024755478, 'time_step': 0.007526671648025513, 'init_value': 50.79739761352539}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:56.26[0m [[32m[1minfo     [0m] [1mFQE_20250505205456: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002044846773147583, 'time_algorithm_update': 0.005430741786956787, 'loss': 10.23276459813118, 'time_step': 0.007527240753173828, 'init_value': 54.60844802856445}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.60844802856445
ave advantage rew: 54.44632892608642, std: 1.9671293925807531
avg cum rews: 941.9185206333334, std: 30.815132166724542
Pearson correlation coefficient: 0.018601811192076947
Spearman correlation coefficient: 0.04360902255639098
Kendall Tau correlation coefficient: 0.031578947368421054
the best agent: 5, best agent cum rewards: 947.7106466666665
1963
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.018700766548222968
avg return on 5 trajectories of agent0: 906.6144469999999
Episode generator created
[2m2025-05-05 20:56.48[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:56.48[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:56.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:56.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:56.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205649[0m
[2m2025-05-05 20:56.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:56.58[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020430822372436526, 'time_algorithm_update': 0.00542764401435852, 'loss': 1.5997788525670766, 'time_step': 0.007521762371063233, 'init_value': 3.3633673191070557}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:57.07[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002029589891433716, 'time_algorithm_update': 0.005438219785690307, 'loss': 3.820835258126259, 'time_step': 0.007519425392150879, 'init_value': 8.474199295043945}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:57.16[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020392248630523684, 'time_algorithm_update': 0.005444839000701905, 'loss': 4.677825254201889, 'time_step': 0.00753592586517334, 'init_value': 15.849178314208984}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:57.25[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040717840194702, 'time_algorithm_update': 0.005442588329315185, 'loss': 4.99066141307354, 'time_step': 0.007535047054290771, 'init_value': 20.57225799560547}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:57.34[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050059795379639, 'time_algorithm_update': 0.005440740585327148, 'loss': 5.427488321900368, 'time_step': 0.007542343854904175, 'init_value': 28.081371307373047}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:57.43[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020509846210479735, 'time_algorithm_update': 0.005444839477539063, 'loss': 6.366909621477127, 'time_step': 0.007547847032546997, 'init_value': 35.06591033935547}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:57.52[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057394504547119, 'time_algorithm_update': 0.005448973655700683, 'loss': 7.023297101259232, 'time_step': 0.007558371305465698, 'init_value': 40.825286865234375}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:58.01[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020747671127319335, 'time_algorithm_update': 0.005517268419265747, 'loss': 7.994654347658157, 'time_step': 0.0076448554992675785, 'init_value': 46.01258087158203}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:58.10[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204844069480896, 'time_algorithm_update': 0.0054528055191040035, 'loss': 9.247872828006745, 'time_step': 0.007552796840667724, 'init_value': 50.920509338378906}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:58.19[0m [[32m[1minfo     [0m] [1mFQE_20250505205649: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020580179691314696, 'time_algorithm_update': 0.005452040910720825, 'loss': 10.16724457001686, 'time_step': 0.0075617990493774415, 'init_value': 56.93471908569336}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.93471908569336
avg return on 5 trajectories of agent1: 1020.3550043333333
Episode generator created
[2m2025-05-05 20:58.22[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:58.22[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:58.22[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:58.22[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:58.22[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205822[0m
[2m2025-05-05 20:58.22[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 20:58.31[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039867162704468, 'time_algorithm_update': 0.005442038297653198, 'loss': 1.6252714444696903, 'time_step': 0.007533698797225952, 'init_value': 3.827451467514038}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 20:58.41[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046260595321655, 'time_algorithm_update': 0.005463646411895752, 'loss': 4.055132906913757, 'time_step': 0.007562185764312744, 'init_value': 9.019672393798828}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 20:58.50[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020481810569763182, 'time_algorithm_update': 0.0054524953365325925, 'loss': 4.8297099356651305, 'time_step': 0.007552339553833008, 'init_value': 14.68685531616211}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 20:58.59[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020502145290374756, 'time_algorithm_update': 0.005470321178436279, 'loss': 5.2254423875808715, 'time_step': 0.007572532176971436, 'init_value': 21.7626953125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 20:59.08[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020541751384735105, 'time_algorithm_update': 0.005456138849258423, 'loss': 5.789608002901077, 'time_step': 0.0075619277954101565, 'init_value': 28.115966796875}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 20:59.17[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020557620525360107, 'time_algorithm_update': 0.005468050241470337, 'loss': 6.608511299610138, 'time_step': 0.0075760228633880615, 'init_value': 32.8746223449707}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 20:59.26[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020525474548339843, 'time_algorithm_update': 0.005470525503158569, 'loss': 6.320600833177567, 'time_step': 0.007575514793395996, 'init_value': 36.84113311767578}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 20:59.35[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020498340129852296, 'time_algorithm_update': 0.005456754446029663, 'loss': 7.461823236942291, 'time_step': 0.007558337926864624, 'init_value': 42.29733657836914}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 20:59.44[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002065171480178833, 'time_algorithm_update': 0.0054857017993927, 'loss': 7.864146701812744, 'time_step': 0.0076035475730896, 'init_value': 45.62599563598633}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 20:59.53[0m [[32m[1minfo     [0m] [1mFQE_20250505205822: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056320667266846, 'time_algorithm_update': 0.005459499597549438, 'loss': 9.049068638086318, 'time_step': 0.0075681393146514895, 'init_value': 51.73649978637695}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.73649978637695
avg return on 5 trajectories of agent2: 889.7319650000001
Episode generator created
[2m2025-05-05 20:59.56[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 20:59.56[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 20:59.56[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 20:59.56[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 20:59.56[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505205956[0m
[2m2025-05-05 20:59.56[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:00.05[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051858425140381, 'time_algorithm_update': 0.005437024593353271, 'loss': 1.6846975899338723, 'time_step': 0.0075405375957489015, 'init_value': 3.943039894104004}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:00.15[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020563764572143553, 'time_algorithm_update': 0.005452178001403809, 'loss': 4.039925531387329, 'time_step': 0.007559811353683472, 'init_value': 9.387626647949219}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:00.24[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020558724403381347, 'time_algorithm_update': 0.0054498140811920165, 'loss': 4.566750409126282, 'time_step': 0.007557371854782105, 'init_value': 13.948772430419922}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:00.33[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020484135150909424, 'time_algorithm_update': 0.0054403355121612545, 'loss': 4.985394091844559, 'time_step': 0.007540539026260376, 'init_value': 18.828388214111328}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:00.42[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020627925395965575, 'time_algorithm_update': 0.005455354452133179, 'loss': 5.197063070178032, 'time_step': 0.007569845199584961, 'init_value': 25.25668716430664}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:00.51[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590994358062743, 'time_algorithm_update': 0.0054607541561126705, 'loss': 6.083872162342072, 'time_step': 0.007571749448776245, 'init_value': 31.508283615112305}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:01.00[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020542309284210204, 'time_algorithm_update': 0.005441930294036865, 'loss': 6.494224550485611, 'time_step': 0.007547262907028198, 'init_value': 37.85386657714844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:01.09[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058436393737793, 'time_algorithm_update': 0.005447962999343872, 'loss': 7.2697382290363315, 'time_step': 0.0075581567287445065, 'init_value': 44.3163948059082}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:01.18[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020611536502838134, 'time_algorithm_update': 0.005447500944137573, 'loss': 8.233863003730773, 'time_step': 0.007560507535934448, 'init_value': 48.44677734375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:01.27[0m [[32m[1minfo     [0m] [1mFQE_20250505205956: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020485010147094727, 'time_algorithm_update': 0.005425702333450317, 'loss': 9.011553624868393, 'time_step': 0.007525469779968262, 'init_value': 53.14165115356445}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.14165115356445
avg return on 5 trajectories of agent3: 900.7046839999999
Episode generator created
[2m2025-05-05 21:01.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:01.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:01.30[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:01.30[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:01.30[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210130[0m
[2m2025-05-05 21:01.30[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:01.39[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020524754524230957, 'time_algorithm_update': 0.005422097682952881, 'loss': 1.6280838223546743, 'time_step': 0.007526313543319702, 'init_value': 3.6912600994110107}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:01.48[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051501989364624, 'time_algorithm_update': 0.00543198823928833, 'loss': 4.046182928204536, 'time_step': 0.0075352656841278075, 'init_value': 8.84483528137207}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:01.57[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020469894409179687, 'time_algorithm_update': 0.005428430557250977, 'loss': 4.835246469140053, 'time_step': 0.00752655029296875, 'init_value': 14.576802253723145}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:02.07[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020507450103759766, 'time_algorithm_update': 0.005436593055725097, 'loss': 5.311239402294159, 'time_step': 0.0075390546321868895, 'init_value': 20.795766830444336}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:02.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020499529838562012, 'time_algorithm_update': 0.005426772832870483, 'loss': 5.3376495609283445, 'time_step': 0.0075285849571228025, 'init_value': 26.911865234375}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:02.25[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042639970779419, 'time_algorithm_update': 0.005432298421859741, 'loss': 6.069526593685151, 'time_step': 0.007526151180267334, 'init_value': 31.9659423828125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:02.34[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020489897727966307, 'time_algorithm_update': 0.005433833122253418, 'loss': 6.677918011665344, 'time_step': 0.007534352779388428, 'init_value': 38.25279235839844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:02.43[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050046443939209, 'time_algorithm_update': 0.005433260917663574, 'loss': 7.561926406383514, 'time_step': 0.00753490662574768, 'init_value': 44.704898834228516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:02.52[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020507216453552247, 'time_algorithm_update': 0.005413751602172851, 'loss': 8.669154863119125, 'time_step': 0.007515650510787964, 'init_value': 50.85328674316406}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:03.01[0m [[32m[1minfo     [0m] [1mFQE_20250505210130: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020741486549377443, 'time_algorithm_update': 0.0054911537170410155, 'loss': 9.659818361997605, 'time_step': 0.007617697715759277, 'init_value': 56.208927154541016}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.208927154541016
avg return on 5 trajectories of agent4: 991.318092
Episode generator created
[2m2025-05-05 21:03.04[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:03.04[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:03.04[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:03.04[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:03.04[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210304[0m
[2m2025-05-05 21:03.04[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:03.13[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020663559436798094, 'time_algorithm_update': 0.005461925268173217, 'loss': 1.581444709300995, 'time_step': 0.007580509901046753, 'init_value': 3.606801748275757}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:03.22[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020532948970794678, 'time_algorithm_update': 0.0054350004196167, 'loss': 4.202548086166382, 'time_step': 0.007539920806884766, 'init_value': 9.318035125732422}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:03.31[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057635545730591, 'time_algorithm_update': 0.0054400753974914555, 'loss': 4.629939644813538, 'time_step': 0.007549131393432617, 'init_value': 14.499567031860352}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:03.40[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020624094009399413, 'time_algorithm_update': 0.0054410164356231685, 'loss': 4.8731544303894045, 'time_step': 0.007554694414138794, 'init_value': 19.369821548461914}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:03.49[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020491909980773926, 'time_algorithm_update': 0.005438268184661865, 'loss': 5.259141518115998, 'time_step': 0.007538553476333618, 'init_value': 26.361860275268555}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:03.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059274196624756, 'time_algorithm_update': 0.0054398860931396485, 'loss': 5.948352142810822, 'time_step': 0.007550702095031738, 'init_value': 31.650890350341797}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:04.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020601773262023926, 'time_algorithm_update': 0.005443987846374512, 'loss': 6.358240292549134, 'time_step': 0.0075557403564453125, 'init_value': 37.3668327331543}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:04.17[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060590744018555, 'time_algorithm_update': 0.005439290523529053, 'loss': 7.3334327256679535, 'time_step': 0.007551487684249878, 'init_value': 42.62647247314453}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:04.26[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020728609561920168, 'time_algorithm_update': 0.0054459373950958255, 'loss': 8.751618241071702, 'time_step': 0.007570732116699219, 'init_value': 48.10590362548828}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:04.35[0m [[32m[1minfo     [0m] [1mFQE_20250505210304: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020710644721984865, 'time_algorithm_update': 0.005455903768539429, 'loss': 9.513819392442704, 'time_step': 0.0075784378051757815, 'init_value': 53.24290084838867}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.24290084838867
avg return on 5 trajectories of agent5: 907.8986876666668
Episode generator created
[2m2025-05-05 21:04.38[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:04.38[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:04.38[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:04.38[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:04.38[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210438[0m
[2m2025-05-05 21:04.38[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:04.47[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020409822463989258, 'time_algorithm_update': 0.005405446529388428, 'loss': 1.5886207893788815, 'time_step': 0.007497657299041748, 'init_value': 3.838268756866455}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:04.56[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053534984588623, 'time_algorithm_update': 0.005427574872970581, 'loss': 3.9800677404403686, 'time_step': 0.007532574892044067, 'init_value': 8.995084762573242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:05.05[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053778648376465, 'time_algorithm_update': 0.005442168951034546, 'loss': 4.6857976422309875, 'time_step': 0.0075472939014434815, 'init_value': 15.72446346282959}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:05.14[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052109718322754, 'time_algorithm_update': 0.00543253493309021, 'loss': 5.255629230499268, 'time_step': 0.007535699367523193, 'init_value': 21.541831970214844}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:05.23[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020591297149658203, 'time_algorithm_update': 0.005451040267944336, 'loss': 5.494064611792564, 'time_step': 0.007561854600906372, 'init_value': 27.909183502197266}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:05.32[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020511882305145265, 'time_algorithm_update': 0.005440032958984375, 'loss': 5.825380288362503, 'time_step': 0.007542478799819946, 'init_value': 32.45418167114258}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:05.41[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020178570747375487, 'time_algorithm_update': 0.005354235887527466, 'loss': 6.759832255601883, 'time_step': 0.007421614170074463, 'init_value': 37.71200180053711}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:05.50[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027989625930786, 'time_algorithm_update': 0.005366716384887695, 'loss': 7.3101276364326475, 'time_step': 0.007445185422897339, 'init_value': 43.38438034057617}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:05.59[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020185036659240724, 'time_algorithm_update': 0.005352699756622314, 'loss': 8.330918979644775, 'time_step': 0.0074211363792419435, 'init_value': 48.0653190612793}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:06.08[0m [[32m[1minfo     [0m] [1mFQE_20250505210438: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227692127227784, 'time_algorithm_update': 0.005369086027145386, 'loss': 8.933282969474792, 'time_step': 0.007442443609237671, 'init_value': 52.63743209838867}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.63743209838867
avg return on 5 trajectories of agent6: 933.5651576666668
Episode generator created
[2m2025-05-05 21:06.11[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:06.11[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:06.11[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:06.11[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:06.11[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210611[0m
[2m2025-05-05 21:06.11[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:06.20[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00202796196937561, 'time_algorithm_update': 0.00534749698638916, 'loss': 1.5574088000953197, 'time_step': 0.007425999402999878, 'init_value': 3.4342703819274902}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:06.29[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067605018615723, 'time_algorithm_update': 0.005443826913833618, 'loss': 3.834895522236824, 'time_step': 0.007563883781433105, 'init_value': 8.912321090698242}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:06.39[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020886061191558837, 'time_algorithm_update': 0.005499170303344726, 'loss': 4.4723245801925655, 'time_step': 0.007640502214431763, 'init_value': 14.673943519592285}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:06.48[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002093732833862305, 'time_algorithm_update': 0.005527559995651245, 'loss': 5.202222272396088, 'time_step': 0.0076751670837402345, 'init_value': 21.35252571105957}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:06.57[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002070650339126587, 'time_algorithm_update': 0.005472702980041504, 'loss': 5.7225907456874845, 'time_step': 0.007595496892929077, 'init_value': 27.37725257873535}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:07.06[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020690464973449705, 'time_algorithm_update': 0.005449264526367187, 'loss': 6.3410510671138764, 'time_step': 0.007569998264312744, 'init_value': 33.90559387207031}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:07.15[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020718727111816407, 'time_algorithm_update': 0.005454723358154297, 'loss': 6.673714585781098, 'time_step': 0.007578377962112427, 'init_value': 39.94303894042969}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:07.24[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020596423149108886, 'time_algorithm_update': 0.005435158252716064, 'loss': 7.504217895746231, 'time_step': 0.0075464069843292235, 'init_value': 45.31973648071289}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:07.33[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062992811203003, 'time_algorithm_update': 0.005447718381881714, 'loss': 8.349342324972152, 'time_step': 0.00756251311302185, 'init_value': 49.16034698486328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:07.42[0m [[32m[1minfo     [0m] [1mFQE_20250505210611: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020719306468963625, 'time_algorithm_update': 0.005451860427856445, 'loss': 9.217130319356919, 'time_step': 0.007576220750808716, 'init_value': 54.24374008178711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.24374008178711
avg return on 5 trajectories of agent7: 849.7985173333333
Episode generator created
[2m2025-05-05 21:07.45[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:07.45[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:07.46[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:07.46[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:07.46[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210746[0m
[2m2025-05-05 21:07.46[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:07.55[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020443334579467775, 'time_algorithm_update': 0.005429753303527832, 'loss': 1.6558354149013759, 'time_step': 0.007525690793991089, 'init_value': 3.8080039024353027}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:08.04[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020476932525634764, 'time_algorithm_update': 0.005439555168151856, 'loss': 3.6939464440345766, 'time_step': 0.007538875818252563, 'init_value': 8.588969230651855}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:08.13[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020528793334960937, 'time_algorithm_update': 0.005448695659637451, 'loss': 4.457680176377297, 'time_step': 0.00755377459526062, 'init_value': 14.5396089553833}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:08.22[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020488922595977782, 'time_algorithm_update': 0.005448992729187012, 'loss': 5.0967557916641235, 'time_step': 0.007549290180206299, 'init_value': 19.798450469970703}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:08.31[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048492670059204, 'time_algorithm_update': 0.005445740938186646, 'loss': 5.450005335330963, 'time_step': 0.00754606294631958, 'init_value': 26.79910659790039}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:08.40[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049578666687012, 'time_algorithm_update': 0.005455207109451294, 'loss': 5.873754156589508, 'time_step': 0.007556626796722412, 'init_value': 34.521263122558594}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:08.49[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039224147796631, 'time_algorithm_update': 0.0054263222217559815, 'loss': 6.571103546261788, 'time_step': 0.00751677680015564, 'init_value': 38.92024612426758}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:08.58[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053842306137085, 'time_algorithm_update': 0.005449994802474976, 'loss': 7.4595739092826845, 'time_step': 0.007555562496185303, 'init_value': 45.27162170410156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:09.07[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020537087917327883, 'time_algorithm_update': 0.005444571256637574, 'loss': 8.303102373123169, 'time_step': 0.007550179243087768, 'init_value': 49.18819808959961}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:09.16[0m [[32m[1minfo     [0m] [1mFQE_20250505210746: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453145503997803, 'time_algorithm_update': 0.005438479423522949, 'loss': 9.623853005886078, 'time_step': 0.007535333156585693, 'init_value': 54.85907745361328}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.85907745361328
avg return on 5 trajectories of agent8: 940.896038
Episode generator created
[2m2025-05-05 21:09.19[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:09.19[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:09.19[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:09.19[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:09.19[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505210919[0m
[2m2025-05-05 21:09.19[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:09.28[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020371429920196535, 'time_algorithm_update': 0.005431597471237183, 'loss': 1.7493329682797194, 'time_step': 0.007520437955856323, 'init_value': 3.486131429672241}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:09.38[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020519125461578368, 'time_algorithm_update': 0.005450793504714966, 'loss': 4.046863377332687, 'time_step': 0.007554660558700562, 'init_value': 8.534918785095215}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:09.47[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453827381134034, 'time_algorithm_update': 0.005432485818862915, 'loss': 4.8420458662509915, 'time_step': 0.007529745817184449, 'init_value': 14.821882247924805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:09.56[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020583550930023194, 'time_algorithm_update': 0.005451845169067383, 'loss': 5.066592632770538, 'time_step': 0.0075618095397949215, 'init_value': 20.874618530273438}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:10.05[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020572290420532227, 'time_algorithm_update': 0.005452729701995849, 'loss': 5.753778545618057, 'time_step': 0.007561427116394043, 'init_value': 27.69910430908203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:10.14[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039275884628296, 'time_algorithm_update': 0.005426648378372192, 'loss': 5.991182805538178, 'time_step': 0.0075172891616821285, 'init_value': 33.909637451171875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:10.23[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020777978897094725, 'time_algorithm_update': 0.005501004219055175, 'loss': 6.94808921790123, 'time_step': 0.007631809234619141, 'init_value': 41.661216735839844}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:10.32[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020517785549163817, 'time_algorithm_update': 0.005452990770339966, 'loss': 8.017200309038163, 'time_step': 0.007556715488433838, 'init_value': 47.345176696777344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:10.41[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553205013275145, 'time_algorithm_update': 0.005448948621749878, 'loss': 9.05560545682907, 'time_step': 0.007555703163146973, 'init_value': 52.484222412109375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:10.50[0m [[32m[1minfo     [0m] [1mFQE_20250505210919: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020533056259155274, 'time_algorithm_update': 0.005444472074508667, 'loss': 10.212682185411452, 'time_step': 0.007549376487731934, 'init_value': 58.31618118286133}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.31618118286133
avg return on 5 trajectories of agent9: 914.6275653333333
Episode generator created
[2m2025-05-05 21:10.53[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:10.53[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:10.53[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:10.53[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:10.53[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211053[0m
[2m2025-05-05 21:10.53[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:11.02[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020543854236602785, 'time_algorithm_update': 0.005438740968704224, 'loss': 1.5804374926686287, 'time_step': 0.007544664144515992, 'init_value': 3.674959659576416}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:11.11[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020527331829071046, 'time_algorithm_update': 0.005438920259475708, 'loss': 3.8925678173303604, 'time_step': 0.00754315972328186, 'init_value': 8.632079124450684}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:11.21[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020534703731536867, 'time_algorithm_update': 0.005455366611480713, 'loss': 4.907936606407166, 'time_step': 0.0075605535507202145, 'init_value': 14.181910514831543}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:11.30[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020525121688842775, 'time_algorithm_update': 0.005453956842422485, 'loss': 5.328467477560043, 'time_step': 0.007558103084564209, 'init_value': 20.479780197143555}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:11.39[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020426177978515626, 'time_algorithm_update': 0.0054292833805084225, 'loss': 6.0116729445457455, 'time_step': 0.00752241849899292, 'init_value': 28.80952262878418}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:11.48[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050236463546753, 'time_algorithm_update': 0.005449443578720093, 'loss': 6.70533661365509, 'time_step': 0.007550869941711426, 'init_value': 34.89421844482422}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:11.57[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055121660232544, 'time_algorithm_update': 0.005451701641082764, 'loss': 7.491698668241501, 'time_step': 0.007558126926422119, 'init_value': 41.48618698120117}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:12.06[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051245927810669, 'time_algorithm_update': 0.005435556888580322, 'loss': 8.479469841480254, 'time_step': 0.007537909746170044, 'init_value': 46.0689582824707}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:12.15[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020564048290252685, 'time_algorithm_update': 0.00545208740234375, 'loss': 9.401220058441162, 'time_step': 0.007560157775878906, 'init_value': 53.65959167480469}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:12.24[0m [[32m[1minfo     [0m] [1mFQE_20250505211053: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020537896156311037, 'time_algorithm_update': 0.005441508054733276, 'loss': 10.615366429567336, 'time_step': 0.007546720027923584, 'init_value': 59.528709411621094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 59.528709411621094
avg return on 5 trajectories of agent10: 923.5157143333332
Episode generator created
[2m2025-05-05 21:12.27[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:12.27[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:12.27[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:12.27[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:12.27[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211227[0m
[2m2025-05-05 21:12.27[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:12.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047163009643555, 'time_algorithm_update': 0.005429276466369629, 'loss': 1.628390380129218, 'time_step': 0.007528035163879394, 'init_value': 3.7754838466644287}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:12.45[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020595405101776123, 'time_algorithm_update': 0.005443040132522583, 'loss': 3.9375102001428606, 'time_step': 0.0075545599460601805, 'init_value': 9.469160079956055}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:12.55[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020616800785064698, 'time_algorithm_update': 0.00545935583114624, 'loss': 4.792881356716156, 'time_step': 0.007572852373123169, 'init_value': 15.682720184326172}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:13.04[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020522375106811525, 'time_algorithm_update': 0.005431530714035035, 'loss': 5.327460657119751, 'time_step': 0.007535033702850342, 'init_value': 21.88274383544922}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:13.13[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020638091564178468, 'time_algorithm_update': 0.0054653799533843994, 'loss': 5.758386459112168, 'time_step': 0.007580851078033447, 'init_value': 27.655643463134766}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:13.22[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020682759284973143, 'time_algorithm_update': 0.005454939365386963, 'loss': 6.209663056850434, 'time_step': 0.007574410676956177, 'init_value': 34.352352142333984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:13.31[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020676543712615965, 'time_algorithm_update': 0.00544901704788208, 'loss': 6.763494302988052, 'time_step': 0.00756826663017273, 'init_value': 39.88762283325195}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:13.40[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067426443099976, 'time_algorithm_update': 0.0054565219879150395, 'loss': 7.351766654253006, 'time_step': 0.007576061248779297, 'init_value': 43.443878173828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:13.49[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020733346939086914, 'time_algorithm_update': 0.005473323345184326, 'loss': 8.40223745393753, 'time_step': 0.007598700761795044, 'init_value': 46.88239288330078}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:13.58[0m [[32m[1minfo     [0m] [1mFQE_20250505211227: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058474063873291, 'time_algorithm_update': 0.00543813419342041, 'loss': 8.487178148508072, 'time_step': 0.007548203945159912, 'init_value': 51.13555145263672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.13555145263672
avg return on 5 trajectories of agent11: 909.1052353333333
Episode generator created
[2m2025-05-05 21:14.01[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:14.01[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:14.01[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:14.01[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:14.01[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211401[0m
[2m2025-05-05 21:14.01[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:14.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020545027256011965, 'time_algorithm_update': 0.0054314789772033694, 'loss': 1.6084523865431548, 'time_step': 0.007537567615509033, 'init_value': 3.6552250385284424}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:14.19[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053224563598633, 'time_algorithm_update': 0.005437389850616455, 'loss': 4.043837322235108, 'time_step': 0.007542311191558838, 'init_value': 9.01900863647461}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:14.29[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053455591201782, 'time_algorithm_update': 0.005436762094497681, 'loss': 4.7049653887748715, 'time_step': 0.007541952848434448, 'init_value': 13.876683235168457}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:14.38[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058766603469849, 'time_algorithm_update': 0.0054391188621520994, 'loss': 5.003022867679596, 'time_step': 0.007548955440521241, 'init_value': 20.55844497680664}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:14.47[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536715984344482, 'time_algorithm_update': 0.005441174745559692, 'loss': 5.605733101129532, 'time_step': 0.007546185731887817, 'init_value': 26.01778221130371}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:14.56[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020603911876678465, 'time_algorithm_update': 0.0054317786693573, 'loss': 6.209442815542221, 'time_step': 0.007543463706970215, 'init_value': 33.778594970703125}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:15.05[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020496561527252196, 'time_algorithm_update': 0.005430977344512939, 'loss': 6.8850313692092895, 'time_step': 0.007531782865524292, 'init_value': 41.42088317871094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:15.14[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052069425582886, 'time_algorithm_update': 0.005444578886032105, 'loss': 8.310469982862472, 'time_step': 0.00754780125617981, 'init_value': 46.797183990478516}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:15.23[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020501084327697754, 'time_algorithm_update': 0.005426777362823486, 'loss': 9.819953070878983, 'time_step': 0.007527945280075074, 'init_value': 54.04427719116211}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:15.32[0m [[32m[1minfo     [0m] [1mFQE_20250505211401: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051973581314087, 'time_algorithm_update': 0.005438066959381103, 'loss': 10.453362349271774, 'time_step': 0.00754118800163269, 'init_value': 59.730716705322266}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 59.730716705322266
avg return on 5 trajectories of agent12: 941.7415686666667
Episode generator created
[2m2025-05-05 21:15.35[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:15.35[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:15.35[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:15.35[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:15.35[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211535[0m
[2m2025-05-05 21:15.35[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:15.44[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020462443828582763, 'time_algorithm_update': 0.005441303730010986, 'loss': 1.71212518876791, 'time_step': 0.00754029369354248, 'init_value': 3.839557647705078}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:15.53[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020164949893951415, 'time_algorithm_update': 0.005382200717926025, 'loss': 3.8105793553590774, 'time_step': 0.007449394464492798, 'init_value': 9.05424690246582}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:16.02[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020276837348937988, 'time_algorithm_update': 0.005387408256530762, 'loss': 4.610291685819626, 'time_step': 0.0074657082557678224, 'init_value': 14.809309005737305}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:16.11[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020265398025512697, 'time_algorithm_update': 0.005383234739303589, 'loss': 5.099079570889473, 'time_step': 0.007460479259490967, 'init_value': 20.792034149169922}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:16.20[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020242574214935304, 'time_algorithm_update': 0.005389639139175415, 'loss': 5.060856779694557, 'time_step': 0.007464340925216675, 'init_value': 26.684040069580078}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:16.29[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002028898477554321, 'time_algorithm_update': 0.0053934381008148196, 'loss': 5.773183373689651, 'time_step': 0.0074726793766021725, 'init_value': 34.23965072631836}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:16.38[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053220510482788, 'time_algorithm_update': 0.00546702241897583, 'loss': 7.182788836479187, 'time_step': 0.007572015047073364, 'init_value': 41.03403854370117}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:16.47[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020554330348968508, 'time_algorithm_update': 0.005472952365875244, 'loss': 7.334102456331253, 'time_step': 0.007579805374145508, 'init_value': 42.50449752807617}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:16.56[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020549647808074953, 'time_algorithm_update': 0.005461642265319824, 'loss': 8.115699863910676, 'time_step': 0.0075678017139434815, 'init_value': 49.35012435913086}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:17.05[0m [[32m[1minfo     [0m] [1mFQE_20250505211535: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042182445526123, 'time_algorithm_update': 0.005454425811767578, 'loss': 9.326494032621383, 'time_step': 0.007547947883605957, 'init_value': 54.42790603637695}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.42790603637695
avg return on 5 trajectories of agent13: 1020.7821686666666
Episode generator created
[2m2025-05-05 21:17.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:17.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:17.09[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:17.09[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:17.09[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211709[0m
[2m2025-05-05 21:17.09[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:17.18[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002078012943267822, 'time_algorithm_update': 0.005502388477325439, 'loss': 1.5969811511039733, 'time_step': 0.00763309121131897, 'init_value': 3.617260694503784}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:17.27[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020480170249938963, 'time_algorithm_update': 0.005435505390167236, 'loss': 3.7923924415111543, 'time_step': 0.007534839391708374, 'init_value': 7.713380813598633}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:17.36[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020477161407470705, 'time_algorithm_update': 0.005442556381225586, 'loss': 4.609346240997314, 'time_step': 0.007541701316833496, 'init_value': 14.021970748901367}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:17.45[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053233861923218, 'time_algorithm_update': 0.0054492132663726805, 'loss': 5.034996183872223, 'time_step': 0.0075535705089569095, 'init_value': 19.902589797973633}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:17.54[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205361008644104, 'time_algorithm_update': 0.005451249122619629, 'loss': 5.767954437494278, 'time_step': 0.007556461334228516, 'init_value': 27.35816764831543}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:18.03[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049232482910156, 'time_algorithm_update': 0.0054404456615448, 'loss': 6.412939357280731, 'time_step': 0.007541055917739868, 'init_value': 34.03334426879883}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:18.12[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020533795356750487, 'time_algorithm_update': 0.005462073564529419, 'loss': 7.210033748149872, 'time_step': 0.007567296028137207, 'init_value': 40.896358489990234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:18.21[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020563890933990477, 'time_algorithm_update': 0.005448613882064819, 'loss': 8.352401838302612, 'time_step': 0.007556225538253784, 'init_value': 48.0725212097168}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:18.30[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052058219909668, 'time_algorithm_update': 0.00543387508392334, 'loss': 8.837260443210601, 'time_step': 0.007536863803863526, 'init_value': 53.331111907958984}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:18.39[0m [[32m[1minfo     [0m] [1mFQE_20250505211709: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020669500827789305, 'time_algorithm_update': 0.005450881004333496, 'loss': 10.262458619117737, 'time_step': 0.0075691847801208495, 'init_value': 58.351295471191406}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.351295471191406
avg return on 5 trajectories of agent14: 1053.9123273333335
Episode generator created
[2m2025-05-05 21:18.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:18.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:18.43[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:18.43[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:18.43[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505211843[0m
[2m2025-05-05 21:18.43[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:18.52[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020407040119171144, 'time_algorithm_update': 0.005394697189331055, 'loss': 1.61652316211164, 'time_step': 0.007486116170883178, 'init_value': 3.3595192432403564}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:19.01[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453650951385498, 'time_algorithm_update': 0.005424360752105713, 'loss': 3.9297435866594315, 'time_step': 0.007521050691604614, 'init_value': 8.573590278625488}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:19.10[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020573132038116454, 'time_algorithm_update': 0.005422343015670777, 'loss': 4.6403770565986635, 'time_step': 0.007530848026275635, 'init_value': 14.305986404418945}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:19.19[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020489063262939455, 'time_algorithm_update': 0.005418546199798584, 'loss': 5.303921709537506, 'time_step': 0.007518196105957031, 'init_value': 21.192543029785156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:19.28[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206089186668396, 'time_algorithm_update': 0.005418262004852295, 'loss': 5.78153306722641, 'time_step': 0.007529806852340698, 'init_value': 28.47865867614746}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:19.37[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020505948066711424, 'time_algorithm_update': 0.005417664527893066, 'loss': 6.608310819625855, 'time_step': 0.007519203186035156, 'init_value': 34.10527420043945}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:19.46[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059461832046509, 'time_algorithm_update': 0.005427283525466919, 'loss': 6.947740176677704, 'time_step': 0.007537924528121949, 'init_value': 38.61968231201172}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:19.55[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020458643436431887, 'time_algorithm_update': 0.00540384030342102, 'loss': 7.280906860113144, 'time_step': 0.007500160932540894, 'init_value': 45.106441497802734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:20.04[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055135011672974, 'time_algorithm_update': 0.005415931463241577, 'loss': 8.423439757108689, 'time_step': 0.00752225136756897, 'init_value': 48.28110885620117}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:20.13[0m [[32m[1minfo     [0m] [1mFQE_20250505211843: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020514070987701417, 'time_algorithm_update': 0.005401133060455322, 'loss': 8.98753869509697, 'time_step': 0.007503281354904175, 'init_value': 51.618343353271484}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.618343353271484
avg return on 5 trajectories of agent15: 988.0368946666667
Episode generator created
[2m2025-05-05 21:20.16[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:20.16[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:20.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:20.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:20.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212016[0m
[2m2025-05-05 21:20.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:20.25[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037492513656616, 'time_algorithm_update': 0.005422912120819092, 'loss': 1.620817033752799, 'time_step': 0.007511430501937867, 'init_value': 3.7463865280151367}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:20.34[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020462758541107177, 'time_algorithm_update': 0.00543288254737854, 'loss': 3.778659110069275, 'time_step': 0.007530730962753296, 'init_value': 8.619739532470703}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:20.43[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020503818988800047, 'time_algorithm_update': 0.00543243408203125, 'loss': 4.456362200975418, 'time_step': 0.007534375667572021, 'init_value': 14.84354019165039}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:20.52[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002066422700881958, 'time_algorithm_update': 0.005475042343139648, 'loss': 4.756630250811577, 'time_step': 0.007593516111373901, 'init_value': 20.682865142822266}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:21.01[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020509700775146484, 'time_algorithm_update': 0.00543923568725586, 'loss': 5.540920823216438, 'time_step': 0.007541416406631469, 'init_value': 28.566164016723633}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:21.10[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050785779953003, 'time_algorithm_update': 0.0054482583999633785, 'loss': 6.355295562028885, 'time_step': 0.007550713062286377, 'init_value': 34.56361389160156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:21.19[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046222925186157, 'time_algorithm_update': 0.005433938980102539, 'loss': 6.976658495426178, 'time_step': 0.0075314102172851565, 'init_value': 42.071346282958984}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:21.28[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020569138526916504, 'time_algorithm_update': 0.0054423661231994625, 'loss': 7.911362923145294, 'time_step': 0.007550782680511474, 'init_value': 45.366756439208984}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:21.37[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020488011837005615, 'time_algorithm_update': 0.00544046950340271, 'loss': 8.932096688985824, 'time_step': 0.007541269540786743, 'init_value': 53.17458724975586}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:21.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212016: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020593059062957763, 'time_algorithm_update': 0.005438344001770019, 'loss': 10.052378000974656, 'time_step': 0.007549327611923218, 'init_value': 57.07799530029297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.07799530029297
avg return on 5 trajectories of agent16: 988.4587906666666
Episode generator created
[2m2025-05-05 21:21.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:21.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:21.50[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:21.50[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:21.50[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212150[0m
[2m2025-05-05 21:21.50[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:21.59[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020420048236846925, 'time_algorithm_update': 0.0054277262687683105, 'loss': 1.6400892385840415, 'time_step': 0.007521293163299561, 'init_value': 4.116222858428955}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:22.08[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041266918182373, 'time_algorithm_update': 0.005426488876342774, 'loss': 3.95592287504673, 'time_step': 0.007519109010696411, 'init_value': 9.587883949279785}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:22.17[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036092519760132, 'time_algorithm_update': 0.005419430494308472, 'loss': 4.583591906666756, 'time_step': 0.0075066394805908205, 'init_value': 15.559346199035645}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:22.26[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046609401702881, 'time_algorithm_update': 0.005436969041824341, 'loss': 5.2407062237262725, 'time_step': 0.007534513950347901, 'init_value': 22.009998321533203}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:22.35[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045520544052124, 'time_algorithm_update': 0.00543146800994873, 'loss': 5.768603489398957, 'time_step': 0.007528194904327393, 'init_value': 29.54120445251465}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:22.44[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053005933761597, 'time_algorithm_update': 0.005421808958053589, 'loss': 6.364557958602905, 'time_step': 0.0075261383056640626, 'init_value': 35.205810546875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:22.53[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020520169734954833, 'time_algorithm_update': 0.005435462474822998, 'loss': 6.984478430986404, 'time_step': 0.007538810014724732, 'init_value': 41.445899963378906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:23.02[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055793762207031, 'time_algorithm_update': 0.005437001705169677, 'loss': 7.812042153596878, 'time_step': 0.007544201135635376, 'init_value': 47.04560089111328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:23.11[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040881872177124, 'time_algorithm_update': 0.005420697927474976, 'loss': 9.582376733541489, 'time_step': 0.007512694835662842, 'init_value': 51.00322723388672}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:23.20[0m [[32m[1minfo     [0m] [1mFQE_20250505212150: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451767444610598, 'time_algorithm_update': 0.005436363697052002, 'loss': 10.382062366008759, 'time_step': 0.007533015251159668, 'init_value': 57.54991149902344}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.54991149902344
avg return on 5 trajectories of agent17: 895.517206
Episode generator created
[2m2025-05-05 21:23.23[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:23.23[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:23.23[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:23.23[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:23.23[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212323[0m
[2m2025-05-05 21:23.23[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:23.32[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00203937029838562, 'time_algorithm_update': 0.005422149419784546, 'loss': 1.6251580469757319, 'time_step': 0.007512687921524048, 'init_value': 3.718538999557495}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:23.41[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037928819656372, 'time_algorithm_update': 0.005438037872314453, 'loss': 3.9459085656404493, 'time_step': 0.007526766538619995, 'init_value': 8.863310813903809}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:23.50[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020424749851226808, 'time_algorithm_update': 0.0054572134017944335, 'loss': 4.7831695860624315, 'time_step': 0.007550703287124634, 'init_value': 15.493149757385254}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:24.00[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049187660217285, 'time_algorithm_update': 0.005457889318466186, 'loss': 5.604811517238617, 'time_step': 0.007558031558990479, 'init_value': 22.279178619384766}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:24.09[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020397961139678954, 'time_algorithm_update': 0.005447160482406616, 'loss': 5.627707340717316, 'time_step': 0.007538076162338257, 'init_value': 29.187044143676758}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:24.18[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020795061588287354, 'time_algorithm_update': 0.005527705430984497, 'loss': 6.244005540847779, 'time_step': 0.007659794807434082, 'init_value': 34.448455810546875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:24.27[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020595095157623293, 'time_algorithm_update': 0.005471617460250855, 'loss': 7.23740696144104, 'time_step': 0.0075825765132904056, 'init_value': 38.793609619140625}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:24.36[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040213108062744, 'time_algorithm_update': 0.0054380733966827395, 'loss': 7.638591498613358, 'time_step': 0.00752916955947876, 'init_value': 43.96861267089844}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:24.45[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050875902175903, 'time_algorithm_update': 0.005452688217163086, 'loss': 7.986453779935837, 'time_step': 0.0075553045272827146, 'init_value': 46.722286224365234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:24.54[0m [[32m[1minfo     [0m] [1mFQE_20250505212323: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453267097473144, 'time_algorithm_update': 0.00544301724433899, 'loss': 8.23617518877983, 'time_step': 0.007539284944534302, 'init_value': 51.373573303222656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.373573303222656
avg return on 5 trajectories of agent18: 1040.9066723333333
Episode generator created
[2m2025-05-05 21:24.57[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:24.57[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:24.57[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:24.57[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:24.57[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212457[0m
[2m2025-05-05 21:24.57[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:25.06[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020462512969970704, 'time_algorithm_update': 0.005410133361816406, 'loss': 1.6347233121544122, 'time_step': 0.0075076079368591305, 'init_value': 4.674055099487305}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:25.15[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020541574954986573, 'time_algorithm_update': 0.005419213771820069, 'loss': 3.851707939386368, 'time_step': 0.0075249428749084475, 'init_value': 8.777704238891602}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:25.24[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020531466007232668, 'time_algorithm_update': 0.005424201726913452, 'loss': 4.501063237667084, 'time_step': 0.00752886438369751, 'init_value': 15.00424861907959}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:25.33[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206593918800354, 'time_algorithm_update': 0.0054322855472564695, 'loss': 5.443797956466675, 'time_step': 0.007549474716186524, 'init_value': 21.666217803955078}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:25.42[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057548522949219, 'time_algorithm_update': 0.005439472436904907, 'loss': 5.997952977418899, 'time_step': 0.0075488312244415285, 'init_value': 28.94855499267578}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:25.52[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020575950145721436, 'time_algorithm_update': 0.005431195020675659, 'loss': 6.863904170513153, 'time_step': 0.007540189743041993, 'init_value': 33.8868293762207}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:26.01[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020515244007110597, 'time_algorithm_update': 0.0054177985191345215, 'loss': 6.842189159154892, 'time_step': 0.0075204455852508545, 'init_value': 40.161651611328125}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:26.10[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002012108325958252, 'time_algorithm_update': 0.005339868307113647, 'loss': 8.128720219135284, 'time_step': 0.007402020215988159, 'init_value': 48.491546630859375}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:26.19[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002033609867095947, 'time_algorithm_update': 0.005356798648834229, 'loss': 9.34591545701027, 'time_step': 0.007441242933273315, 'init_value': 53.40049743652344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:26.27[0m [[32m[1minfo     [0m] [1mFQE_20250505212457: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002038959503173828, 'time_algorithm_update': 0.005364905834197998, 'loss': 10.134339910984039, 'time_step': 0.007454951763153076, 'init_value': 54.9273567199707}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.9273567199707
avg return on 5 trajectories of agent19: 1010.1736113333333
Episode generator created
[2m2025-05-05 21:26.30[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:26.30[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:26.31[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:26.31[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:26.31[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212631[0m
[2m2025-05-05 21:26.31[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:26.40[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020219478607177736, 'time_algorithm_update': 0.005344355344772339, 'loss': 1.6807636920064688, 'time_step': 0.007416452407836914, 'init_value': 3.7560486793518066}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:26.49[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020735201835632325, 'time_algorithm_update': 0.005461935758590698, 'loss': 4.258900354623795, 'time_step': 0.0075869417190551755, 'init_value': 9.322733879089355}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:26.58[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020632245540618895, 'time_algorithm_update': 0.0054549572467803955, 'loss': 4.8353239693641665, 'time_step': 0.00756991171836853, 'init_value': 15.527792930603027}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:27.07[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020551223754882815, 'time_algorithm_update': 0.00545228123664856, 'loss': 5.317590892791748, 'time_step': 0.007558960676193238, 'init_value': 22.12647247314453}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:27.16[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020610971450805665, 'time_algorithm_update': 0.005461626291275025, 'loss': 5.638919871330261, 'time_step': 0.007574544906616211, 'init_value': 27.055225372314453}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:27.25[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204840874671936, 'time_algorithm_update': 0.00543297529220581, 'loss': 6.041496314525604, 'time_step': 0.0075325813293457035, 'init_value': 33.89211654663086}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:27.34[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057934045791626, 'time_algorithm_update': 0.005449442386627197, 'loss': 6.96567289352417, 'time_step': 0.0075591177940368655, 'init_value': 41.284156799316406}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:27.43[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205645751953125, 'time_algorithm_update': 0.005453461647033691, 'loss': 8.040692965745926, 'time_step': 0.007561483144760132, 'init_value': 46.77159118652344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:27.52[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00207002329826355, 'time_algorithm_update': 0.005490040063858032, 'loss': 8.64542416715622, 'time_step': 0.0076125648021698, 'init_value': 50.66255569458008}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:28.01[0m [[32m[1minfo     [0m] [1mFQE_20250505212631: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536785125732423, 'time_algorithm_update': 0.005462374448776245, 'loss': 9.516598967790603, 'time_step': 0.007567995071411133, 'init_value': 54.578369140625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.578369140625
ave advantage rew: 55.08104286193848, std: 2.6870635298218883
avg cum rews: 951.3830173833334, std: 56.57270249831576
Pearson correlation coefficient: -0.08492879891268328
Spearman correlation coefficient: 0.02406015037593985
Kendall Tau correlation coefficient: 0.010526315789473684
the best agent: 11, best agent cum rewards: 909.1052353333333
1964
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.017755993502892024
avg return on 5 trajectories of agent0: 868.5063966666667
Episode generator created
[2m2025-05-05 21:28.24[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:28.24[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:28.24[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:28.24[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:28.24[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212824[0m
[2m2025-05-05 21:28.24[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:28.33[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568983554840087, 'time_algorithm_update': 0.005436603784561157, 'loss': 1.6309443537443877, 'time_step': 0.007544984102249145, 'init_value': 3.348231077194214}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:28.42[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050185203552246, 'time_algorithm_update': 0.0054517450332641606, 'loss': 3.821673995375633, 'time_step': 0.007553956747055054, 'init_value': 7.67850399017334}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:28.51[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020534205436706543, 'time_algorithm_update': 0.0054411935806274415, 'loss': 4.40075845015049, 'time_step': 0.007545779466629029, 'init_value': 13.598000526428223}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:29.00[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055882215499878, 'time_algorithm_update': 0.0054592764377594, 'loss': 5.196242871046066, 'time_step': 0.007566773653030395, 'init_value': 19.49623680114746}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:29.09[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020456340312957765, 'time_algorithm_update': 0.005450622797012329, 'loss': 5.665574586868286, 'time_step': 0.007547631740570069, 'init_value': 26.24230194091797}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:29.18[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061539649963379, 'time_algorithm_update': 0.0054639303684234615, 'loss': 6.071384521842003, 'time_step': 0.0075768883228302004, 'init_value': 32.323787689208984}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:29.27[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020622458457946777, 'time_algorithm_update': 0.005460576295852661, 'loss': 6.620492925882339, 'time_step': 0.007574224948883056, 'init_value': 38.01874542236328}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:29.36[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054110288619995, 'time_algorithm_update': 0.00546241545677185, 'loss': 7.410447969913482, 'time_step': 0.0075682497024536135, 'init_value': 41.64482879638672}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:29.46[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020511324405670167, 'time_algorithm_update': 0.005467246770858764, 'loss': 8.30955141878128, 'time_step': 0.007569642543792725, 'init_value': 47.25751495361328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:29.55[0m [[32m[1minfo     [0m] [1mFQE_20250505212824: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053912878036499, 'time_algorithm_update': 0.00546380615234375, 'loss': 9.53763370513916, 'time_step': 0.007569361448287964, 'init_value': 52.52531814575195}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.52531814575195
avg return on 5 trajectories of agent1: 873.3080483333333
Episode generator created
[2m2025-05-05 21:29.58[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:29.58[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:29.58[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:29.58[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:29.58[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505212958[0m
[2m2025-05-05 21:29.58[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:30.07[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049561023712158, 'time_algorithm_update': 0.005420176029205323, 'loss': 1.5752960647940635, 'time_step': 0.007521502494812012, 'init_value': 3.7305655479431152}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:30.16[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020367195606231688, 'time_algorithm_update': 0.005433254957199097, 'loss': 4.112014271140098, 'time_step': 0.007527713537216187, 'init_value': 8.731566429138184}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:30.25[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060210943222046, 'time_algorithm_update': 0.005449946641921997, 'loss': 4.68170548582077, 'time_step': 0.007562357664108277, 'init_value': 14.940593719482422}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:30.34[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020502707958221437, 'time_algorithm_update': 0.005436490297317505, 'loss': 5.316679089784622, 'time_step': 0.007538659572601318, 'init_value': 21.509260177612305}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:30.43[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020654478073120117, 'time_algorithm_update': 0.005446996212005615, 'loss': 5.545885629415512, 'time_step': 0.007564692258834839, 'init_value': 28.053892135620117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:30.52[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020588641166687013, 'time_algorithm_update': 0.0054433543682098386, 'loss': 6.030153073549271, 'time_step': 0.00755454158782959, 'init_value': 33.91542434692383}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:31.01[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055293560028076, 'time_algorithm_update': 0.0054571137428283695, 'loss': 6.6623603727817535, 'time_step': 0.0075649282932281495, 'init_value': 39.56767272949219}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:31.10[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020568838119506836, 'time_algorithm_update': 0.005447360277175903, 'loss': 7.397923613548278, 'time_step': 0.007556048154830933, 'init_value': 45.377864837646484}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:31.19[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020660712718963622, 'time_algorithm_update': 0.005460278749465942, 'loss': 8.627982505321503, 'time_step': 0.007578873872756958, 'init_value': 50.91588592529297}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:31.29[0m [[32m[1minfo     [0m] [1mFQE_20250505212958: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205591082572937, 'time_algorithm_update': 0.0054435479640960694, 'loss': 9.322995249271393, 'time_step': 0.007551607131958008, 'init_value': 56.11563491821289}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.11563491821289
avg return on 5 trajectories of agent2: 878.0311306666667
Episode generator created
[2m2025-05-05 21:31.32[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:31.32[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:31.32[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:31.32[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:31.32[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213132[0m
[2m2025-05-05 21:31.32[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:31.41[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020488712787628174, 'time_algorithm_update': 0.005443973064422607, 'loss': 1.585160327091813, 'time_step': 0.007544306755065918, 'init_value': 3.862506866455078}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:31.50[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020928735733032225, 'time_algorithm_update': 0.005555638790130615, 'loss': 3.8260994421243666, 'time_step': 0.007702298402786255, 'init_value': 8.735269546508789}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:31.59[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020474941730499268, 'time_algorithm_update': 0.005444339752197266, 'loss': 4.597959201574326, 'time_step': 0.0075431432723999025, 'init_value': 14.442276000976562}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:32.08[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020585236549377443, 'time_algorithm_update': 0.005477459907531739, 'loss': 5.064851884126663, 'time_step': 0.007587831735610962, 'init_value': 19.87910270690918}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:32.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020652379989624025, 'time_algorithm_update': 0.005469966650009156, 'loss': 5.409274128198624, 'time_step': 0.007589234113693237, 'init_value': 26.27689552307129}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:32.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536038875579835, 'time_algorithm_update': 0.00544810676574707, 'loss': 5.833206101417542, 'time_step': 0.007553250312805176, 'init_value': 31.798564910888672}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:32.36[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020525901317596435, 'time_algorithm_update': 0.0054646506309509275, 'loss': 6.553000805139542, 'time_step': 0.007569258689880371, 'init_value': 36.012718200683594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:32.45[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020501561164855955, 'time_algorithm_update': 0.005457309961318969, 'loss': 7.342248540639877, 'time_step': 0.007559233188629151, 'init_value': 41.90998077392578}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:32.54[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020590381622314453, 'time_algorithm_update': 0.005465798854827881, 'loss': 8.470131039619446, 'time_step': 0.007576701402664185, 'init_value': 49.14846420288086}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:33.03[0m [[32m[1minfo     [0m] [1mFQE_20250505213132: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055176019668579, 'time_algorithm_update': 0.005457545518875122, 'loss': 9.356779116153717, 'time_step': 0.00756479001045227, 'init_value': 54.482391357421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.482391357421875
avg return on 5 trajectories of agent3: 857.4198636666666
Episode generator created
[2m2025-05-05 21:33.06[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:33.06[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:33.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:33.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:33.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213306[0m
[2m2025-05-05 21:33.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:33.15[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020465245246887205, 'time_algorithm_update': 0.005429027795791626, 'loss': 1.6077531004846095, 'time_step': 0.007527275800704956, 'init_value': 3.64560604095459}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:33.24[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020310134887695313, 'time_algorithm_update': 0.005415167808532715, 'loss': 4.042672600269317, 'time_step': 0.007497496128082275, 'init_value': 8.718931198120117}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:33.33[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020426597595214844, 'time_algorithm_update': 0.005439468145370483, 'loss': 4.578184082865715, 'time_step': 0.007533904075622559, 'init_value': 13.933300971984863}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:33.42[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020432376861572264, 'time_algorithm_update': 0.005440844297409058, 'loss': 5.079926457881927, 'time_step': 0.007535549640655517, 'init_value': 19.722795486450195}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:33.51[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020304813385009766, 'time_algorithm_update': 0.0054367811679840086, 'loss': 5.656261441230774, 'time_step': 0.007518407344818115, 'init_value': 27.30418586730957}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:34.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020464138984680174, 'time_algorithm_update': 0.0054683201313018796, 'loss': 6.20119102025032, 'time_step': 0.007566638946533203, 'init_value': 32.919044494628906}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:34.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020460112094879152, 'time_algorithm_update': 0.005458439588546753, 'loss': 6.581168280124665, 'time_step': 0.0075565407276153565, 'init_value': 38.39115905761719}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:34.18[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020428528785705565, 'time_algorithm_update': 0.005452007293701172, 'loss': 7.366621119022369, 'time_step': 0.00754665732383728, 'init_value': 44.038429260253906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:34.27[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020413410663604734, 'time_algorithm_update': 0.005457755327224732, 'loss': 9.104244614839553, 'time_step': 0.007550893068313599, 'init_value': 50.51921844482422}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:34.37[0m [[32m[1minfo     [0m] [1mFQE_20250505213306: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453102588653565, 'time_algorithm_update': 0.005455132484436035, 'loss': 9.065721993207932, 'time_step': 0.007552249193191528, 'init_value': 54.48911666870117}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.48911666870117
avg return on 5 trajectories of agent4: 916.0744500000001
Episode generator created
[2m2025-05-05 21:34.40[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:34.40[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:34.40[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:34.40[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:34.40[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213440[0m
[2m2025-05-05 21:34.40[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:34.49[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020699431896209716, 'time_algorithm_update': 0.005486359357833862, 'loss': 1.5507491240724922, 'time_step': 0.0076093790531158445, 'init_value': 2.909210443496704}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:34.58[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020562963485717773, 'time_algorithm_update': 0.005440269231796265, 'loss': 3.773390159368515, 'time_step': 0.007548588991165161, 'init_value': 7.209930419921875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:35.07[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020530970096588135, 'time_algorithm_update': 0.005440270185470581, 'loss': 4.634575321555138, 'time_step': 0.007545508861541748, 'init_value': 13.3009614944458}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:35.16[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048701286315918, 'time_algorithm_update': 0.005436113595962524, 'loss': 5.083245846033097, 'time_step': 0.007536375045776368, 'init_value': 20.064071655273438}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:35.25[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052715539932251, 'time_algorithm_update': 0.005443934917449951, 'loss': 5.850901092529297, 'time_step': 0.007548224449157715, 'init_value': 26.826847076416016}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:35.34[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020647804737091062, 'time_algorithm_update': 0.0054482741355896, 'loss': 6.2798416292667385, 'time_step': 0.0075648148059844975, 'init_value': 32.66627883911133}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:35.43[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493526458740235, 'time_algorithm_update': 0.005435640811920166, 'loss': 6.666172623157501, 'time_step': 0.007536075830459595, 'init_value': 38.76482009887695}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:35.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054401397705078, 'time_algorithm_update': 0.005439999103546142, 'loss': 7.376804548978805, 'time_step': 0.007545992136001587, 'init_value': 43.45824432373047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:36.01[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059720039367676, 'time_algorithm_update': 0.0054383018016815185, 'loss': 8.281468750715256, 'time_step': 0.007549815893173218, 'init_value': 48.001651763916016}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:36.10[0m [[32m[1minfo     [0m] [1mFQE_20250505213440: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020435786247253417, 'time_algorithm_update': 0.0054215586185455324, 'loss': 9.389091743469239, 'time_step': 0.007516504049301148, 'init_value': 52.636985778808594}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.636985778808594
avg return on 5 trajectories of agent5: 873.6005156666666
Episode generator created
[2m2025-05-05 21:36.13[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:36.13[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:36.14[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:36.14[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:36.14[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213614[0m
[2m2025-05-05 21:36.14[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:36.23[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002011957883834839, 'time_algorithm_update': 0.005345422983169556, 'loss': 1.6786542321145534, 'time_step': 0.0074077842235565185, 'init_value': 3.8089752197265625}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:36.31[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020227863788604738, 'time_algorithm_update': 0.00534856653213501, 'loss': 4.044905348062516, 'time_step': 0.0074216856956481935, 'init_value': 8.839576721191406}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:36.40[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020202248096466064, 'time_algorithm_update': 0.00535913634300232, 'loss': 4.555460875988007, 'time_step': 0.00743001651763916, 'init_value': 14.743935585021973}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:36.49[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020184719562530515, 'time_algorithm_update': 0.005355433702468872, 'loss': 5.335324023723603, 'time_step': 0.007424240350723267, 'init_value': 21.125011444091797}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:36.58[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020352270603179934, 'time_algorithm_update': 0.005393983125686646, 'loss': 5.612780966281891, 'time_step': 0.00748020076751709, 'init_value': 27.385835647583008}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:37.08[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055213212966919, 'time_algorithm_update': 0.005439906120300293, 'loss': 6.236508759975433, 'time_step': 0.007546391010284424, 'init_value': 33.135719299316406}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:37.17[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020526785850524904, 'time_algorithm_update': 0.005436383008956909, 'loss': 6.555857439994812, 'time_step': 0.007540501832962036, 'init_value': 37.320899963378906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:37.26[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020422368049621584, 'time_algorithm_update': 0.005434986829757691, 'loss': 7.7943921053409575, 'time_step': 0.007529415369033813, 'init_value': 44.156490325927734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:37.35[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020606496334075928, 'time_algorithm_update': 0.005448208093643188, 'loss': 8.523530085086822, 'time_step': 0.0075607972145080565, 'init_value': 49.79252243041992}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:37.44[0m [[32m[1minfo     [0m] [1mFQE_20250505213614: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052981376647949, 'time_algorithm_update': 0.005449425935745239, 'loss': 10.200962818145753, 'time_step': 0.007554224252700806, 'init_value': 54.14461135864258}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.14461135864258
avg return on 5 trajectories of agent6: 947.2555463333333
Episode generator created
[2m2025-05-05 21:37.47[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:37.47[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:37.47[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:37.47[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:37.47[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213747[0m
[2m2025-05-05 21:37.47[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:37.56[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002032695770263672, 'time_algorithm_update': 0.0054187896251678466, 'loss': 1.6653131439238786, 'time_step': 0.007502585887908936, 'init_value': 3.7138173580169678}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:38.05[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042205095291138, 'time_algorithm_update': 0.005439967632293701, 'loss': 4.031782420516014, 'time_step': 0.00753377103805542, 'init_value': 7.941213607788086}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:38.14[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020592637062072754, 'time_algorithm_update': 0.005469241857528687, 'loss': 4.844501282930374, 'time_step': 0.007580570459365845, 'init_value': 14.805963516235352}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:38.23[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081707239151001, 'time_algorithm_update': 0.00553211498260498, 'loss': 5.192947869896889, 'time_step': 0.007667056798934937, 'init_value': 21.063255310058594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:38.32[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020546007156372072, 'time_algorithm_update': 0.005473993301391602, 'loss': 5.779188764333725, 'time_step': 0.007580549001693726, 'init_value': 27.76637077331543}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:38.41[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046400785446167, 'time_algorithm_update': 0.005445487260818481, 'loss': 6.206594154596329, 'time_step': 0.007543350219726562, 'init_value': 33.65714645385742}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:38.50[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020401380062103273, 'time_algorithm_update': 0.00543783450126648, 'loss': 6.810801478147507, 'time_step': 0.007529563665390014, 'init_value': 40.95886993408203}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:39.00[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052565097808838, 'time_algorithm_update': 0.005446872711181641, 'loss': 8.69821144080162, 'time_step': 0.007551057815551758, 'init_value': 47.617431640625}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:39.09[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020432493686676025, 'time_algorithm_update': 0.005436370611190796, 'loss': 9.487493366718292, 'time_step': 0.007530916690826416, 'init_value': 54.944698333740234}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:39.18[0m [[32m[1minfo     [0m] [1mFQE_20250505213747: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041400909423828, 'time_algorithm_update': 0.005457700967788697, 'loss': 10.683549716234207, 'time_step': 0.007551068067550659, 'init_value': 57.85232925415039}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.85232925415039
avg return on 5 trajectories of agent7: 903.2978706666668
Episode generator created
[2m2025-05-05 21:39.21[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:39.21[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:39.21[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:39.21[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:39.21[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505213921[0m
[2m2025-05-05 21:39.21[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:39.30[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020338704586029053, 'time_algorithm_update': 0.0054216358661651615, 'loss': 1.6573682217150927, 'time_step': 0.007506828784942627, 'init_value': 3.8581533432006836}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:39.39[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040597200393677, 'time_algorithm_update': 0.0054442696571350094, 'loss': 4.0314171544313435, 'time_step': 0.007536584615707397, 'init_value': 8.273148536682129}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:39.48[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043933391571045, 'time_algorithm_update': 0.005439323902130127, 'loss': 4.69981638789177, 'time_step': 0.007534544467926025, 'init_value': 13.015725135803223}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:39.57[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020501208305358887, 'time_algorithm_update': 0.005450829982757568, 'loss': 4.9793665680885315, 'time_step': 0.007552940130233765, 'init_value': 18.843618392944336}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:40.06[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020519750118255615, 'time_algorithm_update': 0.005455923080444336, 'loss': 5.47634804391861, 'time_step': 0.0075600135326385496, 'init_value': 26.070161819458008}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:40.15[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020473732948303224, 'time_algorithm_update': 0.005451758623123169, 'loss': 5.884663560271263, 'time_step': 0.007550654172897339, 'init_value': 32.17732620239258}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:40.24[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020468106269836426, 'time_algorithm_update': 0.005451583623886108, 'loss': 6.320364488124848, 'time_step': 0.007550469160079956, 'init_value': 38.69917678833008}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:40.33[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020461497306823733, 'time_algorithm_update': 0.005429467678070068, 'loss': 7.702044325113296, 'time_step': 0.007526977777481079, 'init_value': 45.873748779296875}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:40.42[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020477612018585207, 'time_algorithm_update': 0.005443891763687134, 'loss': 9.028288985013962, 'time_step': 0.007543747425079346, 'init_value': 51.567710876464844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:40.52[0m [[32m[1minfo     [0m] [1mFQE_20250505213921: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039820671081543, 'time_algorithm_update': 0.005436703443527222, 'loss': 9.978952030658721, 'time_step': 0.00752840781211853, 'init_value': 56.54840087890625}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.54840087890625
avg return on 5 trajectories of agent8: 912.1435506666667
Episode generator created
[2m2025-05-05 21:40.55[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:40.55[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:40.55[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:40.55[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:40.55[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214055[0m
[2m2025-05-05 21:40.55[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:41.04[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020453033447265625, 'time_algorithm_update': 0.005432282686233521, 'loss': 1.6160834068506955, 'time_step': 0.007529083490371704, 'init_value': 3.349959135055542}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:41.13[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042176961898804, 'time_algorithm_update': 0.005437011241912842, 'loss': 3.7959719495773316, 'time_step': 0.00753047513961792, 'init_value': 7.982693672180176}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:41.22[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020530006885528564, 'time_algorithm_update': 0.005442556858062744, 'loss': 4.755275679588318, 'time_step': 0.007547337532043457, 'init_value': 13.71674919128418}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:41.31[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052384614944458, 'time_algorithm_update': 0.005454154253005982, 'loss': 5.20882643532753, 'time_step': 0.007558569192886353, 'init_value': 19.730361938476562}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:41.40[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020481457710266114, 'time_algorithm_update': 0.005446651935577393, 'loss': 5.807372325897217, 'time_step': 0.0075461711883544925, 'init_value': 25.83348846435547}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:41.49[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002056612014770508, 'time_algorithm_update': 0.0054615607261657715, 'loss': 6.1402319676876065, 'time_step': 0.007569931745529175, 'init_value': 32.4963493347168}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:41.58[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020799193382263184, 'time_algorithm_update': 0.0055240366458892826, 'loss': 6.838154693603515, 'time_step': 0.007657295465469361, 'init_value': 38.87150192260742}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:42.07[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073185920715332, 'time_algorithm_update': 0.005505266427993774, 'loss': 7.826987465858459, 'time_step': 0.007631468534469605, 'init_value': 44.050636291503906}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:42.16[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020505928993225096, 'time_algorithm_update': 0.005445998191833496, 'loss': 8.44379136276245, 'time_step': 0.007548201322555542, 'init_value': 49.97591018676758}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:42.25[0m [[32m[1minfo     [0m] [1mFQE_20250505214055: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020470921993255616, 'time_algorithm_update': 0.0054532020092010495, 'loss': 9.614022225141525, 'time_step': 0.007552210569381714, 'init_value': 55.07604217529297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.07604217529297
avg return on 5 trajectories of agent9: 876.247841
Episode generator created
[2m2025-05-05 21:42.28[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:42.28[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:42.29[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:42.29[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:42.29[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214229[0m
[2m2025-05-05 21:42.29[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:42.38[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020409774780273436, 'time_algorithm_update': 0.00541919732093811, 'loss': 1.6364364441484214, 'time_step': 0.007511351108551025, 'init_value': 4.148090362548828}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:42.47[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002066163778305054, 'time_algorithm_update': 0.005438394546508789, 'loss': 3.945329959273338, 'time_step': 0.007556326150894165, 'init_value': 9.023567199707031}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:42.56[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020612063407897947, 'time_algorithm_update': 0.005451744794845581, 'loss': 4.625944574832916, 'time_step': 0.007564951181411744, 'init_value': 14.366179466247559}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:43.05[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020552093982696535, 'time_algorithm_update': 0.005447668552398682, 'loss': 5.407629959344864, 'time_step': 0.007554798364639282, 'init_value': 22.50963020324707}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:43.14[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051368474960327, 'time_algorithm_update': 0.005445237398147583, 'loss': 5.869883847832679, 'time_step': 0.007548584222793579, 'init_value': 29.10441780090332}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:43.23[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047985792160034, 'time_algorithm_update': 0.005432835817337036, 'loss': 6.45989794254303, 'time_step': 0.007532400369644165, 'init_value': 35.673744201660156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:43.32[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205926513671875, 'time_algorithm_update': 0.005457063436508178, 'loss': 7.094691500902176, 'time_step': 0.007569400787353515, 'init_value': 40.66330337524414}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:43.41[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059493064880371, 'time_algorithm_update': 0.005449654340744019, 'loss': 7.595127396345139, 'time_step': 0.007561147451400757, 'init_value': 46.09777069091797}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:43.50[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055842399597168, 'time_algorithm_update': 0.005459491491317749, 'loss': 9.735420067310333, 'time_step': 0.007567612886428833, 'init_value': 54.360809326171875}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:43.59[0m [[32m[1minfo     [0m] [1mFQE_20250505214229: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020605785846710203, 'time_algorithm_update': 0.005445427894592285, 'loss': 10.47613675737381, 'time_step': 0.0075582127571105955, 'init_value': 59.50420379638672}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 59.50420379638672
avg return on 5 trajectories of agent10: 1052.9940566666667
Episode generator created
[2m2025-05-05 21:44.02[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:44.02[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:44.03[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:44.03[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:44.03[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214403[0m
[2m2025-05-05 21:44.03[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:44.12[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493836402893065, 'time_algorithm_update': 0.005435678243637085, 'loss': 1.625536731377244, 'time_step': 0.007536774873733521, 'init_value': 4.233801364898682}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:44.21[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020620918273925783, 'time_algorithm_update': 0.005460453748703003, 'loss': 3.9216552028656007, 'time_step': 0.007574631690979004, 'init_value': 9.138975143432617}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:44.30[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050971508026123, 'time_algorithm_update': 0.005444222211837769, 'loss': 4.803984293460846, 'time_step': 0.007546882629394531, 'init_value': 14.220008850097656}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:44.39[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055034637451172, 'time_algorithm_update': 0.005451485872268676, 'loss': 4.977816945314407, 'time_step': 0.007558398485183716, 'init_value': 20.22673988342285}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:44.48[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002051140785217285, 'time_algorithm_update': 0.005434182167053223, 'loss': 5.667476240158081, 'time_step': 0.007536487579345703, 'init_value': 26.37769889831543}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:44.57[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002052587270736694, 'time_algorithm_update': 0.005441109657287598, 'loss': 5.860135185480118, 'time_step': 0.007545165300369263, 'init_value': 31.892154693603516}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:45.06[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020755441188812255, 'time_algorithm_update': 0.0054581923484802244, 'loss': 6.424353496789932, 'time_step': 0.007585942268371582, 'init_value': 36.43692398071289}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:45.15[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059087038040161, 'time_algorithm_update': 0.00545363712310791, 'loss': 6.893145788908004, 'time_step': 0.007564416408538818, 'init_value': 43.6922721862793}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:45.24[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002062147855758667, 'time_algorithm_update': 0.005462799072265625, 'loss': 8.304068826436996, 'time_step': 0.007576667070388794, 'init_value': 49.07248306274414}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:45.34[0m [[32m[1minfo     [0m] [1mFQE_20250505214403: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020956292152404785, 'time_algorithm_update': 0.005530967473983765, 'loss': 8.843092746973038, 'time_step': 0.007679926633834839, 'init_value': 52.61167907714844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.61167907714844
avg return on 5 trajectories of agent11: 912.1314733333334
Episode generator created
[2m2025-05-05 21:45.37[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:45.37[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:45.37[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:45.37[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:45.37[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214537[0m
[2m2025-05-05 21:45.37[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:45.46[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205415153503418, 'time_algorithm_update': 0.00544987416267395, 'loss': 1.65773919993639, 'time_step': 0.007555804252624512, 'init_value': 3.582646131515503}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:45.55[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020547614097595215, 'time_algorithm_update': 0.0054534759521484375, 'loss': 3.8955074170827864, 'time_step': 0.007559913158416748, 'init_value': 8.66019058227539}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:46.04[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020527553558349607, 'time_algorithm_update': 0.00547662353515625, 'loss': 4.787350230336189, 'time_step': 0.007581172466278076, 'init_value': 15.527325630187988}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:46.13[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020456836223602293, 'time_algorithm_update': 0.005449286222457886, 'loss': 5.442069201231003, 'time_step': 0.007546162605285645, 'init_value': 22.319223403930664}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:46.22[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020271756649017335, 'time_algorithm_update': 0.005418232202529907, 'loss': 5.903085922241211, 'time_step': 0.007495795965194702, 'init_value': 28.55425453186035}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:46.31[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020191545486450196, 'time_algorithm_update': 0.005379895925521851, 'loss': 6.205036547422409, 'time_step': 0.007449560642242432, 'init_value': 32.68817901611328}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:46.40[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020162100791931152, 'time_algorithm_update': 0.005380406856536866, 'loss': 6.765703042268753, 'time_step': 0.007447243928909302, 'init_value': 38.00138473510742}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:46.49[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020260846614837645, 'time_algorithm_update': 0.005395098924636841, 'loss': 7.286106629610062, 'time_step': 0.007472003221511841, 'init_value': 43.18470764160156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:46.58[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002020408630371094, 'time_algorithm_update': 0.0053917615413665776, 'loss': 8.260975513219833, 'time_step': 0.0074629528522491455, 'init_value': 46.30683135986328}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:47.07[0m [[32m[1minfo     [0m] [1mFQE_20250505214537: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002023221492767334, 'time_algorithm_update': 0.005395628452301025, 'loss': 8.958367756843566, 'time_step': 0.007469234704971314, 'init_value': 53.20570373535156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.20570373535156
avg return on 5 trajectories of agent12: 851.6889666666667
Episode generator created
[2m2025-05-05 21:47.10[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:47.10[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:47.10[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:47.10[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:47.10[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214710[0m
[2m2025-05-05 21:47.10[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:47.19[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002043675422668457, 'time_algorithm_update': 0.005426901340484619, 'loss': 1.6796215893775224, 'time_step': 0.007522228240966797, 'init_value': 3.358912467956543}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:47.28[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020555341243743896, 'time_algorithm_update': 0.0054373409748077394, 'loss': 3.9130912882089617, 'time_step': 0.007544622898101806, 'init_value': 8.295960426330566}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:47.37[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047930955886841, 'time_algorithm_update': 0.005441891431808472, 'loss': 4.806342741370201, 'time_step': 0.0075412366390228275, 'init_value': 14.064132690429688}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:47.46[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020554211139678954, 'time_algorithm_update': 0.005433311939239502, 'loss': 5.353118460416794, 'time_step': 0.007540266752243042, 'init_value': 20.915199279785156}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:47.55[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020499515533447268, 'time_algorithm_update': 0.0054385576248168945, 'loss': 5.6740116457939145, 'time_step': 0.007539856195449829, 'init_value': 27.20858383178711}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:48.04[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058990955352783, 'time_algorithm_update': 0.005433820247650147, 'loss': 6.576823917627334, 'time_step': 0.007544342041015625, 'init_value': 34.11214828491211}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:48.13[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053795099258423, 'time_algorithm_update': 0.005432129144668579, 'loss': 6.871766984939575, 'time_step': 0.007537827730178833, 'init_value': 38.346824645996094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:48.23[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054107666015625, 'time_algorithm_update': 0.005448259353637695, 'loss': 8.609040922880173, 'time_step': 0.007554007530212402, 'init_value': 47.169132232666016}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:48.32[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002040735960006714, 'time_algorithm_update': 0.005426101922988892, 'loss': 9.11435390329361, 'time_step': 0.007518203496932984, 'init_value': 48.4633674621582}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:48.41[0m [[32m[1minfo     [0m] [1mFQE_20250505214710: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00205806303024292, 'time_algorithm_update': 0.005443183660507202, 'loss': 10.013038151025771, 'time_step': 0.007553012371063233, 'init_value': 53.56489562988281}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.56489562988281
avg return on 5 trajectories of agent13: 832.52725
Episode generator created
[2m2025-05-05 21:48.44[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:48.44[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:48.44[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:48.44[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:48.44[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505214844[0m
[2m2025-05-05 21:48.44[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:48.53[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020542702674865724, 'time_algorithm_update': 0.005442277669906616, 'loss': 1.564725038409233, 'time_step': 0.007548287391662598, 'init_value': 3.425663709640503}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:49.02[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020643525123596193, 'time_algorithm_update': 0.005467636346817017, 'loss': 3.932584840655327, 'time_step': 0.0075841424465179445, 'init_value': 8.584712982177734}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:49.11[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020451648235321044, 'time_algorithm_update': 0.005432860136032104, 'loss': 4.680034025669098, 'time_step': 0.0075294127464294435, 'init_value': 16.079421997070312}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:49.20[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020521559715270996, 'time_algorithm_update': 0.005441419363021851, 'loss': 5.106616053342819, 'time_step': 0.007545183658599854, 'init_value': 21.22177505493164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:49.29[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493404865264894, 'time_algorithm_update': 0.0054360034465789795, 'loss': 5.703223340272904, 'time_step': 0.0075379061698913575, 'init_value': 29.47614860534668}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:49.38[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020572328567504882, 'time_algorithm_update': 0.005451588153839111, 'loss': 6.120095148324967, 'time_step': 0.007560660600662231, 'init_value': 34.2713623046875}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:49.47[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055519104003906, 'time_algorithm_update': 0.005457390785217285, 'loss': 7.084481234550476, 'time_step': 0.007564760684967041, 'init_value': 40.925148010253906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:49.56[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536346435546873, 'time_algorithm_update': 0.005448453187942505, 'loss': 7.84511633014679, 'time_step': 0.0075535976886749265, 'init_value': 46.6246452331543}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:50.05[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020499584674835204, 'time_algorithm_update': 0.005454575061798096, 'loss': 8.971304342031479, 'time_step': 0.007556495189666748, 'init_value': 51.780941009521484}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:50.15[0m [[32m[1minfo     [0m] [1mFQE_20250505214844: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053685903549194, 'time_algorithm_update': 0.005451846599578858, 'loss': 10.087847833156586, 'time_step': 0.007557374954223633, 'init_value': 57.17272186279297}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.17272186279297
avg return on 5 trajectories of agent14: 921.178355
Episode generator created
[2m2025-05-05 21:50.18[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:50.18[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:50.18[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:50.18[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:50.18[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215018[0m
[2m2025-05-05 21:50.18[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:50.27[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204265832901001, 'time_algorithm_update': 0.005422530889511108, 'loss': 1.6776270088106393, 'time_step': 0.007516816616058349, 'init_value': 3.7039575576782227}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:50.36[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041975975036621, 'time_algorithm_update': 0.005434498786926269, 'loss': 4.203430251955986, 'time_step': 0.007527857542037964, 'init_value': 8.98072338104248}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:50.45[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002049510717391968, 'time_algorithm_update': 0.0054420862197875975, 'loss': 4.819983424663544, 'time_step': 0.007543137788772583, 'init_value': 14.242716789245605}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:50.54[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050175189971924, 'time_algorithm_update': 0.005436273336410523, 'loss': 4.859126559019089, 'time_step': 0.007537772417068481, 'init_value': 20.763084411621094}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:51.03[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020589022636413575, 'time_algorithm_update': 0.00546124005317688, 'loss': 5.262931172966957, 'time_step': 0.007571674108505249, 'init_value': 25.924741744995117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:51.12[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045419454574585, 'time_algorithm_update': 0.0054521307945251465, 'loss': 6.053455493688583, 'time_step': 0.007549200057983398, 'init_value': 33.027435302734375}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:51.21[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020483384132385252, 'time_algorithm_update': 0.005449494123458862, 'loss': 7.065600494384766, 'time_step': 0.007550723314285278, 'init_value': 40.53566360473633}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:51.30[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055820465087891, 'time_algorithm_update': 0.005459782361984253, 'loss': 7.586032970666885, 'time_step': 0.00756747579574585, 'init_value': 42.54308319091797}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:51.39[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020564849376678465, 'time_algorithm_update': 0.005463814735412598, 'loss': 8.056665643692016, 'time_step': 0.007572191715240479, 'init_value': 49.07398223876953}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:51.48[0m [[32m[1minfo     [0m] [1mFQE_20250505215018: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020564701557159422, 'time_algorithm_update': 0.005442267656326294, 'loss': 8.626324360847473, 'time_step': 0.007550703763961792, 'init_value': 52.144569396972656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.144569396972656
avg return on 5 trajectories of agent15: 850.3260433333334
Episode generator created
[2m2025-05-05 21:51.51[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:51.51[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:51.52[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:51.52[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:51.52[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215152[0m
[2m2025-05-05 21:51.52[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:52.01[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020287597179412843, 'time_algorithm_update': 0.00538953161239624, 'loss': 1.542492125198245, 'time_step': 0.007468822002410888, 'init_value': 3.651785373687744}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:52.10[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020486304759979247, 'time_algorithm_update': 0.005412061691284179, 'loss': 3.791970086693764, 'time_step': 0.0075121943950653075, 'init_value': 7.368161201477051}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:52.19[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002031327247619629, 'time_algorithm_update': 0.005406266927719116, 'loss': 4.651121608495712, 'time_step': 0.007488523244857788, 'init_value': 13.285595893859863}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:52.28[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00204605770111084, 'time_algorithm_update': 0.00544510006904602, 'loss': 5.268912864685059, 'time_step': 0.00754280686378479, 'init_value': 19.180448532104492}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:52.37[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020788424015045167, 'time_algorithm_update': 0.0055109021663665774, 'loss': 5.699355275630951, 'time_step': 0.007642905473709107, 'init_value': 26.413066864013672}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:52.46[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002027468681335449, 'time_algorithm_update': 0.005406419038772583, 'loss': 6.097648710489273, 'time_step': 0.007485079526901245, 'init_value': 31.47490882873535}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:52.55[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002037864446640015, 'time_algorithm_update': 0.0054258873462677, 'loss': 6.338963016271591, 'time_step': 0.007515296459197998, 'init_value': 36.71530532836914}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:53.04[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020402352809906006, 'time_algorithm_update': 0.005419425964355469, 'loss': 7.267236619234085, 'time_step': 0.00751128888130188, 'init_value': 42.84784698486328}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:53.13[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020415289402008056, 'time_algorithm_update': 0.005421408414840698, 'loss': 8.442929003238678, 'time_step': 0.007513948917388916, 'init_value': 47.12751770019531}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:53.22[0m [[32m[1minfo     [0m] [1mFQE_20250505215152: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048280477523804, 'time_algorithm_update': 0.005426834106445313, 'loss': 9.028051225423813, 'time_step': 0.007526902914047241, 'init_value': 53.347984313964844}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 53.347984313964844
avg return on 5 trajectories of agent16: 973.4185406666666
Episode generator created
[2m2025-05-05 21:53.25[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:53.25[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:53.25[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:53.25[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:53.25[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215325[0m
[2m2025-05-05 21:53.25[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:53.34[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002036396265029907, 'time_algorithm_update': 0.0054113328456878666, 'loss': 1.6986950798481704, 'time_step': 0.007499404907226562, 'init_value': 4.301121234893799}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:53.43[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002041605234146118, 'time_algorithm_update': 0.005400414943695068, 'loss': 4.041678809404373, 'time_step': 0.007493412017822266, 'init_value': 9.394746780395508}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:53.52[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020438599586486816, 'time_algorithm_update': 0.005412654876708984, 'loss': 4.83057742524147, 'time_step': 0.007508115530014038, 'init_value': 13.82652759552002}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:54.01[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020454270839691162, 'time_algorithm_update': 0.005412862539291382, 'loss': 5.0757642639875415, 'time_step': 0.0075093541145324705, 'init_value': 18.957027435302734}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:54.11[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042001962661743, 'time_algorithm_update': 0.005408295154571533, 'loss': 5.277788174629212, 'time_step': 0.007501509428024292, 'init_value': 24.58308982849121}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:54.20[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002046177387237549, 'time_algorithm_update': 0.005414514303207397, 'loss': 5.731755895972252, 'time_step': 0.007511984825134277, 'init_value': 31.290922164916992}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:54.29[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020512824058532713, 'time_algorithm_update': 0.005411718130111694, 'loss': 6.08441921210289, 'time_step': 0.007514665126800537, 'init_value': 36.566768646240234}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:54.38[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002045227289199829, 'time_algorithm_update': 0.0054036519527435305, 'loss': 7.380924144268036, 'time_step': 0.0075000979900360105, 'init_value': 41.32550048828125}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:54.47[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020542490482330323, 'time_algorithm_update': 0.005415184736251831, 'loss': 7.663891397714615, 'time_step': 0.007521226644515992, 'init_value': 45.973106384277344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:54.56[0m [[32m[1minfo     [0m] [1mFQE_20250505215325: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020400073528289795, 'time_algorithm_update': 0.005398827314376831, 'loss': 8.442284576654433, 'time_step': 0.007490133762359619, 'init_value': 51.4636344909668}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 51.4636344909668
avg return on 5 trajectories of agent17: 888.3523693333333
Episode generator created
[2m2025-05-05 21:54.59[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:54.59[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:54.59[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:54.59[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:54.59[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215459[0m
[2m2025-05-05 21:54.59[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:55.08[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020317909717559816, 'time_algorithm_update': 0.0054267911911010745, 'loss': 1.608063555687666, 'time_step': 0.007509840726852417, 'init_value': 3.3994386196136475}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:55.17[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039663791656494, 'time_algorithm_update': 0.005437837123870849, 'loss': 3.808331128835678, 'time_step': 0.007529139757156372, 'init_value': 7.821682929992676}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:55.26[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020387628078460695, 'time_algorithm_update': 0.0054367585182189945, 'loss': 4.592259502410888, 'time_step': 0.007526890039443969, 'init_value': 14.40916919708252}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:55.35[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020777649879455567, 'time_algorithm_update': 0.005517483949661255, 'loss': 4.8350296074151995, 'time_step': 0.007648402452468872, 'init_value': 20.0106143951416}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:55.44[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048617124557495, 'time_algorithm_update': 0.005453273057937622, 'loss': 5.561246569395065, 'time_step': 0.007553525686264038, 'init_value': 27.474369049072266}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:55.53[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020489304065704345, 'time_algorithm_update': 0.005452600002288819, 'loss': 6.255293936252594, 'time_step': 0.00755333948135376, 'init_value': 33.336917877197266}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:56.02[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061818599700928, 'time_algorithm_update': 0.0054783341884613035, 'loss': 6.906443985939026, 'time_step': 0.0075926072597503665, 'init_value': 40.466941833496094}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:56.12[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020514905452728273, 'time_algorithm_update': 0.005447103261947632, 'loss': 8.219875276327134, 'time_step': 0.007550720453262329, 'init_value': 47.830806732177734}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:56.21[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020445678234100343, 'time_algorithm_update': 0.005435863018035889, 'loss': 9.529523714542389, 'time_step': 0.007532398700714111, 'init_value': 52.724937438964844}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:56.29[0m [[32m[1minfo     [0m] [1mFQE_20250505215459: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020231320858001708, 'time_algorithm_update': 0.005399750471115112, 'loss': 10.610669852733611, 'time_step': 0.007473499536514282, 'init_value': 58.855613708496094}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 58.855613708496094
avg return on 5 trajectories of agent18: 908.4440006666667
Episode generator created
[2m2025-05-05 21:56.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:56.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:56.33[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:56.33[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:56.33[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215633[0m
[2m2025-05-05 21:56.33[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:56.42[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020246400833129883, 'time_algorithm_update': 0.005356870412826538, 'loss': 1.5923930281996728, 'time_step': 0.007431936740875244, 'init_value': 3.8536956310272217}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:56.51[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002026714324951172, 'time_algorithm_update': 0.0053712201118469236, 'loss': 3.755686804771423, 'time_step': 0.00744856333732605, 'init_value': 8.903533935546875}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:57.00[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020253267288208006, 'time_algorithm_update': 0.00537416672706604, 'loss': 4.592750863671303, 'time_step': 0.007450221538543701, 'init_value': 14.299468040466309}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:57.08[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020304172039031982, 'time_algorithm_update': 0.005376712322235107, 'loss': 5.223123750925064, 'time_step': 0.00745766806602478, 'init_value': 21.303571701049805}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:57.17[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020368897914886473, 'time_algorithm_update': 0.0054137718677520754, 'loss': 5.659273469686508, 'time_step': 0.007501253128051758, 'init_value': 28.13810920715332}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:57.27[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059150457382202, 'time_algorithm_update': 0.005462549448013306, 'loss': 6.277752464771271, 'time_step': 0.007573167324066162, 'init_value': 34.671512603759766}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:57.36[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020580668449401854, 'time_algorithm_update': 0.005458662986755371, 'loss': 6.875013015508651, 'time_step': 0.00756817889213562, 'init_value': 40.305301666259766}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:57.45[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020426716804504393, 'time_algorithm_update': 0.005430706977844238, 'loss': 8.006915778875351, 'time_step': 0.0075242331027984615, 'init_value': 45.28382873535156}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:57.54[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002064270496368408, 'time_algorithm_update': 0.005457585334777832, 'loss': 8.253951266288757, 'time_step': 0.007573320150375366, 'init_value': 50.93484115600586}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:58.03[0m [[32m[1minfo     [0m] [1mFQE_20250505215633: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053403615951538, 'time_algorithm_update': 0.0054586856365203855, 'loss': 9.480043962240218, 'time_step': 0.007563872575759888, 'init_value': 52.833778381347656}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 52.833778381347656
avg return on 5 trajectories of agent19: 907.039521
Episode generator created
[2m2025-05-05 21:58.06[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:58.06[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 21:58.06[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 21:58.06[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 21:58.06[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505215806[0m
[2m2025-05-05 21:58.06[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 21:58.15[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020449438095092773, 'time_algorithm_update': 0.005423776865005493, 'loss': 1.5543662499636413, 'time_step': 0.007521414756774902, 'init_value': 3.8449292182922363}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 21:58.24[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020621337890625, 'time_algorithm_update': 0.005450635433197021, 'loss': 4.026908208847046, 'time_step': 0.00756458067893982, 'init_value': 9.108527183532715}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 21:58.33[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057842969894409, 'time_algorithm_update': 0.005461646556854248, 'loss': 4.701218719959259, 'time_step': 0.007571760416030884, 'init_value': 15.67641544342041}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 21:58.42[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020553274154663085, 'time_algorithm_update': 0.005436569929122925, 'loss': 5.819136127948761, 'time_step': 0.007543846607208252, 'init_value': 23.656415939331055}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 21:58.51[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020580325126647947, 'time_algorithm_update': 0.005453499794006347, 'loss': 5.8696567996740345, 'time_step': 0.007563710689544678, 'init_value': 29.89712142944336}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 21:59.01[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020636332035064695, 'time_algorithm_update': 0.0054498579502105715, 'loss': 6.85025306558609, 'time_step': 0.0075655410289764405, 'init_value': 35.642276763916016}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 21:59.10[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002047301292419434, 'time_algorithm_update': 0.0054249117374420164, 'loss': 6.910919864654541, 'time_step': 0.007524027585983277, 'init_value': 40.18478012084961}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 21:59.19[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020580613613128663, 'time_algorithm_update': 0.005448149442672729, 'loss': 7.6550305256843565, 'time_step': 0.007557994365692139, 'init_value': 45.96446228027344}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 21:59.28[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020637552738189697, 'time_algorithm_update': 0.0054461944103240964, 'loss': 8.065891247272491, 'time_step': 0.007562082052230835, 'init_value': 48.38449478149414}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 21:59.37[0m [[32m[1minfo     [0m] [1mFQE_20250505215806: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002081813335418701, 'time_algorithm_update': 0.005510390043258667, 'loss': 7.929134597063064, 'time_step': 0.007645472526550293, 'init_value': 54.0062141418457}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 54.0062141418457
ave advantage rew: 54.62909145355225, std: 2.2575081585374512
avg cum rews: 900.1992895166666, std: 48.432343794027425
Pearson correlation coefficient: -0.3070724368872452
Spearman correlation coefficient: -0.3518796992481203
Kendall Tau correlation coefficient: -0.2631578947368421
the best agent: 9, best agent cum rewards: 876.247841
1965
---------------------------------
Searching empty space policies
(10, 11472)
(20, 11472)
(20, 11472)
Average distance of agents to nearest neighbors: 0.018532205526543777
avg return on 5 trajectories of agent0: 864.1318263333333
Episode generator created
[2m2025-05-05 21:59.59[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 21:59.59[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:00.00[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:00.00[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:00.00[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220000[0m
[2m2025-05-05 22:00.00[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:00.09[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059057950973511, 'time_algorithm_update': 0.0054262585639953615, 'loss': 1.6334179207682609, 'time_step': 0.007536676645278931, 'init_value': 3.6938624382019043}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:00.18[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020550687313079835, 'time_algorithm_update': 0.005441463232040406, 'loss': 3.995130743741989, 'time_step': 0.0075486116409301755, 'init_value': 8.76801586151123}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:00.27[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.00206466007232666, 'time_algorithm_update': 0.005454479455947876, 'loss': 4.814683588981628, 'time_step': 0.007571095466613769, 'init_value': 15.223185539245605}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:00.36[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002055889368057251, 'time_algorithm_update': 0.005428363561630249, 'loss': 5.351388085126877, 'time_step': 0.007535814523696899, 'init_value': 21.746912002563477}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:00.45[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020963914394378663, 'time_algorithm_update': 0.005528356075286865, 'loss': 5.952968392848969, 'time_step': 0.007678059101104737, 'init_value': 27.368345260620117}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:00.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020691609382629396, 'time_algorithm_update': 0.005449867248535157, 'loss': 6.511177054882049, 'time_step': 0.007570883274078369, 'init_value': 32.790435791015625}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:01.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002067640542984009, 'time_algorithm_update': 0.005438267230987549, 'loss': 6.8094005677700045, 'time_step': 0.007557420015335083, 'init_value': 39.528099060058594}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:01.12[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020618860721588134, 'time_algorithm_update': 0.005457146167755127, 'loss': 7.546810662031174, 'time_step': 0.0075713632106781, 'init_value': 46.79941940307617}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:01.21[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060453176498413, 'time_algorithm_update': 0.005448840856552124, 'loss': 8.976096436977386, 'time_step': 0.007560777425765991, 'init_value': 51.956993103027344}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:01.30[0m [[32m[1minfo     [0m] [1mFQE_20250505220000: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020535383224487306, 'time_algorithm_update': 0.0054428141117095945, 'loss': 9.758969073057175, 'time_step': 0.007548052549362183, 'init_value': 55.824188232421875}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 55.824188232421875
avg return on 5 trajectories of agent1: 967.6061506666666
Episode generator created
[2m2025-05-05 22:01.33[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:01.33[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:01.34[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:01.34[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:01.34[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220134[0m
[2m2025-05-05 22:01.34[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:01.43[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020574510097503664, 'time_algorithm_update': 0.005431777000427246, 'loss': 1.5999491837471724, 'time_step': 0.007540720224380493, 'init_value': 3.810551881790161}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:01.52[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002057594299316406, 'time_algorithm_update': 0.005460011720657349, 'loss': 3.788515027046204, 'time_step': 0.007568962574005127, 'init_value': 9.327132225036621}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:02.01[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020591397285461424, 'time_algorithm_update': 0.005451948881149292, 'loss': 4.935637279868126, 'time_step': 0.007562664985656739, 'init_value': 16.298492431640625}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:02.10[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020660250186920167, 'time_algorithm_update': 0.00547059178352356, 'loss': 5.420476516246795, 'time_step': 0.007588135004043579, 'init_value': 22.071075439453125}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:02.19[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020519843101501466, 'time_algorithm_update': 0.005450295925140381, 'loss': 5.392637938022614, 'time_step': 0.007553303003311157, 'init_value': 28.489049911499023}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:02.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020564024448394775, 'time_algorithm_update': 0.005452866554260254, 'loss': 6.217327174425125, 'time_step': 0.007561026573181152, 'init_value': 33.16029357910156}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:02.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020579867362976074, 'time_algorithm_update': 0.005478201627731323, 'loss': 6.78067284488678, 'time_step': 0.007587993621826172, 'init_value': 39.90624237060547}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:02.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020637385845184326, 'time_algorithm_update': 0.005467436075210571, 'loss': 8.969818892002106, 'time_step': 0.007582468748092651, 'init_value': 46.91252517700195}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:02.55[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002054583787918091, 'time_algorithm_update': 0.005451949596405029, 'loss': 8.83011801791191, 'time_step': 0.007557754516601563, 'init_value': 51.5364990234375}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:03.05[0m [[32m[1minfo     [0m] [1mFQE_20250505220134: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002073054075241089, 'time_algorithm_update': 0.005488517999649048, 'loss': 10.10715260219574, 'time_step': 0.0076138973236083984, 'init_value': 56.03480529785156}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.03480529785156
avg return on 5 trajectories of agent2: 929.714208
Episode generator created
[2m2025-05-05 22:03.08[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:03.08[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:03.08[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:03.08[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:03.08[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220308[0m
[2m2025-05-05 22:03.08[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:03.17[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020709648132324217, 'time_algorithm_update': 0.005481931209564209, 'loss': 1.6550785248279571, 'time_step': 0.007605765342712402, 'init_value': 3.715223789215088}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:03.26[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020477607250213624, 'time_algorithm_update': 0.005446043729782105, 'loss': 3.856538064002991, 'time_step': 0.007545466423034668, 'init_value': 8.306794166564941}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:03.35[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020487167835235597, 'time_algorithm_update': 0.005450545072555542, 'loss': 4.496011241078377, 'time_step': 0.007551316261291504, 'init_value': 14.080427169799805}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:03.44[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020406146049499513, 'time_algorithm_update': 0.005437236309051513, 'loss': 5.118391786575318, 'time_step': 0.007529221296310425, 'init_value': 19.108705520629883}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:03.53[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002050215005874634, 'time_algorithm_update': 0.005444216012954712, 'loss': 5.45478930401802, 'time_step': 0.0075460968017578125, 'init_value': 24.896316528320312}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:04.02[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020528850555419924, 'time_algorithm_update': 0.005455238103866577, 'loss': 5.946469226837158, 'time_step': 0.007559668779373169, 'init_value': 30.61341667175293}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:04.11[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020557973384857176, 'time_algorithm_update': 0.0054565823078155514, 'loss': 6.344701473236084, 'time_step': 0.007564258098602295, 'init_value': 37.38860321044922}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:04.20[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020576937198638918, 'time_algorithm_update': 0.005454909563064575, 'loss': 7.726687806606293, 'time_step': 0.007564077138900757, 'init_value': 42.83226776123047}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:04.29[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002060039520263672, 'time_algorithm_update': 0.0054593031406402585, 'loss': 8.795559551477432, 'time_step': 0.0075707688331604, 'init_value': 51.09502029418945}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:04.39[0m [[32m[1minfo     [0m] [1mFQE_20250505220308: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002061870098114014, 'time_algorithm_update': 0.0054596331119537355, 'loss': 9.263777771949767, 'time_step': 0.007573343276977539, 'init_value': 56.61045455932617}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 56.61045455932617
avg return on 5 trajectories of agent3: 947.888767
Episode generator created
[2m2025-05-05 22:04.42[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:04.42[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:04.42[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:04.42[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:04.42[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220442[0m
[2m2025-05-05 22:04.42[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:04.51[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020392591953277586, 'time_algorithm_update': 0.005424839735031128, 'loss': 1.659699484437704, 'time_step': 0.007515105009078979, 'init_value': 3.8832569122314453}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:05.00[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020512917041778564, 'time_algorithm_update': 0.005438137292861939, 'loss': 3.7552641520500183, 'time_step': 0.007541013479232788, 'init_value': 8.439477920532227}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:05.09[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002048377752304077, 'time_algorithm_update': 0.005432481527328491, 'loss': 4.644180485486984, 'time_step': 0.007532474756240845, 'init_value': 14.919075965881348}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:05.18[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020493192672729494, 'time_algorithm_update': 0.005436148166656494, 'loss': 5.236364762067795, 'time_step': 0.007536596298217774, 'init_value': 21.285179138183594}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:05.27[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020605077743530275, 'time_algorithm_update': 0.005448323011398315, 'loss': 6.12040317106247, 'time_step': 0.007560463190078736, 'init_value': 29.584430694580078}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:05.36[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020604238510131836, 'time_algorithm_update': 0.005443665742874145, 'loss': 6.777260029554367, 'time_step': 0.007555590152740478, 'init_value': 36.9540901184082}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:05.45[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020536072254180907, 'time_algorithm_update': 0.005443477153778077, 'loss': 7.5502083661556245, 'time_step': 0.007548247575759888, 'init_value': 41.584415435791016}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:05.54[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020610759258270265, 'time_algorithm_update': 0.0054521412849426265, 'loss': 8.589868878602982, 'time_step': 0.007564729452133179, 'init_value': 47.60647201538086}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:06.03[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020587031841278075, 'time_algorithm_update': 0.005453635454177857, 'loss': 8.786492307424545, 'time_step': 0.007564169406890869, 'init_value': 51.43714904785156}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:06.12[0m [[32m[1minfo     [0m] [1mFQE_20250505220442: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002058753252029419, 'time_algorithm_update': 0.005438668966293335, 'loss': 10.07481998348236, 'time_step': 0.007549143552780151, 'init_value': 57.33162307739258}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.33162307739258
avg return on 5 trajectories of agent4: 1003.9492056666667
Episode generator created
[2m2025-05-05 22:06.15[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:06.15[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:06.16[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:06.16[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:06.16[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220616[0m
[2m2025-05-05 22:06.16[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:06.25[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020433642864227295, 'time_algorithm_update': 0.005440186023712159, 'loss': 1.6854930095523595, 'time_step': 0.007535124540328979, 'init_value': 3.604886531829834}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:06.34[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002039456844329834, 'time_algorithm_update': 0.005427320003509522, 'loss': 4.267006090641022, 'time_step': 0.007517878770828247, 'init_value': 9.42180347442627}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:06.43[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002059457778930664, 'time_algorithm_update': 0.005457243204116821, 'loss': 4.899050352096558, 'time_step': 0.00756862211227417, 'init_value': 15.00060749053955}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:06.52[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020248706340789797, 'time_algorithm_update': 0.005367945671081543, 'loss': 5.035357935190201, 'time_step': 0.007443641185760498, 'init_value': 20.488798141479492}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:07.01[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020198256969451906, 'time_algorithm_update': 0.005363442897796631, 'loss': 5.385849718093872, 'time_step': 0.0074339165687561035, 'init_value': 25.75574493408203}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:07.10[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020165746212005616, 'time_algorithm_update': 0.005360532522201538, 'loss': 5.934426825761795, 'time_step': 0.00742740511894226, 'init_value': 31.132648468017578}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:07.19[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020186910629272463, 'time_algorithm_update': 0.005355816602706909, 'loss': 6.777243064880371, 'time_step': 0.007424809694290161, 'init_value': 37.623878479003906}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:07.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020200564861297607, 'time_algorithm_update': 0.005381775379180908, 'loss': 7.09128296995163, 'time_step': 0.007452420949935913, 'init_value': 41.34172058105469}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:07.37[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020557529926300048, 'time_algorithm_update': 0.0054449539184570316, 'loss': 7.841721579551697, 'time_step': 0.007552026748657226, 'init_value': 45.06475067138672}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:07.46[0m [[32m[1minfo     [0m] [1mFQE_20250505220616: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020560064315795898, 'time_algorithm_update': 0.00544390082359314, 'loss': 8.605989568471909, 'time_step': 0.007552588939666748, 'init_value': 48.90949630737305}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 48.90949630737305
avg return on 5 trajectories of agent5: 912.2793656666666
Episode generator created
[2m2025-05-05 22:07.49[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:07.49[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:07.49[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:07.49[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:07.49[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220749[0m
[2m2025-05-05 22:07.49[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:07.58[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020347468852996826, 'time_algorithm_update': 0.005381148338317871, 'loss': 1.6321869775503874, 'time_step': 0.007466489553451538, 'init_value': 3.870490074157715}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:08.07[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020511507987976073, 'time_algorithm_update': 0.005418765068054199, 'loss': 3.94804414331913, 'time_step': 0.007521158695220948, 'init_value': 9.26323413848877}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:08.16[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002053775072097778, 'time_algorithm_update': 0.005412023782730102, 'loss': 4.589779186248779, 'time_step': 0.007517512083053589, 'init_value': 15.640331268310547}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:08.25[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0020495502948760986, 'time_algorithm_update': 0.0054084091186523435, 'loss': 5.000189409255982, 'time_step': 0.007509129285812378, 'init_value': 21.543212890625}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:08.34[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.002042128801345825, 'time_algorithm_update': 0.005410998582839966, 'loss': 5.811271819710732, 'time_step': 0.007504639863967896, 'init_value': 28.52371597290039}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:08.43[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019964470863342285, 'time_algorithm_update': 0.005261341571807862, 'loss': 6.244489912033081, 'time_step': 0.007306674718856812, 'init_value': 35.6341438293457}[0m [36mstep[0m=[35m6000[0m
[2m2025-05-05 22:08.51[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=7 step=7000[0m [36mepoch[0m=[35m7[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018910064697265625, 'time_algorithm_update': 0.005049971342086792, 'loss': 7.085166732311249, 'time_step': 0.006985684156417846, 'init_value': 39.99296188354492}[0m [36mstep[0m=[35m7000[0m
[2m2025-05-05 22:09.00[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=8 step=8000[0m [36mepoch[0m=[35m8[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001891582489013672, 'time_algorithm_update': 0.0050489377975463864, 'loss': 7.617115656375885, 'time_step': 0.0069854755401611325, 'init_value': 46.29902267456055}[0m [36mstep[0m=[35m8000[0m
[2m2025-05-05 22:09.08[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=9 step=9000[0m [36mepoch[0m=[35m9[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019035732746124267, 'time_algorithm_update': 0.005056944608688355, 'loss': 9.010857655286788, 'time_step': 0.00700561261177063, 'init_value': 52.24617385864258}[0m [36mstep[0m=[35m9000[0m
[2m2025-05-05 22:09.17[0m [[32m[1minfo     [0m] [1mFQE_20250505220749: epoch=10 step=10000[0m [36mepoch[0m=[35m10[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001897822380065918, 'time_algorithm_update': 0.005059011459350586, 'loss': 10.139694158792496, 'time_step': 0.00700168776512146, 'init_value': 57.65633773803711}[0m [36mstep[0m=[35m10000[0m

FQE Fitting completed.
Estimated Initial State Value: 57.65633773803711
avg return on 5 trajectories of agent6: 935.4623593333334
Episode generator created
[2m2025-05-05 22:09.20[0m [[32m[1minfo     [0m] [1mAction-space has been automatically determined.[0m [36maction_space[0m=[35m<ActionSpace.CONTINUOUS: 1>[0m
[2m2025-05-05 22:09.20[0m [[32m[1minfo     [0m] [1mAction size has been automatically determined.[0m [36maction_size[0m=[35m8[0m
PPOQWrapper initialized on device: cpu
--------------------------------------------------------------------------------
Fitting d3rlpy FQE...
[2m2025-05-05 22:09.20[0m [[32m[1mdebug    [0m] [1mBuilding models...            [0m
[2m2025-05-05 22:09.20[0m [[32m[1mdebug    [0m] [1mModels have been built.       [0m
[2m2025-05-05 22:09.20[0m [[32m[1minfo     [0m] [1mDirectory is created at d3rlpy_logs/FQE_20250505220920[0m
[2m2025-05-05 22:09.20[0m [[32m[1minfo     [0m] [1mParameters                    [0m [36mparams[0m=[35m{'observation_shape': [105], 'action_size': 8, 'config': {'type': 'fqe', 'params': {'batch_size': 100, 'gamma': 0.99, 'observation_scaler': {'type': 'none', 'params': {}}, 'action_scaler': {'type': 'none', 'params': {}}, 'reward_scaler': {'type': 'none', 'params': {}}, 'compile_graph': False, 'learning_rate': 0.0003, 'optim_factory': {'type': 'adam', 'params': {'clip_grad_norm': None, 'lr_scheduler_factory': {'type': 'none', 'params': {}}, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0, 'amsgrad': False}}, 'encoder_factory': {'type': 'default', 'params': {'activation': 'relu', 'use_batch_norm': False, 'dropout_rate': None}}, 'q_func_factory': {'type': 'mean', 'params': {'share_encoder': False}}, 'n_critics': 1, 'target_update_interval': 100}}}[0m
[2m2025-05-05 22:09.28[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=1 step=1000[0m [36mepoch[0m=[35m1[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0019068496227264405, 'time_algorithm_update': 0.005072050333023072, 'loss': 1.7028508236557245, 'time_step': 0.007024423599243164, 'init_value': 3.6734399795532227}[0m [36mstep[0m=[35m1000[0m
[2m2025-05-05 22:09.36[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=2 step=2000[0m [36mepoch[0m=[35m2[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018471889495849608, 'time_algorithm_update': 0.004962873220443725, 'loss': 4.026022670865059, 'time_step': 0.0068524832725524905, 'init_value': 8.65427017211914}[0m [36mstep[0m=[35m2000[0m
[2m2025-05-05 22:09.45[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=3 step=3000[0m [36mepoch[0m=[35m3[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018153388500213622, 'time_algorithm_update': 0.004890399217605591, 'loss': 4.711898157596588, 'time_step': 0.006745953559875489, 'init_value': 15.110635757446289}[0m [36mstep[0m=[35m3000[0m
[2m2025-05-05 22:09.53[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=4 step=4000[0m [36mepoch[0m=[35m4[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001820749282836914, 'time_algorithm_update': 0.004896254062652588, 'loss': 5.3743277387619015, 'time_step': 0.0067573776245117186, 'init_value': 21.06552505493164}[0m [36mstep[0m=[35m4000[0m
[2m2025-05-05 22:10.01[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=5 step=5000[0m [36mepoch[0m=[35m5[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.001818244218826294, 'time_algorithm_update': 0.00490184760093689, 'loss': 5.830999638080597, 'time_step': 0.006760721921920777, 'init_value': 29.051233291625977}[0m [36mstep[0m=[35m5000[0m
[2m2025-05-05 22:10.09[0m [[32m[1minfo     [0m] [1mFQE_20250505220920: epoch=6 step=6000[0m [36mepoch[0m=[35m6[0m [36mmetrics[0m=[35m{'time_sample_batch': 0.0018337984085083007, 'time_algorithm_update': 0.004934574604034424, 'loss': 6.259318819284439, 'time_step': 0.006810756683349609, 'init_value': 34.31496047973633}[0m [36mstep[0m=[35m6000[0m
